
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="baidu-site-verification" content="1XvvwQ7Apt" />
  
    <title>dianzi blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="edwin">
    

    
    <meta name="description" content="edwin jin dianzi blog">
<meta property="og:type" content="website">
<meta property="og:title" content="dianzi blog">
<meta property="og:url" content="http://taojinke.github.io/page/5/index.html">
<meta property="og:site_name" content="dianzi blog">
<meta property="og:description" content="edwin jin dianzi blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="dianzi blog">
<meta name="twitter:description" content="edwin jin dianzi blog">

    
    <link rel="alternative" href="/atom.xml" title="dianzi blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">

  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?345f95aea4ada2935d6f9ea4177b51ab";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>

</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="dianzi blog" title="dianzi blog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="dianzi blog">dianzi blog</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
						<a href="/music/index.html" target="_blank">Music</a>
					</li>
					<li>
 					
						<form class="search" action="http://taojinke.github.io/" target="_blank">
							<label>Search</label>
						<input name="s" type="hidden" value= null ><input type="text" name="q" size="30" placeholder="搜索"><br>
						</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/03/236f4bf/" title="Memcache的hash策略及配置总结 -" itemprop="url">Memcache的hash策略及配置总结 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-03T02:09:37.000Z" itemprop="datePublished"> 发表于 2015-07-03</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p><a href="http://www.drupal001.com/wp-content/plugins/down-as-pdf/generate.php?id=1290" target="_blank" rel="external">PDF&#x7248;&#x672C;</a></p>
<p>Memcach&#x662F;web&#x5E94;&#x7528;/ <a href="http://drupal001.net" target="_blank" rel="external">Drupal</a> &#x5E94;&#x7528;&#x6027;&#x80FD;&#x63D0;&#x9AD8;&#x7684;&#x5229;&#x5668;&#xFF0C;&#x8FD1;&#x671F;&#x5728;&#x4F7F;&#x7528;Memcache&#x4E2D;&#xFF0C;&#x53D1;&#x73B0;&#x6709;&#x5F88;&#x591A;&#x5C0F;&#x95EE;&#x9898;&#xFF0C;&#x56E0;&#x6B64;&#x4F5C;&#x8005;&#x7279;&#x610F;&#x603B;&#x7ED3;&#x4E86;&#x51E0;&#x4E2A;&#xFF0C;&#x653E;&#x4E0A;&#x6765;&#x4F9B;&#x5927;&#x5BB6;&#x53C2;&#x8003;&#x4F7F;&#x7528;&#x3002; </p>
<h4 id="1-_Memcache&#x548C;Memcached&#x7684;&#x533A;&#x522B;">1. Memcache&#x548C;Memcached&#x7684;&#x533A;&#x522B;</h4><h4 id="&#x8FD9;&#x4E2A;&#x662F;&#x5386;&#x53F2;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x662F;&#xFF0C;&#x8A00;&#x800C;&#x603B;&#x4E4B;&#xFF1A;&#x540D;&#x5B57;&#x957F;&#x7684;&#x66F4;&#x725B;&#x903C;!_&#xA0;">&#x8FD9;&#x4E2A;&#x662F;&#x5386;&#x53F2;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x662F;&#xFF0C;&#x8A00;&#x800C;&#x603B;&#x4E4B;&#xFF1A;&#x540D;&#x5B57;&#x957F;&#x7684;&#x66F4;&#x725B;&#x903C;! &#xA0;</h4><p>&#x6240;&#x4EE5;&#xFF0C;&#x63A8;&#x8350;&#x4F7F;&#x7528;memcached&#x3002;&#x53E6;&#x5916;&#xFF0C;memcached&#x6709;&#x5F88;&#x591A;&#x65B0;&#x7279;&#x6027;&#xFF0C;&#x5305;&#x62EC;getMulti/setMulti&#x3001;&#x652F;&#x6301;&#x5B58;&#x50A8;object&#x3001;&#x652F;&#x6301;count+1&#x64CD;&#x4F5C;&#xFF0C;&#x90FD;&#x4F1A;&#x6BD4;memcache&#x7684;&#x597D;&#x7528;&#x4E00;&#x4E9B;&#xFF0C;&#x53EF;&#x4EE5;&#x8BD5;&#x8BD5;&#xFF0C;&#x6216;&#x8BB8;&#x4EE5;&#x540E;&#x652F;&#x6301;&#x66F4;&#x591A;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x8D76;&#x4E0A;redis&#x3002;&#x3002; </p>
<p><a href="http://drupal001.net" target="_blank" rel="external">Drupal&#x5927;&#x5B66;</a> &#x4E0A;&#x5173;&#x4E8E;memcache&#x7684;&#x95EE;&#x7B54;&#xFF1A; <a href="http://drupal001.net/search/apachesolr_search/memcache" target="_blank" rel="external">http://drupal001.net/search/apachesolr_search/memcache</a></p>
<p>&#x5982;&#x4E0B;&#xFF08;&#x6458;&#x81EA;&#x5FB7;&#x95EE;&#xFF09;&#xFF1A; </p>
<pre><code><span class="symbol">#Memcache</span>
<span class="char">$m</span> = new <span class="class">Memcache</span>();
<span class="char">$m</span>-&amp;amp;gt;addServer(&amp;apos;localhost&amp;apos;, <span class="number">11211</span>);
<span class="char">$v</span> = <span class="char">$m</span>-&amp;amp;gt;get(&amp;apos;counter&amp;apos;);
<span class="char">$m</span>-&amp;amp;gt;set(&amp;apos;counter&amp;apos;, <span class="char">$v</span> + <span class="number">1</span>); 
#&amp;<span class="symbol">#x7531</span>;&amp;<span class="symbol">#x4E8E</span>;get/set&amp;<span class="symbol">#x8FD9</span>;&amp;<span class="symbol">#x4E24</span>;&amp;<span class="symbol">#x4E2A</span>;&amp;<span class="symbol">#x52A8</span>;&amp;<span class="symbol">#x4F5C</span>;&amp;<span class="symbol">#x65E0</span>;&amp;<span class="symbol">#x6CD5</span>;&amp;<span class="symbol">#x4F5C</span>;&amp;<span class="symbol">#x4E3A</span>;&amp;<span class="symbol">#x4E00</span>;&amp;<span class="symbol">#x4E2A</span>;&amp;<span class="symbol">#x539F</span>;&amp;<span class="symbol">#x5B50</span>;&amp;<span class="symbol">#x6765</span>;&amp;<span class="symbol">#x64CD</span>;&amp;<span class="symbol">#x4F5C</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x6240</span>;&amp;<span class="symbol">#x4EE5</span>;&amp;<span class="symbol">#x5F53</span>;&amp;<span class="symbol">#x591A</span>;&amp;<span class="symbol">#x4E2A</span>;&amp;<span class="symbol">#x8FDB</span>;&amp;<span class="symbol">#x7A0B</span>;&amp;<span class="symbol">#x540C</span>;&amp;<span class="symbol">#x65F6</span>;&amp;<span class="symbol">#x5904</span>;&amp;<span class="symbol">#x7406</span>;&amp;<span class="symbol">#x65F6</span>;&amp;<span class="symbol">#xFF0C</span>;
#&amp;<span class="symbol">#x4F1A</span>;&amp;<span class="symbol">#x51FA</span>;&amp;<span class="symbol">#x73B0</span>;&amp;<span class="symbol">#x4E22</span>;&amp;<span class="symbol">#x5931</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x53EF</span>;&amp;<span class="symbol">#x80FD</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x66F4</span>;&amp;<span class="symbol">#x8BA9</span>;&amp;<span class="symbol">#x4EBA</span>;&amp;<span class="symbol">#x607C</span>;&amp;<span class="symbol">#x706B</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x662F</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x4F60</span>;&amp;<span class="symbol">#x6839</span>;&amp;<span class="symbol">#x672C</span>;&amp;<span class="symbol">#x5C31</span>;&amp;<span class="symbol">#x4E0D</span>;&amp;<span class="symbol">#x77E5</span>;&amp;<span class="symbol">#x9053</span>;&amp;<span class="symbol">#x4EC0</span>;&amp;<span class="symbol">#x4E48</span>;&amp;<span class="symbol">#x65F6</span>;&amp;<span class="symbol">#x5019</span>;&amp;<span class="symbol">#x51FA</span>;&amp;<span class="symbol">#x73B0</span>;&amp;<span class="symbol">#x4E22</span>;&amp;<span class="symbol">#x5931</span>;&amp;<span class="symbol">#x3002</span>;

<span class="symbol">#Memcached</span>
<span class="char">$m</span>d = new <span class="class">Memcached</span>();
<span class="char">$m</span>d-&amp;amp;gt;addServer(&amp;apos;localhost&amp;apos;, <span class="number">11211</span>);
<span class="char">$v</span> = <span class="char">$m</span>d-&amp;amp;gt;get(&amp;apos;counter&amp;apos;, null, <span class="char">$t</span>oken)
<span class="char">$m</span>d-&amp;amp;gt;cas(<span class="char">$t</span>oken, &amp;apos;counter&amp;apos;, <span class="char">$v</span> + <span class="number">1</span>);
<span class="symbol">#cas</span>&amp;<span class="symbol">#x662F</span>;<span class="class">Memcached</span>&amp;<span class="symbol">#x7248</span>;&amp;<span class="symbol">#x672C</span>;&amp;<span class="symbol">#x91CC</span>;&amp;<span class="symbol">#x63D0</span>;&amp;<span class="symbol">#x4F9B</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x529F</span>;&amp;<span class="symbol">#x80FD</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x8BF4</span>;&amp;<span class="symbol">#x767D</span>;&amp;<span class="symbol">#x4E86</span>;&amp;<span class="symbol">#x5C31</span>;&amp;<span class="symbol">#x662F</span>;&amp;<span class="symbol">#x4E00</span>;&amp;<span class="symbol">#x4E2A</span>;&amp;<span class="symbol">#x4E50</span>;&amp;<span class="symbol">#x89C2</span>;&amp;<span class="symbol">#x9501</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x529F</span>;&amp;<span class="symbol">#x80FD</span>;&amp;<span class="symbol">#xFF0C</span>;
#&amp;<span class="symbol">#x5982</span>;&amp;<span class="symbol">#x679C</span>;&amp;<span class="symbol">#x4F60</span>;&amp;<span class="symbol">#x628A</span>;<span class="char">$t</span>oken&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x503C</span>;var_dump&amp;<span class="symbol">#x51FA</span>;&amp;<span class="symbol">#x6765</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x5C31</span>;&amp;<span class="symbol">#x4F1A</span>;&amp;<span class="symbol">#x53D1</span>;&amp;<span class="symbol">#x73B0</span>;<span class="char">$t</span>oken&amp;<span class="symbol">#x5176</span>;&amp;<span class="symbol">#x5B9E</span>;&amp;<span class="symbol">#x5C31</span>;&amp;<span class="symbol">#x662F</span>;&amp;<span class="symbol">#x4E00</span>;&amp;<span class="symbol">#x4E2A</span>;&amp;<span class="symbol">#x7248</span>;&amp;<span class="symbol">#x672C</span>;&amp;<span class="symbol">#x53F7</span>;&amp;<span class="symbol">#xFF0C</span>;
#&amp;<span class="symbol">#x5982</span>;&amp;<span class="symbol">#x679C</span>;&amp;<span class="symbol">#x901A</span>;&amp;<span class="symbol">#x8FC7</span>;get&amp;<span class="symbol">#x5F97</span>;&amp;<span class="symbol">#x5230</span>;&amp;<span class="symbol">#x7684</span>;<span class="char">$t</span>oken&amp;<span class="symbol">#x7248</span>;&amp;<span class="symbol">#x672C</span>;&amp;<span class="symbol">#x53F7</span>;&amp;<span class="symbol">#x5728</span>;cas&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x65F6</span>;&amp;<span class="symbol">#x5019</span>;&amp;<span class="symbol">#x4E0D</span>;&amp;<span class="symbol">#x5BF9</span>;&amp;<span class="symbol">#x5E94</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x5C31</span>;&amp;<span class="symbol">#x8BF4</span>;&amp;<span class="symbol">#x660E</span>;&amp;<span class="symbol">#x5DF2</span>;&amp;<span class="symbol">#x7ECF</span>;&amp;<span class="symbol">#x6709</span>;&amp;<span class="symbol">#x522B</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x64CD</span>;&amp;<span class="symbol">#x4F5C</span>;&amp;<span class="symbol">#x66F4</span>;&amp;<span class="symbol">#x65B0</span>;&amp;<span class="symbol">#x4E86</span>;&amp;<span class="symbol">#xFF0C</span>;
#&amp;<span class="symbol">#x6B64</span>;&amp;<span class="symbol">#x65F6</span>;cas&amp;<span class="symbol">#x64CD</span>;&amp;<span class="symbol">#x4F5C</span>;&amp;<span class="symbol">#x4F1A</span>;&amp;<span class="symbol">#x5931</span>;&amp;<span class="symbol">#x8D25</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x81F3</span>;&amp;<span class="symbol">#x4E8E</span>;&amp;<span class="symbol">#x5982</span>;&amp;<span class="symbol">#x4F55</span>;&amp;<span class="symbol">#x7EE7</span>;&amp;<span class="symbol">#x7EED</span>;&amp;<span class="symbol">#x64CD</span>;&amp;<span class="symbol">#x4F5C</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x5C31</span>;&amp;<span class="symbol">#x770B</span>;&amp;<span class="symbol">#x4F60</span>;&amp;<span class="symbol">#x81EA</span>;&amp;<span class="symbol">#x5DF1</span>;&amp;<span class="symbol">#x4E86</span>;
</code></pre><p>&#x4E24;&#x8005;&#x7684;&#x533A;&#x522B;&#x5982;&#x4E0B;&#xFF0C;&#x4E0B;&#x9762;&#x662F;Memcache&#x7684;&#x65B9;&#x6CD5;&#xFF1A;</p>
<p><img src="http://taojinke.github.io/img/20150703/236c65c.png" alt=""></p>
<p>&#x4E0B;&#x9762;&#x662F;memcached&#x7684;&#x65B9;&#x6CD5;&#xFF1A;</p>
<p><img src="http://taojinke.github.io/img/20150703/236c8cd.png" alt=""></p>
<h4 id="2-_Memcache&#x7684;&#x54C8;&#x5E0C;&#x7B56;&#x7565;">2. Memcache&#x7684;&#x54C8;&#x5E0C;&#x7B56;&#x7565;</h4><p>&#x5E38;&#x89C4;&#x7684;hash&#x7B56;&#x7565;&#x662F;&#x53D6;&#x6A21;&#xFF0C;&#x6BD4;&#x5982;key=10, &#x6709;&#x4E24;&#x53F0;&#x670D;&#x52A1;&#xFF0C;&#x5C31;10%2=0&#xFF0C;&#x7B97;&#x51FA;&#x8BE5;&#x503C;&#x5206;&#x5E03;&#x5728;&#x7B2C;&#x4E00;&#x53F0;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x3002;&#x90A3;&#x4E48;&#x7F3A;&#x70B9;&#x4E5F;&#x5F88;&#x660E;&#x663E;&#xFF0C;&#x6BD4;&#x5982;&#x670D;&#x52A1;&#x5668;&#x589E;&#x52A0;&#x4E00;&#x53F0;&#xFF0C;&#x4E4B;&#x524D;&#x7684;&#x5206;&#x5E03;&#x5F0F;&#x7B56;&#x7565;&#x5168;&#x5B8C;&#x86CB;&#x3002; </p>
<p>&#x56E0;&#x6B64;&#xFF0C;&#x4E1A;&#x754C;&#x9700;&#x8981;&#x66F4;&#x725B;&#x903C;&#x7684;&#x7B97;&#x6CD5;~</p>
<p>&#x4E00;&#x81F4;&#x6027;hash&#x7B97;&#x6CD5;&#x9686;&#x91CD;&#x767B;&#x573A;&#xFF01;</p>
<p>&#x7B80;&#x5355;&#x8BF4;&#x6765;&#xFF0C;&#x4E00;&#x81F4;&#x6027;hash&#x7B97;&#x6CD5;&#x5C31;&#x662F;&#x5148;&#x628A;&#x670D;&#x52A1;&#x5668;&#x4E5F;&#x901A;&#x8FC7;&#x67D0;&#x4E00;&#x4E2A;&#x7279;&#x5F81;&#xFF08;&#x5982;IP/MAC&#x5730;&#x5740;&#xFF09;hash&#x4E00;&#x4E0B;&#xFF0C;&#x8FD9;&#x6837;&#x670D;&#x52A1;&#x5668;&#x4F1A;&#x6309;&#x7167;&#x5206;&#x5E03;&#xFF08;&#x53EF;&#x80FD;&#x4E0D;&#x5747;&#x5300;&#xFF09;&#x5728;&#x4E00;&#x4E2A;&#x8303;&#x56F4;&#xFF0C;&#x7136;&#x540E;&#x628A;key&#x518D;hash&#x4E00;&#x4E0B;&#xFF0C;&#x7136;&#x540E;&#x770B;key&#x6700;&#x8FD1;&#x7684;&#x4E0B;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x4F5C;&#x4E3A;&#x8BE5;key&#x7684;&#x5B58;&#x50A8;bin&#x3002;&#x8FD9;&#x6837;&#xFF0C;&#x5982;&#x679C;&#x589E;&#x52A0;&#x4E00;&#x53F0;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x91CD;&#x65B0;&#x5206;&#x914D;&#x7684;key&#x53EA;&#x662F;&#x5206;&#x5E03;&#x518D;&#x65B0;&#x589E;&#x7684;&#x8FD9;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x548C;&#x4E0A;&#x4E00;&#x4E2A;&#x6700;&#x8FD1;&#x7684;&#x670D;&#x52A1;&#x5668;&#x4E4B;&#x95F4;&#x7684;key&#xFF0C;&#x5176;&#x4F59;&#x7684;&#x90FD;&#x4E0D;&#x53D8;&#x3002; </p>
<p>&#x521D;&#x6B65;&#x7684;&#x670D;&#x52A1;&#x5668;&#x5206;&#x5E03;&#xFF1A;</p>
<p><img src="http://taojinke.github.io/img/20150703/236cb3e.jpg" alt=""></p>
<p>&#x589E;&#x52A0;&#x670D;&#x52A1;&#x5668;&#x7684;&#x5206;&#x5E03;&#xFF1A;</p>
<p><img src="http://taojinke.github.io/img/20150703/236cdaf.jpg" alt=""></p>
<p>&#x4E0A;&#x9762;&#x7684;&#x63CF;&#x8FF0;&#x7684;&#x662F;&#x767D;&#x8BDD;&#xFF0C;&#x53EF;&#x80FD;&#x6BD4;&#x8F83;&#x62D7;&#x53E3;&#xFF0C;&#x7B14;&#x8005;&#x6587;&#x5B57;&#x6C34;&#x5E73;&#x6709;&#x9650;&#xFF0C;&#x8BE6;&#x60C5;&#x89C1;&#x4E0B;&#x9762;&#x7684;&#x94FE;&#x63A5;&#xFF1A;</p>
<p><a href="http://blogread.cn/it/article/5271" target="_blank" rel="external">http://blogread.cn/it/article/5271</a></p>
<p><a href="http://blog.csdn.net/kongqz/article/details/669541" target="_blank" rel="external">http://blog.csdn.net/kongqz/article/details/669541</a> 7 </p>
<h4 id="3-_Memcache&#x7684;hash&#x7B56;&#x7565;&#x914D;&#x7F6E;">3. Memcache&#x7684;hash&#x7B56;&#x7565;&#x914D;&#x7F6E;</h4><p>Memcache&#x5B89;&#x88C5;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x54C8;&#x5E0C;&#x7B56;&#x7565;&#xFF0C;memcache.hash_strategy&#x3002;&#x76EE;&#x524D;&#x6709;standard&#x6A21;&#x5F0F;&#x548C;consistent&#x6A21;&#x5F0F;&#x3002;standard&#x6A21;&#x5F0F;&#x5176;&#x5B9E;&#x5C31;&#x662F;%&#xFF0C;&#x5373;&#x53D6;&#x6A21;&#x3002;&#x800C;consistent&#xFF0C;&#x5C31;&#x662F;hash&#x7684;&#x4E00;&#x81F4;&#x6027;&#x7B97;&#x6CD5;&#x3002;</p>
<p>&#x5728;Memcache&#x4E2D;&#xFF0C;hash&#x7B56;&#x7565;&#x5728;PHP.ini&#x6587;&#x4EF6;&#x4E2D;&#x8BBE;&#x7F6E;</p>
<pre><code>[Memcache] 
Memcache.<span class="variable">allow_failover =</span> <span class="number">1</span> 
&amp;<span class="comment">#x2026;&amp;#x2026; </span>
&amp;<span class="comment">#x2026;&amp;#x2026; </span>
Memcache.<span class="variable">hash_strategy =</span>consistent 
Memcache.<span class="variable">hash_function =</span>crc32
</code></pre><p>&#x5728;Memcached&#x4E2D;&#xFF0C;hash&#x7B56;&#x7565;&#x5728;PHP&#x7684;&#x53C2;&#x6570;&#x4E2D;&#x8BBE;&#x7F6E;&#xFF1A;</p>
<pre><code>mem <span class="subst">=</span> <span class="literal">new</span> memcached(); 
<span class="variable">$mem</span><span class="subst">-&amp;</span>amp;<span class="literal">gt</span>;setOption(Memcached<span class="tag">::OPT_DISTRIBUTION</span>,Memcached<span class="tag">::DISTRIBUTION_CONSISTENT</span>); 
<span class="variable">$mem</span><span class="subst">-&amp;</span>amp;<span class="literal">gt</span>;setOption(Memcached<span class="tag">::OPT_LIBKETAMA_COMPATIBLE</span>,<span class="literal">true</span>);
</code></pre><h4 id="4-_&#x540E;&#x8BB0;">4. &#x540E;&#x8BB0;</h4><p>&#x56E0;&#x6B64;&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x63A8;&#x8350;&#x4F7F;&#x7528;&#x4E00;&#x81F4;&#x6027;&#x54C8;&#x5E0C;&#x7B97;&#x6CD5;&#xFF0C;&#x4F46;&#x51E1;&#x4E8B;&#x65E0;&#x7EDD;&#x5BF9;&#xFF0C;&#x6BD4;&#x5982;&#x4E00;&#x4E2A;&#x5C0F;&#x7684;&#x7AD9;&#x70B9;&#xFF0C;memcache&#x7684;&#x670D;&#x52A1;&#x51E0;&#x4E4E;&#x6C38;&#x4E0D;&#x4F1A;&#x589E;&#x52A0;&#xFF0C;&#x8FD9;&#x662F;&#x7528;&#x5E38;&#x89C4;&#x7684;standard&#x7684;&#x7B97;&#x6CD5;&#x4E5F;&#x662F;&#x6BD4;&#x8F83;&#x63A8;&#x8350;&#x7684;&#xFF0C;&#x6BD5;&#x7ADF;&#x4E00;&#x81F4;&#x6027;&#x7B97;&#x6CD5;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x5747;&#x5300;&#x5206;&#x5E03;&#x7684;&#x95EE;&#x9898;&#xFF08;&#x53EF;&#x80FD;&#x5DF2;&#x7ECF;&#x89E3;&#x51B3;&#x4E86;&#x3002;&#x3002;&#xFF09;</p>
<p>&#x6253;&#x5B8C;&#x6536;&#x5DE5;&#xFF01;</p>
<p>&#x5173;&#x4E8E; <a href="http://www.drupal001.com" target="_blank" rel="external">drupal</a> &#x548C;memcache&#x7684;&#x96C6;&#x6210;&#xFF0C;&#xFFFD;&#xFFFD;&#xFFFD;&#x5BB6;&#x53C2;&#x8003;&#x4E0B;&#x9762;&#x7684;&#x6587;&#x7AE0;&#xFF1A; </p>
<p><a href="http://www.drupal001.com/2013/09/drupal7-memcache/" target="_blank" rel="external">&#x5982;&#x4F55;&#x5728;Drupal7&#x4E2D;&#x914D;&#x7F6E;Memcache</a></p>
<p>&#x66F4;&#x591A;&#x95EE;&#x9898;&#x8BF7;&#x5230; <a href="http://drupal001.net/" target="_blank" rel="external">Drupal&#x5927;&#x5B66;</a> &#x63D0;&#x95EE;&#xFF1A; <a href="http://drupal001.net/" target="_blank" rel="external">http://drupal001.net/</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Memcached/">Memcached</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/03/235b9ce/" title="memcached 1.4.23 发布，集中式缓存系统 -" itemprop="url">memcached 1.4.23 发布，集中式缓存系统 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-03T02:09:37.000Z" itemprop="datePublished"> 发表于 2015-07-03</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p><a href="http://www.oschina.net/news/61534/oschina-opensource-collection-plan-for-it-companies" target="_blank" rel="external">&#x5F00;&#x6E90;&#x4E2D;&#x56FD;&#x7684; IT &#x516C;&#x53F8;&#x5F00;&#x6E90;&#x8F6F;&#x4EF6;&#x6574;&#x7406;&#x8BA1;&#x5212;&#x4ECB;&#x7ECD;</a></p>
<p>memcached 1.4.23 &#x53D1;&#x5E03;&#xFF0C;&#x6B64;&#x7248;&#x672C;&#x73B0;&#x5DF2;&#x63D0;&#x4F9B;&#x4E0B;&#x8F7D;&#xFF1A; <a href="http://www.memcached.org/files/memcached-1.4.23.tar.gz" target="_blank" rel="external">http://www.memcached.org/files/memcached-1.4.23.tar.gz</a> &#x3002; </p>
<p>&#x6B64;&#x7248;&#x672C;&#x66F4;&#x65B0;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A;</p>
<h3 id="Bug_&#x4FEE;&#x590D;">Bug &#x4FEE;&#x590D;</h3><ul>
<li>spinlocks removed since they never seem to improve performance.</li>
<li>flush_all was not thread safe.</li>
<li>better handle items refcounted in tail by unlinking them from the LRU&apos;s</li>
</ul>
<h3 id="&#x65B0;&#x7279;&#x6027;">&#x65B0;&#x7279;&#x6027;</h3><p>&#x91CD;&#x5199;&#x4E86; memcached &#x7684;&#x6838;&#x5FC3; LRU &#x7B97;&#x6CD5;&#xFF1A;</p>
<ul>
<li>global cache_lock is gone, LRU&apos;s are now independently locked.</li>
<li>LRU&apos;s are now split between HOT, WARM, and COLD LRU&apos;s. New items enter the HOT LRU.</li>
<li>LRU updates only happen as items reach the bottom of an LRU. If active in HOT, stay in HOT, if active in WARM, stay in WARM. If active in COLD, move to WARM.</li>
<li>HOT/WARM each capped at 32% of memory available for that slab class. COLD is uncapped.</li>
<li>Items flow from HOT/WARM into COLD.</li>
<li>A background thread exists which shuffles items between/within the LRU&apos;s as capacities are reached.</li>
</ul>
<p>&#x4E3B;&#x8981;&#x76EE;&#x6807;&#x662F;&#x4FDD;&#x62A4;&#x201C;scanning&#x201D;&#x7684; active items&#xFF0C;&#x5176;&#x6B21;&#x662F;&#x4E3A;&#x4E86;&#x6539;&#x8FDB;&#x5EF6;&#x8FDF;&#x3002;</p>
<p>&#x66F4;&#x591A;&#x6539;&#x8FDB;&#x5185;&#x5BB9;&#x8BF7;&#x770B; <a href="https://code.google.com/p/memcached/wiki/ReleaseNotes1423" target="_blank" rel="external">&#x53D1;&#x884C;&#x8BF4;&#x660E;</a> &#x3002; </p>
<p>memcached&#x662F;&#x4E00;&#x5957;&#x5206;&#x5E03;&#x5F0F;&#x7684;&#x5FEB;&#x53D6;&#x7CFB;&#x7EDF;&#xFF0C;&#x5F53;&#x521D;&#x662F;Danga Interactive&#x4E3A;&#x4E86;LiveJournal&#x6240;&#x53D1;&#x5C55;&#x7684;&#xFF0C;&#x4F46;&#x76EE;&#x524D;&#x88AB;&#x8BB8;&#x591A;&#x8F6F;&#x4EF6;&#xFF08;&#x5982;MediaWiki&#xFF09;&#x6240;&#x4F7F;&#x7528;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x5957;&#x5F00;&#x653E;&#x6E90;&#x4EE3;&#x7801;&#x8F6F;&#x4EF6;&#xFF0C;&#x4EE5;BSD license&#x6388;&#x6743;&#x91CA;&#x51FA;&#x3002; </p>
<p>memcached&#x7F3A;&#x4E4F;&#x8BA4;&#x8BC1;&#x4EE5;&#x53CA;&#x5B89;&#x5168;&#x7BA1;&#x5236;&#xFF0C;&#x8FD9;&#x4EE3;&#x8868;&#x5E94;&#x8BE5;&#x5C06;memcached&#x670D;&#x52A1;&#x5668;&#x653E;&#x7F6E;&#x5728;&#x9632;&#x706B;&#x5899;&#x540E;&#x3002;</p>
<p>memcached &#x7684;API&#x4F7F;&#x7528;&#x4E09;&#x5341;&#x4E8C;&#x4F4D;&#x5143;&#x7684;&#x5FAA;&#x73AF;&#x5197;&#x4F59;&#x6821;&#x9A8C;&#xFF08;CRC-32&#xFF09;&#x8BA1;&#x7B97;&#x952E;&#x503C;&#x540E;&#xFF0C;&#x5C06;&#x8D44;&#x6599;&#x5206;&#x6563;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x673A;&#x5668;&#x4E0A;&#x3002;&#x5F53;&#x8868;&#x683C;&#x6EE1;&#x4E86;&#x4EE5;&#x540E;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x65B0;&#x589E;&#x7684;&#x8D44;&#x6599;&#x4F1A;&#x4EE5;LRU&#x673A;&#x5236;&#x66FF;&#x6362;&#x6389;&#x3002; &#x7531;&#x4E8E;memcached&#x901A;&#x5E38;&#x53EA;&#x662F;&#x5F53;&#x4F5C;&#x5FEB;&#x53D6;&#x7CFB;&#x7EDF;&#x4F7F;&#x7528;&#xFF0C;&#x6240;&#x4EE5;&#x4F7F;&#x7528;memcached&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5F0F;&#x5728;&#x5199;&#x56DE;&#x8F83;&#x6162;&#x7684;&#x7CFB;&#x7EDF;&#x65F6;&#xFF08;&#x50CF;&#x662F;&#x540E;&#x7AEF;&#x7684;&#x6570;&#x636E;&#x5E93;&#xFF09;&#x9700;&#x8981;&#x989D;&#x5916;&#x7684;&#x7A0B;&#x5F0F;&#x7801;&#x66F4;&#x65B0; memcached&#x5185;&#x7684;&#x8D44;&#x6599;&#x3002;</p>
<p>memcached&#x5177;&#x6709;&#x591A;&#x79CD;&#x8BED;&#x8A00;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x5F00;&#x53D1;&#x5305;&#xFF0C;&#x5305;&#x62EC;&#xFF1A;Perl/PHP/JAVA/C/Python/Ruby/C#/MySQL/</p>
<p>&#x5BA2;&#x6237;&#x7AEF;&#x5305;&#x7684;&#x4E0B;&#x8F7D;&#x5730;&#x5740;&#x662F;&#xFF1A; <a href="http://code.google.com/p/memcached/wiki/Clients" target="_blank" rel="external">http://code.google.com/p/memcached/wiki/Clients</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Memcached/">Memcached</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/03/2359a11/" title="论实现序列化的在云端的必要性 -" itemprop="url">论实现序列化的在云端的必要性 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-03T02:09:37.000Z" itemprop="datePublished"> 发表于 2015-07-03</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>&#x5BF9;&#x4E8E;java&#x5B9E;&#x73B0;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x91CD;&#x8981;&#x6027;&#xFF0C;&#x5728;&#x5355;&#x673A;&#x7A0B;&#x5E8F;&#x5185;&#x662F;&#x4E0D;&#x592A;&#x5BB9;&#x6613;&#x88AB;&#x91CD;&#x89C6;&#x7684;&#xFF0C;&#x5728;&#x672C;&#x5730;&#x8C03;&#x8BD5;&#x4E2D;&#xFF0C;tomacat&#x81EA;&#x52A8;&#x4E3A;&#x4E3A;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x7A0B;&#x5E8F;&#x5B9E;&#x73B0;&#x4E86;&#x5E8F;&#x5217;&#x5316;&#xFF0C;&#x800C;&#x4E14;bean(&#x7528;&#x6765;&#x5B9E;&#x73B0;&#x7F13;&#x5B58;&#x7684;java&#x7A0B;&#x5E8F;)&#x592A;&#x5C0F;&#xFF0C;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x4EC0;&#x4E48;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x4F46;&#x662F;&#x4E00;&#x65E6;&#x90E8;&#x7F72;&#x5230;&#x4E91;&#x7AEF;&#xFF0C;&#x9EBB;&#x70E6;&#x5C31;&#x51FA;&#x73B0;&#x4E86;&#xFF0C;&#x5C31;&#x4F1A;&#x53D1;&#x73B0;session&#x4E3A;&#x4EC0;&#x4E48;&#x5B58;&#x4E0D;&#x8FDB;&#x503C;&#x5462;?&#x4E0D;&#x4E45;&#x524D;&#x6211;&#x5728;&#x65B0;&#x6D6A;&#x4E91;&#x4E91;&#x7AEF;&#x90E8;&#x7F72;session&#x5C31;&#x51FA;&#x73B0;&#x4E86;&#x672A;&#x80FD;&#x53D6;&#x4E0D;&#x5230;&#x503C;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<p><img src="http://taojinke.github.io/img/20150703/23577e3.jpg" alt=""></p>
<p>&#x9488;&#x5BF9;&#x65B0;&#x6D6A;&#x4E91;&#x670D;&#x52A1;&#x5668;&#xFF0C;session&#x7684;&#x4FE1;&#x606F;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x5206;&#x5E03;&#x5F0F;Memcache&#x5B58;&#x50A8;&#x3002;</p>
<p>&#x800C;Memcache&#x5B58;&#x50A8;&#x5462;?</p>
<p>&#x4E0D;&#x5C11;&#x60F3;&#x6784;&#x5EFA;&#x5927;&#x8D1F;&#x8F7D;&#x7684;&#x7F51;&#x7AD9;&#x90FD;&#x91C7;&#x53D6;Memcache&#x6765;&#x5206;&#x62C5;&#x6570;&#x636E;&#x5E93;&#x7684;&#x538B;&#x529B;&#x3002;</p>
<p>Memcache&#x9996;&#x5148;&#x5728;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x7684;&#x5185;&#x5B58;&#x4E2D;&#x5F00;&#x8F9F;&#x4E00;&#x4E2A;&#x7A7A;&#x95F4;&#xFF0C;&#x7136;&#x540E;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;hash&#x8868;&#x3002;</p>
<p>memcache &#x4EE5;&#x5B88;&#x62A4;&#x7A0B;&#x5E8F;&#x7684;&#x5F62;&#x5F0F;&#x8FD0;&#x884C;&#x5728;&#x670D;&#x52A1;&#x5668;&#x7AEF;(&#x4E00;&#x4E2A;&#x6216;&#x8005;&#x591A;&#x4E2A;&#x670D;&#x52A1;&#x5668;)&#xFF0C;&#x968F;&#x65F6;&#x63A5;&#x53D7;&#x6765;&#x81EA;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x8FDE;&#x63A5;&#x64CD;&#x4F5C;&#xFF0C;&#x7136;&#x540E;&#x8FDB;&#x884C;&#x5B58;&#x53D6;&#x6570;&#x636E;&#xFF0C;Memcache&#x662F;&#x4E00;&#x6B3E;nosql&#x5185;&#x5B58;&#x6570;&#x636E;&#x5E93;&#x3002;&#x91C7;&#x7528;&#x7684;&#x662F;&#x952E;&#x503C;&#x5B58;&#x50A8;&#xFF0C;&#x6BCF;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x5B58;&#x5165;&#x7684;&#x5BF9;&#x8C61;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x7684;key&#x3002;&#x4F46;&#x662F;&#x5BF9;&#x8C61;&#x662F;&#x6CA1;&#x529E;&#x6CD5;&#x6301;&#x4E45;&#x5316;&#x7684;&#xFF0C;&#x8DDF;memcache&#x5F88;&#x76F8;&#x4F3C;&#x7684;redis&#x662F;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x6301;&#x4E45;&#x5316;&#x5230;&#x786C;&#x76D8;&#x7684;&#x3002;&#x7136;&#x540E;&#x628A;&#x5BA2;&#x6237;&#x7AEF;&#x9700;&#x8981;&#x7F13;&#x5B58;&#x7684;&#x6570;&#x636E;&#x4EE5;key-value&#x7684;&#x5F62;&#x5F0F;&#x4FDD;&#x5B58;&#x5728;&#x670D;&#x52A1;&#x5668;&#x7684;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#xFF0C;value&#x503C;&#x5B58;&#x5165;key&#x503C;hash&#x8F6C;&#x5316;&#x540E;&#x7684;&#x5BF9;&#x5E94;&#x7684;&#x67D0;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x3002;&#x53D6;&#x503C;&#x7684;&#x65F6;&#x5019;&#x901A;&#x8FC7;&#x540C;&#x6837;&#x7684;&#x8F6C;&#x5316;&#x540E;&#x5BF9;&#x54CD;&#x5E94;&#xFFFD;&#xFFFD;&#xFFFD;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x4ED8;&#x51FA;&#x8BF7;&#x6C42;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x800C;&#x5728;&#x5E8F;&#x5217;&#x5316;&#x5728;&#x5728;&#x5176;&#x4E2D;&#x8D77;&#x5230;&#x4EC0;&#x4E48;&#x4F5C;&#x7528;&#x5462;?</p>
<p>&#x5728;memcache&#x7F13;&#x5B58;&#x5230;&#x5185;&#x5B58;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x662F;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x5230;&#x5E8F;&#x5217;&#x5316;&#x5B58;&#x50A8;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x5982;&#x679C;&#x4F60;&#x7684;bean&#x5305;&#x4E2D;&#x7684;&#x4EE3;&#x7801;&#x90FD;&#x6CA1;&#x5B9E;&#x73B0;&#x5E8F;&#x5217;&#x5316;&#x63A5;&#x53E3;&#xFF0C;&#x5728;&#x7F13;&#x5B58;&#x7684;&#x65F6;&#x5019;&#x662F;&#x4E0D;&#x4F1A;&#x88AB;&#x7F13;&#x5B58;&#x5230;&#x670D;&#x52A1;&#x5668;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x9020;&#x6210;&#x4E86;session&#x5E76;&#x6CA1;&#x6709;&#x5B58;&#x503C;&#x7684;&#x95EE;&#x9898;&#x53D1;&#x751F;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x5728;&#x90E8;&#x7F72;&#x5230;&#x65B0;&#x6D6A;&#x4E91;&#x7684;&#x7A0B;&#x5E8F;&#x5B58;&#x50A8;&#x5230;session&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x5FC5;&#x987B;&#x5B9E;&#x73B0;&#x5E8F;&#x5217;&#x5316;&#x63A5;&#x53E3;&#x624D;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;session&#x5B58;&#x50A8;&#x7684;&#x3002;</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Memcached/">Memcached</a><a href="/tags/Nosql/">Nosql</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/03/234ccfd/" title="深入学习Memcached -" itemprop="url">深入学习Memcached -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-03T02:09:37.000Z" itemprop="datePublished"> 发表于 2015-07-03</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>&#x7531;&#x4E8E;&#x5B9E;&#x9A8C;&#x5BA4;&#x5728;&#x4E00;&#x4E2A;&#x9879;&#x76EE;&#x4E2D;&#x7528;&#x5230;&#x4E86;Memcached&#x5206;&#x5E03;&#x5F0F;&#x7F13;&#x5B58;&#xFF0C;&#x81EA;&#x5DF1;&#x8FD9;&#x6BB5;&#x65F6;&#x95F4;&#x4E5F;&#x5BF9;&#x5206;&#x5E03;&#x5F0F;&#x7F13;&#x5B58;&#x6DF1;&#x5165;&#x5B66;&#x4E60;&#x4E86;&#x4E00;&#x4E0B;&#xFF0C;&#x672C;&#x6587;&#x5C31;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#x81EA;&#x5DF1;&#x7684;&#x6536;&#x83B7;&#xFF0C;&#x8FD8;&#x662F;&#x4ECE;Memcached&#x662F;&#x4EC0;&#x4E48;&#x8C08;&#x8D77;&#x5427;&#x3002;</p>
<h2 id="Memcached&#x662F;&#x4EC0;&#x4E48;">Memcached&#x662F;&#x4EC0;&#x4E48;</h2><p>Memcached&#x662F;&#x4E00;&#x6B3E;&#x9AD8;&#x6027;&#x80FD;&#x7684;&#x5206;&#x5E03;&#x5F0F;&#x5185;&#x5B58;&#x5BF9;&#x8C61;&#x7F13;&#x5B58;&#x7CFB;&#x7EDF;&#xFF0C;&#x4F7F;&#x7528;&#x5B83;&#x53EF;&#x4EE5;&#x51CF;&#x5C11;&#x5E94;&#x7528;&#x7CFB;&#x7EDF;&#x5BF9;&#x6570;&#x636E;&#x5E93;&#x7684;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#xFF0C;&#x51CF;&#x8F7B;&#x4E86;&#x6570;&#x636E;&#x5E93;&#x8D1F;&#x8F7D;&#xFF0C;&#x5E76;&#x4E14;&#x63D0;&#x5347;&#x4E86;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x54CD;&#x5E94;&#x901F;&#x5EA6;&#x3002;&#x53EF;&#x4EE5;&#x5C06;Memcached&#x6BD4;&#x4F5C;&#x4E00;&#x4E2A;&#x5DE8;&#x5927;&#x7684;&#x3001;&#x5B58;&#x50A8;&#x4E86;&#x5F88;&#x591A; &#x5BF9;&#x7684;&#x54C8;&#x5E0C;&#x8868;&#xFF0C;&#x901A;&#x8FC7;key&#x53EF;&#x4EE5;&#x5B58;&#x50A8;&#x6216;&#x67E5;&#x8BE2;&#x4EFB;&#x610F;&#x7684;&#x6570;&#x636E;&#x3002;&#x5B83;&#x7684;&#x5B9E;&#x73B0;&#x4F9D;&#x8D56;&#x4E8E;&#x51E0;&#x4E2A;&#x91CD;&#x8981;&#x7684;&#x7B97;&#x6CD5;&#xFF0C;&#x4E0B;&#x9762;&#x5C31;&#x8BE6;&#x7EC6;&#x8BB2;&#x8BB2; <strong>&#x6700;&#x8FD1;&#x6700;&#x5C11;&#x4F7F;&#x7528;&#xFF08;LRU&#xFF09;&#x7B97;&#x6CD5;</strong> &#x548C; <strong>&#x4E00;&#x81F4;&#x6027;&#x54C8;&#x5E0C;&#x7B97;&#x6CD5;</strong> &#x3002; </p>
<h2 id="LRU&#x7B97;&#x6CD5;">LRU&#x7B97;&#x6CD5;</h2><p>&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x9875;&#x9762;&#x7F6E;&#x6362;&#x7B97;&#x6CD5;&#x4E2D;&#x4E5F;&#x5305;&#x62EC;&#x8BE5;&#x7B97;&#x6CD5;&#xFF0C;&#x8FD9;&#x79CD;&#x7B97;&#x6CD5;&#x975E;&#x5E38;&#x9002;&#x5408;&#x4E8E;&#x7F13;&#x5B58;&#x7CFB;&#x7EDF;&#x3002;&#x5B83;&#x57FA;&#x4E8E;&#x4E00;&#x79CD;&#x5047;&#x8BBE;&#xFF1A;&#x8FC7;&#x53BB;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x4F7F;&#x7528;&#x9891;&#x7387;&#x6700;&#x4F4E;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x5C06;&#x6765;&#x4E5F;&#x4F1A;&#x5F88;&#x5C11;&#x4F7F;&#x7528;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x6211;&#x81EA;&#x5DF1;&#x5B9E;&#x73B0;&#x7684;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E;LRU&#x7B97;&#x6CD5;&#x7684;&#x7F13;&#x5B58;&#xFF0C;&#x5B83;&#x5B9E;&#x73B0;&#x4E86;&#x57FA;&#x672C;&#x7684;&#x7F13;&#x5B58;&#x529F;&#x80FD;&#xFF0C;&#x4E0D;&#x8FC7;&#x9700;&#x8981;&#x6539;&#x8FDB;&#x7684;&#x4E00;&#x70B9;&#x662F;&#x8BE5;&#x7F13;&#x5B58;&#x5E94;&#x8BE5;&#x662F;&#x5355;&#x4F8B;&#x7684;&#x3002; </p>
<pre><code><span class="package"><span class="keyword">package</span> <span class="title">colin</span>.<span class="title">cache</span>;  </span>
</code></pre><p>/**  </p>
<ul>
<li></li>
<li>@author Colin Wang  </li>
<li><p>Created on Apr 18, 2015<br>*/<br>public class LRUCache {<br> private static final int DEFAULT_MAX_SIZE = 10;<br> private Object[] elements;<br> private int size;  </p>
<p> public LRUCache(int maxSize) {  </p>
<pre><code>elements = <span class="keyword">new</span> <span class="built_in">Object</span>[maxSize];  
</code></pre><p> }  </p>
<p> public LRUCache() {  </p>
<pre><code>this<span class="list">(<span class="keyword">DEFAULT_MAX_SIZE</span>)</span><span class="comment">;  </span>
</code></pre><p> }  </p>
<p> public boolean isEmpty() {  </p>
<pre><code><span class="keyword">return</span> <span class="built_in">size</span> == <span class="number">0</span>;  
</code></pre><p> }  </p>
<p> public int size() {  </p>
<pre><code><span class="keyword">return</span> <span class="built_in">size</span>;  
</code></pre><p> }  </p>
<p> public boolean isFull() {  </p>
<pre><code><span class="keyword">return</span> <span class="built_in">size</span> == elements.<span class="built_in">length</span>;  
</code></pre><p> }  </p>
<p> /**  </p>
<ul>
<li>&#x8FD4;&#x56DE;&#x5143;&#x7D20;&#x5728;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x4F4D;&#x7F6E;  </li>
<li></li>
<li>@param element  </li>
<li><p>@return<br>*/<br>public int indexOf(Object element) {<br> for (int i = 0; i &lt; size; i++) {  </p>
<pre><code><span class="keyword">if</span> (element.<span class="keyword">equals</span>(elements[i])) {  
<span class="command">    return</span> i;  
}  
</code></pre><p> }<br> return -1;<br>}  </p>
<p>public Object push(Object element) {<br> int index = -1;<br> if (!isFull() &amp;&amp; indexOf(element) == -1) {  </p>
<pre><code>// &amp;<span class="symbol">#x7F13</span>;&amp;<span class="symbol">#x5B58</span>;&amp;<span class="symbol">#x672A</span>;&amp;<span class="symbol">#x6EE1</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x5E76</span>;&amp;<span class="symbol">#x4E14</span>;&amp;<span class="symbol">#x5176</span>;&amp;<span class="symbol">#x4E2D</span>;&amp;<span class="symbol">#x4E0D</span>;&amp;<span class="symbol">#x542B</span>;&amp;<span class="symbol">#x6709</span>;&amp;<span class="symbol">#x5F85</span>;&amp;<span class="symbol">#x63D2</span>;&amp;<span class="symbol">#x5165</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x5143</span>;&amp;<span class="symbol">#x7D20</span>;  
elements[size++] = element;  
</code></pre><p> } else if (isFull() &amp;&amp; indexOf(element) == -1) {  </p>
<pre><code>// &amp;<span class="symbol">#x7F13</span>;&amp;<span class="symbol">#x5B58</span>;&amp;<span class="symbol">#x5DF2</span>;&amp;<span class="symbol">#x6EE1</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x5E76</span>;&amp;<span class="symbol">#x4E14</span>;&amp;<span class="symbol">#x5176</span>;&amp;<span class="symbol">#x4E2D</span>;&amp;<span class="symbol">#x4E0D</span>;&amp;<span class="symbol">#x542B</span>;&amp;<span class="symbol">#x6709</span>;&amp;<span class="symbol">#x5F85</span>;&amp;<span class="symbol">#x63D2</span>;&amp;<span class="symbol">#x5165</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x5143</span>;&amp;<span class="symbol">#x7D20</span>;  
for (int i = <span class="number">0</span>; i &amp;lt; size - <span class="number">1</span>; i++) {  
    elements[i] = elements[i + <span class="number">1</span>];  
}  
elements[size - <span class="number">1</span>] = element;  
</code></pre><p> } else {  </p>
<pre><code><span class="keyword">index</span> = indexOf(element);  
<span class="keyword">for</span> (int i = <span class="keyword">index</span>; i &amp;lt; size - <span class="number">1</span>; i++) <span class="comment">{  
    elements[i] = elements[i + 1];  
}</span>  
elements[size - <span class="number">1</span>] = element;  
</code></pre><p> }<br> return index == -1 ? null : elements[index];<br>}  </p>
<p>public void show() {<br> for (int i = 0; i &lt; size; i++) {  </p>
<pre><code><span class="tag">System</span><span class="class">.out</span><span class="class">.print</span>(<span class="tag">elements</span><span class="attr_selector">[i]</span><span class="class">.toString</span>() + &amp;<span class="tag">quot</span>; &amp;<span class="tag">quot</span>;);  
</code></pre><p> }<br>}<br>}</p>
</li>
</ul>
</li>
</ul>
<h2 id="&#x4E00;&#x81F4;&#x6027;&#x54C8;&#x5E0C;&#x7B97;&#x6CD5;">&#x4E00;&#x81F4;&#x6027;&#x54C8;&#x5E0C;&#x7B97;&#x6CD5;</h2><p>&#x8BE5;&#x7B97;&#x6CD5;&#x5728;&#x5206;&#x5E03;&#x5F0F;&#x7F13;&#x5B58;&#x7CFB;&#x7EDF;&#x4E2D;&#x5E94;&#x7528;&#x5341;&#x5206;&#x5E7F;&#x6CDB;&#xFF0C;&#x5B83;&#x7684;&#x5173;&#x952E;&#x4E4B;&#x5904;&#x5728;&#x4E8E;&#x4F7F;&#x7528;&#x73AF;&#x5F62;&#x7684;&#x54C8;&#x5E0C;&#x7A7A;&#x95F4;&#x3002;&#x9996;&#x5148;&#x6211;&#x4EEC;&#x5148;&#x8003;&#x8651;&#x4E00;&#x4E0B;JDK&#x4E2D;HashMap&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#xFF0C;HashMap&#x6709;&#x4E00;&#x4E2A;&#x521D;&#x59CB;&#x5BB9;&#x91CF;&#x548C;&#x88C5;&#x8F7D;&#x56E0;&#x5B50;&#xFF0C;&#x5F53;HashMap&#x4E2D;&#x5143;&#x7D20;&#x7684;&#x6570;&#x91CF;&#x8FBE;&#x5230;&#x4E86; &#x521D;&#x59CB;&#x5BB9;&#x91CF;*&#x88C5;&#x8F7D;&#x56E0;&#x5B50; &#x8FD9;&#x4E48;&#x591A;&#x65F6;&#xFF0C;HashMap&#x5C31;&#x4F1A;&#x8FDB;&#x884C;&#x6269;&#x5BB9;&#xFF08;&#x53D8;&#x4E3A;&#x539F;&#x6765;&#x7684;2&#x500D;&#xFF09;&#x7136;&#x540E;&#x518D;&#x54C8;&#x5E0C;&#xFF0C;&#x5F53;&#x5143;&#x7D20;&#x5F88;&#x591A;&#x65F6;&#xFF0C;&#x8FD9;&#x79CD;&#x518D;&#x54C8;&#x5E0C;&#x64CD;&#x4F5C;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x5F88;&#x6D88;&#x8017;&#x8D44;&#x6E90;&#x7684;&#x3002;&#x5C3D;&#x7BA1;HashMap&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x79CD;&#x6BD4;&#x8F83;&#x4F18;&#x5316;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x6BD4;&#x5982;HashMap&#x7684;&#x5927;&#x5C0F;&#x603B;&#x662F;&#x4E3A;2&#x7684;n&#x6B21;&#x5E42;&#xFF08;&#x9ED8;&#x8BA4;&#x5927;&#x5C0F;&#x4E3A;16&#xFF09;&#xFF0C;&#x8FD9;&#x6837;&#x65E2;&#x51CF;&#x5C11;&#x4E86;&#x54C8;&#x5E0C;&#x78B0;&#x649E;&#x7684;&#x51E0;&#x7387;&#xFF08;&#x56E0;&#x4E3A; 2&#x7684;n&#x6B21;&#x5E42;-1 &#x8F6C;&#x5316;&#x4E3A;&#x4E8C;&#x8FDB;&#x5236;&#x65F6;&#x6240;&#x6709;&#x4F4D;&#x5747;&#x4E3A;1&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x907F;&#x514D;&#x4E86;&#x67D0;&#x4E9B;&#x4F4D;&#x4E0D;&#x80FD;&#x53D1;&#x6325;&#x4F5C;&#x7528;&#xFF09;&#xFF0C;&#x53C8;&#x589E;&#x52A0;&#x4E86;HashMap&#x5728;&#x5B9A;&#x4F4D;&#x5143;&#x7D20;&#x65F6;&#x7684;&#x6548;&#x7387;&#xFF0C;&#x6BD4;&#x5982;&#x65B9;&#x6CD5;&#xFF1A; </p>
<pre><code><span class="keyword">static</span> <span class="function"><span class="keyword">int</span> <span class="title">indexFor</span><span class="params">(<span class="keyword">int</span> h, <span class="keyword">int</span> length)</span> </span>{  
<span class="keyword">return</span> h &amp;amp; (length-<span class="number">1</span>);  
</code></pre><p>}</p>
<p>&#x5F53;length&#x603B;&#x662F;2&#x7684;n&#x6B21;&#x65B9;&#x65F6;&#xFF0C; h &amp; (length - 1) &#x8FD0;&#x7B97;&#x7B49;&#x4EF7;&#x4E8E;&#x5BF9;length&#x53D6;&#x6A21;&#x3002;&#x4F46;&#x662F;&#x8FD9;&#x4E9B;&#x4ECD;&#x7136;&#x4E0D;&#x80FD;&#x5B8C;&#x5168;&#x5F25;&#x8865;&#x6240;&#x6709;&#x5143;&#x7D20;&#x5FC5;&#x987B;&#x5168;&#x90E8;&#x91CD;&#x65B0;&#x54C8;&#x5E0C;&#x7684;&#x5F31;&#x70B9;&#x3002;&#x6BD4;&#x5982;&#x6211;&#x4EEC;&#x62E5;&#x6709;N&#x53F0;&#x7F13;&#x5B58;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x70ED;&#x6570;&#x636E;&#x5DF2;&#x7ECF;&#x901A;&#x8FC7;Hash&#x7B97;&#x6CD5;&#x6620;&#x5C04;&#x5230;&#x4E86;&#x8FD9;N&#x53F0;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x5F53;&#x5176;&#x4E2D;&#x4E00;&#x53F0;&#x7F13;&#x5B58;&#x670D;&#x52A1;&#x5668;&#x6302;&#x6389;&#xFF0C;&#xFFFD;&#xFFFD;&#xFFFD;&#x8005;&#x6211;&#x4EEC;&#x53C8;&#x65B0;&#x6DFB;&#x4E86;&#x51E0;&#x53F0;&#x7F13;&#x5B58;&#x670D;&#x52A1;&#x5668;&#x8FDB;&#x6765;&#x65F6;&#xFF0C;&#x6240;&#x6709;&#x5DF2;&#x7ECF;&#x6620;&#x5C04;&#x597D;&#x7684;&#x6570;&#x636E;&#x90FD;&#x5C06;&#x5931;&#x6548;&#xFF0C;&#x800C;&#x6211;&#x4EEC;&#x7684;&#x540E;&#x7AEF;&#x6570;&#x636E;&#x5E93;&#x5C06;&#x4F1A;&#x627F;&#x53D7;&#x8FD9;&#x4E00;&#x5207;&#xFF01;&#x6240;&#x4EE5;&#xFF0C;&#x4E00;&#x81F4;&#x6027;Hash&#x7B97;&#x6CD5;&#x5C31;&#x6D3E;&#x4E0A;&#x7528;&#x573A;&#x4E86;&#xFF0C;&#x4E0A;&#x9762;&#x5DF2;&#x7ECF;&#x63D0;&#x5230;&#xFF0C;&#x4E00;&#x81F4;&#x6027;&#x54C8;&#x5E0C;&#x7B97;&#x6CD5;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x73AF;&#x5F62;&#x7684;&#x54C8;&#x5E0C;&#x7A7A;&#x95F4;&#xFF0C;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF1A; </p>
<p><img src="http://taojinke.github.io/img/20150703/234a10b.jpg" alt=""></p>
<p>&#x5E38;&#x89C4;&#x7684;Hash&#x7B97;&#x6CD5;&#x4E3A;&#x5C06;&#x67D0;&#x4E2A;key&#x6620;&#x5C04;&#x4E3A;&#x4E00;&#x4E2A;32&#x4F4D;&#x6574;&#x6570;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x8FD9;0&#x81F3;2^32-1&#x7684;&#x6570;&#x503C;&#x7A7A;&#x95F4;&#x9996;&#x4F4D;&#x76F8;&#x63A5;&#x4FBF;&#x5F62;&#x6210;&#x4E86;&#x4E00;&#x4E2A;&#x73AF;&#x3002;&#x7136;&#x540E;&#x628A;&#x6211;&#x4EEC;&#x7684;&#x7F13;&#x5B58;&#x670D;&#x52A1;&#x5668;&#x901A;&#x8FC7;&#x6563;&#x5217;&#xFF08;&#x5BF9;IP&#x6216;&#x673A;&#x5668;&#x540D;&#x7B49;&#x8FDB;&#x884C;&#x6563;&#x5217;&#xFF09;&#x6620;&#x5C04;&#x5230;&#x8FD9;&#x4E2A;&#x73AF;&#x4E0A;&#xFF0C;&#x8FD9;&#x6837;&#xFF0C;&#x5F53;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x88AB;&#x6563;&#x5217;&#x5230;&#x67D0;&#x4E2A;&#x4F4D;&#x7F6E;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x628A;&#x8BE5;&#x5BF9;&#x8C61;&#x7F13;&#x5B58;&#x5230; <strong>&#x987A;&#x65F6;&#x9488;&#x65B9;&#x5411;</strong> &#x79BB;&#x5B83;&#x6700;&#x8FD1;&#x7684;&#x7F13;&#x5B58;&#x670D;&#x52A1;&#x5668;&#x7ED3;&#x70B9;&#x4E0A;&#x3002;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x5F53;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x7F13;&#x5B58;&#x670D;&#x52A1;&#x5668;&#x7ED3;&#x70B9;&#x5931;&#x6548;&#x65F6;&#xFF0C;&#x4E0D;&#x4F1A;&#x5BFC;&#x81F4;&#x6240;&#x6709;&#x7684;&#x7F13;&#x5B58;&#x6570;&#x636E;&#x90FD;&#x5931;&#x6548;&#xFF0C;&#x4E5F;&#x4EC5;&#x4EC5;&#x9700;&#x8981;&#x628A;&#x539F;&#x6765;&#x88AB;&#x7F13;&#x5B58;&#x5230;&#x8BE5;&#x7ED3;&#x70B9;&#x4E0A;&#x7684;&#x6570;&#x636E;&#x7EE7;&#x7EED;&#x7F13;&#x5B58;&#x5230;&#x4E0B;&#x4E00;&#x4E2A;&#x987A;&#x65F6;&#x9488;&#x65B9;&#x5411;&#x79BB;&#x5B83;&#x6700;&#x8FD1;&#x7684;&#x7ED3;&#x70B9;&#x4E0A;&#x5373;&#x53EF;&#x3002;&#x5F53;&#x65B0;&#x589E;&#x4E00;&#x4E2A;&#x7ED3;&#x70B9;&#x65F6;&#xFF0C;&#x540C;&#x6837;&#x4E5F;&#x53EA;&#x9700;&#x8981;&#x5BF9;&#x5F88;&#x5C11;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x518D;&#x54C8;&#x5E0C;&#x5E76;&#x6620;&#x5C04;&#x5230;&#x65B0;&#x7684;&#x7ED3;&#x70B9;&#x4E0A;&#x5373;&#x53EF;&#x3002;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x51FA;&#x73B0;&#x6570;&#x636E;&#x5206;&#x914D;&#x4E0D;&#x5747;&#x5300;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x6BD4;&#x5982;&#x7EDD;&#x5927;&#x591A;&#x6570;&#x7684;&#x6570;&#x636E;&#x90FD;&#x88AB;&#x7F13;&#x5B58;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x7ED3;&#x70B9;&#x4E0A;&#xFF0C;&#x800C;&#x5176;&#x4ED6;&#x7684;&#x7ED3;&#x70B9;&#x5219;&#x7F13;&#x5B58;&#x5F88;&#x5C11;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x4E00;&#x81F4;&#x6027;&#x54C8;&#x5E0C;&#x7B97;&#x6CD5;&#x8FD8;&#x63D0;&#x51FA;&#x4E86; <strong>&#x865A;&#x62DF;&#x7ED3;&#x70B9;</strong> &#x7684;&#x6982;&#x5FF5;&#x3002;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF1A; </p>
<p><img src="http://taojinke.github.io/img/20150703/234a37c.jpg" alt=""></p>
<p>A1&#x548C;A2&#x4E3A;&#x7ED3;&#x70B9;A&#x7684;&#x865A;&#x62DF;&#x7ED3;&#x70B9;&#xFF0C;&#x865A;&#x62DF;&#x7ED3;&#x70B9;&#x7684;hash&#x503C;&#x8BA1;&#x7B97;&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x5BF9;&#x5E94;&#x7ED3;&#x70B9;&#x7684;IP&#x5730;&#x5740;&#x52A0;&#x6570;&#x5B57;&#x540E;&#x7F00;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x5982;&#x201C;192.168.1.1#1&#x201D;&#x3002;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x5C06;&#x88AB;&#x6563;&#x5217;&#x5230;A1&#x548C;A2&#x7684;&#x6570;&#x636E;&#x90FD;&#x7F13;&#x5B58;&#x8FDB;&#x7ED3;&#x70B9;A&#x4E2D;&#xFF0C;&#x4ECE;&#x800C;&#x907F;&#x514D;&#x4E86;&#x6570;&#x636E;&#x5206;&#x5E03;&#x4E0D;&#x5E73;&#x8861;&#x7684;&#x73B0;&#x8C61;&#x3002;</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Memcached/">Memcached</a><a href="/tags/Nosql/">Nosql</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/03/2348d83/" title="memcache源代码研究 - 数据结构篇（上） -" itemprop="url">memcache源代码研究 - 数据结构篇（上） -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-03T02:09:37.000Z" itemprop="datePublished"> 发表于 2015-07-03</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="LIBEVENT_THREAD">LIBEVENT_THREAD</h4><p>&#x2003;&#x2003; LIBEVENT_THREAD &#x4EE3;&#x8868;&#x7684;&#x662F; memcache &#x91CC;&#x7684; worker thread&#xFF0C;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#xFF1A; </p>
<pre><code>typedef struct {  
    pthread_t thread_id;        /<span class="keyword">*</span> unique ID of this thread <span class="keyword">*</span>/
    struct event_base <span class="keyword">*</span>base;    /<span class="keyword">*</span> libevent handle this thread uses <span class="keyword">*</span>/
    struct event notify_event;  /<span class="keyword">*</span> listen event for notify pipe <span class="keyword">*</span>/
    int notify_receive_fd;      /<span class="keyword">*</span> receiving end of notify pipe <span class="keyword">*</span>/
    int notify_send_fd;         /<span class="keyword">*</span> sending end of notify pipe <span class="keyword">*</span>/
    struct thread_stats stats;  /<span class="keyword">*</span> Stats generated by this thread <span class="keyword">*</span>/
    struct conn_queue <span class="keyword">*</span>new_conn_queue; /<span class="keyword">*</span> queue of new connections to handle <span class="keyword">*</span>/
    cache_t <span class="keyword">*</span>suffix_cache;      /<span class="keyword">*</span> suffix cache <span class="keyword">*</span>/
} LIBEVENT_THREAD;
</code></pre><p>&#x91CC;&#x9762;&#x7684;&#x6570;&#x636E;&#x6210;&#x5458;&#x4E3B;&#x8981;&#x662F;&#x7528;&#x4E8E; main thread &#x4E0E; worker thread &#x4E4B;&#x95F4;&#x901A;&#x4FE1;&#x7684;&#x3002;&#x4E3B;&#x8FDB;&#x7A0B;&#x6BCF;&#x6B21;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x90FD;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A; pipe&#xFF0C;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x91CC;&#x5BF9;&#x5E94;&#x7684;&#x662F; notify_send_fd &#x548C; notify_receive_fd &#xFF0C;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A; </p>
<pre><code><span class="atom">void</span> <span class="atom">memcached_thread_init</span>(...) {  
    ...
    <span class="atom">for</span> (<span class="atom">i</span> = <span class="number">0</span>; <span class="atom">i</span> &amp;<span class="atom">lt</span>; <span class="atom">nthreads</span>; <span class="atom">i</span>++) {
    <span class="atom">int</span> <span class="atom">fds</span>[<span class="number">2</span>];
    <span class="atom">if</span> (<span class="atom">pipe</span>(<span class="atom">fds</span>)) { // &amp;<span class="atom">lt</span>;-- &amp;#<span class="atom">x521B</span>;&amp;#<span class="atom">x5EFA</span>; <span class="atom">pipe</span>
        ...
    }
    <span class="atom">threads</span>[<span class="atom">i</span>].<span class="atom">notify_receive_fd</span> = <span class="atom">fds</span>[<span class="number">0</span>];
    <span class="atom">threads</span>[<span class="atom">i</span>].<span class="atom">notify_send_fd</span> = <span class="atom">fds</span>[<span class="number">1</span>];
    <span class="atom">setup_thread</span>(&amp;<span class="atom">amp</span>;<span class="atom">threads</span>[<span class="atom">i</span>]);
       ...
    }
    ...
}
</code></pre><p>&#x6BCF;&#x5F53;&#x6709;&#x65B0;&#x7684;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E3B;&#x8FDB;&#x7A0B;&#x5C31;&#x4F1A;&#x5F80; notify_send_fd &#x91CC;&#x5199;&#x6570;&#x636E;&#x6765;&#x901A;&#x77E5;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#xFF0C;&#x5B50;&#x7EBF;&#x7A0B;&#x63A5;&#x5230;&#x6D88;&#x606F;&#x4E4B;&#x540E;&#x4F1A;&#x521B;&#x5EFA;&#x65B0;&#x7684;connection&#xFF0C;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A; </p>
<pre><code><span class="xml">void dispatch_conn_new(...) </span><span class="expression">{  
    <span class="variable">CQ</span>_<span class="variable">ITEM</span> *<span class="variable">item</span> = <span class="variable">cqi</span>_<span class="variable">new</span>(); /<span class="end-block">/ </span>&amp;<span class="variable"><span class="keyword">lt</span></span>;<span class="variable">--</span> <span class="variable">CQ</span>_<span class="variable">ITEM</span> &amp;<span class="begin-block">#x</span>7528;&amp;<span class="begin-block">#x</span>6765;&amp;<span class="begin-block">#x</span>5<span class="variable">B</span>58;&amp;<span class="begin-block">#x</span>653<span class="variable">E</span>;&amp;<span class="begin-block">#x</span>4<span class="variable">E</span>0<span class="variable">E</span>;&amp;<span class="begin-block">#x</span>8<span class="variable">FDE</span>;&amp;<span class="begin-block">#x</span>63<span class="variable">A</span>5;&amp;<span class="begin-block">#x</span>76<span class="variable">F</span>8;&amp;<span class="begin-block">#x</span>5173;&amp;<span class="begin-block">#x</span>7684;&amp;<span class="begin-block">#x</span>5404;&amp;<span class="begin-block">#x</span>79<span class="variable">CD</span>;&amp;<span class="begin-block">#x</span>53<span class="variable">C</span>2;&amp;<span class="begin-block">#x</span>6570;
    <span class="variable">char</span> <span class="variable">buf</span>[1];
    <span class="variable">...</span>
    <span class="variable">int</span> <span class="variable">tid</span> = (<span class="variable">last</span>_<span class="variable">thread</span> + 1) % <span class="variable">settings.num</span>_<span class="variable">threads</span>;
    <span class="variable">LIBEVENT</span>_<span class="variable">THREAD</span> *<span class="variable">thread</span> = <span class="variable">threads</span> + <span class="variable">tid</span>; /<span class="end-block">/ </span>&amp;<span class="variable"><span class="keyword">lt</span></span>;<span class="variable">--</span> &amp;<span class="begin-block">#x</span>9009;&amp;<span class="begin-block">#x</span>62<span class="variable">E</span>9;&amp;<span class="begin-block">#x</span>5<span class="variable">B</span>50;&amp;<span class="begin-block">#x</span>7<span class="variable">EBF</span>;&amp;<span class="begin-block">#x</span>7<span class="variable">A</span>0<span class="variable">B</span>;
    <span class="variable">last</span>_<span class="variable">thread</span> = <span class="variable">tid</span>;
    /<span class="end-block">/ </span>&amp;<span class="begin-block">#x</span>5<span class="variable">B</span>58;&amp;<span class="begin-block">#x</span>50<span class="variable">A</span>8;&amp;<span class="begin-block">#x</span>5404;&amp;<span class="begin-block">#x</span>79<span class="variable">CD</span>;&amp;<span class="begin-block">#x</span>53<span class="variable">C</span>2;&amp;<span class="begin-block">#x</span>6570;
    <span class="variable">item-</span>&amp;<span class="variable"><span class="keyword">gt</span></span>;<span class="variable">sfd</span> = <span class="variable">sfd</span>;
    <span class="variable">item-</span>&amp;<span class="variable"><span class="keyword">gt</span></span>;<span class="variable">init</span>_<span class="variable">state</span> = <span class="variable">init</span>_<span class="variable">state</span>;
    <span class="variable">item-</span>&amp;<span class="variable"><span class="keyword">gt</span></span>;<span class="variable">event</span>_<span class="variable">flags</span> = <span class="variable">event</span>_<span class="variable">flags</span>;
    <span class="variable">item-</span>&amp;<span class="variable"><span class="keyword">gt</span></span>;<span class="variable">read</span>_<span class="variable">buffer</span>_<span class="variable">size</span> = <span class="variable">read</span>_<span class="variable">buffer</span>_<span class="variable">size</span>;
    <span class="variable">item-</span>&amp;<span class="variable"><span class="keyword">gt</span></span>;<span class="variable">transport</span> = <span class="variable">transport</span>; 
    <span class="variable">cq</span>_<span class="variable">push</span>(<span class="variable">thread-</span>&amp;<span class="variable"><span class="keyword">gt</span></span>;<span class="variable">new</span>_<span class="variable">conn</span>_<span class="variable">queue</span>, <span class="variable">item</span>); /<span class="end-block">/ </span>&amp;<span class="variable"><span class="keyword">lt</span></span>;<span class="variable">--</span> &amp;<span class="begin-block">#x</span>5<span class="variable">C</span>06;&amp;<span class="begin-block">#x</span>8<span class="variable">BF</span>7;&amp;<span class="begin-block">#x</span>6<span class="variable">C</span>42;&amp;<span class="begin-block">#x</span>53<span class="variable">C</span>2;&amp;<span class="begin-block">#x</span>6570;&amp;<span class="begin-block">#x</span>538<span class="variable">B</span>;&amp;<span class="begin-block">#x</span>5165;&amp;<span class="begin-block">#x</span>5<span class="variable">DE</span>5;&amp;<span class="begin-block">#x</span>4<span class="variable">F</span>5<span class="variable">C</span>;&amp;<span class="begin-block">#x</span>7<span class="variable">EBF</span>;&amp;<span class="begin-block">#x</span>7<span class="variable">A</span>0<span class="variable">B</span>;&amp;<span class="begin-block">#x</span>7684; <span class="variable">connection</span> &amp;<span class="begin-block">#x</span>961<span class="variable">F</span>;&amp;<span class="begin-block">#x</span>5217;&amp;<span class="begin-block">#x</span>5<span class="variable">F</span>53;&amp;<span class="begin-block">#x</span>4<span class="variable">E</span>2<span class="variable">D</span>;
    <span class="variable">...</span>
    <span class="variable">buf</span>[0] = &amp;<span class="variable">apos</span>;<span class="variable">c</span>&amp;<span class="variable">apos</span>;;
    <span class="variable"><span class="keyword">if</span></span> (<span class="variable">write</span>(<span class="variable">thread-</span>&amp;<span class="variable"><span class="keyword">gt</span></span>;<span class="variable">notify</span>_<span class="variable">send</span>_<span class="variable">fd</span>, <span class="variable">buf</span>, 1) != 1) { /<span class="end-block">/ </span>&amp;<span class="variable"><span class="keyword">lt</span></span>;<span class="variable">--</span> &amp;<span class="begin-block">#x</span>901<span class="variable">A</span>;&amp;<span class="begin-block">#x</span>8<span class="variable">FC</span>7; <span class="variable">pipe</span> &amp;<span class="begin-block">#x</span>901<span class="variable">A</span>;&amp;<span class="begin-block">#x</span>77<span class="variable">E</span>5; <span class="variable">worker</span> <span class="variable">thread</span>
        <span class="variable">perror</span>(&amp;<span class="variable">quot</span>;<span class="variable">Writing</span> <span class="variable">to</span> <span class="variable">thread</span> <span class="variable">notify</span> <span class="variable">pipe</span>&amp;<span class="variable">quot</span>;);
    }</span><span class="xml">
}



// &amp;#x5B50;&amp;#x7EBF;&amp;#x7A0B;&amp;#x63A5;&amp;#x6536;&amp;#x8BF7;&amp;#x6C42;&amp;#x901A;&amp;#x77E5;
static void thread_libevent_process(int fd, short which, void *arg) </span><span class="expression">{  
    <span class="variable">...</span>
    <span class="variable"><span class="keyword">if</span></span> (<span class="variable">read</span>(<span class="variable">fd</span>, <span class="variable">buf</span>, 1) != 1)
        <span class="variable">...</span>
    <span class="variable">switch</span> (<span class="variable">buf</span>[0]) {
    <span class="variable">case</span> &amp;<span class="variable">apos</span>;<span class="variable">c</span>&amp;<span class="variable">apos</span>;:
    <span class="variable">item</span> = <span class="variable">cq</span>_<span class="variable">pop</span>(<span class="variable">me-</span>&amp;<span class="variable"><span class="keyword">gt</span></span>;<span class="variable">new</span>_<span class="variable">conn</span>_<span class="variable">queue</span>); /<span class="end-block">/ </span>&amp;<span class="variable"><span class="keyword">lt</span></span>;<span class="variable">--</span> &amp;<span class="begin-block">#x</span>4<span class="variable">ECE</span>;&amp;<span class="begin-block">#x</span>961<span class="variable">F</span>;&amp;<span class="begin-block">#x</span>5217;&amp;<span class="begin-block">#x</span>91<span class="variable">CC</span>;&amp;<span class="begin-block">#x</span>9762;&amp;<span class="begin-block">#x</span>8<span class="variable">BFB</span>;&amp;<span class="begin-block">#x</span>53<span class="variable">D</span>6;&amp;<span class="begin-block">#x</span>6700;&amp;<span class="begin-block">#x</span>65<span class="variable">B</span>0;&amp;<span class="begin-block">#x</span>7684;&amp;<span class="begin-block">#x</span>8<span class="variable">BF</span>7;&amp;<span class="begin-block">#x</span>6<span class="variable">C</span>42;
    <span class="variable"><span class="keyword">if</span></span> (<span class="variable">NULL</span> != <span class="variable">item</span>) {
        /<span class="end-block">/ </span>&amp;<span class="begin-block">#x</span>521<span class="variable">B</span>;&amp;<span class="begin-block">#x</span>5<span class="variable">EFA</span>;&amp;<span class="begin-block">#x</span>65<span class="variable">B</span>0;&amp;<span class="begin-block">#x</span>7684;&amp;<span class="begin-block">#x</span>8<span class="variable">FDE</span>;&amp;<span class="begin-block">#x</span>63<span class="variable">A</span>5;
        <span class="variable">conn</span> *<span class="variable">c</span> = <span class="variable">conn</span>_<span class="variable">new</span>(<span class="variable">item-</span>&amp;<span class="variable"><span class="keyword">gt</span></span>;<span class="variable">sfd</span>, <span class="variable">item-</span>&amp;<span class="variable"><span class="keyword">gt</span></span>;<span class="variable">init</span>_<span class="variable">state</span>, <span class="variable">item-</span>&amp;<span class="variable"><span class="keyword">gt</span></span>;<span class="variable">event</span>_<span class="variable">flags</span>,
                           <span class="variable">item-</span>&amp;<span class="variable"><span class="keyword">gt</span></span>;<span class="variable">read</span>_<span class="variable">buffer</span>_<span class="variable">size</span>, <span class="variable">item-</span>&amp;<span class="variable"><span class="keyword">gt</span></span>;<span class="variable">transport</span>, <span class="variable">me-</span>&amp;<span class="variable"><span class="keyword">gt</span></span>;<span class="variable">base</span>);
       <span class="variable">...</span>
    }</span><span class="xml">
        break;
   ...
   }
}</span>
</code></pre><h4 id="connection">connection</h4><p>&#x2003;&#x2003; connection &#x4EE3;&#x8868;&#x7684;&#x662F;&#x670D;&#x52A1;&#x63A5;&#x6536;&#x7684;&#x6BCF;&#x4E2A;&#x8FDE;&#x63A5;&#x3002;&#x5982;&#x4E0A;&#x9762;&#x6CE8;&#x91CA;&#x91CC;&#x63D0;&#x5230;&#x7684;&#xFF0C;&#x662F;&#x5728;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x63A5;&#x6536;&#x5230;&#x8BF7;&#x6C42;&#x7684;&#x65F6;&#x5019;&#x521B;&#x5EFA;&#x7684;&#x3002; connection &#x5185;&#x90E8;&#x7ED3;&#x6784;&#x6BD4;&#x8F83;&#x5E9E;&#x5927;&#xFF0C;&#x58F0;&#x660E;&#x4E86;&#x4E0E;&#x8FDE;&#x63A5;&#x76F8;&#x5173;&#x7684;&#x5404;&#x79CD;&#x53D8;&#x91CF;&#x3002;&#x6BD4;&#x5982;&#x5176;&#x4E2D;&#x7684; rbuf &#x548C; rbytes &#xFF0C;&#x5B83;&#x4EEC;&#x662F;&#x7528;&#x6765;&#x5B58;&#x50A8;&#x4ECE; socket &#x8FDE;&#x63A5;&#x4E2D;&#x8BFB;&#x53D6;&#x7684;&#x5185;&#x5BB9;&#x7684;&#xFF0C;&#x8FD8;&#x6709; rcurr &#x5219;&#x662F;&#x7528;&#x6765;&#x6807;&#x8BB0; rbuf &#x5DF2;&#x7ECF;&#x89E3;&#x6790;&#x5230;&#x4E86;&#x54EA;&#x91CC;&#x3002; </p>
<p>memcached &#x542F;&#x52A8;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x53EB;&#x505A; conns &#x7684;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF0C;&#x7528;&#x6765;&#x7F13;&#x5B58;&#x6240;&#x6709;&#x8FDE;&#x63A5;&#x3002;&#x5F53;&#x8C03;&#x7528; conn_new &#x51FD;&#x6570;&#x521B;&#x5EFA;&#x65B0;&#x7684; connection &#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x5148;&#x4ECE; conns &#x5F53;&#x4E2D;&#x67E5;&#x8BE2;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x521B;&#x5EFA;&#x4E86;&#x8FDE;&#x63A5;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x5219;&#x8FD4;&#x56DE;&#x73B0;&#x6709;&#x7684; connection &#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#xFF0C;&#x624D;&#x521B;&#x5EFA;&#x65B0;&#x7684;&#xFF0C;&#x4EE3;&#x7801;&#x5927;&#x81F4;&#x5982;&#x4E0B;&#xFF1A; </p>
<pre><code>conn *conn_new(...) {  
    conn *<span class="built_in">c</span>;
    <span class="built_in">assert</span>(sfd &amp;gt;= <span class="number">0</span> &amp;amp;&amp;amp; sfd &amp;lt; max_fds);
    <span class="built_in">c</span> = conns[sfd];
    <span class="keyword">if</span> (<span class="type">NULL</span> == <span class="built_in">c</span>) {
        <span class="comment">// &amp;#x521B;&amp;#x5EFA;&amp;#x65B0;&amp;#x7684; connection</span>
        ...
        <span class="built_in">c</span>-&amp;gt;sfd = sfd;
        conns[sfd] = <span class="built_in">c</span>;
    }
    <span class="comment">// &amp;#x4F7F;&amp;#x7528;&amp;#x7F13;&amp;#x5B58;&amp;#x7684; connection</span>
    ...
    <span class="keyword">return</span> <span class="built_in">c</span>;
}
</code></pre><h4 id="slabclass_t_&amp;_item">slabclass_t &amp; item</h4><p>slabclass_t &#x548C; item &#x662F; memcache &#x91CC;&#x4E0E;&#x7F13;&#x5B58;&#x529F;&#x80FD;&#x548C;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x76F8;&#x5173;&#x8054;&#x7684;&#x5173;&#x952E;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x3002; </p>
<p>To be continued …</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Memcached/">Memcached</a><a href="/tags/数据结构/">数据结构</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/03/234073c/" title="轻量的Memcached代理Twemproxy的部署 -" itemprop="url">轻量的Memcached代理Twemproxy的部署 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-03T02:09:37.000Z" itemprop="datePublished"> 发表于 2015-07-03</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p> &#x8F7B;&#x91CF;&#x7684;Memcached&#x4EE3;&#x7406;Twemproxy&#x7684;&#x90E8;&#x7F72; </p>
<p>Twemproxy(&#x53C8;&#x79F0;&#x4E3A;nutcracker)&#x662F;&#x4E00;&#x4E2A;&#x8F7B;&#x91CF;&#x7EA7;&#x7684;Redis&#x548C;Memcached&#x4EE3;&#x7406;&#xFF0C;&#x4E3B;&#x8981;&#x7528;&#x6765;&#x51CF;&#x5C11;&#x5BF9;&#x540E;&#x7AEF;&#x7F13;&#x5B58;&#x670D;&#x52A1;&#x5668;&#x7684;&#x8FDE;&#x63A5;&#x6570;&#x3002;&#x7531;Twitter&#x5F00;&#x6E90;&#x51FA;&#x6765;&#x7684;&#x7F13;&#x5B58;&#x670D;&#x52A1;&#x5668;&#x96C6;&#x7FA4;&#x7BA1;&#x7406;&#x5DE5;&#x5177;&#xFF0C;&#x4E3B;&#x8981;&#x7528;&#x6765;&#x5F25;&#x8865;Redis&#x548C;Memcached&#x5BF9;&#x96C6;&#x7FA4;(cluster)&#x7BA1;&#x7406;&#x6307;&#x51FA;&#x7684;&#x4E0D;&#x8DB3;&#x3002;</p>
<p>Twemproxy&#x662F;&#x4E00;&#x4E2A;&#x5FEB;&#x901F;&#x7684;&#x5355;&#x7EBF;&#x7A0B;&#x4EE3;&#x7406;&#x7A0B;&#x5E8F;&#xFF0C;&#x652F;&#x6301;Memcached ASCII&#x534F;&#x8BAE;&#x548C;&#x66F4;&#x65B0;&#x7684;Redis&#x534F;&#x8BAE;&#x3002;</p>
<p>Twemproxy&#x6700;&#x4E86;&#x4E0D;&#x8D77;&#x7684;&#x5730;&#x65B9;&#x5C31;&#x5728;&#x4E8E;&#x5B83;&#x80FD;&#x5728;&#x8282;&#x70B9;&#x5931;&#x8D25;&#x7684;&#x65F6;&#x5019;&#x5378;&#x8F7D;&#x5B83;&#xFF0C;&#x7136;&#x540E;&#x53EF;&#x4EE5;&#x5728;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x4EE5;&#x540E;&#x91CD;&#x65B0;&#x5C1D;&#x8BD5;&#xFF08;&#x968F;&#x5373;&#xFF09;&#x8FDE;&#x63A5;&#xFF0C;&#x53C8;&#x6216;&#x8005;&#x53EF;&#x4EE5;&#x4E25;&#x683C;&#x6309;&#x7167;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x5199;&#x7684;&#x952E;&#x4E0E;&#x670D;&#x52A1;&#x5668;&#x4E4B;&#x95F4;&#x5BF9;&#x5E94;&#x5173;&#x7CFB;&#x8FDB;&#x884C;&#x8FDE;&#x63A5;&#x3002;</p>
<h4 id="&#x5B89;&#x88C5;&#x90E8;&#x7F72;">&#x5B89;&#x88C5;&#x90E8;&#x7F72;</h4><p>&#x73B0;&#x6709;&#x6D4B;&#x8BD5;&#x673A;&#xFF1A;192.168.11.51/52/68</p>
<p>&#x5148;&#x5728;51&#x548C;52&#x6D4B;&#x8BD5;&#x673A;&#x4E0A;&#x5B89;&#x88C5;&#x597D;libevent&#x548C;memcached&#xFF0C;&#x5206;&#x522B;&#x542F;&#x52A8;&#x4E24;&#x4E2A;memcached&#x5B9E;&#x4F8B;&#xFF1B;</p>
<p>&#x7136;&#x540E;&#x5728;68&#x4E0A;&#x5B89;&#x88C5;&#x597D;twemproxy&#xFF0C;&#x914D;&#x7F6E;&#x597D;&#x53C2;&#x6570;&#xFF0C;&#x542F;&#x52A8;twemproxy&#x5B9E;&#x4F8B;&#x3002;</p>
<p>&#x5B89;&#x88C5;&#x548C;&#x542F;&#x52A8;memcached&#x5B9E;&#x4F8B; </p>
<p>&#x8BE6;&#x7EC6;&#x6B65;&#x9AA4;&#xFF0C;&#x8BF7;&#x53C2;&#x89C1;&#x4E4B;&#x524D;&#x7684;&#x535A;&#x6587; <a href="http://ultrasql.blog.51cto.com/9591438/1632179" target="_blank" rel="external">&#x300A;Memcached 1.4.22&#x5B89;&#x88C5;&#x548C;&#x914D;&#x7F6E;&#x300B;</a> &#xFF0C;&#x5206;&#x522B;&#x542F;&#x52A8;&#x5982;&#x4E0B;&#x5B9E;&#x4F8B;&#xFF1A; </p>
<pre><code>/usr/<span class="keyword">local</span>/bin/memcached -<span class="keyword">d</span> -<span class="keyword">m</span> 128 -<span class="keyword">u</span> memcached -<span class="keyword">l</span> 192.168.11.51 -p 11211 -c 1024 -P /<span class="keyword">var</span>/<span class="keyword">run</span>/memcached/memcached1.pid
/usr/<span class="keyword">local</span>/bin/memcached -<span class="keyword">d</span> -<span class="keyword">m</span> 128 -<span class="keyword">u</span> memcached -<span class="keyword">l</span> 192.168.11.51 -p 11212 -c 1024 -P /<span class="keyword">var</span>/<span class="keyword">run</span>/memcached/memcached2.pid
/usr/<span class="keyword">local</span>/bin/memcached -<span class="keyword">d</span> -<span class="keyword">m</span> 128 -<span class="keyword">u</span> memcached -<span class="keyword">l</span> 192.168.11.52 -p 11211 -c 1024 -P /<span class="keyword">var</span>/<span class="keyword">run</span>/memcached/memcached1.pid
/usr/<span class="keyword">local</span>/bin/memcached -<span class="keyword">d</span> -<span class="keyword">m</span> 128 -<span class="keyword">u</span> memcached -<span class="keyword">l</span> 192.168.11.52 -p 11212 -c 1024 -P /<span class="keyword">var</span>/<span class="keyword">run</span>/memcached/memcached2.pid
</code></pre><p>&#x5B89;&#x88C5;&#x548C;&#x542F;&#x52A8;twemproxy&#x5B9E;&#x4F8B; </p>
<p>1 <strong>&#x3001;&#x5B89;&#x88C5;autoconf</strong></p>
<pre><code>cd /tmp
wget <span class="symbol">http:</span>/<span class="regexp">/ftp.gnu.org/gnu</span><span class="regexp">/autoconf/autoconf</span>-<span class="number">2.69</span>.tar.gz
tar zxvf autoconf-<span class="number">2.69</span>.tar.gz
cd autoconf-<span class="number">2.69</span>
./configure --prefix=<span class="regexp">/usr/</span>
make &amp;amp;&amp;amp; make install
</code></pre><p>2 <strong>&#x3001;&#x5B89;&#x88C5;twemproxy</strong></p>
<pre><code><span class="keyword">cd</span> /tmp
wget https:<span class="comment">//github.com/twitter/twemproxy/archive/master.zip</span>
unzip master.<span class="keyword">zip</span> -<span class="keyword">d</span> /usr/<span class="keyword">local</span>/
<span class="keyword">cd</span> /usr/<span class="keyword">local</span>
mv twemproxy-master twemproxy
<span class="keyword">cd</span> twemproxy
CFLAGS=&amp;quot;-ggdb3 -O0&amp;quot; autoreconf -fvi
./configure --prefix=/usr/<span class="keyword">local</span>/twemproxy --enable-debug=<span class="literal">log</span>
make &amp;amp;&amp;amp; make install
</code></pre><p>3 <strong>&#x3001;&#x67E5;&#x770B;&#x5E2E;&#x52A9;</strong></p>
<pre><code>[root@test01 twemproxy]# ./sbin/nutcracker -<span class="literal">h</span>

This is nutcracker-0.4.0
Usage: nutcracker [-?hVdDt] [-v verbosity level] [-o output <span class="keyword">file</span>]
[-c <span class="keyword">conf</span> <span class="keyword">file</span>] [-s stats port] [-a stats addr]
[-i stats interval] [-p pid <span class="keyword">file</span>] [-<span class="keyword">m</span> mbuf size]
Options:
-<span class="keyword">h</span>, --<span class="keyword">help</span> : this <span class="keyword">help</span>
-V, --<span class="keyword">version</span> : show <span class="keyword">version</span> and <span class="keyword">exit</span>
-t, --<span class="keyword">test</span>-<span class="keyword">conf</span> : <span class="keyword">test</span> configuration <span class="keyword">for</span> <span class="keyword">syntax</span> errors and <span class="keyword">exit</span>
-<span class="keyword">d</span>, --daemonize : <span class="keyword">run</span> <span class="keyword">as</span> a daemon
-<span class="keyword">D</span>, --<span class="keyword">describe</span>-stats : <span class="keyword">print</span> stats description and <span class="keyword">exit</span>
-v, --verbose=<span class="keyword">N</span> : <span class="keyword">set</span> logging level (default: 5, min: 0, max: 11)
-o, --output=S : <span class="keyword">set</span> logging <span class="keyword">file</span> (default: stderr)
-c, --<span class="keyword">conf</span>-<span class="keyword">file</span>=S : <span class="keyword">set</span> configuration <span class="keyword">file</span> (default: <span class="keyword">conf</span>/nutcracker.yml)
-s, --stats-port=<span class="keyword">N</span> : <span class="keyword">set</span> stats monitoring port (default: 22222)
-a, --stats-addr=S : <span class="keyword">set</span> stats monitoring ip (default: 0.0.0.0)
-i, --stats-interval=<span class="keyword">N</span> : <span class="keyword">set</span> stats aggregation interval <span class="keyword">in</span> msec (default: 30000 msec)
-p, --pid-<span class="keyword">file</span>=S : <span class="keyword">set</span> pid <span class="keyword">file</span> (default: off)
-<span class="keyword">m</span>, --mbuf-size=<span class="keyword">N</span> : <span class="keyword">set</span> size of mbuf chunk <span class="keyword">in</span> bytes (default: 16384 bytes)
</code></pre><p>4 <strong>&#x3001;&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</strong></p>
<pre><code>mkdir <span class="regexp">/etc/</span>nutcracker
cp .<span class="regexp">/conf/</span>nutcracker.yml <span class="regexp">/etc/</span>nutcracker/
vi <span class="regexp">/etc/</span>nutcracker/nutcracker.yml
<span class="label">
memcached:</span>
<span class="string">listen:</span> <span class="number">192.168</span>.11.55:<span class="number">22121</span>
<span class="string">hash:</span> fnvla_64
<span class="string">distribution:</span> ketama
<span class="string">timeout:</span> <span class="number">400</span>
<span class="string">backlog:</span> <span class="number">1024</span>
<span class="string">preconnect:</span> <span class="literal">true</span>
<span class="string">auto_eject_hosts:</span> <span class="literal">true</span>
<span class="string">server_retry_timeout:</span> <span class="number">30000</span>
<span class="string">server_failure_limit:</span> <span class="number">3</span>
<span class="string">servers:</span>
- <span class="number">192.168</span>.11.51:<span class="number">11211</span>:<span class="number">1</span>
- <span class="number">192.168</span>.11.51:<span class="number">11212</span>:<span class="number">1</span>
- <span class="number">192.168</span>.11.52:<span class="number">11211</span>:<span class="number">1</span>
- <span class="number">192.168</span>.11.52:<span class="number">11212</span>:<span class="number">1</span>
</code></pre><p>&#x53C2;&#x6570;&#x89E3;&#x6790;&#xFF1A;</p>
<p>listen: &#x542F;&#x52A8;twemproxy&#x670D;&#x52A1;&#x7684;IP&#x548C;&#x7AEF;&#x53E3;</p>
<p>hash: &#x6307;&#x5B9A;&#x5177;&#x4F53;&#x7684;&#x54C8;&#x5E0C;&#x51FD;&#x6570;</p>
<p>distribution: &#x6307;&#x5B9A;&#x5177;&#x4F53;&#x7684;&#x54C8;&#x5E0C;&#x7B97;&#x6CD5;</p>
<p>preconnect: &#x4E00;&#x4E2A;&#x5E03;&#x5C14;&#x503C;&#xFF0C;&#x5982;&#x679C;&#x8BE5;&#x63A7;&#x4EF6;&#x7684;nutcracker&#x524D;&#x7AEF;&#x8FDE;&#x63A5;&#x5728;&#x8FD9;&#x4E2A;&#x6C60;&#x4E0A;&#x7684;&#x6240;&#x6709;&#x670D;&#x52A1;&#x5668;&#x8FDB;&#x7A0B;&#x542F;&#x52A8;&#x3002;&#x9ED8;&#x8BA4;&#x503C;&#x4E3A;&#x5047;</p>
<p>auto_eject_hosts: &#x662F;&#x5426;&#x5728;&#x7ED3;&#x70B9;&#x65E0;&#x6CD5;&#x54CD;&#x5E94;&#x7684;&#x65F6;&#x5019;&#x4E34;&#x65F6;&#x6458;&#x9664;&#x7ED3;&#x70B9;</p>
<p>server_retry_timeout: &#x91CD;&#x8BD5;&#x7684;&#x65F6;&#x95F4;&#xFF08;&#x6BEB;&#x79D2;&#xFF09;</p>
<p>server_failure_limit: &#x7ED3;&#x70B9;&#x6545;&#x969C;&#x591A;&#x5C11;&#x6B21;&#x5C31;&#x7B97;&#x6458;&#x9664;&#x6389;</p>
<p>servers: &#x4E0B;&#x9762;&#x8868;&#x793A;&#x6240;&#x6709;&#x7684;memcached&#x8282;&#x70B9;&#xFF08;IP:&#x7AEF;&#x53E3;&#x53F7;:&#x6743;&#x91CD;&#xFF09;</p>
<p>5 <strong>&#x3001;&#x914D;&#x7F6E;&#x4EE5;&#x670D;&#x52A1;&#x542F;&#x52A8;</strong></p>
<pre><code>cp .<span class="regexp">/scripts/</span>nutcracker.init <span class="regexp">/etc/</span>init.d/nutcracker
chmod <span class="number">755</span> <span class="regexp">/etc/</span>init.d/nutcracker
vi <span class="regexp">/etc/</span>init.d/nutcracker
</code></pre><ol>
<li><p>&#x65B0;&#x589E;&#x5B9A;&#x4E49;daemo</p>
<p> daemon=&quot;/usr/local/twemproxy/sbin/nutcracker&quot;</p>
</li>
<li><p>&#x66FF;&#x6362;&#x6240;&#x6709;</p>
<p> daemon —user ${USER} ${prog} $OPTIONS</p>
</li>
</ol>
<p>&#x4E3A;</p>
<pre><code><span class="label">${daemo}</span> <span class="label">$OPTIONS</span>

chkconfig --add nutcracker
chkconfig --level 35 nutcracker <span class="keyword">on</span>
chkconfig --<span class="keyword">list</span> nutcracker

vi /etc/profile
</code></pre><p>&#x5728;&#x91CC;&#x9762;&#x52A0;&#x5165;&#xFF1A;</p>
<pre><code>export <span class="constant">PATH=</span>&amp;quot;<span class="variable">$PATH</span><span class="symbol">:/usr/local/twemproxy/sbin&amp;quot</span>;

. /etc/profile
echo <span class="variable">$PATH</span>
</code></pre><p>6 <strong>&#x3001;&#x6D4B;&#x8BD5;&#x914D;&#x7F6E;&#x5E76;&#x542F;&#x52A8;&#x670D;&#x52A1;</strong></p>
<pre><code>nutcracker -t -c /etc/nutcracker/nutcracker.yml
<span class="keyword">service</span> nutcracker <span class="literal">start</span>
</code></pre><h4 id="&#x6570;&#x636E;&#x5199;&#x5165;&#x6D4B;&#x8BD5;">&#x6570;&#x636E;&#x5199;&#x5165;&#x6D4B;&#x8BD5;</h4><pre><code>[root@test01 init.d]# telnet 192.168.11.55 11211

Trying 192.168.11.55...
Connected to 192.168.11.55.
Escape character is &amp;apos;^]&amp;apos;.
<span class="operator"><span class="keyword">set</span> key1 <span class="number">0</span> <span class="number">0</span> <span class="number">1</span>
<span class="number">1</span>
STORED
<span class="keyword">set</span> key2 <span class="number">0</span> <span class="number">0</span> <span class="number">2</span>
<span class="number">22</span>
STORED
<span class="keyword">set</span> key3 <span class="number">0</span> <span class="number">0</span> <span class="number">3</span>
<span class="number">333</span>
STORED
<span class="keyword">set</span> key4 <span class="number">0</span> <span class="number">0</span> <span class="number">4</span>
<span class="number">4444</span>
STORED
<span class="keyword">set</span> key5 <span class="number">0</span> <span class="number">0</span> <span class="number">5</span>
<span class="number">55555</span>
STORED
quit
<span class="keyword">Connection</span> closed <span class="keyword">by</span> <span class="keyword">foreign</span> host.

[root@test01 ~]# telnet <span class="number">192.168</span>.11.51 <span class="number">11211</span>

Trying <span class="number">192.168</span>.11.51...
Connected <span class="keyword">to</span> <span class="number">192.168</span>.11.51.
<span class="keyword">Escape</span> <span class="built_in">character</span> <span class="keyword">is</span> &amp;apos;</span>^]&amp;apos;.
get key1
<span class="operator"><span class="keyword">END</span>
<span class="keyword">get</span> key2
<span class="keyword">END</span>
<span class="keyword">get</span> key3
<span class="keyword">END</span>
<span class="keyword">get</span> key4
<span class="keyword">END</span>
<span class="keyword">get</span> key5
<span class="keyword">END</span>
quit
<span class="keyword">Connection</span> closed <span class="keyword">by</span> <span class="keyword">foreign</span> host.

[root@test01 ~]# telnet <span class="number">192.168</span>.11.51 <span class="number">11212</span>

Trying <span class="number">192.168</span>.11.51...
Connected <span class="keyword">to</span> <span class="number">192.168</span>.11.51.
<span class="keyword">Escape</span> <span class="built_in">character</span> <span class="keyword">is</span> &amp;apos;</span>^]&amp;apos;.
get key1
<span class="operator"><span class="keyword">END</span>
<span class="keyword">get</span> key2
<span class="keyword">END</span>
<span class="keyword">get</span> key3
<span class="keyword">END</span>
<span class="keyword">get</span> key4
<span class="keyword">END</span>
<span class="keyword">get</span> key5
<span class="keyword">END</span>
quit
<span class="keyword">Connection</span> closed <span class="keyword">by</span> <span class="keyword">foreign</span> host.

[root@test02 ~]# telnet <span class="number">192.168</span>.11.52 <span class="number">11211</span>

Trying <span class="number">192.168</span>.11.52...
Connected <span class="keyword">to</span> <span class="number">192.168</span>.11.52.
<span class="keyword">Escape</span> <span class="built_in">character</span> <span class="keyword">is</span> &amp;apos;</span>^]&amp;apos;.
get key1
<span class="operator"><span class="keyword">END</span>
<span class="keyword">get</span> key2
<span class="keyword">END</span>
<span class="keyword">get</span> key3
<span class="keyword">END</span>
<span class="keyword">get</span> key4
<span class="keyword">END</span>
<span class="keyword">get</span> key5
<span class="keyword">END</span>
quit
<span class="keyword">Connection</span> closed <span class="keyword">by</span> <span class="keyword">foreign</span> host.

[root@test02 ~]# telnet <span class="number">192.168</span>.11.52 <span class="number">11212</span>

Trying <span class="number">192.168</span>.11.52...
Connected <span class="keyword">to</span> <span class="number">192.168</span>.11.52.
<span class="keyword">Escape</span> <span class="built_in">character</span> <span class="keyword">is</span> &amp;apos;</span>^]&amp;apos;.
get key1
VALUE key1 0 1
1
<span class="operator"><span class="keyword">END</span>
<span class="keyword">get</span> key2
<span class="keyword">VALUE</span> key2 <span class="number">0</span> <span class="number">2</span>
<span class="number">22</span>
<span class="keyword">END</span>
<span class="keyword">get</span> key3
<span class="keyword">VALUE</span> key3 <span class="number">0</span> <span class="number">3</span>
<span class="number">333</span>
<span class="keyword">END</span>
<span class="keyword">get</span> key4
<span class="keyword">VALUE</span> key4 <span class="number">0</span> <span class="number">4</span>
<span class="number">4444</span>
<span class="keyword">END</span>
<span class="keyword">get</span> key5
<span class="keyword">VALUE</span> key5 <span class="number">0</span> <span class="number">5</span>
<span class="number">55555</span>
<span class="keyword">END</span>
quit
<span class="keyword">Connection</span> closed <span class="keyword">by</span> <span class="keyword">foreign</span> host.</span>
</code></pre><p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6570;&#x636E;&#x5168;&#x90E8;&#x4ECE;52&#x7684;11212&#x7AEF;&#x53E3;&#x83B7;&#x53D6;&#x5230;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x505C;&#x6389;52&#x7684;11212&#x7AEF;&#x53E3;&#x670D;&#x52A1;&#x3002;</p>
<p>&#x7EE7;&#x7EED;&#x5F80;&#x4EE3;&#x7406;&#x5199;&#x6570;&#x636E;&#x3002;</p>
<pre><code><span class="comment">[root@test03 init.d]</span># telnet 192.168.11.55 11211

Trying 192.168.11.55...
Connected to 192.168.11.55.
Escape character <span class="keyword">is</span> &amp;apos;^]&amp;apos;.
set username 0 0 6
ryanxu
STORED
set aa 0 0 2
aa
STORED
quit
Connection <span class="keyword">closed</span> by foreign host.

<span class="comment">[root@test03 init.d]</span># telnet 192.168.11.55 11211

Trying 192.168.11.55...
Connected to 192.168.11.55.
Escape character <span class="keyword">is</span> &amp;apos;^]&amp;apos;.
get key1
SERVER_ERROR Connection refused
Connection <span class="keyword">closed</span> by foreign host.

<span class="comment">[root@test03 init.d]</span># telnet 192.168.11.55 11211

Trying 192.168.11.55...
Connected to 192.168.11.55.
Escape character <span class="keyword">is</span> &amp;apos;^]&amp;apos;.
get key1
SERVER_ERROR Connection refused
Connection <span class="keyword">closed</span> by foreign host.

<span class="comment">[root@test03 init.d]</span># telnet 192.168.11.55 11211

Trying 192.168.11.55...
Connected to 192.168.11.55.
Escape character <span class="keyword">is</span> &amp;apos;^]&amp;apos;.
get key1
END
get key2
END
get key3
END
quit
Connection <span class="keyword">closed</span> by foreign host.
</code></pre><p>&#x4E00;&#x53F0;memcached &#x6302;&#x6389;&#x540E;&#xFF0C;twemproxy &#x80FD;&#x591F;&#x81EA;&#x52A8;&#x6458;&#x9664;&#x3002;&#x6062;&#x590D;&#x540E;&#xFF0C;twemproxy &#x80FD;&#x591F;&#x81EA;&#x52A8;&#x8BC6;&#x522B;&#x3001;&#x6062;&#x590D;&#x5E76;&#x91CD;&#x65B0;&#x52A0;&#x5165;&#x5230; memcached &#x7EC4;&#x4E2D;&#x91CD;&#x65B0;&#x4F7F;&#x7528;&#x3002;</p>
<h4 id="&#x95EE;&#x9898;&#x603B;&#x7ED3;">&#x95EE;&#x9898;&#x603B;&#x7ED3;</h4><p>1&#xFF09;.yml&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x6BCF;&#x4E2A;&#x53C2;&#x6570;&#x503C;&#x5BF9;&#x5206;&#x9694;&#x7B26;&#x201D;:&#x201D;&#x540E;&#x9700;&#x8981;&#x6709;&#x4E00;&#x4E2A;&#x7A7A;&#x683C;&#x3002;</p>
<p>2&#xFF09;&#x4E0D;&#x540C;&#x5C42;&#x6B21;&#x7684;&#x53C2;&#x6570;&#x9700;&#x8981;&#x7F29;&#x8FDB;&#x533A;&#x5206;&#xFF0C;&#x6700;&#x597D;&#x4F7F;&#x7528;tab&#x952E;&#x7F29;&#x8FDB;&#xFF0C;&#x5426;&#x5219;nutcracker&#x8FDB;&#x7A0B;&#x4E0D;&#x80FD;&#x542F;&#x52A8;&#x3002;</p>
<p>3&#xFF09;&#x5728;auto_eject_hosts: true&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5173;&#x95ED;&#x4E00;&#x4E2A;memcached&#x5B9E;&#x4F8B;&#x540E;&#xFF0C;&#x5199;&#x5165;&#x6570;&#x636E;&#x8FD8;&#x662F;&#x63D0;&#x793A;&#x201C;(error) ERR Connection refused&#x201D;&#x3002;&#x8FD9;&#x4E2A;&#x4E0E;server_retry_timeout&#x53C2;&#x6570;&#x8BBE;&#x7F6E;&#x592A;&#x5C0F;&#x6709;&#x5173;&#xFF0C;30000&#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x597D;&#x7684;&#x9009;&#x62E9;&#x3002;</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Memcached/">Memcached</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/03/233ddbb/" title="JS结合Memcache实现爬虫程序的识别与阻挡 -" itemprop="url">JS结合Memcache实现爬虫程序的识别与阻挡 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-03T02:09:37.000Z" itemprop="datePublished"> 发表于 2015-07-03</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>&#x6700;&#x8FD1;&#x516C;&#x53F8;&#x7F51;&#x7AD9;&#x7684;&#x4E00;&#x4E2A;&#x67E5;&#x8BE2;&#x63A5;&#x53E3;&#x4E00;&#x76F4;&#x906D;&#x53D7;&#x722C;&#x866B;&#x7684;&#x8BBF;&#x95EE;&#xFF0C;&#x7531;&#x4E8E;&#x5BF9;&#x65B9;&#x901A;&#x8FC7;&#x6570;&#x91CF;&#x5DE8;&#x5927;&#x7684;&#x5206;&#x5E03;&#x5F0F;IP&#x8BBF;&#x95EE;(&#x5927;&#x7EA6;&#x662F;&#x6B63;&#x5E38;&#x8BBF;&#x95EE;IP&#x6570;&#x91CF;&#x7684;&#x51E0;&#x767E;&#x500D;)&#xFF0C;&#x540C;&#x65F6;&#x5355;&#x4E2A;IP&#x7684;&#x8BBF;&#x95EE;&#x9891;&#x7387;&#x53C8;&#x6BD4;&#x8F83;&#x4F4E;&#xFF0C;&#x6240;&#x4EE5;&#x4EE5;&#x5F80;&#x90E8;&#x7F72;&#x7684;&#x4E00;&#x4E9B;&#x6839;&#x636E;&#x8BBF;&#x95EE;&#x9891;&#x7387;&#x7279;&#x5F81;&#x8BC6;&#x522B;&#x963B;&#x6321;&#x7684;&#x7B56;&#x7565;&#x57FA;&#x672C;&#x65E0;&#x6CD5;&#x8D77;&#x5230;&#x6709;&#x6548;&#x7684;&#x9632;&#x8303;&#x4F5C;&#x7528;&#x3002;</p>
<p>&#x9891;&#x7387;&#x7279;&#x5F81;&#x8BC6;&#x522B;&#x884C;&#x4E0D;&#x901A;&#xFF0C;&#x4E8E;&#x662F;&#x6211;&#x4EEC;&#x53C8;&#x901A;&#x8FC7;&#x8BC6;&#x522B;&#x722C;&#x866B;&#x5DE5;&#x5177;&#x7684;HTTP&#x8BF7;&#x6C42;&#x5934;&#x4E2D;&#x7684;&#x4E00;&#x4E9B;&#x7279;&#x5F81;&#xFF1A;&#x662F;&#x5426;&#x5305;&#x542B;&#x7279;&#x5B9A;&#x7684;HTTP&#x5934;&#x6216;&#x6CA1;&#x6709;&#x5305;&#x542B;&#x67D0;&#x4E9B;&#x6B63;&#x5E38;&#x6D4F;&#x89C8;&#x5668;&#x8BF7;&#x6C42;&#x5E94;&#x8BE5;&#x643A;&#x5E26;&#x7684;HTTP&#x5934;(&#x5982;cookie&#x548C;referrer)&#xFF0C;&#x8FD9;&#x6837;&#x7684;&#x5C01;&#x9501;&#x6BD4;&#x8F83;&#x6709;&#x9488;&#x5BF9;&#x6027;&#xFF0C;&#x4F46;&#x662F;HTTP&#x5934;&#x7684;&#x4FEE;&#x6539;&#x6210;&#x672C;&#x5F88;&#x4F4E;&#xFF0C;&#x5BF9;&#x65B9;&#x540E;&#x6765;&#x4E5F;&#x786E;&#x5B9E;&#x591A;&#x6B21;&#x8C03;&#x6574;HTTP&#x5934;&#x4FE1;&#x606F;&#x6765;&#x89C4;&#x907F;&#x6211;&#x4EEC;&#x7684;&#x68C0;&#x67E5;&#x3002;&#x540C;&#x65F6;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4E5F;&#x6709;&#x53EF;&#x80FD;&#x8BEF;&#x4F24;&#x4E00;&#x4E9B;&#x6B63;&#x5E38;&#x7684;&#x8BBF;&#x95EE;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x66F4;&#x6709;&#x6548;&#x5730;&#x8BC6;&#x522B;&#x722C;&#x866B;&#x7A0B;&#x5E8F;&#xFF0C;&#x6211;&#x4EEC;&#x7EE7;&#x7EED;&#x5BFB;&#x627E;&#x5176;&#x5B83;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4E5F;&#x5728;&#x7F51;&#x4E0A;&#x67E5;&#x4E86;&#x4E00;&#x4E9B;&#x8D44;&#x6599;&#x3002;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x666E;&#x904D;&#x5E94;&#x7528;&#x7684;&#x539F;&#x7406;&#xFF0C;&#x662F;&#x57FA;&#x4E8E;&#x722C;&#x866B;&#x4E00;&#x822C;&#x90FD;&#x662F;&#x6784;&#x9020;&#x67E5;&#x8BE2;&#x8BF7;&#x6C42;&#x76F4;&#x63A5;Post&#x5230;&#x67E5;&#x8BE2;&#x63A5;&#x53E3;&#x8FD9;&#x4E00;&#x7279;&#x5F81;&#xFF0C;&#x901A;&#x8FC7;&#x5728;&#x9875;&#x9762;&#x5D4C;&#x5165;JS&#x4EE3;&#x7801;&#x5224;&#x65AD;&#x8BBF;&#x95EE;&#x6765;&#x6E90;&#x662F;&#x4E00;&#x4E2A;&#x771F;&#x5B9E;&#x6D4F;&#x89C8;&#x5668;&#x8FD8;&#x662F;&#x4E00;&#x4E2A;&#x76F4;&#x63A5;&#x8BF7;&#x6C42;&#x63A5;&#x53E3;&#x7684;&#x7A0B;&#x5E8F;&#x3002;&#x5728;&#x66F4;&#x5B8C;&#x6574;&#x7684;&#x65B9;&#x6848;&#x91CC;&#xFF0C;&#x8FD8;&#x6709;&#x540C;&#x65F6;&#x7ED3;&#x5408;memcache&#x6216;redis&#x5BF9;&#x8BF7;&#x6C42;&#x7684;IP&#x8FDB;&#x884C;&#x8BA1;&#x6570;&#x7EDF;&#x8BA1;&#xFF1A;&#x5728;&#x67E5;&#x8BE2;&#x63A5;&#x53E3;&#x65F6;&#xFF0C;&#x5BF9;&#x6765;&#x6E90;IP&#x8BF7;&#x6C42;&#x8BA1;&#x6570;+1&#xFF0C;&#x540C;&#x65F6;&#xFFFD;&#xFFFD;&#xFFFD;&#x54CD;&#x5E94;&#x9875;&#x9762;&#x7684;JS&#x91CC;&#x5B9E;&#x73B0;&#x5BF9;&#x6765;&#x6E90;IP&#x8BF7;&#x6C42;-1&#xFF0C;&#x8FD9;&#x6837;&#x4E00;&#x6765;&#xFF0C;&#x6B63;&#x5E38;&#x7684;&#x7528;&#x6237;&#x6D4F;&#x89C8;&#x5668;&#x67E5;&#x8BE2;&#x8BBF;&#x95EE;&#xFF0C;&#x4E24;&#x6B21;&#x64CD;&#x4F5C;&#x8BA1;&#x6570;&#x62B5;&#x6D88;&#xFF0C;&#x8BA1;&#x6570;&#x5E94;&#x8BE5;&#x59CB;&#x7EC8;&#x4FDD;&#x6301;&#x5728;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x4F4E;&#x7684;&#x503C;(&#x7406;&#x60F3;&#x60C5;&#x51B5;&#x5E94;&#x8BE5;&#x59CB;&#x7EC8;&#x5728;0&#x6216;1&#xFF0C;&#x4F46;&#x8003;&#x8651;&#x5230;&#x54CD;&#x5E94;&#x9875;&#x9762;&#x53EF;&#x80FD;&#x51FA;&#x73B0;&#x52A0;&#x8F7D;&#x4E0D;&#x5B8C;&#x5168;&#x7B49;&#x60C5;&#x51B5;&#xFF0C;&#x4E0D;&#x4E00;&#x5B9A;&#x6BCF;&#x6B21;&#x90FD;&#x80FD;&#x51CF;&#x503C;)&#xFF0C;&#x800C;&#x722C;&#x866B;&#x7A0B;&#x5E8F;&#x7531;&#x4E8E;&#x5E76;&#x4E0D;&#x89E6;&#x53D1;JS&#xFF0C;&#x7D2F;&#x8BA1;&#x67E5;&#x8BE2;&#x59CB;&#x7EC8;&#x589E;&#x957F;&#x3002;&#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x6709;&#x6548;&#x8BC6;&#x522B;&#x51FA;&#x54EA;&#x4E9B;&#x6765;&#x6E90;&#x662F;&#x722C;&#x866B;&#x8BF7;&#x6C42;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x8981;&#x600E;&#x4E48;&#x5904;&#x7406;&#x5C31;&#x7B80;&#x5355;&#x4E86;&#x3002; </p>
<p>&#x8BF4;&#x8D77;&#x6765;&#x603B;&#x662F;&#x6CA1;&#x6709;&#x770B;&#x8D77;&#x6765;&#x90A3;&#x4E48;&#x6E05;&#x6670;&#x660E;&#x4E86;&#xFF0C;&#x4E8E;&#x662F;&#x548C;&#x56E2;&#x961F;&#x7684;&#x5C0F;&#x4F19;&#x4F34;&#x4EEC;&#x5546;&#x91CF;&#x505A;&#x4E2A;demo&#x6765;&#x6F14;&#x793A;&#x4E00;&#x4E0B;&#xFF0C;&#x8BF4;&#x5E72;&#x5C31;&#x5E72;&#xFF0C;&#x7528;&#x7B80;&#x5355;&#x5F3A;&#x5927;&#x53C8;&#x597D;&#x7528;&#x7684;Python(&#x6211;&#x4E0D;&#x4F1A;&#x544A;&#x8BC9;&#x4F60;&#x5176;&#x5B9E;&#x662F;&#x56E0;&#x4E3A;&#x6211;&#x53EA;&#x4F1A;Python&#x7684;)&#x642D;&#x4E2A;&#x7F51;&#x7AD9;&#xFF0C;&#x8D77;&#x4E2A;memcache&#xFF0C;&#x534A;&#x4E2A;&#x4E0B;&#x5348;&#x57FA;&#x672C;&#x9F50;&#x6D3B;&#x4E86;&#x3002;</p>
<p>&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>#!/bin/python

import memcache
import web
render = web.template.render(&amp;apos;templates/&amp;apos;)

mc = memcache.<span class="class">Client</span>([&amp;apos;x.x.x.<span class="method">x:</span><span class="number">11211</span>&amp;apos;], debug=<span class="number">0</span>)

<span class="symbol">#index</span>&amp;<span class="symbol">#x9875</span>;&amp;<span class="symbol">#x9762</span>;&amp;<span class="symbol">#x6709</span>;&amp;<span class="symbol">#x4E2A</span>;&amp;<span class="symbol">#x6700</span>;&amp;<span class="symbol">#x57FA</span>;&amp;<span class="symbol">#x672C</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x641C</span>;&amp;<span class="symbol">#x7D22</span>;&amp;<span class="symbol">#x6846</span>;&amp;<span class="symbol">#xFF0C</span>;post&amp;<span class="symbol">#x5230</span>;search&amp;<span class="symbol">#x9875</span>;&amp;<span class="symbol">#x9762</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x5728</span>;search&amp;<span class="symbol">#x76F4</span>;&amp;<span class="symbol">#x63A5</span>;&amp;<span class="symbol">#x663E</span>;&amp;<span class="symbol">#x793A</span>;post&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x5185</span>;&amp;<span class="symbol">#x5BB9</span>;&amp;<span class="symbol">#x3002</span>;
#&amp;<span class="symbol">#x5728</span>;search&amp;<span class="symbol">#x9875</span>;&amp;<span class="symbol">#x9762</span>;&amp;<span class="symbol">#x5D4C</span>;&amp;<span class="symbol">#x5165</span>;&amp;<span class="symbol">#x7684</span>;<span class="class">JS</span>&amp;<span class="symbol">#x4EE3</span>;&amp;<span class="symbol">#x7801</span>;&amp;<span class="symbol">#x4F1A</span>;&amp;<span class="symbol">#x5411</span>;memcache&amp;<span class="symbol">#x9875</span>;&amp;<span class="symbol">#x9762</span>;&amp;<span class="symbol">#x53D1</span>;&amp;<span class="symbol">#x8D77</span>;&amp;<span class="symbol">#x8BF7</span>;&amp;<span class="symbol">#x6C42</span>;
urls = (
  &amp;apos;/&amp;apos;,&amp;apos;index&amp;apos;,
  &amp;apos;/search&amp;apos;,&amp;apos;search&amp;apos;,
  &amp;apos;/memcache&amp;apos;,&amp;apos;mem&amp;apos;

)

class <span class="method">index:</span>
  def <span class="class">GET</span>(<span class="keyword">self</span>):
    return render.index()

#&amp;<span class="symbol">#x5728</span>;search&amp;<span class="symbol">#x9875</span>;&amp;<span class="symbol">#x9762</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x64CD</span>;&amp;<span class="symbol">#x4F5C</span>;memcache&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x5BF9</span>;&amp;<span class="symbol">#x8BBF</span>;&amp;<span class="symbol">#x95EE</span>;&amp;<span class="symbol">#x6E90</span>;<span class="class">IP</span>&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x8BA1</span>;&amp;<span class="symbol">#x6570</span>;+<span class="number">1</span>
#&amp;<span class="symbol">#x540C</span>;&amp;<span class="symbol">#x65F6</span>;&amp;<span class="symbol">#x505A</span>;&amp;<span class="symbol">#x4E2A</span>;&amp;<span class="symbol">#x5224</span>;&amp;<span class="symbol">#x65AD</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x5982</span>;&amp;<span class="symbol">#x679C</span>;&amp;<span class="symbol">#x53D1</span>;&amp;<span class="symbol">#x73B0</span>;memcache&amp;<span class="symbol">#x91CC</span>;&amp;<span class="symbol">#x8FD9</span>;&amp;<span class="symbol">#x4E2A</span>;<span class="class">IP</span>&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x8BBF</span>;&amp;<span class="symbol">#x95EE</span>;&amp;<span class="symbol">#x8BA1</span>;&amp;<span class="symbol">#x6570</span>;&amp;gt;<span class="number">1</span>&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x5C31</span>;&amp;<span class="symbol">#x8FD4</span>;&amp;<span class="symbol">#x56DE</span>;&amp;<span class="symbol">#x4E00</span>;&amp;<span class="symbol">#x4E2A</span>;&amp;<span class="symbol">#x62A5</span>;&amp;<span class="symbol">#x9519</span>;&amp;<span class="symbol">#x9875</span>;&amp;<span class="symbol">#x9762</span>;
class <span class="method">search:</span>
  def <span class="class">POST</span>(<span class="keyword">self</span>):
    data = web.input().get(&amp;apos;searchstr&amp;apos;)
    <span class="symbol">#data</span> = web.ctx[&amp;apos;ip&amp;apos;]
    srcip = str(web.ctx[&amp;apos;ip&amp;apos;])
    if mc.get(srcip):
      mc.incr(srcip)
    <span class="method">else:</span>
      mc.set(srcip,<span class="number">1</span>)
    if mc.get(srcip) &amp;gt; <span class="number">1</span>:
      return render.bug()
    <span class="method">else:</span>
      return render.search(data)

<span class="symbol">#memcache</span>&amp;<span class="symbol">#x9875</span>;&amp;<span class="symbol">#x9762</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x5904</span>;&amp;<span class="symbol">#x7406</span>;&amp;<span class="symbol">#x65B9</span>;&amp;<span class="symbol">#x6CD5</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x64CD</span>;&amp;<span class="symbol">#x4F5C</span>;&amp;<span class="symbol">#x5BF9</span>;&amp;<span class="symbol">#x8BBF</span>;&amp;<span class="symbol">#x95EE</span>;&amp;<span class="symbol">#x6E90</span>;<span class="class">IP</span>&amp;<span class="symbol">#x8BA1</span>;&amp;<span class="symbol">#x6570</span>;-<span class="number">1</span>
class <span class="method">mem:</span>
  def <span class="class">GET</span>(<span class="keyword">self</span>):
    srcip = str(web.ctx[&amp;apos;ip&amp;apos;])
    if mc.get(srcip):
      mc.decr(srcip)


if __name__ == &amp;quot;__main__&amp;quot;:
  app = web.application(urls,globals())
  app.run()
</code></pre><p>&#x7B2C;&#x4E00;&#x6B21;&#x8D34;&#x5B8C;&#x4EE3;&#x7801;&#x53D1;&#x73B0;&#x679C;&#x7136;&#x8FD8;&#x662F;&#x6CA1;&#x6709;&#x517B;&#x6210;&#x5199;&#x6CE8;&#x91CA;&#x7684;&#x597D;&#x4E60;&#x60EF;&#xFF0C;&#x597D;&#x5728;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#xFF0C;&#x8D76;&#x7D27;&#x8865;&#x5145;&#x4E00;&#x4E0B;&#x3002;&#x4EE3;&#x7801;&#x8FD0;&#x884C;&#x8D77;&#x6765;&#xFF0C;&#x9996;&#x9875;&#x5C31;&#x957F;&#x8FD9;&#x6837;&#xFF1A; </p>
<p><img src="http://taojinke.github.io/img/20150703/233ca33.png" alt=""></p>
<p>Paste_Image.png</p>
<p>&#x968F;&#x4FBF;&#x8F93;&#x5165;&#x4E00;&#x4E2A;&#x67E5;&#x8BE2;&#xFF0C;&#x6BD4;&#x5982;&quot;123&quot;&#xFF0C;&#x67E5;&#x8BE2;&#x51FA;&#x7684;&#x7ED3;&#x679C;&#x9875;&#xFF0C;&#x957F;&#x8FD9;&#x6837;&#xFF1A;</p>
<p><img src="http://taojinke.github.io/img/20150703/233cca4.png" alt=""></p>
<p>Paste_Image.png</p>
<p>&#x8FD9;&#x65F6;&#x5019;&#xFF0C;&#x53BB;&#x770B;&#x4E00;&#x4E0B;memcache&#x91CC;&#x7684;&#x8BB0;&#x5F55;&#xFF0C;&#x6211;&#x4EEC;&#x8FD9;&#x4E2A;IP&#x7684;&#x8BB0;&#x5F55;&#x6709;&#x4E86;&#xFF0C;&#x8BA1;&#x6570;&#x662F;0</p>
<p><img src="http://taojinke.github.io/img/20150703/233cf15.png" alt=""></p>
<p>Paste_Image.png</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x5DE5;&#x5177;&#x6784;&#x9020;POST&#x8BF7;&#x6C42;&#x6A21;&#x62DF;&#x722C;&#x866B;&#x7684;&#x884C;&#x4E3A;&#x3002;&#x6784;&#x9020;&#x5DE5;&#x5177;&#x5F88;&#x591A;&#x5F88;&#x591A;&#xFF0C;&#x6211;&#x4EEC;&#x4E3A;&#x4E86;&#x65B9;(tou)&#x4FBF;(lan)&#xFF0C;&#x5C31;&#x7528;linux&#x81EA;&#x5E26;&#x7684;wget&#xFF0C;&#x9053;&#x7406;&#x662F;&#x4E00;&#x6837;&#x4E00;&#x6837;&#x7684;</p>
<pre><code>$ wget <span class="variable">--post-data=</span>&amp;quot;<span class="variable">searchstr=</span><span class="number">123</span>&amp;amp;<span class="variable">submit=</span>Submit&amp;quot; http://x.x.x.x:<span class="number">8080</span>/search
</code></pre><p>&#x55EF;&#xFF0C;&#x7B2C;&#x4E00;&#x6B21;&#x67E5;&#x8BE2;&#xFF0C;&#x6211;&#x4EEC;&#x770B;&#x5230;&#x83B7;&#x53D6;&#x7684;&#x7ED3;&#x679C;&#x548C;&#x7528;&#x6D4F;&#x89C8;&#x5668;&#x8BBF;&#x95EE;&#x5F97;&#x5230;&#x7684;&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF1A;</p>
<p><img src="http://taojinke.github.io/img/20150703/233cf15.png" alt=""></p>
<p>Paste_Image.png</p>
<p>&#x4F46;&#x662F;&#x770B;&#x770B;&#x6211;&#x4EEC;&#x7684;memcache&#xFF0C;&#x7531;&#x4E8E;&#x5DE5;&#x5177;&#x5E76;&#x4E0D;&#x4F1A;&#x89E6;&#x53D1;&#x7ED3;&#x679C;&#x9875;&#x9762;&#x4E0A;&#x7684;JS&#xFF0C;&#x6240;&#x4EE5;&#x8BA1;&#x6570;&#x7D2F;&#x8BA1;&#x5230;&#x4E86;1</p>
<p><img src="http://taojinke.github.io/img/20150703/233cf15.png" alt=""></p>
<p>Paste_Image.png</p>
<p>&#x4E8E;&#x662F;&#x518D;&#x7528;&#x5DE5;&#x5177;&#x6765;&#x67E5;&#x8BE2;&#x4E00;&#x6B21;&#x770B;&#x770B;&#xFF0C;&#x7531;&#x4E8E;memcache&#x4E2D;&#x7D2F;&#x8BA1;&#x5230;&#x4E86;2&#xFF0C;&#x7A0B;&#x5E8F;&#x5904;&#x7406;&#x76F4;&#x63A5;&#x8DF3;&#x5230;&#x62A5;&#x9519;&#x9875;&#x9762;&#x4E86;&#x3002;&#x771F;&#x5B9E;&#x5E94;&#x7528;&#x4E2D;&#xFF0C;&#x8FD9;&#x91CC;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x9A8C;&#x8BC1;&#x7801;&#x4E4B;&#x7C7B;&#x7684;&#x4E1C;&#x897F;&#x3002;</p>
<p><img src="http://taojinke.github.io/img/20150703/233d186.png" alt=""></p>
<p>Paste_Image.png</p>
<p>&#x8FD9;&#x4E2A;demo&#x5E76;&#x6CA1;&#x6709;&#x7528;&#x5230;&#x7279;&#x522B;&#x6DF1;&#x7684;&#x539F;&#x7406;&#x548C;&#x6280;&#x672F;&#xFF0C;&#x4E0D;&#x8FC7;&#x80FD;&#x901A;&#x8FC7;&#x81EA;&#x5DF1;&#x7684;&#x53CC;&#x624B;&#x628A;&#x522B;&#x4EBA;&#x63D0;&#x4F9B;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x6F14;&#x793A;&#x51FA;&#x6765;&#xFF0C;&#x611F;&#x89C9;&#x8FD8;&#x662F;&#x68D2;&#x68D2;&#x54D2;&#xFF0C;&#x4E0D;&#x65AD;&#x7406;&#x8BBA;&#x7ED3;&#x5408;&#x5B9E;&#x8DF5;&#x5E76;&#x505A;&#x597D;&#x603B;&#x7ED3;&#x624D;&#x662F;&#x63D0;&#x9AD8;&#x6280;&#x672F;&#x6C34;&#x5E73;&#x7684;&#x597D;&#x65B9;&#x6CD5;&#x3002;&#x7EB8;&#x4E0A;&#x5F97;&#x6765;&#x7EC8;&#x89C9;&#x6D45;&#xFF0C;&#x7EDD;&#x77E5;&#x6B64;&#x4E8B;&#x8981;&#x8EAC;&#x884C;&#xFF0C;&#x4EE5;&#x6B64;&#x4F5C;&#x4E3A;&#x7B80;&#x4E66;&#x7B2C;&#x4E00;&#x7BC7;&#x3002; </p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/JavaScript/">JavaScript</a><a href="/tags/Memcached/">Memcached</a><a href="/tags/Python/">Python</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/03/2335292/" title="memcache源代码研究 - overview -" itemprop="url">memcache源代码研究 - overview -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-03T02:09:36.000Z" itemprop="datePublished"> 发表于 2015-07-03</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="&#x7EBF;&#x7A0B;&#x6A21;&#x578B;">&#x7EBF;&#x7A0B;&#x6A21;&#x578B;</h4><p>&#x9996;&#x5148;&#xFF0C;memcache &#x5728;&#x542F;&#x52A8;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x7EC4; worker &#x7EBF;&#x7A0B;&#xFF0C;&#x4E3B;&#x7EBF;&#x7A0B;&#x63A5;&#x6536;&#x5230;&#x7684;&#x8BF7;&#x6C42;&#x90FD;&#x4F1A;&#x8F6C;&#x7ED9; worker &#x7EBF;&#x7A0B;&#x53BB;&#x5904;&#x7406;&#x3002;&#x9700;&#x8981;&#x591A;&#x63D0;&#x4E00;&#x53E5;&#x7684;&#x662F;&#xFF0C;&#x4E3B;&#x7EBF;&#x7A0B;&#x4E0E;&#x5404; worker &#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x662F;&#x901A;&#x8FC7; <a href="https://github.com/nmathewson/Libevent" target="_blank" rel="external">libevent</a> &#x901A;&#x4FE1;&#x7684;, memcache &#x5904;&#x7406;&#x5404;&#x79CD; IO &#x64CD;&#x4F5C;&#x90FD;&#x57FA;&#x4E8E;&#x7684; libevent&#x3002; </p>
<p><img src="http://taojinke.github.io/img/20150703/23343ec.png" alt=""></p>
<h4 id="&#x5904;&#x7406;&#x6D41;&#x7A0B;">&#x5904;&#x7406;&#x6D41;&#x7A0B;</h4><p>&#x5F53;&#x4E3B;&#x7EBF;&#x7A0B;&#x63A5;&#x6536;&#x5230;&#x8BF7;&#x6C42;&#x8FDE;&#x63A5;(connection)&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x5C06;&#x8BF7;&#x6C42;&#x8F6C;&#x53D1;&#x7ED9; worker &#x7EBF;&#x7A0B;&#x3002;&#x8BF7;&#x6C42;&#x7684;&#x5904;&#x7406;&#x6D41;&#x7A0B;&#x96C6;&#x4E2D;&#x5728; memcache.c &#x6587;&#x4EF6;&#x91CC;&#x7684; drive_machine &#x65B9;&#x6CD5;&#x5F53;&#x4E2D;&#x3002; drive_machine &#x5176;&#x5B9E;&#x662F;&#x4E00;&#x4E2A;&#x5927;&#x53F7;&#x7684;&#x72B6;&#x6001;&#x673A;&#xFF0C;&#x5904;&#x7406;&#x6D41;&#x7A0B;&#x7ECF;&#x5386;&#x7684;&#x72B6;&#x6001;&#x5982;&#x4E00;&#x4E0B;&#x4EE3;&#x7801;&#x6240;&#x793A;&#xFF1A; </p>
<pre><code><span class="comment">/**
 * Possible states of a connection.
 */</span>
<span class="class"><span class="keyword">enum</span> <span class="title">conn_states</span> </span>{  
    conn_listening, 
    conn_new_cmd, 
    conn_waiting, 
    conn_read, 
    conn_parse_cmd,
    conn_write,
    conn_nread,
    conn_swallow,
    conn_closing,
    conn_mwrite,
    conn_closed,
    conn_max_state
};
</code></pre><p>&#x5176;&#x4E2D;&#x89E3;&#x6790;&#x3001;&#x5904;&#x7406;&#x8BF7;&#x6C42;&#x662F;&#x5728; conn_parse_cmd &#x5F00;&#x59CB;&#x8FDB;&#x884C;&#x7684;&#xFF0C;&#x4E3B;&#x8981;&#x7684;&#x903B;&#x8F91;&#x662F;&#x5728; process_command &#x51FD;&#x6570;&#x5F53;&#x4E2D;&#xFF0C;&#x91CC;&#x9762;&#x542B;&#x6709;&#x5BF9;&#x4E0D;&#x540C;&#x547D;&#x4EE4;&#x7684;&#x5904;&#x7406;&#x51FD;&#x6570;&#xFF0C;&#x51FD;&#x6570;&#x540D;&#x4E00;&#x822C;&#x53EB; process_xxx_command &#x3002; </p>
<h4 id="&#x5173;&#x8054;&#x6570;&#x7EC4;">&#x5173;&#x8054;&#x6570;&#x7EC4;</h4><p>memache &#x4F7F;&#x7528; <a href="http://en.wikipedia.org/wiki/Associative_array" target="_blank" rel="external">Associative Array</a> &#x6765;&#x5B9E;&#x73B0;&#x7684;&#x7F13;&#x5B58;&#x529F;&#x80FD;&#x3002;&#x4E3B;&#x8981;&#x7684;&#x903B;&#x8F91;&#x5728; assoc.h &#x548C; assoc.c &#x4EE3;&#x7801;&#x6587;&#x4EF6;&#x4E2D;&#x3002;worker &#x7EBF;&#x7A0B;&#x63A5;&#x5230;&#x8BF7;&#x6C42;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x6839;&#x636E;&#x547D;&#x4EE4;&#x7C7B;&#x578B;&#xFF08; set , get etc&#xFF09;&#x5BF9;&#x5173;&#x8054;&#x6570;&#x7EC4;&#x505A;&#x4E0D;&#x540C;&#x7684;&#x64CD;&#x4F5C;&#x3002; </p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Memcached/">Memcached</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/03/23337b7/" title="Memcached 1.4.24 发布，集中式缓存系统 -" itemprop="url">Memcached 1.4.24 发布，集中式缓存系统 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-03T02:09:36.000Z" itemprop="datePublished"> 发表于 2015-07-03</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p><a href="http://www.oschina.net/news/61534/oschina-opensource-collection-plan-for-it-companies" target="_blank" rel="external">&#x5F00;&#x6E90;&#x4E2D;&#x56FD;&#x7684; IT &#x516C;&#x53F8;&#x5F00;&#x6E90;&#x8F6F;&#x4EF6;&#x6574;&#x7406;&#x8BA1;&#x5212;&#x4ECB;&#x7ECD;</a></p>
<p>Memcached 1.4.24 &#x53D1;&#x5E03;&#xFF0C;&#x6B64;&#x7248;&#x672C;&#x662F; Memcached 1.4.23 &#x7248;&#x672C;&#x7684; bug &#x4FEE;&#x590D;&#x7248;&#x672C;&#xFF0C;&#x73B0;&#x5DF2;&#x63D0;&#x4F9B;&#x4E0B;&#x8F7D;&#xFF1A; <a href="http://www.memcached.org/files/memcached-1.4.24.tar.gz" target="_blank" rel="external">http://www.memcached.org/files/memcached-1.4.24.tar.gz</a> &#x3002; </p>
<p>&#x66F4;&#x591A;&#x6539;&#x8FDB;&#x5185;&#x5BB9;&#x8BF7;&#x770B; <a href="https://code.google.com/p/memcached/wiki/ReleaseNotes1424" target="_blank" rel="external">&#x53D1;&#x884C;&#x8BF4;&#x660E;</a> &#x3002; </p>
<p>memcached&#x662F;&#x4E00;&#x5957;&#x5206;&#x5E03;&#x5F0F;&#x7684;&#x5FEB;&#x53D6;&#x7CFB;&#x7EDF;&#xFF0C;&#x5F53;&#x521D;&#x662F;Danga Interactive&#x4E3A;&#x4E86;LiveJournal&#x6240;&#x53D1;&#x5C55;&#x7684;&#xFF0C;&#x4F46;&#x76EE;&#x524D;&#x88AB;&#x8BB8;&#x591A;&#x8F6F;&#x4EF6;&#xFF08;&#x5982;MediaWiki&#xFF09;&#x6240;&#x4F7F;&#x7528;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x5957;&#x5F00;&#x653E;&#x6E90;&#x4EE3;&#x7801;&#x8F6F;&#x4EF6;&#xFF0C;&#x4EE5;BSD license&#x6388;&#x6743;&#x91CA;&#x51FA;&#x3002; </p>
<p>memcached&#x7F3A;&#x4E4F;&#x8BA4;&#x8BC1;&#x4EE5;&#x53CA;&#x5B89;&#x5168;&#x7BA1;&#x5236;&#xFF0C;&#x8FD9;&#x4EE3;&#x8868;&#x5E94;&#x8BE5;&#x5C06;memcached&#x670D;&#x52A1;&#x5668;&#x653E;&#x7F6E;&#x5728;&#x9632;&#x706B;&#x5899;&#x540E;&#x3002;</p>
<p>memcached &#x7684;API&#x4F7F;&#x7528;&#x4E09;&#x5341;&#x4E8C;&#x4F4D;&#x5143;&#x7684;&#x5FAA;&#x73AF;&#x5197;&#x4F59;&#x6821;&#x9A8C;&#xFF08;CRC-32&#xFF09;&#x8BA1;&#x7B97;&#x952E;&#x503C;&#x540E;&#xFF0C;&#x5C06;&#x8D44;&#x6599;&#x5206;&#x6563;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x673A;&#x5668;&#x4E0A;&#x3002;&#x5F53;&#x8868;&#x683C;&#x6EE1;&#x4E86;&#x4EE5;&#x540E;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x65B0;&#x589E;&#x7684;&#x8D44;&#x6599;&#x4F1A;&#x4EE5;LRU&#x673A;&#x5236;&#x66FF;&#x6362;&#x6389;&#x3002; &#x7531;&#x4E8E;memcached&#x901A;&#x5E38;&#x53EA;&#x662F;&#x5F53;&#x4F5C;&#x5FEB;&#x53D6;&#x7CFB;&#x7EDF;&#x4F7F;&#x7528;&#xFF0C;&#x6240;&#x4EE5;&#x4F7F;&#x7528;memcached&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5F0F;&#x5728;&#x5199;&#x56DE;&#x8F83;&#x6162;&#x7684;&#x7CFB;&#x7EDF;&#x65F6;&#xFF08;&#x50CF;&#x662F;&#x540E;&#x7AEF;&#x7684;&#x6570;&#x636E;&#x5E93;&#xFF09;&#x9700;&#x8981;&#x989D;&#x5916;&#x7684;&#x7A0B;&#x5F0F;&#x7801;&#x66F4;&#x65B0; memcached&#x5185;&#x7684;&#x8D44;&#x6599;&#x3002;</p>
<p>memcached&#x5177;&#x6709;&#x591A;&#x79CD;&#x8BED;&#x8A00;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x5F00;&#x53D1;&#x5305;&#xFF0C;&#x5305;&#x62EC;&#xFF1A;Perl/PHP/JAVA/C/Python/Ruby/C#/MySQL/</p>
<p>&#x5BA2;&#x6237;&#x7AEF;&#x5305;&#x7684;&#x4E0B;&#x8F7D;&#x5730;&#x5740;&#x662F;&#xFFFD;&#xFFFD;&#xFFFD; <a href="http://code.google.com/p/memcached/wiki/Clients" target="_blank" rel="external">http://code.google.com/p/memcached/wiki/Clients</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Memcached/">Memcached</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/03/232e244/" title="IT 工程师文化碎碎念 -" itemprop="url">IT 工程师文化碎碎念 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-03T02:09:36.000Z" itemprop="datePublished"> 发表于 2015-07-03</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>&#x5728;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x91CC;&#xFF0C;&#x9119;&#x4EBA;&#x5C06;&#x7ED9;&#x5927;&#x5BB6;&#x5206;&#x4EAB;&#x4E0B;&#x6211;&#x4E2A;&#x4EBA;&#x5BF9;&#x4E8E;IT&#x5DE5;&#x7A0B;&#x5E08;&#x4E8B;&#x52A1;&#x89C4;&#x5212;&#x4E0A;&#x7684;&#x4E00;&#x4E9B;&#x4F53;&#x609F;&#x611F;&#x53D7;&#xFF0C;&#x6B22;&#x8FCE;&#x62CD;&#x7816;&#x3002;</p>
<h4 id="&#x9879;&#x76EE;_+_&#x4EFB;&#x52A1;&#x9A71;&#x52A8;&#x5236;">&#x9879;&#x76EE; + &#x4EFB;&#x52A1;&#x9A71;&#x52A8;&#x5236;</h4><p>&#x4EE5;&#x8FD0;&#x7EF4;&#xFF08;&#x5F00;&#x53D1;&#xFF09;&#x4EBA;&#x5458;&#x7684;&#x89C6;&#x89D2;&#x6765;&#x770B;&#xFF0C;&#x6240;&#x6709;&#x5DE5;&#x4F5C;&#x4E0A;&#x7684;&#x4E8B;&#x52A1;&#x53EF;&#x4EE5;&#x5212;&#x5206;&#x4E3A;&#x4E24;&#x5927;&#x7C7B;&#xFF1A;Project &amp; Ticket.</p>
<p>&#x5177;&#x4F53;&#x6765;&#x8BF4;&#xFF0C;&#x9879;&#x76EE;&#x5C31;&#x662F;&#x4E00;&#x4E9B;&#x8BA1;&#x5212;&#x4E2D;&#x7684;&#x4EFB;&#x52A1;&#x96C6;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x662F;&#x7C7B;&#x4F3C;&#x722C;&#x866B;&#x5E94;&#x7528;&#x8FD9;&#x6837;&#x7684;&#x7814;&#x53D1;&#x9879;&#x76EE;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x50CF;Memcached&#x8FD0;&#x7EF4;&#x8FD9;&#x6837;&#x7684;&#x8FD0;&#x7EF4;&#x9879;&#x76EE;&#x3002;&#x4E00;&#x4E2A;&#x9879;&#x76EE;&#x610F;&#x5473;&#x7740;&#x5F88;&#x591A;&#x7684;&#x65E5;&#x5E38;&#x4E8B;&#x52A1;&#xFF0C;&#x4E5F;&#x662F;&#x65E5;&#x5E38;&#x5DE5;&#x4F5C;&#x4E2D;&#x6700;&#x82B1;&#x65F6;&#x95F4;&#x7684;&#x3002;</p>
<p>&#x5DE5;&#x5355;&#xFF08;&#x53EF;&#x4EE5;&#x662F;&#x903B;&#x8F91;&#x62BD;&#x8C61;&#x5C42;&#x9762;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x6BD4;&#x5982;&#x67D0;&#x7528;&#x6237;&#x7684;&#x4E00;&#x4E2A;&#x9700;&#x6C42;&#xFF09;&#x5219;&#x662F;&#x4E00;&#x4E9B;&#x6765;&#x81EA;&#x5404;&#x4E2A;&#x7528;&#x6237;&#x7684;&#x9700;&#x6C42;&#xFF0C;&#x6211;&#x4EEC;&#x65E0;&#x6CD5;&#x4FDD;&#x8BC1;&#x6211;&#x4EEC;&#x652F;&#x6301;&#x7684;&#x9879;&#x76EE;&#x96C6;&#x80FD;&#x591F;&#x6EE1;&#x8DB3;&#x6240;&#x6709;&#x7528;&#x6237;&#x7684;&#x9700;&#x6C42;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5C31;&#x9700;&#x8981;&#x63A5;&#x53D7;&#x4ED6;&#x4EEC;&#x7684;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x9700;&#x6C42;&#xFF0C;&#x5E76;&#x4E14;&#x76F8;&#x5E94;&#x7684;&#x8BC4;&#x4F30; &amp; &#x8DDF;&#x8FDB;&#x3002;</p>
<p>&#x9664;&#x6B64;&#x4E4B;&#x5916;&#xFF0C;&#x6211;&#x5B9E;&#x5728;&#x60F3;&#x4E0D;&#x5230;&#x66F4;&#x591A;&#x53EF;&#x4EE5;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#x4E86; :)</p>
<p>&#x6700;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5DE5;&#x4F5C;&#x4E0A;&#x7684;&#x4E8B;&#x60C5;&#x4E5F;&#x8BB8;&#x4F1A;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;</p>
<ul>
<li>&#x722C;&#x866B;&#x9879;&#x76EE;&#x5F00;&#x53D1;&#xFF1B;</li>
<li>&#x722C;&#x866B;&#x9879;&#x76EE;&#x8FD0;&#x7EF4;&#xFF1B;</li>
<li>Memcached &#x8C03;&#x4F18;&#xFF1B;</li>
<li>&#x8001;&#x5927;&#x8981;&#x6C42;&#x6536;&#x96C6;&#x6240;&#x6709;&#x673A;&#x5668;&#x7684;&#x67D0;&#x4E9B;&#x53C2;&#x6570;&#x6307;&#x6807;&#x6C47;&#x603B;&#x6210;&#x62A5;&#x8868;&#x7ED9;&#x4ED6;&#x770B;&#x4E00;&#x4E0B;&#x3002;</li>
</ul>
<p>&#x90A3;&#x4E48;&#xFF0C;Project + Ticket&#x80FD;&#x5426;&#x518D;&#x7EC6;&#x5316;&#x62BD;&#x8C61;&#x4E00;&#x4E0B;&#x5462;? &#x6211;&#x60F3;&#xFF0C;&#x5B83;&#x5F53;&#x7136;&#x662F;&#x53EF;&#x4EE5;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C06;&#x9879;&#x76EE;&#x548C;&#x5DE5;&#x5355;&#x7684;&#x6240;&#x8C13;&#x201C;&#x9700;&#x6C42;&#x201D;&#xFF0C;&#x6BD4;&#x5982;&#x67D0;&#x5E94;&#x7528;&#x9700;&#x8981;&#x5F00;&#x53D1;&#x67D0;&#x4E9B;&#x529F;&#x80FD;&#x3001;&#x8FD0;&#x7EF4;&#x624B;&#x4E0A;&#x4E00;&#x4E9B;&#x5E94;&#x7528;&#x7684;&#x6539;&#x9020;&#x8C03;&#x4F18;&#x4EE5;&#x53CA;&#x4E00;&#x4E9B;&#x7528;&#x6237;&#x7684;&#x7279;&#x6B8A;&#x9700;&#x6C42;&#xFF08;&#x5373;&#x4E2A;&#x6027;&#x5316;&#x7684;ticket&#xFF09;&#x7EDF;&#x4E00;&#x62BD;&#x8C61;&#x6210;&#x201C;&#x4EFB;&#x52A1;&#x201D;&#x3002;</p>
<p>&#x90A3;&#x4E48;&#xFF0C;&#x5F88;&#x660E;&#x4E86;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x4E8B;&#x60C5;&#x7684;&#x89C4;&#x5212;&#x6700;&#x540E;&#x53EF;&#x80FD;&#x4F1A;&#x53D8;&#x6210;&#x8FD9;&#x6837;&#xFF1A;</p>
<ul>
<li>&#xFF08;&#x722C;&#x866B;&#x9879;&#x76EE;&#x5F00;&#x53D1;&#xFF09;&#x4E3A;&#x67D0;&#x4E1A;&#x52A1;&#x7684;&#x8C03;&#x6574;&#xFF0C;&#x4FEE;&#x6539;&#x722C;&#x866B;&#x4EE3;&#x7801;&#x6293;&#x53D6;&#x903B;&#x8F91;&#xFF1B;</li>
<li>&#xFF08;&#x722C;&#x866B;&#x9879;&#x76EE;&#x8FD0;&#x7EF4;&#xFF09;&#x4E3A;&#x67D0;&#x4E9B;&#x722C;&#x866B;&#x5BA2;&#x6237;&#x7AEF;&#x673A;&#x5668;&#x5B89;&#x88C5;&#x6307;&#x5B9A;&#x7684;&#x5305;&#x5E76;&#x505A;&#x914D;&#x7F6E;&#xFF1B;</li>
<li>&#xFF08;Memcached&#x8FD0;&#x7EF4;&#xFF09;&#x4E3A;Memcached&#x673A;&#x5668;&#x8C03;&#x6574;Linux&#x5185;&#x6838;&#x53C2;&#x6570;&#x548C;swap&#x8BBE;&#x7F6E;&#xFF1B;</li>
<li>&#xFF08;&#x989D;&#x5916;ticket&#xFF09;&#x6536;&#x96C6;&#x673A;&#x5668;&#x53C2;&#x6570;&#x6307;&#x6807;&#xFF0C;&#x6C47;&#x603B;&#x62A5;&#x8868;&#xFF1B;</li>
</ul>
<p>&#x6240;&#x4EE5;&#xFF0C;&#x9996;&#x5148;&#xFF0C;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#x4E86;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x505A;&#x4E9B;&#x4EC0;&#x4E48;&#x4E8B;&#x60C5;&#x3002; Ps. &#x5370;&#x8C61;&#x7B14;&#x8BB0;&#x662F;&#x4E00;&#x4E2A;&#x4E0D;&#x9519;&#x7684;APP&#xFF0C;&#x4E5F;&#x8BB8;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7528;&#x5B83;&#x505A;&#x8F7D;&#x4F53; :)</p>
<h4 id="&#x603B;&#x7ED3;&#x548C;&#x56DE;&#x987E;">&#x603B;&#x7ED3;&#x548C;&#x56DE;&#x987E;</h4><p>&#x65E2;&#x7136;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x6E05;&#x695A;&#x7684;&#x77E5;&#x9053;&#x4E86;&#x81EA;&#x5DF1;&#x6240;&#x8981;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#xFF0C;&#x90A3;&#x4E48;&#x5F53;&#x7136;&#x5F97;&#x9700;&#x8981;&#x8FDB;&#x4E00;&#x6B65;&#xFF0C;&#x6211;&#x4EEC;&#x5F97;&#x505A;&#x56DE;&#x987E;&#x548C;&#x603B;&#x7ED3;&#xFF0C;&#x6BD4;&#x5982;&#x8BF4; Memcached &#x8FD0;&#x7EF4; &#x8FD9;&#x6574;&#x4E2A;&#x7684;&#x9879;&#x76EE;&#x96C6;&#x8017;&#x8D39;&#x4E86;&#x81EA;&#x8EAB;&#x5F88;&#x591A;&#x7CBE;&#x529B;&#xFF0C;&#x90A3;&#x4E48;&#x6216;&#x8BB8;&#x5E94;&#x8BE5;&#x95EE;&#x81EA;&#x5DF1;&#x51E0;&#x4E2A;&#x95EE;&#x9898;&#xFF1A; </p>
<ul>
<li>&#x662F;&#x5426;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#x90FD;&#x662F;&#x6709;&#x4EF7;&#x503C;&#x7684;&#x5462;?</li>
</ul>
<p>&#x5F53;&#x6211;&#x4EEC;&#x505A;&#x4E00;&#x4E9B;&#x603B;&#x7ED3;&#x548C;&#x56DE;&#x987E;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x9996;&#x5148;&#x5F97;&#x5224;&#x65AD;&#x505A;&#x8FD9;&#x4E9B;&#x4EFB;&#x52A1;&#x7684; &#x6536;&#x76CA; &#x662F;&#x5426;&#x8FBE;&#x5230;&#x9884;&#x671F;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x662F;&#x5426;&#x5728;&#x505A;&#x4E00;&#x4E9B;&#x672C;&#x4E0D;&#x9700;&#x8981;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#x5462;? &#x6BD4;&#x5982;&#x4E00;&#x4E9B;&#x5220;&#x9664;&#x6587;&#x4EF6;&#x7684;&#x52A8;&#x4F5C;&#xFF0C;&#x672C;&#x6765;&#x53EF;&#x4EE5;&#x4EA4;&#x7ED9;crontab&#x4E4B;&#x7C7B;&#x7684;&#x8BA1;&#x5212;&#x4EFB;&#x52A1;&#x6765;&#x505A;&#xFF0C;&#x81EA;&#x5DF1;&#x53BB;&#x624B;&#x5DE5;&#x505A;&#x8FD9;&#x4E2A;&#x4E8B;&#x60C5;&#x4FBF;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x4EF7;&#x503C;&#xFF0C;&#x53C8;&#x6BD4;&#x5982;&#x5236;&#x9020;&#x51FA;&#x4E00;&#x4E9B;&#x6CA1;&#x6709;&#x4EBA;&#x6D88;&#x8D39;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;&#x6CA1;&#x6709;&#x4EF7;&#x503C;&#x7684;&#x3002; </p>
<p>&#x5728;&#x6211;&#x770B;&#x6765;&#xFF0C;&#x8BC4;&#x5224;&#x4E00;&#x4EF6;&#x4E8B;&#x60C5;&#x662F;&#x5426;&#x505A;&#x7684;&#x6709;&#x4EF7;&#x503C;&#xFF0C;&#x9996;&#x5148;&#x4E00;&#x70B9;&#xFF0C;&#x5982;&#x679C;&#x8DDF;&#x8001;&#x5927;&#x6C47;&#x62A5;&#x8BF4;&#xFF0C;&#x6211;&#x6B63;&#x5728;&#x505A;&#x8FD9;&#x4E2A;&#x4E8B;&#x60C5;&#xFF0C;&#x8001;&#x5927;&#x4F1A;&#x4E0D;&#x4F1A;&#x8BA4;&#x53EF;? &#x5176;&#x6B21;&#xFF0C;&#x8FD9;&#x4E2A;&#x4E8B;&#x60C5;&#x505A;&#x5B8C;&#x4E86;&#xFF0C;&#x662F;&#x5426;&#x4F1A;&#x4EA7;&#x751F;&#x4E00;&#x4E9B;&#x79EF;&#x6781;&#x7684;&#x53D8;&#x5316;? &#x6700;&#x540E;&#xFF0C;&#x82B1;&#x8D39;&#x5728;&#x8FD9;&#x4E2A;&#x4EFB;&#x52A1;&#x4E0A;&#x7684;&#x65F6;&#x95F4;&#x4E0E;&#x5B9E;&#x9645;&#x7684;&#x6536;&#x76CA;&#x662F;&#x5426;&#x6210;&#x6BD4;&#x4F8B;?</p>
<p>&#x5728;&#x7406;&#x6E05;&#x8FD9;&#x4E9B;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5B8C;&#x6210; &#x4EFB;&#x52A1; &#x7684;&#x6548;&#x7387;&#x53CA;&#x83B7;&#x53D6;&#x7684;&#x6536;&#x76CA;&#x4E5F;&#x8BB8;&#x4F1A;&#x66F4;&#x9AD8;&#x3002; </p>
<ul>
<li>&#x662F;&#x5426;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#x5B58;&#x5728; &gt; 10&#x6B21;&#x7684;&#x91CD;&#x590D;&#x5462;?</li>
</ul>
<p>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#xFF0C;&#x88AB;&#x91CD;&#x590D;&#x7684;&#x64CD;&#x4F5C;&#x8D85;&#x8FC7;10&#x6B21;&#x4EE5;&#x4E0A;&#x800C;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x6539;&#x8FDB;&#xFF0C;&#x90A3;&#x4E48;&#x4F60;&#x5F97;&#x8B66;&#x9192;&#x4E86;&#xFF0C;&#x662F;&#x5426;&#x8FD9;&#x4E2A;&#x4EFB;&#x52A1;&#x8FD8;&#x503C;&#x5F97;&#x7EE7;&#x7EED;&#x8FD9;&#x6837;&#x7684;&#x91CD;&#x590D;&#x52B3;&#x52A8;&#x5462;?</p>
<p>IT &#x754C;&#x8FD1;&#x51E0;&#x5E74;&#x63D0;&#x51FA;&#x7684;xx&#x81EA;&#x52A8;&#x5316;&#x6B63;&#x662F;&#x6E90;&#x4E8E;&#x5BF9;&#x91CD;&#x590D;&#x52B3;&#x52A8;&#x7684;&#x6DF1;&#x5165;&#x6539;&#x9020;&#x3002;&#x65E0;&#x8BBA;&#x662F;&#x534A;&#x81EA;&#x52A8;&#x5316;&#xFF0C;&#x8FD8;&#x662F;&#x5168;&#x81EA;&#x52A8;&#x5316;&#xFF0C;&#x81EA;&#x52A8;&#x5316;&#x7684;&#x9700;&#x6C42;&#x9A71;&#x52A8;&#x4FBF;&#x662F;&#x201C;&#x5B83;&#x5B9E;&#x5728;&#x88AB;&#x91CD;&#x590D;&#x592A;&#x591A;&#x6B21;&#x6570;&#x4E86;&#x201D;&#xFF0C;&#x53E6;&#x5916;&#xFF0C;&#x81EA;&#x52A8;&#x5316;&#x9700;&#x8981;&#x4E00;&#x4E9B;&#x524D;&#x63D0;&#xFF0C;&#x672C;&#x4EBA;&#x603B;&#x7ED3;&#x4E3A;&#xFF1A; &#x6807;&#x51C6;&#x5316; &amp; &#x6D41;&#x7A0B;&#x5316; &#x3002; </p>
<p>&#x4EE5;&#x722C;&#x866B;&#x81EA;&#x52A8;&#x6293;&#x53D6;&#x7F51;&#x9875;&#x6570;&#x636E;&#x4E3A;&#x4F8B;&#xFF0C;&#x5982;&#x679C;HTML&#x7684;&#x4EE3;&#x7801;&#x7ED3;&#x6784;&#x4E0D;&#x662F;&#x89C4;&#x6574;&#x7684;XML&#x683C;&#x5F0F;&#xFF0C;&#x5982;&#x679C;&#x6293;&#x53D6;&#x7684;&#x76EE;&#x6807;&#x6E90;&#x4E0D;&#x80FD;&#x901A;&#x8FC7;&#x6B63;&#x5219;&#x5339;&#x914D;&#x7684;&#x65B9;&#x5F0F;&#x5F88;&#x597D;&#x7684;&#x6293;&#x53D6;&#x51FA;&#x5B9E;&#x9645;&#x6570;&#x636E;&#xFF0C;&#x90A3;&#x4E48;&#x722C;&#x866B;&#x7684;&#x81EA;&#x52A8;&#x5316;&#x6293;&#x53D6;&#x4FBF;&#x6C38;&#x8FDC;&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x68A6;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x6240;&#x8C13;&#x7684; &#x6807;&#x51C6;&#x5316; &#xFF0C;&#x4F60;&#x9996;&#x5148;&#x5F97;&#x4FDD;&#x8BC1;&#x8FD9;&#x4E2A;&#x4EFB;&#x52A1;&#x662F;&#x975E;&#x5E38;&#x6807;&#x51C6;&#x7684;&#x5E76;&#x4E14;&#x80FD;&#x5F88;&#x597D;&#x88AB;&#x62C6;&#x89E3;&#x7684;&#x3002; </p>
<p>&#x800C; &#x6D41;&#x7A0B;&#x5316; &#x5219;&#x662F;&#x6307;&#x8FD9;&#x4E2A;&#x91CD;&#x590D;&#x5B8C;&#x6210;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x672C;&#x8EAB;&#x662F;&#x53EF;&#x4EE5;&#x6309;&#x7167;&#x56FA;&#x5B9A;&#x7684;&#x6D41;&#x7A0B;&#x6216;&#x8005;&#x5DE5;&#x5E8F;&#x53BB;&#x5B8C;&#x6210;&#x7684;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5B83;&#x7684;&#x89E3;&#x9898;&#x903B;&#x8F91;&#x662F;&#x975E;&#x5E38;&#x56FA;&#x5B9A;&#x7684;&#xFF0C;&#x5018;&#x82E5;&#x65E0;&#x6CD5;&#x8FBE;&#x6210;&#x8FD9;&#x4E00;&#x70B9;&#xFF0C;&#x81EA;&#x52A8;&#x5316;&#x4E5F;&#x662F;&#x5F88;&#x96BE;&#x63A8;&#x52A8;&#x7684;&#x3002; </p>
<p>&#x5176;&#x5B9E;&#x5982;&#x679C;&#x80FD;&#x591F;&#x505A;&#x5230; &#x534A;&#x81EA;&#x52A8;&#x5316; &#xFF0C;&#x76F8;&#x4FE1;&#x4E5F;&#x662F;&#x6709;&#x5DE8;&#x5927;&#x4EF7;&#x503C;&#x7684;&#xFF0C;&#x6BD4;&#x5982;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4E0D;&#x518D;&#x5173;&#x5FC3;&#x5177;&#x4F53;&#x7684;&#x6280;&#x672F;&#x7EC6;&#x8282;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x6309;&#x7167;&#x9700;&#x6C42;&#xFF0C;&#x5728;Web&#x4E0A;&#x70B9;&#x51E0;&#x4E2A;&#x6309;&#x94AE;&#x5373;&#x53EF;&#x5B8C;&#x6210;&#xFF0C;&#x518D;&#x6BD4;&#x5982;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5F00;&#x653E;Web&#x5DE5;&#x5177;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x76F4;&#x63A5;&#x66B4;&#x9732;&#x7ED9;&#x6700;&#x7EC8;&#x7684;&#x9700;&#x6C42;&#x7528;&#x6237;&#xFF0C;&#x8BA9;&#x4ED6;&#x4EEC; &#x81EA;&#x52A9;&#x670D;&#x52A1; &#xFF0C;&#x4ECE;&#x800C;&#x5B9E;&#x73B0;&#x89E3;&#x653E;&#x53CC;&#x624B;&#x7684;&#x76EE;&#x7684;&#x3002; </p>
<h4 id="&#x79EF;&#x6781;&#x4E86;&#x89E3;&#x884C;&#x4E1A;&#x53D8;&#x5316;">&#x79EF;&#x6781;&#x4E86;&#x89E3;&#x884C;&#x4E1A;&#x53D8;&#x5316;</h4><p>IT &#x884C;&#x4E1A;&#x65E5;&#x65B0;&#x6708;&#x5F02;&#xFF0C;&#x6BCF;&#x5206;&#x6BCF;&#x79D2;&#x90FD;&#x5728;&#x53D1;&#x751F;&#x5DE8;&#x5927;&#x7684;&#x53D8;&#x5316;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x4E0D;&#x5173;&#x6CE8;&#x5230;&#x8FD9;&#x4E9B;&#xFF0C;&#x90A3;&#x53EF;&#x80FD;&#x4F1A;&#x91CD;&#x590D;&#x9020;&#x4E00;&#x4E9B;&#x8F6E;&#x5B50;&#xFF0C;&#x4E25;&#x91CD;&#x7684;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x88AB;&#x65F6;&#x4EE3;&#x6240;&#x629B;&#x5F03;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#x8BF4;&#xFF0C;&#x5F53;&#x5F00;&#x6E90;&#x754C;&#x5DF2;&#x7ECF;&#x8BDE;&#x751F;&#x4E86;Linux&#x7CFB;&#x7EDF;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x4EEC;&#x518D;&#x9020;&#x4E00;&#x4E2A;OS&#x4FBF;&#x662F;&#x611A;&#x8822;&#x4E4B;&#x4E3E;&#x4E86;&#x3002;&#x53C8;&#x6216;&#x8005;&#xFF0C;&#x5F53;&#x4E1A;&#x754C;&#x51FA;&#x73B0;&#x79CD;&#x7C7B;&#x7E41;&#x591A;&#x7684;&#x5F00;&#x53D1;&#x8BED;&#x8A00;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x8FD8;&#x56FA;&#x6267;&#x7684;&#x4F7F;&#x7528;&#x7740;&#x5355;&#x4E00;&#x8BED;&#x8A00;&#x505A;&#x5F00;&#x53D1;&#x4FBF;&#x53C8;&#x662F;&#x663E;&#x5F97;&#x8FC7;&#x65F6;&#x4E86;&#x3002;</p>
<p>&#x65F6;&#x65F6;&#x523B;&#x523B;&#x7684;&#x5173;&#x6CE8;&#x81EA;&#x8EAB;&#x6240;&#x5728;&#x7684;&#x884C;&#x4E1A;&#x7684;&#x53D8;&#x9769;&#xFF0C;&#x5173;&#x6CE8;Github&#x3001;InfoQ&#x3001;51CTO&#x7B49;&#x4E00;&#x4E9B;&#x6280;&#x672F;&#x7AD9;&#x70B9;&#x7684;&#x8D44;&#x8BAF;&#x4EE5;&#x53CA;&#x65B0;&#x5174;&#x6280;&#x672F;&#xFF0C;&#x65E0;&#x7591;&#x4F1A;&#x7ED9;&#x81EA;&#x5DF1;&#x7684;&#x5DE5;&#x4F5C;&#x6709;&#x5F88;&#x5927;&#x7684;&#x52A9;&#x529B;&#x3002;&#x503C;&#x5F97;&#x4E00;&#x63D0;&#x7684;&#x662F;&#xFF0C;&#x5F53;&#x4F60;&#x4ECE;&#x4E8B;&#x67D0;&#x9879;&#x804C;&#x4E1A;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x878D;&#x5165;&#x5230;&#x8FD9;&#x4E2A;&#x804C;&#x4E1A;&#x7684;&#x5708;&#x5B50;&#x4E5F;&#x662F;&#x4E2A;&#x4E0D;&#x9519;&#x7684;&#x60F3;&#x6CD5;&#xFF0C;&#x6BD4;&#x5982;&#x8FD0;&#x7EF4;&#x559C;&#x6B22;&#x52A0;&#x4E00;&#x4E9B;QQ&#x7FA4;&#xFF0C;&#x559C;&#x6B22;&#x53C2;&#x4E0E;&#x4E00;&#x4E9B;&#x6280;&#x672F;&#x5206;&#x4EAB;&#xFF0C;&#x559C;&#x6B22;&#x53C2;&#x52A0;QCon&#x4EE5;&#x53CA;&#x901B; <a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=2&amp;cad=rja&amp;uact=8&amp;ved=0CCcQFjAB&amp;url=http%3A%2F%2Fbbs.linuxtone.org%2F&amp;ei=xXomVfuGBomqoQTZk4KIDw&amp;usg=AFQjCNEqhLo9k3D7DeA3MQYOIr_bLjBZIQ&amp;sig2=xO1PyvM3VUv6-HiEkqpdVg" target="_blank" rel="external">Linux Tone</a> &#xFF0C;&#x591A;&#x548C;&#x4E1A;&#x754C;&#x7684;&#x540C;&#x50DA;&#x6C9F;&#x901A;&#x4EA4;&#x6D41;&#xFF0C;&#x53EF;&#x4EE5;&#x7ED9;&#x81EA;&#x5DF1;&#x66F4;&#x591A;&#x7684;&#x7075;&#x611F;&#x548C;&#x673A;&#x4F1A;&#xFF08;&#x6BD4;&#x5982;&#x8DF3;&#x69FD;~&#xFF09;&#xFF01; </p>
<p>&#x5C31;&#x662F;&#x8FD9;&#x4E9B;&#x4E86;&#xFF0C;&#x4EE5;&#x4E0A;&#x4EC5;&#x4EC5;&#x662F;&#x9119;&#x4EBA;&#x7684;&#x4E00;&#x4E9B;&#x4E2A;&#x4EBA;&#x611F;&#x53D7;&#xFF0C;&#x4E0D;&#x559C;&#x52FF;&#x55B7;~</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Memcached/">Memcached</a><a href="/tags/操作系统/">操作系统</a><a href="/tags/运维技术/">运维技术</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/4/"><span></span>Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/48/">48</a><a class="extend next" rel="next" href="/page/6/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/transcribe/" title="transcribe">transcribe<sup>472</sup></a></li>
		  
		
		  
			<li><a href="/categories/日志/" title="日志">日志<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/ZooKeeper/" title="ZooKeeper">ZooKeeper<sup>73</sup></a></li>
			
		
			
				<li><a href="/tags/JVM/" title="JVM">JVM<sup>65</sup></a></li>
			
		
			
				<li><a href="/tags/Memcached/" title="Memcached">Memcached<sup>61</sup></a></li>
			
		
			
				<li><a href="/tags/Node-js/" title="Node.js">Node.js<sup>52</sup></a></li>
			
		
			
				<li><a href="/tags/Spring-MVC/" title="Spring MVC">Spring MVC<sup>30</sup></a></li>
			
		
			
				<li><a href="/tags/Nosql/" title="Nosql">Nosql<sup>25</sup></a></li>
			
		
			
				<li><a href="/tags/C/" title="C++">C++<sup>24</sup></a></li>
			
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>22</sup></a></li>
			
		
			
				<li><a href="/tags/数据库/" title="数据库">数据库<sup>22</sup></a></li>
			
		
			
				<li><a href="/tags/Gulp/" title="Gulp">Gulp<sup>21</sup></a></li>
			
		
			
				<li><a href="/tags/开源/" title="开源">开源<sup>15</sup></a></li>
			
		
			
				<li><a href="/tags/Dubbo/" title="Dubbo">Dubbo<sup>13</sup></a></li>
			
		
			
				<li><a href="/tags/Java/" title="Java">Java<sup>13</sup></a></li>
			
		
			
				<li><a href="/tags/源码分析/" title="源码分析">源码分析<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/Net/" title=".Net">.Net<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/Mac-OS-X/" title="Mac OS X">Mac OS X<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/io-js/" title="io.js">io.js<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/程序员/" title="程序员">程序员<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/Ubuntu/" title="Ubuntu">Ubuntu<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/Kafka/" title="Kafka">Kafka<sup>7</sup></a></li>
			
		
		</ul>
</div>


<div class="weiboshow">
	<p class="asidetitle">新浪微博</p>
	<iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=1289635200&verifier=e6bef170&dpc=1"></iframe>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Larry Page in Google. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/512316815" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/sblig" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/sblig" target="_blank" title="fblog">fblog</a> © 2015
		
		<a href="/about" target="_blank" title="edwin">edwin</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
