
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="baidu-site-verification" content="1XvvwQ7Apt" />
  
    <title>dianzi blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="edwin">
    

    
    <meta name="description" content="edwin jin dianzi blog">
<meta property="og:type" content="website">
<meta property="og:title" content="dianzi blog">
<meta property="og:url" content="http://taojinke.github.io/page/43/index.html">
<meta property="og:site_name" content="dianzi blog">
<meta property="og:description" content="edwin jin dianzi blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="dianzi blog">
<meta name="twitter:description" content="edwin jin dianzi blog">

    
    <link rel="alternative" href="/atom.xml" title="dianzi blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">

  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?345f95aea4ada2935d6f9ea4177b51ab";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>

</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="dianzi blog" title="dianzi blog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="dianzi blog">dianzi blog</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
						<a href="/music/index.html" target="_blank">Music</a>
					</li>
					<li>
 					
						<form class="search" action="http://taojinke.github.io/" target="_blank">
							<label>Search</label>
						<input name="s" type="hidden" value= null ><input type="text" name="q" size="30" placeholder="搜索"><br>
						</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/02/f48ee67/" title="JAVA深入研究——Method的Invoke方法。 -" itemprop="url">JAVA深入研究——Method的Invoke方法。 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-01T23:50:30.000Z" itemprop="datePublished"> 发表于 2015-07-02</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>Method&#x7684;invoke&#x65B9;&#x6CD5;</p>
<p>1.&#x5148;&#x68C0;&#x67E5;&#xA0;AccessibleObject&#x7684;override&#x5C5E;&#x6027;&#x662F;&#x5426;&#x4E3A;true&#x3002;</p>
<p>AccessibleObject&#x662F;Method,Field,Constructor&#x7684;&#x7236;&#x7C7B;&#xFF0C;override&#x5C5E;&#x6027;&#x9ED8;&#x8BA4;&#x4E3A;false,&#x53EF;&#x8C03;&#x7528;setAccessible&#x65B9;&#x6CD5;&#x6539;&#x53D8;&#xFF0C;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E3A;true,&#x5219;&#xFFFD;&#xFFFD;&#xFFFD;&#x793A;&#x53EF;&#x4EE5;&#x5FFD;&#x7565;&#x8BBF;&#x95EE;&#x6743;&#x9650;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x3002;</p>
<p>2.&#x5982;&#x679C;&#x4E0D;&#x662F;ture,&#x5219;&#x8981;&#x8FDB;&#x884C;&#x8BBF;&#x95EE;&#x6743;&#x9650;&#x68C0;&#x6D4B;&#x3002;&#x7528;Reflection&#x7684;quickCheckMemberAccess&#x65B9;&#x6CD5;&#x5148;&#x68C0;&#x67E5;&#x662F;&#x4E0D;&#x662F;public&#x7684;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x662F;&#x518D;&#x7528;Reflection.getCallerClass(1)&#x65B9;&#x6CD5;&#x83B7;</p>
<p>&#x5F97;&#x5230;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;Class,&#x7136;&#x540E;&#x505A;&#x662F;&#x5426;&#x6709;&#x6743;&#x9650;&#x8BBF;&#x95EE;&#x7684;&#x6821;&#x9A8C;&#xFF0C;&#x6821;&#x9A8C;&#x4E4B;&#x540E;&#x7F13;&#x5B58;&#x4E00;&#x6B21;&#xFF0C;&#x4EE5;&#x4FBF;&#x4E0B;&#x6B21;&#x5982;&#x679C;&#x8FD8;&#x662F;&#x8FD9;&#x4E2A;&#x7C7B;&#x6765;&#x8C03;&#x7528;&#x5C31;&#x4E0D;&#x7528;&#x53BB;&#x505A;&#x6821;&#x9A8C;&#x4E86;&#xFF0C;&#x76F4;&#x63A5;&#x7528;&#x4E0A;&#x6B21;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#xFF08;&#x5F88;&#x5947;&#x602A;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x7F13;&#x5B58;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5982;&#x679C;&#x4E0B;&#x6B21;&#x6362;&#x4E2A;&#x7C7B;&#x6765;&#x8C03;&#x7528;&#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x4E0D;&#x7528;&#x4F1A;&#x7F13;&#x5B58;&#x4E86;&#xFF0C;&#x800C;&#x518D;&#x9A8C;&#x8BC1;&#x4E00;&#x904D;&#xFF0C;&#x628A;&#x8FD9;&#x6B21;&#x7684;&#x7ED3;&#x679C;&#x505A;&#x4E3A;&#x7F13;&#x5B58;&#xFF0C;&#x4F46;&#x4E0A;&#x4E00;&#x6B21;&#x7684;&#x7F13;&#x5B58;&#x7ED3;&#x679C;&#x5C31;&#x88AB;&#x51B2;&#x6389;&#x4E86;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x7B80;&#x5355;&#x7684;&#x7F13;&#x51B2;&#x673A;&#x5236;&#xFF0C;&#x53EA;&#x9002;&#x7528;&#x4E8E;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x91CD;&#x590D;&#x8C03;&#x7528;)&#x3002;</p>
<p>3.&#x8C03;&#x7528;MethodAccessor&#x7684;invoke&#x65B9;&#x6CD5;&#x3002;&#x6BCF;&#x4E2A;Method&#x5BF9;&#x8C61;&#x5305;&#x542B;&#x4E00;&#x4E2A;root&#x5BF9;&#x8C61;&#xFF0C;root&#x5BF9;&#x8C61;&#x91CC;&#x6301;&#x6709;&#x4E00;&#x4E2A;MethodAccessor&#x5BF9;&#x8C61;&#x3002;&#x6211;&#x4EEC;&#x83B7;&#x5F97;&#x7684;Method&#x72EC;&#x4EAB;&#x76F8;&#x5F53;&#x4E8E;&#x4E00;&#x4E2A;root&#x5BF9;&#x8C61;&#x7684;&#x955C;&#x50CF;&#xFF0C;&#x6240;&#x6709;&#x8FD9;&#x7C7B;Method&#x5171;&#x4EAB;root&#x91CC;&#x7684;MethodAccessor&#x5BF9;&#x8C61;,(&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x7531;ReflectionFactory&#x65B9;&#x6CD5;&#x751F;&#x6210;,ReflectionFactory&#x5BF9;&#x8C61;&#x5728;Method&#x7C7B;&#x4E2D;&#x662F;static&#xA0;final&#x7684;&#x7531;native&#x65B9;&#x6CD5;&#x5B9E;&#x4F8B;&#x5316;)&#x3002;</p>
<p>ReflectionFactory&#x751F;&#x6210;MethodAccessor&#xFF1A;&#x5982;&#x679C;noInflation&#x7684;&#x5C5E;&#x6027;&#x4E3A;true&#x5219;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;MethodAccessorGenerator&#x521B;&#x5EFA;&#x7684;&#x4E00;&#x4E2A;MethodAccessor&#x3002;</p>
<p>&#x5426;&#x5219;&#x8FD4;&#x56DE;DelegatingMethodAccessorImpl&#xFF0C;&#x5E76;&#x5C06;&#x4ED6;&#x4E0E;&#x4E00;&#x4E2A;NativeMethodAccessorImpl&#x4E92;&#x76F8;&#x5F15;&#x7528;&#x3002;&#x4F46;DelegatingMethodAccessorImpl&#x6267;&#x884C;invoke&#x65B9;&#x6CD5;&#x7684;&#x65F6;&#x5019;&#x53C8;&#x59D4;&#x6258;&#x7ED9;NativeMethodAccessorImpl&#x4E86;&#x3002;</p>
<p>&#x518D;&#x4E00;&#x6B65;&#x6DF1;&#x5165;</p>
<p>4.NativeMethodAccessorImpl&#x7684;invkoe&#x65B9;&#x6CD5;:</p>
<p>&#x8C03;&#x7528;natiave&#x65B9;&#x6CD5;invoke0&#x6267;&#x884C;&#x65B9;&#x6CD5;&#x8C03;&#x7528;.</p>
<p>&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x6709;&#x4E00;&#x4E2A;&#x8BA1;&#x6570;&#x5668;numInvocations&#xFF0C;&#x6BCF;&#x8C03;&#x7528;&#x4E00;&#x6B21;&#x65B9;&#x6CD5;+1,&#x5F53;&#x6BD4;&#xA0;ReflectionFactory.inflationThreshold(15)&#x5927;&#x7684;&#x65F6;&#x5019;,&#x7528;MethodAccessorGenerator&#x521B;&#x5EFA;&#x4E00;&#x4E2A;MethodAccessor,&#x5E76;&#x628A;&#x4E4B;&#x524D;&#x7684;DelegatingMethodAccessorImpl&#x5F15;&#x7528;&#x66FF;&#x6362;&#x4E3A;&#x73B0;&#x5728;&#x65B0;&#x521B;&#x5EFA;&#x7684;&#x3002;&#x4E0B;&#x4E00;&#x6B21;DelegatingMethodAccessorImpl&#x5C31;&#x4E0D;&#x4F1A;&#x518D;&#x4EA4;&#x7ED9;NativeMethodAccessorImpl&#x6267;&#x884C;&#x4E86;&#xFF0C;&#x800C;&#x662F;&#x4EA4;&#x7ED9;&#x65B0;&#x751F;&#x6210;&#x7684;java&#x5B57;&#x8282;&#x7801;&#x7684;MethodAccessor&#x3002;</p>
<p>MethodAccessorGenerator&#x4F7F;&#x7528;&#x4E86;asm&#x5B57;&#x8282;&#x7801;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x6280;&#x672F;&#xFF0C;&#x6682;&#x4E0D;&#x6DF1;&#x5165;&#x7814;&#x7A76;&#x3002;</p>
<p>&#x603B;&#x7ED3;&#xA0;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x751F;&#x6210;&#x591A;&#x4E2A;Method&#x5BF9;&#x8C61;&#xFF0C;&#x4F46;&#x53EA;&#x6709;&#x4E00;&#x4E2A;root&#x5BF9;&#x8C61;&#xFF0C;&#x4E3B;&#x8981;&#x7528;&#x4E8E;&#x6301;&#x6709;&#x4E00;&#x4E2A;MethodAccessor&#x5BF9;&#x8C61;&#xFF0C;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x4E5F;&#x53EF;&#x4EE5;&#x8BA4;&#x4E3A;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x662F;static&#x7684;&#x3002;&#x56E0;&#x4E3A;Method&#x7684;invoke&#x662F;&#x4EA4;&#x7ED9;MethodAccessor&#x6267;&#x884C;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x6240;&#x60F3;&#x8981;&#x77E5;&#x9053;&#x7684;&#x7B54;&#x6848;&#x5728;MethodAccessor&#x7684;invoke&#x4E2D;&#xFF0C;&#x6DF1;&#x5165;MethodAccessor&#xFF1A;</p>
<p>—————————————————————MethodAccessor————————————————-</p>
<p>&#x5047;&#x5982;&#x6709;&#x8FD9;&#x4E48;&#x4E00;&#x4E2A;&#x7C7B;A&#xFF1A;&#xA0;</p>
<p>public class A {</p>
<p>public void foo(String name) {</p>
<p>System.out.println(&quot;Hello, &quot; + name);</p>
<p>}</p>
<p>}</p>
<p>&#x53EF;&#x4EE5;&#x7F16;&#x5199;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x7C7B;&#x6765;&#x53CD;&#x5C04;&#x8C03;&#x7528;A&#x4E0A;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;</p>
<p>import java.lang.reflect.Method;</p>
<p>public class TestClassLoad {</p>
<p>public static void main(String[] args) throws Exception {</p>
<p>Class&lt;?&gt; clz = Class.forName(&quot;A&quot;);</p>
<p>Object o = clz.newInstance();</p>
<p>Method m = clz.getMethod(&quot;foo&quot;, String.class);</p>
<p>for (int i = 0; i &lt; 16; i++) {</p>
<p>m.invoke(o, Integer.toString(i));</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>&#x6CE8;&#x610F;&#x5230;TestClassLoad&#x7C7B;&#x4E0A;&#x4E0D;&#x4F1A;&#x6709;&#x5BF9;&#x7C7B;A&#x7684;&#x7B26;&#x53F7;&#x4F9D;&#x8D56;&#x2014;&#x2014;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5728;&#x52A0;&#x8F7D;&#x5E76;&#x521D;&#x59CB;&#x5316;TestClassLoad&#x7C7B;&#x65F6;&#x4E0D;&#x9700;&#x8981;&#x5173;&#x5FC3;&#x7C7B;A&#x7684;&#x5B58;&#x5728;&#x4E0E;&#x5426;&#xFF0C;&#x800C;&#x662F;&#x7B49;&#x5230;main()&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x5230;&#x8C03;&#x7528;Class.forName()&#x65F6;&#x624D;&#x8BD5;&#x56FE;&#x5BF9;&#x7C7B;A&#x505A;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#xFF1B;&#x8FD9;&#x91CC;&#x7528;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x7248;&#x7684;forName()&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x4F7F;&#x7528;&#x5F53;&#x524D;&#x65B9;&#x6CD5;&#x6240;&#x5728;&#x7C7B;&#x7684;ClassLoader&#x6765;&#x52A0;&#x8F7D;&#xFF0C;&#x5E76;&#x4E14;&#x521D;&#x59CB;&#x5316;&#x65B0;&#x52A0;&#x8F7D;&#x7684;&#x7C7B;&#x3002;&#x2026;&#x2026;&#x597D;&#x5427;&#x8FD9;&#x4E2A;&#x7EC6;&#x8282;&#x8DDF;&#x4E3B;&#x9898;&#x6CA1;&#x5565;&#x5173;&#x7CFB;&#x3002;&#xA0;</p>
<p>&#x56DE;&#x5230;&#x4E3B;&#x9898;&#x3002;&#x8FD9;&#x6B21;&#x6211;&#x7684;&#x6D4B;&#x8BD5;&#x73AF;&#x5883;&#x662F;Sun&#x7684;JDK 1.6.0 update 13 build 03&#x3002;&#x7F16;&#x8BD1;&#x4E0A;&#x8FF0;&#x4EE3;&#x7801;&#xFF0C;&#x5E76;&#x5728;&#x6267;&#x884C;TestClassLoad&#x65F6;&#x52A0;&#x5165;-XX:+TraceClassLoading&#x53C2;&#x6570;&#xFF08;&#x6216;&#x8005;-verbose:class&#x6216;&#x8005;&#x76F4;&#x63A5;-verbose&#x90FD;&#x884C;&#xFF09;&#xFF0C;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>&#x63A7;&#x5236;&#x53F0;&#x547D;&#x4EE4;</p>
<p>java&#xA0;-XX:+TraTestClassLoad &#xA0;ceClassLoading&#xA0;</p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8F93;&#x51FA;&#x4E86;&#x4E00;&#x5927;&#x5806;log&#xFF0C;&#x628A;&#x5176;&#x4E2D;&#x76F8;&#x5173;&#x7684;&#x90E8;&#x5206;&#x622A;&#x53D6;&#x51FA;&#x6765;&#x5982;&#x4E0B;&#xFF1A;</p>
<p> <img src="http://taojinke.github.io/img/20150702/f489412.gif" alt=""></p>
<pre><code>[Loaded TestClassLoad from file:/D:/temp_code/test_java_classload/]
[Loaded A from file:/D:/temp_code/test_java_classload/]
[Loaded sun<span class="class">.reflect</span><span class="class">.NativeMethodAccessorImpl</span> from shared objects file]
[Loaded sun<span class="class">.reflect</span><span class="class">.DelegatingMethodAccessorImpl</span> from shared objects file]
Hello, <span class="number">0</span>
Hello, <span class="number">1</span>
Hello, <span class="number">2</span>
Hello, <span class="number">3</span>
Hello, <span class="number">4</span>
Hello, <span class="number">5</span>
Hello, <span class="number">6</span>
Hello, <span class="number">7</span>
Hello, <span class="number">8</span>
Hello, <span class="number">9</span>
Hello, <span class="number">10</span>
Hello, <span class="number">11</span>
Hello, <span class="number">12</span>
Hello, <span class="number">13</span>
Hello, <span class="number">14</span>
[Loaded sun<span class="class">.reflect</span><span class="class">.ClassFileConstants</span> from shared objects file]
[Loaded sun<span class="class">.reflect</span><span class="class">.AccessorGenerator</span> from shared objects file]
[Loaded sun<span class="class">.reflect</span><span class="class">.MethodAccessorGenerator</span> from shared objects file]
[Loaded sun<span class="class">.reflect</span><span class="class">.ByteVectorFactory</span> from shared objects file]
[Loaded sun<span class="class">.reflect</span><span class="class">.ByteVector</span> from shared objects file]
[Loaded sun<span class="class">.reflect</span><span class="class">.ByteVectorImpl</span> from shared objects file]
[Loaded sun<span class="class">.reflect</span><span class="class">.ClassFileAssembler</span> from shared objects file]
[Loaded sun<span class="class">.reflect</span><span class="class">.UTF8</span> from shared objects file]
[Loaded java<span class="class">.lang</span><span class="class">.Void</span> from shared objects file]
[Loaded sun<span class="class">.reflect</span><span class="class">.Label</span> from shared objects file]
[Loaded sun<span class="class">.reflect</span><span class="class">.Label</span><span class="variable">$PatchInfo</span> from shared objects file]
[Loaded java<span class="class">.util</span><span class="class">.AbstractList</span><span class="variable">$Itr</span> from shared objects file]
[Loaded sun<span class="class">.reflect</span><span class="class">.MethodAccessorGenerator</span>$<span class="number">1</span> from shared objects file]
[Loaded sun<span class="class">.reflect</span><span class="class">.ClassDefiner</span> from shared objects file]
[Loaded sun<span class="class">.reflect</span><span class="class">.ClassDefiner</span>$<span class="number">1</span> from shared objects file]
[Loaded sun<span class="class">.reflect</span><span class="class">.GeneratedMethodAccessor1</span> from __JVM_DefineClass__]
Hello, <span class="number">15</span>
</code></pre><p> <img src="http://taojinke.github.io/img/20150702/f489412.gif" alt=""></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x524D;15&#x6B21;&#x53CD;&#x5C04;&#x8C03;&#x7528;A.foo()&#x65B9;&#x6CD5;&#x5E76;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x7A00;&#x5947;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x4F46;&#x5728;&#x7B2C;16&#x6B21;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#x65F6;&#x4F3C;&#x4E4E;&#x6709;&#x4EC0;&#x4E48;&#x4E1C;&#x897F;&#x88AB;&#x89E6;&#x53D1;&#x4E86;&#xFF0C;&#x5BFC;&#x81F4;JVM&#x65B0;&#x52A0;&#x8F7D;&#x4E86;&#x4E00;&#x5806;&#x7C7B;&#xFF0C;&#x5176;&#x4E2D;&#x5C31;&#x5305;&#x62EC;[Loaded sun.reflect.GeneratedMethodAccessor1 from <strong>JVM_DefineClass</strong>]&#x8FD9;&#x4E48;&#x4E00;&#x884C;&#x3002;&#x8FD9;&#x662F;&#x54EA;&#x91CC;&#x6765;&#x7684;&#x5462;&#xFF1F;</p>
<p>&#x5148;&#x6765;&#x770B;&#x770B;JDK&#x91CC;Method.invoke()&#x662F;&#x600E;&#x4E48;&#x5B9E;&#x73B0;&#x7684;&#x3002;java.lang.reflect.Method&#xFF1A;&#xA0; </p>
<p> <img src="http://taojinke.github.io/img/20150702/f489683.gif" alt=""></p>
<pre><code><span class="keyword">public</span> <span class="keyword">final</span>
    <span class="class"><span class="keyword">class</span> <span class="title">Method</span> <span class="keyword">extends</span> <span class="title">AccessibleObject</span> <span class="keyword">implements</span> <span class="title">GenericDeclaration</span>, 
                             <span class="title">Member</span> </span>{
    <span class="comment">// ...</span>
    <span class="keyword">private</span> <span class="keyword">volatile</span> MethodAccessor methodAccessor;
    <span class="comment">// For sharing of MethodAccessors. This branching structure is</span>
    <span class="comment">// currently only two levels deep (i.e., one root Method and</span>
    <span class="comment">// potentially many Method objects pointing to it.)</span>
    <span class="keyword">private</span> Method              root;
    <span class="comment">// ...</span>
    <span class="keyword">public</span> <span class="function">Object <span class="title">invoke</span><span class="params">(Object obj, Object... args)</span>
            <span class="keyword">throws</span> IllegalAccessException, IllegalArgumentException,
            InvocationTargetException
    </span>{
        <span class="keyword">if</span> (!override) {
            <span class="keyword">if</span> (!Reflection.quickCheckMemberAccess(clazz, modifiers)) {
                Class caller = Reflection.getCallerClass(<span class="number">1</span>);
                Class targetClass = ((obj == <span class="keyword">null</span> || !Modifier.isProtected(modifiers))
                                     ? clazz
                                     : obj.getClass());
                <span class="keyword">boolean</span> cached;
                <span class="keyword">synchronized</span> (<span class="keyword">this</span>) {
                    cached = (securityCheckCache == caller)
                        &amp;amp;&amp;amp; (securityCheckTargetClassCache == targetClass);
                }
                <span class="keyword">if</span> (!cached) {
                    Reflection.ensureMemberAccess(caller, clazz, obj, modifiers);
                    <span class="keyword">synchronized</span> (<span class="keyword">this</span>) {
                    securityCheckCache = caller;
                    securityCheckTargetClassCache = targetClass;
                    }
                }
            }
        }
        <span class="keyword">if</span> (methodAccessor == <span class="keyword">null</span>) acquireMethodAccessor();
        <span class="function"><span class="keyword">return</span> methodAccessor.<span class="title">invoke</span><span class="params">(obj, args)</span></span>;
    }
    <span class="comment">// <span class="doctag">NOTE</span> that there is no synchronization used here. It is correct</span>
    <span class="comment">// (though not efficient) to generate more than one MethodAccessor</span>
    <span class="comment">// for a given Method. However, avoiding synchronization will</span>
    <span class="comment">// probably make the implementation more scalable.</span>
    <span class="keyword">private</span> <span class="function"><span class="keyword">void</span> <span class="title">acquireMethodAccessor</span><span class="params">()</span> </span>{
        <span class="comment">// First check to see if one has been created yet, and take it</span>
        <span class="comment">// if so</span>
        MethodAccessor tmp = <span class="keyword">null</span>;
        <span class="keyword">if</span> (root != <span class="keyword">null</span>) tmp = root.getMethodAccessor();
        <span class="keyword">if</span> (tmp != <span class="keyword">null</span>) {
            methodAccessor = tmp;
            <span class="keyword">return</span>;
        }
        <span class="comment">// Otherwise fabricate one and propagate it up to the root</span>
        tmp = reflectionFactory.newMethodAccessor(<span class="keyword">this</span>);
        setMethodAccessor(tmp);
    }
    <span class="comment">// ...</span>
}
</code></pre><p> <img src="http://taojinke.github.io/img/20150702/f4898f4.gif" alt=""></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;Method.invoke()&#x5B9E;&#x9645;&#x4E0A;&#x5E76;&#x4E0D;&#x662F;&#x81EA;&#x5DF1;&#x5B9E;&#x73B0;&#x7684;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#x903B;&#x8F91;&#xFF0C;&#x800C;&#x662F;&#x59D4;&#x6258;&#x7ED9;sun.reflect.MethodAccessor&#x6765;&#x5904;&#x7406;&#x3002;</p>
<p>&#x6BCF;&#x4E2A;&#x5B9E;&#x9645;&#x7684;Java&#x65B9;&#x6CD5;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5BF9;&#x5E94;&#x7684;Method&#x5BF9;&#x8C61;&#x4F5C;&#x4E3A;root&#xFF0C;&#x3002;&#x8FD9;&#x4E2A;root&#x662F;&#x4E0D;&#x4F1A;&#x66B4;&#x9732;&#x7ED9;&#x7528;&#x6237;&#x7684;&#xFF0C;&#x800C;&#x662F;&#x6BCF;&#x6B21;&#x5728;&#x901A;&#x8FC7;&#x53CD;&#x5C04;&#x83B7;&#x53D6;Method&#x5BF9;&#x8C61;&#x65F6;&#x65B0;&#x521B;&#x5EFA;Method&#x5BF9;&#x8C61;&#x628A;root&#x5305;&#x88C5;&#x8D77;&#x6765;&#x518D;&#x7ED9;&#x7528;&#x6237;&#x3002;&#x5728;&#x7B2C;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x5B9E;&#x9645;Java&#x65B9;&#x6CD5;&#x5BF9;&#x5E94;&#x5F97;Method&#x5BF9;&#x8C61;&#x7684;invoke()&#x65B9;&#x6CD5;&#x4E4B;&#x524D;&#xFF0C;&#x5B9E;&#x73B0;&#x8C03;&#x7528;&#x903B;&#x8F91;&#x7684;MethodAccessor&#x5BF9;&#x8C61;&#x8FD8;&#x6CA1;&#x521B;&#x5EFA;&#xFF1B;&#x7B49;&#x7B2C;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#x65F6;&#x624D;&#x65B0;&#x521B;&#x5EFA;MethodAccessor&#x5E76;&#x66F4;&#x65B0;&#x7ED9;root&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;MethodAccessor.invoke()&#x771F;&#x6B63;&#x5B8C;&#x6210;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#x3002;&#xA0;</p>
<p>&#x90A3;&#x4E48;MethodAccessor&#x662F;&#x5565;&#x5462;&#xFF1F;&#xA0;</p>
<p>sun.reflect.MethodAccessor&#xFF1A;</p>
<pre><code><span class="keyword">public</span> <span class="interface"><span class="keyword">interface</span> MethodAccessor </span>{
    <span class="comment">/** Matches specification in {@link java.lang.reflect.Method} */</span>
    <span class="keyword">public</span> <span class="built_in">Object</span> invoke(<span class="built_in">Object</span> obj, <span class="built_in">Object</span>[] args)
        throws IllegalArgumentException, InvocationTargetException;
}
</code></pre><p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5B83;&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x5355;&#x65B9;&#x6CD5;&#x63A5;&#x53E3;&#xFF0C;&#x5176;invoke()&#x65B9;&#x6CD5;&#x4E0E;Method.invoke()&#x7684;&#x5BF9;&#x5E94;&#x3002;</p>
<p>&#x521B;&#x5EFA;MethodAccessor&#x5B9E;&#x4F8B;&#x7684;&#x662F;ReflectionFactory&#x3002;</p>
<p>sun.reflect.ReflectionFactory&#xFF1A;</p>
<p> <img src="http://taojinke.github.io/img/20150702/f489b65.gif" alt=""></p>
<pre><code>public class <span class="type">ReflectionFactory</span> {
    private <span class="keyword">static</span> boolean initted = <span class="literal">false</span>;
    // ...
    //
    // &amp;quot;<span class="type">Inflation</span>&amp;quot; mechanism. <span class="type">Loading</span> bytecodes to implement
    // <span class="type">Method</span>.invoke() <span class="keyword">and</span> <span class="type">Constructor</span>.newInstance() currently costs
    // <span class="number">3</span>-<span class="number">4</span>x more than an invocation via native code <span class="keyword">for</span> the first
    // invocation (though subsequent invocations have been benchmarked
    // to be over <span class="number">20</span>x faster). <span class="type">Unfortunately</span> this cost increases
    // startup time <span class="keyword">for</span> certain applications that use reflection
    // intensively (but only once per class) to bootstrap themselves.
    // <span class="type">To</span> avoid this penalty we reuse the existing <span class="type">JVM</span> entry points
    // <span class="keyword">for</span> the first few invocations <span class="keyword">of</span> <span class="type">Methods</span> <span class="keyword">and</span> <span class="type">Constructors</span> <span class="keyword">and</span>
    // then switch to the bytecode-based implementations.
    //
    // <span class="type">Package</span>-private to be accessible to <span class="type">NativeMethodAccessorImpl</span>
    // <span class="keyword">and</span> <span class="type">NativeConstructorAccessorImpl</span>
    private <span class="keyword">static</span> boolean noInflation        = <span class="literal">false</span>;
    private <span class="keyword">static</span> <span class="type">int</span>     inflationThreshold = <span class="number">15</span>;
    // ...
    /** <span class="type">We</span> have to defer full initialization <span class="keyword">of</span> this class until after
        the <span class="keyword">static</span> initializer <span class="keyword">is</span> run since java.lang.reflect.<span class="type">Method</span>&amp;apos;s
        <span class="keyword">static</span> initializer (more properly, that <span class="keyword">for</span>
        java.lang.reflect.<span class="type">AccessibleObject</span>) causes this class&amp;apos;s to be
        run, before the system properties are <span class="type">set</span> up. */
    private <span class="keyword">static</span> <span class="type">void</span> checkInitted() {
        <span class="keyword">if</span> (initted) <span class="keyword">return</span>;
        <span class="type">AccessController</span>.doPrivileged(new <span class="type">PrivilegedAction</span>() {
                public <span class="type">Object</span> run() {
                    // <span class="type">Tests</span> to ensure the system properties table <span class="keyword">is</span> fully
                    // initialized. <span class="type">This</span> <span class="keyword">is</span> needed because reflection code <span class="keyword">is</span>
                    // called very early <span class="keyword">in</span> the initialization process (before
                    // command-line arguments have been parsed <span class="keyword">and</span> therefore
                    // these user-settable properties installed.) <span class="type">We</span> assume that
                    // <span class="keyword">if</span> <span class="type">System</span>.<span class="keyword">out</span> <span class="keyword">is</span> non-null then the <span class="type">System</span> class has been
                    // fully initialized <span class="keyword">and</span> that the bulk <span class="keyword">of</span> the startup code
                    // has been run.
                    <span class="keyword">if</span> (<span class="type">System</span>.<span class="keyword">out</span> == null) {
                        // java.lang.<span class="type">System</span> <span class="keyword">not</span> yet fully initialized
                        <span class="keyword">return</span> null;
                    }
                    <span class="type">String</span> val = <span class="type">System</span>.getProperty(&amp;quot;sun.reflect.noInflation&amp;quot;);
                    <span class="keyword">if</span> (val != null &amp;amp;&amp;amp; val.equals(&amp;quot;<span class="literal">true</span>&amp;quot;)) {
                        noInflation = <span class="literal">true</span>;
                    }
                    val = <span class="type">System</span>.getProperty(&amp;quot;sun.reflect.inflationThreshold&amp;quot;);
                    <span class="keyword">if</span> (val != null) {
                        <span class="keyword">try</span> {
                            inflationThreshold = <span class="type">Integer</span>.parseInt(val);
                        } catch (<span class="type">NumberFormatException</span> e) {
                            throw (<span class="type">RuntimeException</span>) 
                                new <span class="type">RuntimeException</span>(&amp;quot;<span class="type">Unable</span> to parse property sun.reflect.inflationThreshold&amp;quot;).
                                    initCause(e);
                        }
                    }
                    initted = <span class="literal">true</span>;
                    <span class="keyword">return</span> null;
                }
            });
    }
    // ...
    public <span class="type">MethodAccessor</span> newMethodAccessor(<span class="type">Method</span> <span class="keyword">method</span>) {
        checkInitted();
        <span class="keyword">if</span> (noInflation) {
            <span class="keyword">return</span> new <span class="type">MethodAccessorGenerator</span>().
                generateMethod(<span class="keyword">method</span>.getDeclaringClass(),
                               <span class="keyword">method</span>.getName(),
                               <span class="keyword">method</span>.getParameterTypes(),
                               <span class="keyword">method</span>.getReturnType(),
                               <span class="keyword">method</span>.getExceptionTypes(),
                               <span class="keyword">method</span>.getModifiers());
        } <span class="keyword">else</span> {
            <span class="type">NativeMethodAccessorImpl</span> acc =
                new <span class="type">NativeMethodAccessorImpl</span>(<span class="keyword">method</span>);
            <span class="type">DelegatingMethodAccessorImpl</span> res =
                new <span class="type">DelegatingMethodAccessorImpl</span>(acc);
            acc.setParent(res);
            <span class="keyword">return</span> res;
        }
    }
}
</code></pre><p> <img src="http://taojinke.github.io/img/20150702/f489dd6.gif" alt=""></p>
<p>&#x8FD9;&#x91CC;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6709;&#x8DA3;&#x7684;&#x5730;&#x65B9;&#x4E86;&#x3002;&#x5982;&#x6CE8;&#x91CA;&#x6240;&#x8FF0;&#xFF0C;&#x5B9E;&#x9645;&#x7684;MethodAccessor&#x5B9E;&#x73B0;&#x6709;&#x4E24;&#x4E2A;&#x7248;&#x672C;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;Java&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x662F;native code&#x5B9E;&#x73B0;&#x7684;&#x3002;Java&#x5B9E;&#x73B0;&#x7684;&#x7248;&#x672C;&#x5728;&#x521D;&#x59CB;&#x5316;&#x65F6;&#x9700;&#x8981;&#x8F83;&#x591A;&#x65F6;&#x95F4;&#xFF0C;&#x4F46;&#x957F;&#x4E45;&#x6765;&#x8BF4;&#x6027;&#x80FD;&#x8F83;&#x597D;&#xFF1B;native&#x7248;&#x672C;&#x6B63;&#x597D;&#x76F8;&#x53CD;&#xFF0C;&#x542F;&#x52A8;&#x65F6;&#x76F8;&#x5BF9;&#x8F83;&#x5FEB;&#xFF0C;&#x4F46;&#x8FD0;&#x884C;&#x65F6;&#x95F4;&#x957F;&#x4E86;&#x4E4B;&#x540E;&#x901F;&#x5EA6;&#x5C31;&#x6BD4;&#x4E0D;&#x8FC7;Java&#x7248;&#x4E86;&#x3002;&#x8FD9;&#x662F;HotSpot&#x7684;&#x4F18;&#x5316;&#x65B9;&#x5F0F;&#x5E26;&#x6765;&#x7684;&#x6027;&#x80FD;&#x7279;&#x6027;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x662F;&#x8BB8;&#x591A;&#x865A;&#x62DF;&#x673A;&#x7684;&#x5171;&#x540C;&#x70B9;&#xFF1A;&#x8DE8;&#x8D8A;native&#x8FB9;&#x754C;&#x4F1A;&#x5BF9;&#x4F18;&#x5316;&#x6709;&#x963B;&#x788D;&#x4F5C;&#x7528;&#xFF0C;&#x5B83;&#x5C31;&#x50CF;&#x4E2A;&#x9ED1;&#x7BB1;&#x4E00;&#x6837;&#x8BA9;&#x865A;&#x62DF;&#x673A;&#x96BE;&#x4EE5;&#x5206;&#x6790;&#x4E5F;&#x5C06;&#x5176;&#x5185;&#x8054;&#xFF0C;&#x4E8E;&#x662F;&#x8FD0;&#x884C;&#x65F6;&#x95F4;&#x957F;&#x4E86;&#x4E4B;&#x540E;&#x53CD;&#x800C;&#x662F;&#x6258;&#x7BA1;&#x7248;&#x672C;&#x7684;&#x4EE3;&#x7801;&#x66F4;&#x5FEB;&#x4E9B;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x6743;&#x8861;&#x4E24;&#x4E2A;&#x7248;&#x672C;&#x7684;&#x6027;&#x80FD;&#xFF0C;Sun&#x7684;JDK&#x4F7F;&#x7528;&#x4E86;&#x201C;inflation&#x201D;&#x7684;&#x6280;&#x5DE7;&#xFF1A;&#x8BA9;Java&#x65B9;&#x6CD5;&#x5728;&#x88AB;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#x65F6;&#xFF0C;&#x5F00;&#x5934;&#x82E5;&#x5E72;&#x6B21;&#x4F7F;&#x7528;native&#x7248;&#xFF0C;&#x7B49;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#x6B21;&#x6570;&#x8D85;&#x8FC7;&#x9608;&#x503C;&#x65F6;&#x5219;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x4E13;&#x7528;&#x7684;MethodAccessor&#x5B9E;&#x73B0;&#x7C7B;&#xFF0C;&#x751F;&#x6210;&#x5176;&#x4E2D;&#x7684;invoke()&#x65B9;&#x6CD5;&#x7684;&#x5B57;&#x8282;&#x7801;&#xFF0C;&#x4EE5;&#x540E;&#x5BF9;&#x8BE5;Java&#x65B9;&#x6CD5;&#x7684;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#x5C31;&#x4F1A;&#x4F7F;&#x7528;Java&#x7248;&#x3002;&#xA0;</p>
<p>Sun&#x7684;JDK&#x662F;&#x4ECE;1.4&#x7CFB;&#x5F00;&#x59CB;&#x91C7;&#x7528;&#x8FD9;&#x79CD;&#x4F18;&#x5316;&#x7684;&#x3002;</p>
<p>PS.&#x53EF;&#x4EE5;&#x5728;&#x542F;&#x52A8;&#x547D;&#x4EE4;&#x91CC;&#x52A0;&#x4E0A;-D <em>sun.reflect.noInflation</em> =true&#xFF0C;&#x5C31;&#x4F1A;RefactionFactory&#x7684;noInflation&#x5C5E;&#x6027;&#x5C31;&#x53D8;&#x6210;true&#x4E86;&#xFF0C;&#x8FD9;&#x6837;&#x4E0D;&#x7528;&#x7B49;&#x5230;15&#x8C03;&#x7528;&#x540E;&#xFF0C;&#x7A0B;&#x5E8F;&#x4E00;&#x5F00;&#x59CB;&#x5C31;&#x4F1A;&#x7528;java&#x7248;&#x7684;MethodAccessor&#x4E86;&#x3002; </p>
<p>&#x4E0A;&#x9762;&#x770B;&#x5230;&#x4E86;ReflectionFactory.newMethodAccessor()&#x751F;&#x4EA7;MethodAccessor&#x7684;&#x903B;&#x8F91;&#xFF0C;&#x5728;&#x201C;&#x5F00;&#x5934;&#x82E5;&#x5E72;&#x6B21;&#x201D;&#x65F6;&#x7528;&#x5230;&#x7684;DelegatingMethodAccessorImpl&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>sun.reflect.DelegatingMethodAccessorImpl&#xFF1A;</p>
<p> <img src="http://taojinke.github.io/img/20150702/f489dd6.gif" alt=""></p>
<pre><code><span class="comment">/** Delegates its invocation to another MethodAccessorImpl and can
    change its delegate at run time. */</span>
<span class="class"><span class="keyword">class</span> <span class="title">DelegatingMethodAccessorImpl</span> <span class="keyword"><span class="keyword">extends</span></span> <span class="title">MethodAccessorImpl</span> {</span>
    <span class="keyword">private</span> <span class="type">MethodAccessorImpl</span> delegate;
    <span class="type">DelegatingMethodAccessorImpl</span>(<span class="type">MethodAccessorImpl</span> delegate) {
        setDelegate(delegate);
    }    
    public <span class="type">Object</span> invoke(<span class="type">Object</span> obj, <span class="type">Object</span>[] args)
        <span class="keyword">throws</span> <span class="type">IllegalArgumentException</span>, <span class="type">InvocationTargetException</span>
    {
        <span class="keyword">return</span> delegate.invoke(obj, args);
    }
    void setDelegate(<span class="type">MethodAccessorImpl</span> delegate) {
        <span class="keyword">this</span>.delegate = delegate;
    }
}
</code></pre><p> <img src="http://taojinke.github.io/img/20150702/f48a047.gif" alt=""></p>
<p>&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x95F4;&#x63A5;&#x5C42;&#xFF0C;&#x65B9;&#x4FBF;&#x5728;native&#x4E0E;Java&#x7248;&#x7684;MethodAccessor&#x4E4B;&#x95F4;&#x5B9E;&#x73B0;&#x5207;&#x6362;&#x3002;</p>
<p>&#x7136;&#x540E;&#x4E0B;&#x9762;&#x5C31;&#x662F;native&#x7248;MethodAccessor&#x7684;Java&#x4E00;&#x4FA7;&#x7684;&#x58F0;&#x660E;:</p>
<p>sun.reflect.NativeMethodAccessorImpl&#xFF1A;</p>
<p> <img src="http://taojinke.github.io/img/20150702/f48a047.gif" alt=""></p>
<pre><code>/** <span class="type">Used</span> only <span class="keyword">for</span> the first few invocations <span class="keyword">of</span> a <span class="type">Method</span>; afterward,
    switches to bytecode-based implementation */
class <span class="type">NativeMethodAccessorImpl</span> extends <span class="type">MethodAccessorImpl</span> {
    private <span class="type">Method</span> <span class="keyword">method</span>;
    private <span class="type">DelegatingMethodAccessorImpl</span> parent;
    private <span class="type">int</span> numInvocations;
    <span class="type">NativeMethodAccessorImpl</span>(<span class="type">Method</span> <span class="keyword">method</span>) {
        this.<span class="keyword">method</span> = <span class="keyword">method</span>;
    }    
    public <span class="type">Object</span> invoke(<span class="type">Object</span> obj, <span class="type">Object</span>[] args)
        throws <span class="type">IllegalArgumentException</span>, <span class="type">InvocationTargetException</span>
    {
        <span class="keyword">if</span> (++numInvocations &amp;gt; <span class="type">ReflectionFactory</span>.inflationThreshold()) {
            <span class="type">MethodAccessorImpl</span> acc = (<span class="type">MethodAccessorImpl</span>)
                new <span class="type">MethodAccessorGenerator</span>().
                    generateMethod(<span class="keyword">method</span>.getDeclaringClass(),
                                   <span class="keyword">method</span>.getName(),
                                   <span class="keyword">method</span>.getParameterTypes(),
                                   <span class="keyword">method</span>.getReturnType(),
                                   <span class="keyword">method</span>.getExceptionTypes(),
                                   <span class="keyword">method</span>.getModifiers());
            parent.setDelegate(acc);
        }
        <span class="keyword">return</span> invoke0(<span class="keyword">method</span>, obj, args);
    }
    <span class="type">void</span> setParent(<span class="type">DelegatingMethodAccessorImpl</span> parent) {
        this.parent = parent;
    }
    private <span class="keyword">static</span> native <span class="type">Object</span> invoke0(<span class="type">Method</span> m, <span class="type">Object</span> obj, <span class="type">Object</span>[] args);
}
</code></pre><p> <img src="http://taojinke.github.io/img/20150702/f48a2b8.gif" alt=""></p>
<p>&#x6BCF;&#x6B21;NativeMethodAccessorImpl.invoke()&#x65B9;&#x6CD5;&#x88AB;&#x8C03;&#x7528;&#x65F6;&#xFF0C;&#x90FD;&#x4F1A;&#x589E;&#x52A0;&#x4E00;&#x4E2A;&#x8C03;&#x7528;&#x6B21;&#x6570;&#x8BA1;&#x6570;&#x5668;&#xFF0C;&#x770B;&#x8D85;&#x8FC7;&#x9608;&#x503C;&#x6CA1;&#x6709;&#xFF1B;&#x4E00;&#x65E6;&#x8D85;&#x8FC7;&#xFF0C;&#x5219;&#x8C03;&#x7528;MethodAccessorGenerator.generateMethod()&#x6765;&#x751F;&#x6210;Java&#x7248;&#x7684;MethodAccessor&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#xFF0C;&#x5E76;&#x4E14;&#x6539;&#x53D8;DelegatingMethodAccessorImpl&#x6240;&#x5F15;&#x7528;&#x7684;MethodAccessor&#x4E3A;Java&#x7248;&#x3002;&#x540E;&#x7EED;&#x7ECF;&#x7531;DelegatingMethodAccessorImpl.invoke()&#x8C03;&#x7528;&#x5230;&#x7684;&#x5C31;&#x662F;Java&#x7248;&#x7684;&#x5B9E;&#x73B0;&#x4E86;&#x3002;</p>
<p>&#x6CE8;&#x610F;&#x5230;&#x5173;&#x952E;&#x7684;invoke0()&#x65B9;&#x6CD5;&#x662F;&#x4E2A;native&#x65B9;&#x6CD5;&#x3002;&#x5B83;&#x5728;HotSpot VM&#x91CC;&#x662F;&#x7531;JVM_InvokeMethod()&#x51FD;&#x6570;&#x6240;&#x652F;&#x6301;&#x7684;&#xFF1A;</p>
<p>&#x7531;C&#x7F16;&#x5199;</p>
<pre><code>JNIEXPORT jobject JNICALL Java_sun_reflect_NativeMethodAccessorImpl_invoke0
(JNIEnv *env, jclass unused, jobject <span class="keyword">m</span>, jobject obj, jobjectArray <span class="keyword">args</span>)
{
    <span class="keyword">return</span> JVM_InvokeMethod(env, <span class="keyword">m</span>, obj, <span class="keyword">args</span>);
}
</code></pre><p> <img src="http://taojinke.github.io/img/20150702/f48a529.gif" alt=""></p>
<pre><code><span class="type">JVM_ENTRY</span>(jobject, <span class="type">JVM_InvokeMethod</span>(<span class="type">JNIEnv</span> *env, jobject <span class="keyword">method</span>, jobject obj, jobjectArray args0))
  <span class="type">JVMWrapper</span>(&amp;quot;<span class="type">JVM_InvokeMethod</span>&amp;quot;);
  <span class="type">Handle</span> method_handle;
  <span class="keyword">if</span> (thread-&amp;gt;stack_available((address) &amp;amp;method_handle) &amp;gt;= <span class="type">JVMInvokeMethodSlack</span>) {
    method_handle = <span class="type">Handle</span>(<span class="type">THREAD</span>, <span class="type">JNIHandles</span>::resolve(<span class="keyword">method</span>));
    <span class="type">Handle</span> receiver(<span class="type">THREAD</span>, <span class="type">JNIHandles</span>::resolve(obj));
    objArrayHandle args(<span class="type">THREAD</span>, objArrayOop(<span class="type">JNIHandles</span>::resolve(args0)));
    oop <span class="literal">result</span> = <span class="type">Reflection</span>::invoke_method(method_handle(), receiver, args, <span class="type">CHECK_NULL</span>);
    jobject res = <span class="type">JNIHandles</span>::make_local(env, <span class="literal">result</span>);
    <span class="keyword">if</span> (<span class="type">JvmtiExport</span>::should_post_vm_object_alloc()) {
      oop ret_type = java_lang_reflect_Method::return_type(method_handle());
      assert(ret_type != <span class="type">NULL</span>, &amp;quot;sanity check: ret_type oop must <span class="keyword">not</span> be <span class="type">NULL</span>!&amp;quot;);
      <span class="keyword">if</span> (java_lang_Class::is_primitive(ret_type)) {
        // <span class="type">Only</span> <span class="keyword">for</span> primitive <span class="keyword">type</span> vm allocates memory <span class="keyword">for</span> java <span class="keyword">object</span>.
        // <span class="type">See</span> box() <span class="keyword">method</span>.
        <span class="type">JvmtiExport</span>::post_vm_object_alloc(<span class="type">JavaThread</span>::current(), <span class="literal">result</span>);
      }
    }
    <span class="keyword">return</span> res;
  } <span class="keyword">else</span> {
    <span class="type">THROW_0</span>(vmSymbols::java_lang_StackOverflowError());
  }
<span class="type">JVM_END</span>
</code></pre><p> <img src="http://taojinke.github.io/img/20150702/f48a529.gif" alt=""></p>
<p>&#x5176;&#x4E2D;&#x7684;&#x5173;&#x952E;&#x53C8;&#x662F;Reflection::invoke_method()&#xFF1A;</p>
<p> <img src="http://taojinke.github.io/img/20150702/f48a79a.gif" alt=""></p>
<pre><code><span class="comment">// This would be nicer if, say, java.lang.reflect.Method was a subclass</span>
<span class="comment">// of java.lang.reflect.Constructor</span>

oop Reflection::invoke_method(oop method_mirror, Handle receiver, objArrayHandle args, TRAPS) <span class="comment">{
  oop mirror             = java_lang_reflect_Method::clazz(method_mirror);
  int slot               = java_lang_reflect_Method::slot(method_mirror);
  bool override          = java_lang_reflect_Method::override(method_mirror) != 0;
  objArrayHandle ptypes(THREAD, objArrayOop(java_lang_reflect_Method::parameter_types(method_mirror)));

  oop return_type_mirror = java_lang_reflect_Method::return_type(method_mirror);
  BasicType rtype;
  if (java_lang_Class::is_primitive(return_type_mirror)) {
    rtype = basic_type_mirror_to_basic_type(return_type_mirror, CHECK_NULL);
  }</span> <span class="keyword">else</span> <span class="comment">{
    rtype = T_OBJECT;
  }</span>

  instanceKlassHandle klass(THREAD, java_lang_Class::as_klassOop(mirror));
  methodOop m = klass-&amp;gt;method_with_idnum(slot);
  <span class="keyword">if</span> (m == NULL) <span class="comment">{
    THROW_MSG_0(vmSymbols::java_lang_InternalError(), &amp;quot;invoke&amp;quot;);
  }</span>
  methodHandle <span class="function"><span class="keyword">method</span><span class="params">(THREAD, m)</span>;</span>

  return invoke(klass, <span class="function"><span class="keyword">method</span>, <span class="title">receiver</span>, <span class="title">override</span>, <span class="title">ptypes</span>, <span class="title">rtype</span>, <span class="title">args</span>, <span class="title">true</span>, <span class="title">THREAD</span>);</span>
}
</code></pre><p> <img src="http://taojinke.github.io/img/20150702/f48a79a.gif" alt=""></p>
<p>&#x518D;&#x4E0B;&#x53BB;&#x5C31;&#x6DF1;&#x5165;&#x5230;HotSpot VM&#x7684;&#x5185;&#x90E8;&#x4E86;&#xFF0C;&#x672C;&#x6587;&#x5C31;&#x5728;&#x8FD9;&#x91CC;&#x6253;&#x4F4F;&#x5427;&#x3002;&#x6709;&#x540C;&#x5B66;&#x6709;&#x5174;&#x8DA3;&#x6DF1;&#x7A76;&#x7684;&#x8BDD;&#x4EE5;&#x540E;&#x53EF;&#x4EE5;&#x518D;&#x5199;&#x4E00;&#x7BC7;&#x8BA8;&#x8BBA;native&#x7248;&#x7684;&#x5B9E;&#x73B0;&#x3002;</p>
<p>&#x56DE;&#x5230;Java&#x7684;&#x4E00;&#x4FA7;&#x3002;MethodAccessorGenerator&#x957F;&#x5565;&#x6837;&#x5462;&#xFF1F;&#x7531;&#x4E8E;&#x4EE3;&#x7801;&#x592A;&#x957F;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x5B8C;&#x6574;&#x8D34;&#x4E86;&#xFF0C;&#x6709;&#x5174;&#x8DA3;&#x7684;&#x53EF;&#x4EE5;&#x5230;OpenJDK 6&#x7684;Mercurial&#x4ED3;&#x5E93;&#x770B;&#xFF1A; <a href="http://hg.openjdk.java.net/jdk6/jdk6/jdk/file/b202c79afde3/src/share/classes/sun/reflect/MethodAccessorGenerator.java" target="_blank" rel="external">OpenJDK 6 build 17&#x7684;MethodAccessorGenerator</a> &#x3002;&#x5B83;&#x7684;&#x57FA;&#x672C;&#x5DE5;&#x4F5C;&#x5C31;&#x662F;&#x5728;&#x5185;&#x5B58;&#x91CC;&#x751F;&#x6210;&#x65B0;&#x7684;&#x4E13;&#x7528;Java&#x7C7B;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x52A0;&#x8F7D;&#x3002;&#x5C31;&#x8D34;&#x8FD9;&#x4E48;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#xFF1A; </p>
<p> <img src="http://taojinke.github.io/img/20150702/f48aa0b.gif" alt=""></p>
<pre><code><span class="keyword">private</span> static synchronized <span class="built_in">String</span> generateName(<span class="built_in">boolean</span> isConstructor,
                                                <span class="built_in">boolean</span> forSerialization)
{
    <span class="keyword">if</span> (isConstructor) {
        <span class="keyword">if</span> (forSerialization) {
            int num = ++serializationConstructorSymnum;
            <span class="keyword">return</span> &amp;quot;sun/reflect/GeneratedSerializationConstructorAccessor&amp;quot; + num;
        } <span class="keyword">else</span> {
            int num = ++<span class="constructor">constructorSymnum;
            <span class="keyword">return</span> &amp;quot;sun/reflect/GeneratedConstructorAccessor&amp;quot; + num;
        }
    } <span class="keyword">else</span> </span>{
        int num = ++methodSymnum;
        <span class="keyword">return</span> &amp;quot;sun/reflect/GeneratedMethodAccessor&amp;quot; + num;
    }
}
</code></pre><p> <img src="http://taojinke.github.io/img/20150702/f48aa0b.gif" alt=""></p>
<p>&#x53BB;&#x9605;&#x8BFB;&#x6E90;&#x7801;&#x7684;&#x8BDD;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;MethodAccessorGenerator&#x662F;&#x5982;&#x4F55;&#x4E00;&#x70B9;&#x70B9;&#x628A;Java&#x7248;&#x7684;MethodAccessor&#x5B9E;&#x73B0;&#x7C7B;&#x751F;&#x4EA7;&#x51FA;&#x6765;&#x7684;&#x3002;&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x5230;GeneratedMethodAccessor+&#x6570;&#x5B57;&#x8FD9;&#x79CD;&#x540D;&#x5B57;&#x662F;&#x4ECE;&#x54EA;&#x91CC;&#x6765;&#x7684;&#x4E86;&#xFF0C;&#x5C31;&#x5728;&#x4E0A;&#x9762;&#x7684;generateName()&#x65B9;&#x6CD5;&#x91CC;&#x3002;&#x5BF9;&#x672C;&#x6587;&#x5F00;&#x5934;&#x7684;&#x4F8B;&#x5B50;&#x7684;A.foo()&#xFF0C;&#x751F;&#x6210;&#x7684;Java&#x7248;MethodAccessor&#x5927;&#x81F4;&#x5982;&#x4E0B;&#xFF1A; </p>
<p> <img src="http://taojinke.github.io/img/20150702/f48ac7c.gif" alt=""></p>
<pre><code><span class="keyword">package</span> sun.reflect;
public <span class="class"><span class="keyword">class</span> <span class="title">GeneratedMethodAccessor1</span> <span class="keyword"><span class="keyword">extends</span></span> <span class="title">MethodAccessorImpl</span> {</span>    
    public <span class="type">GeneratedMethodAccessor1</span>() {
        <span class="keyword">super</span>();
    }
    public <span class="type">Object</span> invoke(<span class="type">Object</span> obj, <span class="type">Object</span>[] args)   
        <span class="keyword">throws</span> <span class="type">IllegalArgumentException</span>, <span class="type">InvocationTargetException</span> {
        <span class="comment">// prepare the target and parameters</span>
        <span class="keyword">if</span> (obj == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="type">NullPointerException</span>();
        <span class="keyword">try</span> {
            <span class="type">A</span> target = (<span class="type">A</span>) obj;
            <span class="keyword">if</span> (args.length != <span class="number">1</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="type">IllegalArgumentException</span>();
            <span class="type">String</span> arg0 = (<span class="type">String</span>) args[<span class="number">0</span>];
        } <span class="keyword">catch</span> (<span class="type">ClassCastException</span> e) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="type">IllegalArgumentException</span>(e.toString());
        } <span class="keyword">catch</span> (<span class="type">NullPointerException</span> e) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="type">IllegalArgumentException</span>(e.toString());
        }
        <span class="comment">// make the invocation</span>
        <span class="keyword">try</span> {
            target.foo(arg0);
        } <span class="keyword">catch</span> (<span class="type">Throwable</span> t) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="type">InvocationTargetException</span>(t);
        }
    }
}
</code></pre><p> <img src="http://taojinke.github.io/img/20150702/f48aeed.gif" alt=""></p>
<p>&#x5C31;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#x800C;&#x8A00;&#xFF0C;&#x8FD9;&#x4E2A;invoke()&#x65B9;&#x6CD5;&#x975E;&#x5E38;&#x5E72;&#x51C0;&#xFF08;&#x7136;&#x800C;&#x5C31;&#x201C;&#x6B63;&#x5E38;&#x8C03;&#x7528;&#x201D;&#x800C;&#x8A00;&#x8FD9;&#x989D;&#x5916;&#x5F00;&#x9500;&#x8FD8;&#x662F;&#x660E;&#x663E;&#x7684;&#xFF09;&#x3002;&#x6CE8;&#x610F;&#x5230;&#x53C2;&#x6570;&#x6570;&#x7EC4;&#x88AB;&#x62C6;&#x5F00;&#x4E86;&#xFF0C;&#x628A;&#x6BCF;&#x4E2A;&#x53C2;&#x6570;&#x90FD;&#x6062;&#x590D;&#x5230;&#x539F;&#x672C;&#x6CA1;&#x6709;&#x88AB;Object[]&#x5305;&#x88C5;&#x524D;&#x7684;&#x6837;&#x5B50;&#xFF0C;&#x7136;&#x540E;&#x5BF9;&#x76EE;&#x6807;&#x65B9;&#x6CD5;&#x505A;&#x6B63;&#x5E38;&#x7684;invokevirtual&#x8C03;&#x7528;&#x3002;&#x7531;&#x4E8E;&#x5728;&#x751F;&#x6210;&#x4EE3;&#x7801;&#x65F6;&#x5DF2;&#x7ECF;&#x5FAA;&#x73AF;&#x904D;&#x5386;&#x8FC7;&#x53C2;&#x6570;&#x7C7B;&#x578B;&#x7684;&#x6570;&#x7EC4;&#xFF0C;&#x751F;&#x6210;&#x51FA;&#x6765;&#x7684;&#x4EE3;&#x7801;&#x91CC;&#x5C31;&#x4E0D;&#x518D;&#x5305;&#x542B;&#x5FAA;&#x73AF;&#x4E86;&#x3002;</p>
<p>&#x81F3;&#x6B64;&#x627E;&#x5230;&#x6211;&#x7684;&#x7B54;&#x6848;&#x4E86;&#xFF0C;&#x56E0;&#x4E3A;MethodAccessor&#x4F1A;&#x505A;&#x5F3A;&#x5236;&#x7C7B;&#x578B;&#xFFFD;&#xFFFD;&#xFFFD;&#x6362;&#x518D;&#x8FDB;&#x884C;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#xFF0C;&#x4F46;&#x7236;&#x7C7B;&#x5F3A;&#x5236;&#x8F6C;&#x5316;&#x6210;&#x5B50;&#x7C7B;&#x7684;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x4F1A;&#x62A5;&#x9519;&#x7C7B;&#x578B;&#x4E0D;&#x5339;&#x914D;&#x9519;&#x8BEF;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x53D8;&#x91CF;&#x7684;&#x5F15;&#x7528;&#x58F0;&#x660E;&#x662F;&#x7236;&#x4F46;&#x5B9E;&#x9645;&#x6307;&#x5411;&#x7684;&#x5BF9;&#x8C61;&#x662F;&#x5B50;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x79CD;&#x8C03;&#x7528;&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x7684;&#x3002;</p>
<p>—————————————————————————————&#x9898;&#x5916;&#x8BDD;—————————————————————</p>
<p>&#x5F53;&#x8BE5;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#x6210;&#x4E3A;&#x70ED;&#x70B9;&#x65F6;&#xFF0C;&#x5B83;&#x751A;&#x81F3;&#x53EF;&#x4EE5;&#x88AB;&#x5185;&#x8054;&#x5230;&#x9760;&#x8FD1;Method.invoke()&#x7684;&#x4E00;&#x4FA7;&#xFF0C;&#x5927;&#x5927;&#x964D;&#x4F4E;&#x4E86;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#x7684;&#x5F00;&#x9500;&#x3002;&#x800C;native&#x7248;&#x7684;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#x5219;&#x65E0;&#x6CD5;&#x88AB;&#x6709;&#x6548;&#x5185;&#x8054;&#xFF0C;&#x56E0;&#x800C;&#x8C03;&#x7528;&#x5F00;&#x9500;&#x65E0;&#x6CD5;&#x968F;&#x7A0B;&#x5E8F;&#x7684;&#x8FD0;&#x884C;&#x800C;&#x964D;&#x4F4E;&#x3002;&#xA0;</p>
<p>&#x867D;&#x8BF4;Sun&#x7684;JDK&#x8FD9;&#x79CD;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#x4F7F;&#x5F97;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#x6210;&#x672C;&#x6BD4;&#x4EE5;&#x524D;&#x964D;&#x4F4E;&#x4E86;&#x5F88;&#x591A;&#xFF0C;&#x4F46;Method.invoke()&#x672C;&#x8EAB;&#x8981;&#x7528;&#x6570;&#x7EC4;&#x5305;&#x88C5;&#x53C2;&#x6570;&#xFF1B;&#x800C;&#x4E14;&#x6BCF;&#x6B21;&#x8C03;&#x7528;&#x90FD;&#x5FC5;&#x987B;&#x68C0;&#x67E5;&#x65B9;&#x6CD5;&#x7684;&#x53EF;&#x89C1;&#x6027;&#xFF08;&#x5728;Method.invoke()&#x91CC;&#xFF09;&#xFF0C;&#x4E5F;&#x5FC5;&#x987B;&#x68C0;&#x67E5;&#x6BCF;&#x4E2A;&#x5B9E;&#x9645;&#x53C2;&#x6570;&#x4E0E;&#x5F62;&#x5F0F;&#x53C2;&#x6570;&#x7684;&#x7C7B;&#x578B;&#x5339;&#x914D;&#x6027;&#xFF08;&#x5728;NativeMethodAccessorImpl.invoke0()&#x91CC;&#x6216;&#x8005;&#x751F;&#x6210;&#x7684;Java&#x7248;MethodAccessor.invoke()&#x91CC;&#xFF09;&#xFF1B;&#x800C;&#x4E14;Method.invoke()&#x5C31;&#x50CF;&#x662F;&#x4E2A;&#x72EC;&#x6728;&#x6865;&#x4E00;&#x6837;&#xFF0C;&#x5404;&#x5904;&#x7684;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#x90FD;&#x8981;&#x6324;&#x8FC7;&#x53BB;&#xFF0C;&#x5728;&#x8C03;&#x7528;&#x70B9;&#x4E0A;&#x6536;&#x96C6;&#x5230;&#x7684;&#x7C7B;&#x578B;&#x4FE1;&#x606F;&#x5C31;&#x4F1A;&#x5F88;&#x4E71;&#xFF0C;&#x5F71;&#x54CD;&#x5185;&#x8054;&#x7A0B;&#x5E8F;&#x7684;&#x5224;&#x65AD;&#xFF0C;&#x4F7F;&#x5F97;Method.invoke()&#x81EA;&#x8EAB;&#x96BE;&#x4EE5;&#x88AB;&#x5185;&#x8054;&#x5230;&#x8C03;&#x7528;&#x65B9;&#x3002;&#xA0;</p>
<p>&#x76F8;&#x6BD4;&#x4E4B;&#x4E0B;JDK7&#x91CC;&#x65B0;&#x7684;MethodHandler&#x5219;&#x66F4;&#x6709;&#x6F5C;&#x529B;&#xFF0C;&#x5728;&#x5176;&#x529F;&#x80FD;&#x5B8C;&#x5168;&#x5B9E;&#x73B0;&#x540E;&#x80FD;&#x8FBE;&#x5230;&#x6BD4;&#x666E;&#x901A;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#x66F4;&#x9AD8;&#x7684;&#x6027;&#x80FD;&#x3002;&#x5728;&#x4F7F;&#x7528;MethodHandle&#x6765;&#x505A;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#x65F6;&#xFF0C;MethodHandle.invoke()&#x7684;&#x5F62;&#x5F0F;&#x53C2;&#x6570;&#x4E0E;&#x8FD4;&#x56DE;&#x503C;&#x7C7B;&#x578B;&#x90FD;&#x662F;&#x51C6;&#x786E;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x53EA;&#x9700;&#x8981;&#x5728;&#x94FE;&#x63A5;&#x65B9;&#x6CD5;&#x7684;&#x65F6;&#x5019;&#x624D;&#x9700;&#x8981;&#x68C0;&#x67E5;&#x7C7B;&#x578B;&#x7684;&#x5339;&#x914D;&#x6027;&#xFF0C;&#x800C;&#x4E0D;&#x5FC5;&#xFFFD;&#xFFFD;&#xFFFD;&#x6BCF;&#x6B21;&#x8C03;&#x7528;&#x65F6;&#x90FD;&#x68C0;&#x67E5;&#x3002;&#x800C;&#x4E14;MethodHandle&#x662F;&#x4E0D;&#x53EF;&#x53D8;&#x503C;&#xFF0C;&#x5728;&#x521B;&#x5EFA;&#x540E;&#x5176;&#x5185;&#x90E8;&#x72B6;&#x6001;&#x5C31;&#x4E0D;&#x4F1A;&#x518D;&#x6539;&#x53D8;&#x4E86;&#xFF1B;JVM&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x8FD9;&#x4E2A;&#x77E5;&#x8BC6;&#x800C;&#x653E;&#x5FC3;&#x7684;&#x5BF9;&#x5B83;&#x505A;&#x6FC0;&#x8FDB;&#x4F18;&#x5316;&#xFF0C;&#x4F8B;&#x5982;&#x5C06;&#x5B9E;&#x9645;&#x7684;&#x8C03;&#x7528;&#x76EE;&#x6807;&#x5185;&#x8054;&#x5230;&#x505A;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#x7684;&#x4E00;&#x4FA7;&#x3002;&#xA0;</p>
<p>&#x672C;&#x6765;Java&#x7684;&#x5B89;&#x5168;&#x673A;&#x5236;&#x4F7F;&#x5F97;&#x4E0D;&#x540C;&#x7C7B;&#x4E4B;&#x95F4;&#x4E0D;&#x662F;&#x4EFB;&#x610F;&#x4FE1;&#x606F;&#x90FD;&#x53EF;&#x89C1;&#xFF0C;&#x4F46;Sun&#x7684;JDK&#x91CC;&#x5F00;&#x4E86;&#x4E2A;&#x53E3;&#xFF0C;&#x6709;&#x4E00;&#x4E2A;&#x6807;&#x8BB0;&#x7C7B;&#x4E13;&#x95E8;&#x7528;&#x4E8E;&#x5F00;&#x540E;&#x95E8;&#xFF1A;</p>
<p> <img src="http://taojinke.github.io/img/20150702/f48aeed.gif" alt=""></p>
<pre><code>package sun.reflect;
/** &amp;lt;P&amp;gt; MagicAccessorImpl (named <span class="keyword">for</span> parity <span class="keyword">with</span> FieldAccessorImpl <span class="keyword">and</span>
    others, <span class="keyword">not</span> because <span class="keyword">it</span> actually implements an interface) <span class="keyword">is</span> a
    marker <span class="type">class</span> <span class="keyword">in</span> <span class="keyword">the</span> hierarchy. All subclasses <span class="keyword">of</span> this <span class="type">class</span> are
    &amp;quot;magically&amp;quot; granted access <span class="keyword">by</span> <span class="keyword">the</span> VM <span class="keyword">to</span> otherwise inaccessible
    fields <span class="keyword">and</span> methods <span class="keyword">of</span> other classes. It <span class="keyword">is</span> used <span class="keyword">to</span> hold <span class="keyword">the</span> code
    <span class="keyword">for</span> dynamically-generated FieldAccessorImpl <span class="keyword">and</span> MethodAccessorImpl
    subclasses. (Use <span class="keyword">of</span> <span class="keyword">the</span> <span class="property">word</span> &amp;quot;unsafe&amp;quot; was avoided <span class="keyword">in</span> this <span class="type">class</span>&amp;apos;s
    <span class="property">name</span> <span class="keyword">to</span> avoid confusion <span class="keyword">with</span> {@link sun.misc.Unsafe}.) &amp;lt;/P&amp;gt;
    &amp;lt;P&amp;gt; The bug fix <span class="keyword">for</span> <span class="number">4486457</span> also necessitated disabling
    verification <span class="keyword">for</span> this <span class="type">class</span> <span class="keyword">and</span> all subclasses, <span class="keyword">as</span> opposed <span class="keyword">to</span> just
    SerializationConstructorAccessorImpl <span class="keyword">and</span> subclasses, <span class="keyword">to</span> avoid
    having <span class="keyword">to</span> indicate <span class="keyword">to</span> <span class="keyword">the</span> VM which <span class="keyword">of</span> these dynamically-generated
    stub classes were known <span class="keyword">to</span> be able <span class="keyword">to</span> pass <span class="keyword">the</span> verifier. &amp;lt;/P&amp;gt;
    &amp;lt;P&amp;gt; Do <span class="keyword">not</span> change <span class="keyword">the</span> <span class="property">name</span> <span class="keyword">of</span> this <span class="type">class</span> <span class="keyword">without</span> also changing <span class="keyword">the</span>
    VM&amp;apos;s code. &amp;lt;/P&amp;gt; */
<span class="type">class</span> MagicAccessorImpl {
}
</code></pre><p> <img src="http://taojinke.github.io/img/20150702/f48b15e.gif" alt=""></p>
<p>&#x90A3;&#x4E2A;&quot;<strong>JVM_DefineClass</strong>&quot;&#x7684;&#x6765;&#x6E90;&#x662F;&#x8FD9;&#x91CC;&#xFF1A;src/share/vm/prims/jvm.cpp&#xA0; </p>
<p> <img src="http://taojinke.github.io/img/20150702/f48b15e.gif" alt=""></p>
<pre><code><span class="comment">// common code for JVM_DefineClass() and JVM_DefineClassWithSource()</span>
<span class="comment">// and JVM_DefineClassWithSourceCond()</span>
<span class="keyword">static</span> <span class="function">jclass <span class="title">jvm_define_class_common</span><span class="params">(JNIEnv *env, <span class="keyword">const</span> <span class="keyword">char</span> *name,
                                      jobject loader, <span class="keyword">const</span> jbyte *buf,
                                      jsize len, jobject pd, <span class="keyword">const</span> <span class="keyword">char</span> *source,
                                      jboolean verify, TRAPS)</span> </span>{
  <span class="keyword">if</span> (source == NULL)  source = &amp;quot;__JVM_DefineClass__&amp;quot;;
</code></pre><p> <img src="http://taojinke.github.io/img/20150702/f48b3cf.gif" alt=""></p>
<p>P.S. log&#x91CC;&#x7684;&quot;shared objects file&quot;,&#x5176;&#x5B9E;&#x5C31;&#x662F;rt.jar,&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x8FD9;&#x4E48;&#x663E;&#x793A;&#xFF0C;Stack OverFlow&#x4E0A;&#x6709;&#x8FD9;&#x6837;&#x7684;&#x56DE;&#x7B54;&#xFF1A;</p>
<p>This is Class Data Sharing. When running the Sun/Oracle Client HotSpot and sharing enable (either -Xshare:auto which is the default, or&#xA0; -Xshare:on ), the&#xA0; classes.jsa file is memory mapped. This file contains a number of classes (listed in the&#xA0; classlist file) in internal representation suitable for the exact configuration of the machine running it. The idea is that the classes can be loaded quickly, getting the the JVM up faster. Soon enough a class not covered will be hit, and&#xA0; rt.jar will need to be opened and classes loaded conventionally as required. </p>
<p>&#x4E0D;&#x80FD;&#x5F88;&#x597D;&#x7406;&#x89E3;&#xFF0C;&#x5927;&#x6982;&#x7406;&#x89E3;&#x5C31;&#x662F;&#x6240;&#x6709;jvm&#x5171;&#x4EAB;&#xFF0C;&#x5E76;&#x53EF;&#x4EE5;&#x5FEB;&#x901F;&#x52A0;&#x8F7D;&#x91CC;&#x9762;&#x7684;class.&#x6709;&#x82F1;&#x6587;&#x597D;&#x7684;&#x670B;&#x53CB;&#x53EF;&#x4EE5;&#x7559;&#x8A00;&#x5E2E;&#x52A9;&#x4E0B;&#x3002;</p>
<p>P.S java&#x5185;&#x8054;&#x51FD;&#x6570;</p>
<p>C++&#x662F;&#x5426;&#x4E3A;&#x5185;&#x8054;&#x51FD;&#x6570;&#x7531;&#x81EA;&#x5DF1;&#x51B3;&#x5B9A;&#xFF0C;Java&#x7531;&#x7F16;&#x8BD1;&#x5668;&#x51B3;&#x5B9A;&#x3002;&#x5185;&#x8054;&#x51FD;&#x6570;&#x5C31;&#x662F;&#x6307;&#x51FD;&#x6570;&#x5728;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x5730;&#x65B9;&#x76F4;&#x63A5;&#x5C55;&#x5F00;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x5728;&#x8C03;&#x7528;&#x65F6;&#x4E0D;&#x7528;&#x50CF;&#x4E00;&#x822C;&#x51FD;&#x6570;&#x90A3;&#x6837;&#xFF0C;&#x53C2;&#x6570;&#x538B;&#x6808;&#xFF0C;&#x8FD4;&#x56DE;&#x65F6;&#x53C2;&#x6570;&#x51FA;&#x6808;&#x4EE5;&#x53CA;&#x8D44;&#x6E90;&#x91CA;&#x653E;&#x7B49;&#xFF0C;&#x8FD9;&#x6837;&#x63D0;&#x9AD8;&#x4E86;&#x7A0B;&#x5E8F;&#x6267;&#x884C;&#x901F;&#x5EA6;&#x3002;</p>
<p>Java&#x4E0D;&#x652F;&#x6301;&#x76F4;&#x63A5;&#x58F0;&#x660E;&#x4E3A;&#x5185;&#x8054;&#x51FD;&#x6570;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x8BA9;&#x4ED6;&#x5185;&#x8054;&#xFF0C;&#x5219;&#x662F;&#x7531;&#x7F16;&#x8BD1;&#x5668;&#x8BF4;&#x4E86;&#x7B97;&#xFF0C;&#x4F60;&#x53EA;&#x80FD;&#x591F;&#x5411;&#x7F16;&#x8BD1;&#x5668;&#x63D0;&#x51FA;&#x8BF7;&#x6C42;&#x3002;</p>
<p>final&#x9664;&#x4E86;&#x4E0D;&#x80FD;&#x88AB;override&#x5916;&#xFF0C;&#x8FD8;&#x53EF;&#x80FD;&#x5B9E;&#x73B0;&#x5185;&#x8054;&#x3002;&#x5982;&#x679C;&#x51FD;&#x6570;&#x4E3A;private&#xFF0C;&#x5219;&#x4E5F;&#x53EF;&#x80FD;&#x662F;&#x5185;&#x8054;&#x7684;&#x3002;</p>
<p>&#x603B;&#x7684;&#x6765;&#x8BF4;&#xFF0C;&#x4E00;&#x822C;&#x7684;&#x51FD;&#x6570;&#x90FD;&#x4E0D;&#x4F1A;&#x88AB;&#x5F53;&#x505A;&#x5185;&#x8054;&#x51FD;&#x6570;&#xFF0C;&#x53EA;&#x6709;&#x58F0;&#x660E;&#x4E86;final&#x540E;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x624D;&#x4F1A;&#x8003;&#x8651;&#x662F;&#x4E0D;&#x662F;&#x8981;&#x628A;&#x4F60;&#x7684;&#x51FD;&#x6570;&#x53D8;&#x6210;&#x5185;&#x8054;&#x51FD;&#x6570;&#x3002;</p>
<p>&#x5185;&#x8054;&#x4E0D;&#x4E00;&#x5B9A;&#x597D;&#xFF0C;&#x5F53;&#x88AB;&#x6307;&#x5B9A;&#x4E3A;&#x5185;&#x8054;&#x7684;&#x65B9;&#x6CD5;&#x4F53;&#x5F88;&#x5927;&#x65F6;&#xFF0C;&#x5C55;&#x5F00;&#x7684;&#x5F00;&#x9500;&#x53EF;&#x80FD;&#x5C31;&#x5DF2;&#x7ECF;&#x8D85;&#x8FC7;&#x4E86;&#x666E;&#x901A;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x8C03;&#x7528;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x5F15;&#x5165;&#x4E86;&#x5185;&#x8054;&#x53CD;&#x800C;&#x964D;&#x4F4E;&#x4E86;&#x6027;&#x80FD;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x9009;&#x62E9;&#x8FD9;&#x4E2A;&#x5173;&#x952E;&#x5B57;&#x5E94;&#x8BE5;&#x614E;&#x91CD;&#x4E9B;&#xFF0C;&#x4E0D;&#x8FC7;&#xFF0C;&#x5728;&#x4EE5;&#x540E;&#x9AD8;&#x7248;&#x672C;&#x7684;JVM&#x4E2D;&#xFF0C;&#x5728;&#x5904;&#x7406;&#x5185;&#x8054;&#x65F6;&#x505A;&#x51FA;&#x4E86;&#x4F18;&#x5316;&#xFF0C;&#x5B83;&#x4F1A;&#x6839;&#x636E;&#x65B9;&#x6CD5;&#x7684;&#x89C4;&#x6A21;&#x6765;&#x786E;&#x5B9A;&#x662F;&#x5426;&#x5C55;&#x5F00;&#x8C03;&#x7528;&#x3002;</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/JVM/">JVM</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/02/f495762/" title="OSChina 开源周刊第32期 —— Go 的插件化开发 Pingo -" itemprop="url">OSChina 开源周刊第32期 —— Go 的插件化开发 Pingo -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-01T23:50:30.000Z" itemprop="datePublished"> 发表于 2015-07-02</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="&#x6BCF;&#x5468;&#x6280;&#x672F;&#x62A2;&#x5148;&#x770B;&#xFF0C;&#x603B;&#x6709;&#x4F60;&#x60F3;&#x8981;&#x7684;&#xFF01;">&#x6BCF;&#x5468;&#x6280;&#x672F;&#x62A2;&#x5148;&#x770B;&#xFF0C;&#x603B;&#x6709;&#x4F60;&#x60F3;&#x8981;&#x7684;&#xFF01;</h4><p>&#x79FB;&#x52A8;&#x5F00;&#x53D1; </p>
<ul>
<li><strong>&#x3010;&#x535A;&#x5BA2;&#x3011;</strong> <a href="http://my.oschina.net/u/2340880/blog/404605" target="_blank" rel="external"><strong>IOS &#x8868;&#x89C6;&#x56FE;(UITableView)&#x4F7F;&#x7528;&#x8BE6;&#x89E3;</strong></a> UITableView&#x89C6;&#x56FE;&#x662F;IOS&#x5F00;&#x53D1;&#x4E2D;&#x5E38;&#x7528;&#x800C;&#x597D;&#x7528;&#x7684;&#x4E00;&#x4E2A;&#x63A7;&#x4EF6;&#x3002; <a href="http://my.oschina.net/u/2340880/blog/403996" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
</ul>
<h4 id="&#x524D;&#x7AEF;&#x5F00;&#x53D1;">&#x524D;&#x7AEF;&#x5F00;&#x53D1;</h4><ul>
<li><strong>&#x3010;&#x8F6F;&#x4EF6;&#x3011;</strong> <a href="http://www.oschina.net/p/nginfinitescroll" target="_blank" rel="external"><strong>AngularJS &#x65E0;&#x9650;&#x6EDA;&#x52A8;&#x6307;&#x4EE4; ngInfiniteScroll</strong></a> ngInfiniteScroll &#x662F;&#xFFFD;&#xFFFD;&#xFFFD;&#x4E2A; AngularJS &#x7684;&#x6269;&#x5C55;&#x6307;&#x4EE4;&#xFF0C;&#x5B9E;&#x73B0;&#x4E86;&#x7F51;&#x9875;&#x7684;&#x65E0;&#x9650;&#x6EDA;&#x52A8;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x76F8;&#x5F53;&#x4E8E;&#x9875;&#x9762;&#x6EDA;&#x52A8;&#x5230;&#x6700;&#x5E95;&#x90E8;&#x7684;&#x65F6;&#x5019;&#x81EA;&#x52A8;&#x52A0;&#x8F7D;&#x66F4;&#x591A;&#x5185;&#x5BB9;&#x3002; <a href="http://www.oschina.net/p/nginfinitescroll" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><strong>&#x3010;&#x535A;&#x5BA2;&#x3011;</strong> <a href="http://my.oschina.net/u/2342955/blog/408889" target="_blank" rel="external"><strong>Angular&#x5B66;&#x4E60;&#x5FC3;&#x5F97;&#x4E4B;directive&#x2014;&#x2014;scope&#x9009;&#x9879;&#x4E0E;&#x7ED1;&#x5B9A;&#x7B56;&#x7565;</strong></a> &#x5927;&#x5BB6;&#x77E5;&#x9053;&#xFF0C;&#x5F53;scope&#x9009;&#x9879;&#x5199;&#x4E3A;scope:{}&#x8FD9;&#x79CD;&#x5F62;&#x5F0F;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x5DF2;&#x7ECF;&#x4E3A;&#x6307;&#x4EE4;&#x751F;&#x6210;&#x4E86;&#x9694;&#x79BB;&#x4F5C;&#x7528;&#x57DF;&#xFF0C;&#x73B0;&#x5728;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x770B;&#x7ED1;&#x5B9A;&#x7B56;&#x7565;&#x7684;&#x4E09;&#x79CD;&#x5F62;&#x5F0F;&#xFF1A;&amp; &#x3001;= &#x3001;@&#x3002; <a href="http://my.oschina.net/u/2342955/blog/408889" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
</ul>
<h4 id="&#x670D;&#x52A1;&#x7AEF;&#x5F00;&#x53D1;/&#x7BA1;&#x7406;">&#x670D;&#x52A1;&#x7AEF;&#x5F00;&#x53D1;/&#x7BA1;&#x7406;</h4><ul>
<li><strong>&#x3010;&#x7FFB;&#x8BD1;&#x3011;</strong> <a href="http://www.oschina.net/translate/zero-downtime-haproxy-reloads" target="_blank" rel="external"><strong>&#x771F;&#x6B63;&#x96F6;&#x505C;&#x673A; HAProxy &#x91CD;&#x8F7D;</strong></a> &#x6211;&#x4EEC;&#x559C;&#x6B22;&#x5728;&#x53D1;&#x5C55; SOA &#x7684;&#x65F6;&#x5019;&#x4F7F;&#x7528; SmartStack &#x7ED9;&#x6211;&#x4EEC;&#x5E26;&#x6765;&#x7684;&#x7075;&#x6D3B;&#x6027;&#xFF0C;&#x4F46;&#x8FD9;&#x79CD;&#x7075;&#x6D3B;&#x6027;&#x662F;&#x6709;&#x4EE3;&#x4EF7;&#x7684;&#x3002;&#x901A;&#x5E38;&#x5F53;&#x670D;&#x52A1;&#x6216;&#x5728;&#x670D;&#x52A1;&#x540E;&#x7AEF;&#x6267;&#x884C;&#x589E;&#x52A0;&#x6216;&#x6C38;&#x4E45;&#x5220;&#x9664;&#x547D;&#x4EE4;&#x7684;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6574;&#x4E2A;&#x57FA;&#x7840;&#x8BBE;&#x65BD;&#x4E0D;&#x5F97;&#x4E0D;&#x91CD;&#x65B0;&#x52A0;&#x8F7D; HAProxy &#x3002; <a href="http://www.oschina.net/translate/zero-downtime-haproxy-reloads" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><strong>&#x3010;&#x7FFB;&#x8BD1;&#x3011;</strong> <a href="http://www.oschina.net/translate/beyond-storm-for-streaming-data-applications" target="_blank" rel="external"><strong>Storm &#x5E76;&#x975E;&#x5B8C;&#x5168;&#x9002;&#x5408;&#x6240;&#x6709;&#x5B9E;&#x65F6;&#x5E94;&#x7528;</strong></a> &#x4E3A;&#x4E86;&#x5E94;&#x5BF9;&#x4E0D;&#x65AD;&#x589E;&#x957F;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x540C;&#x65F6;&#xFF0C;&#x5229;&#x7528;&#x5B9E;&#x65F6;&#x4E2A;&#x6027;&#x5316;&#x6280;&#x672F;&#x6539;&#x8FDB;&#x5728;&#x7EBF;&#x7528;&#x6237;&#x4F53;&#x9A8C;&#xFF0C;&#x8D8A;&#x6765;&#x8D8A;&#x591A;&#x7684;&#x5E94;&#x7528;&#x5F00;&#x53D1;&#x5F15;&#x5165;&#x4E86;&#x6D41;&#x6570;&#x636E;&#x6280;&#x672F;&#x3002;&#x5BF9;&#x4E8E;&#x6D41;&#x6570;&#x636E;&#x5E94;&#x7528;&#x7684;&#x5B9A;&#x4E49;&#x591A;&#x79CD;&#x591A;&#x6837;&#xFF0C;&#x4F46;&#x90FD;&#x5305;&#x542B;&#x4E09;&#x4E2A;&#x57FA;&#x672C;&#x529F;&#x80FD;&#xFF1A;&#x5B9E;&#x65F6;&#x6570;&#x636E;&#x91C7;&#x96C6;&#xFF0C;&#x5B9E;&#x65F6;&#x5206;&#x6790;&#x548C;&#x81EA;&#x52A8;&#x5316;&#x51B3;&#x7B56;&#x3002; <a href="http://www.oschina.net/translate/beyond-storm-for-streaming-data-applications" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><strong>&#x3010;&#x7FFB;&#x8BD1;&#x3011;</strong> <a href="http://www.oschina.net/translate/deploying-rails-applications-with-the-puma-web-server" target="_blank" rel="external"><strong>&#x4F7F;&#x7528; Puma Web &#x670D;&#x52A1;&#x5668;&#x90E8;&#x7F72; Rails &#x5E94;&#x7528;</strong></a> &#x76F8;&#x5BF9;&#x4E8E;&#x4E00;&#x6B21;&#x53EA;&#x5904;&#x7406;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#x7684; Web &#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#xFF0C;&#x5E76;&#x53D1;&#x5904;&#x7406;&#x8BF7;&#x6C42;&#x7684; Web &#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#xFF0C;&#x80FD;&#x591F;&#x66F4;&#x9AD8;&#x6548;&#x7684;&#x4F7F;&#x7528;&#x52A8;&#x6001;&#x8D44;&#x6E90;&#x3002;Puma&#xA0;&#x662F;&#x548C; Unicorn &#x76F8;&#x7ADE;&#x4E89;&#x7684; Web &#x670D;&#x52A1;&#x5668;&#xFF0C;&#x5B83;&#x80FD;&#x591F;&#x5904;&#x7406;&#x5E76;&#x53D1;&#x8BF7;&#x6C42;&#x3002; <a href="http://www.oschina.net/translate/deploying-rails-applications-with-the-puma-web-server" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><strong>&#x3010;&#x7FFB;&#x8BD1;&#x3011;</strong> <a href="http://www.oschina.net/translate/running-kafka-scale" target="_blank" rel="external"><strong>LinkedIn &#x2014;&#x2014; Apache Kafka &#x7684;&#x4F38;&#x7F29;&#x6269;&#x5C55;&#x80FD;&#x529B;</strong></a> &#x5982;&#x679C;&#x6570;&#x636E;&#x662F;&#x9AD8;&#x79D1;&#x6280;&#x7684;&#x751F;&#x547D;&#x7EBF;&#x7684;&#x8BDD;&#xFF0C;Apache Kafka &#x5C31;&#x662F; LinkedIn &#x516C;&#x53F8;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x4E2D;&#x7684;&#x5FAA;&#x73AF;&#x7CFB;&#x7EDF;&#x3002;&#x6211;&#x4EEC;&#x4F7F;&#x7528; Kafka &#x5728;&#x591A;&#x7CFB;&#x7EDF;&#x4E4B;&#x95F4;&#x642C;&#x79FB;&#x5404;&#x7C7B;&#x6570;&#x636E;&#xFF0C;&#x5B83;&#x51E0;&#x4E4E;&#x6BCF;&#x4E00;&#x5929;&#x90FD;&#x63A5;&#x89E6;&#x6BCF;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x3002; <a href="http://www.oschina.net/translate/running-kafka-scale" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><strong>&#x3010;&#x8F6F;&#x4EF6;&#x3011;</strong> <a href="http://www.oschina.net/p/caddy" target="_blank" rel="external"><strong>HTTP/2 Web &#x670D;&#x52A1;&#x5668; Caddy</strong></a> Caddy &#x662F;&#x4E00;&#x4E2A;&#x652F;&#x6301; HTTP/2 &#x7684;&#x8DE8;&#x5E73;&#x53F0; Web &#x670D;&#x52A1;&#x5668;&#xFF0C;&#x4F7F;&#x7528;&#x548C;&#x914D;&#x7F6E;&#x90FD;&#x975E;&#x5E38;&#x7B80;&#x5355;&#x3002;Caddy &#x652F;&#x6301; HTTP/2, IPv6, Markdown, WebSockets, FastCGI, &#x6A21;&#x677F;&#x7B49;&#x7B49;&#x3002; <a href="http://www.oschina.net/p/caddy" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
</ul>
<h4 id="&#x7F16;&#x7A0B;&#x8BED;&#x8A00;">&#x7F16;&#x7A0B;&#x8BED;&#x8A00;</h4><ul>
<li><strong>&#x3010;&#x8F6F;&#x4EF6;&#x3011;</strong> <a href="http://www.oschina.net/p/freecache" target="_blank" rel="external"><strong>Go &#x8BED;&#x8A00;&#x7684;&#x7F13;&#x5B58;&#x5E93; FreeCache</strong></a> FreeCache &#x662F;&#x4E00;&#x4E2A; Go &#x8BED;&#x8A00;&#x7684;&#x7F13;&#x5B58;&#x5E93;&#xFF0C;&#x65E0;&#x989D;&#x5916;&#x7684; GC &#x8D1F;&#x8377;&#x3002;&#x6570;&#x767E;&#x4E07;&#x5BF9;&#x8C61;&#x7684;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5EF6;&#x8FDF;&#x4EC5;&#x5728;&#x6570;&#x767E;&#x6BEB;&#x79D2;&#x3002; <a href="http://www.oschina.net/p/freecache" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><strong>&#x3010;&#x8F6F;&#x4EF6;&#x3011;</strong> <a href="http://www.oschina.net/p/pingo" target="_blank" rel="external"><strong>Go &#x7684;&#x63D2;&#x4EF6;&#x5316;&#x5F00;&#x53D1; Pingo</strong></a> Pingo &#x662F;&#x4E00;&#x4E2A;&#x7528;&#x6765;&#x4E3A; Go &#x7A0B;&#x5E8F;&#x7F16;&#x5199;&#x63D2;&#x4EF6;&#x7684;&#x7B80;&#x5355;&#x72EC;&#x7ACB;&#x5E93;&#xFF0C;&#x56E0;&#x4E3A; Go &#x672C;&#x8EAB;&#x662F;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x6240;&#x6709;&#x63D2;&#x4EF6;&#x90FD;&#x4EE5;&#x5916;&#x90E8;&#x8FDB;&#x7A0B;&#x65B9;&#x5F0F;&#x5B58;&#x5728;&#x3002; <a href="http://www.oschina.net/p/pingo" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><strong>&#x3010;&#x7FFB;&#x8BD1;&#x3011;</strong> <a href="http://www.oschina.net/translate/robovm-1-0-released-commercial-licenses-a-look-under-the-hood" target="_blank" rel="external"><strong>RoboVM 1.0 &#x53D1;&#x5E03; &#x2014;&#x2014; &#x5546;&#x4E1A;&#x8BB8;&#x53EF;&#x548C;&#x65B0;&#x529F;&#x80FD;&#x4ECB;&#x7ECD;</strong></a> &#x7ECF;&#x8FC7;&#x6570;&#x6708;&#x7684;&#x8270;&#x82E6;&#x5DE5;&#x4F5C;&#x6211;&#x4EEC;&#x5F88;&#x81EA;&#x8C6A;&#x7684;&#x5BA3;&#x5E03;&#x6211;&#x4EEC;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x7A33;&#x5B9A;&#x7248; RoboVM 1.0 &#x53D1;&#x5E03;&#x4E86;&#xFF01; <a href="http://www.oschina.net/translate/robovm-1-0-released-commercial-licenses-a-look-under-the-hood" target="_blank" rel="external">&#x8BE6;&#x7EC6;</a></li>
<li><strong>&#x3010;&#x535A;&#x5BA2;&#x3011;</strong> <a href="http://my.oschina.net/benhaile/blog/408377" target="_blank" rel="external"><strong>Java 8 &#x91CC;&#x9762; lambda &#x6700;&#x4F73;&#x5B9E;&#x8DF5;</strong></a> &#x5728; Java 8 &#x91CC;&#x9762;Lambda&#x662F;&#x6700;&#x706B;&#x7684;&#x4E3B;&#x9898;&#xFF0C;&#x4E0D;&#x4EC5;&#x4EC5;&#x662F;&#x56E0;&#x4E3A;&#x8BED;&#x6CD5;&#x7684;&#x6539;&#x53D8;&#xFF0C;&#x66F4;&#x91CD;&#x8981;&#x7684;&#x662F;&#x5E26;&#x6765;&#x4E86;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x7684;&#x601D;&#x60F3;&#xFF0C;&#x6211;&#x89C9;&#x5F97;&#x4F18;&#x79C0;&#x7684;&#x7A0B;&#x5E8F;&#x5458;&#xFF0C;&#x6709;&#x5FC5;&#x8981;&#x5B66;&#x4E60;&#x4E00;&#x4E0B;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x7684;&#x601D;&#x60F3;&#x4EE5;&#x5F00;&#x9614;&#x601D;&#x8DEF;&#x3002;&#x6240;&#x4EE5;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x804A;&#x804A;Lambda&#x7684;&#x5E94;&#x7528;&#x573A;&#x666F;&#xFF0C;&#x6027;&#x80FD;&#xFF0C;&#x4E5F;&#x4F1A;&#x63D0;&#x53CA;&#x4E0B;&#x4E0D;&#x597D;&#x7684;&#x4E00;&#x9762;&#x3002; <a href="http://my.oschina.net/benhaile/blog/408377" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
</ul>
<h4 id="&#x6570;&#x636E;&#x5E93;">&#x6570;&#x636E;&#x5E93;</h4><ul>
<li><strong>&#x3010;&#x8F6F;&#x4EF6;&#x3011;</strong> <a href="http://www.oschina.net/p/torodb" target="_blank" rel="external"><strong>JSON &#x6587;&#x6863;&#x6570;&#x636E;&#x5E93; ToroDB</strong></a> ToroDB &#x662F;&#x4E00;&#x4E2A;&#x5F00;&#x6E90;&#x7684;&#x9762;&#x5411;&#x6587;&#x6863;&#x7684; JSON &#x6570;&#x636E;&#x5E93;&#xFF0C;&#x57FA;&#x4E8E; PostgreSQL &#x8FD0;&#x884C;&#x3002;JSON &#x6587;&#x6863;&#x5173;&#x7CFB;&#x5316;&#x5B58;&#x50A8;&#xFF0C;&#x800C;&#x975E; blob/jsonb &#x65B9;&#x5F0F;&#xFF0C;&#x53EF;&#x663E;&#x8457;&#x63D0;&#x5347;&#x5B58;&#x50A8;&#x548C; IO&#xFF0C;&#x517C;&#x5BB9; MongoDB&#x3002; <a href="http://www.oschina.net/p/torodb" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><strong>&#x3010;&#x535A;&#x5BA2;&#x3011;</strong> <a href="http://my.oschina.net/Suregogo/blog/406798" target="_blank" rel="external"><strong>PostgreSQL &#x7528; C &#x5B8C;&#x6210;&#x5B58;&#x50A8;&#x8FC7;&#x7A0B;&#x4F8B;&#x5B50;</strong></a> &#x6700;&#x8FD1;&#x7ED9;&#x5BA2;&#x6237;&#x5199;&#x4E86;&#x4E00;&#x4E2A;PG&#x7528;C&#x5199;&#x7684;&#x5B58;&#x50A8;&#x8FC7;&#x7A0B;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x5728;&#x6B64;&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;&#x3002; <a href="http://my.oschina.net/Suregogo/blog/406798" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><strong>&#x3010;&#x535A;&#x5BA2;&#x3011;</strong> <a href="http://my.oschina.net/Kenyon/blog/407093" target="_blank" rel="external"><strong>PostgreSQL 9.4 &#x7684;&#x7269;&#x5316;&#x89C6;&#x56FE;&#x66F4;&#x65B0;</strong></a> PostgreSQL &#x7684;9.4&#x7248;&#x672C;&#x51FA;&#x6765;&#x6709;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x4E86;&#xFF0C;&#x4E5F;&#x66F4;&#x65B0;&#x4E86;&#x5F88;&#x591A;&#x5185;&#x5BB9;&#xFF0C;&#x5176;&#x4E2D;&#x4E4B;&#x4E00;&#x662F;&#x6BD4;&#x8F83;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x7269;&#x5316;&#x89C6;&#x56FE;&#x7684;&#x66F4;&#x65B0;&#xFF0C;&#x5BF9;&#x6BD4;&#x539F;&#x5148;&#x7684;&#x7269;&#x5316;&#x89C6;&#x56FE;&#x8BED;&#x6CD5;&#xFF0C;&#x65B0;&#x589E;&#x4E86;&#x4E00;&#x4E2A;CONCURRENTLY&#x53C2;&#x6570;&#x3002; <a href="http://my.oschina.net/Kenyon/blog/407093" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
</ul>
<h4 id="&#x5176;&#x4ED6;&#x7C7B;&#x578B;">&#x5176;&#x4ED6;&#x7C7B;&#x578B;</h4><ul>
<li><strong>&#x3010;&#x8F6F;&#x4EF6;&#x3011;</strong> <a href="http://www.oschina.net/p/docker-gitlab" target="_blank" rel="external"><strong>Docker Gitlab &#x2014;&#x2014; Gitlab &#x7684; Docker &#x6620;&#x50CF;</strong></a> Docker Gitlab &#x662F;&#x63D0;&#x4F9B; Gitlab &#x73AF;&#x5883;&#x7684; Docker &#x6620;&#x50CF;&#xFF0C;&#x53EF;&#x65B9;&#x4FBF;&#x7684;&#x5728; Docker &#x5BB9;&#x5668;&#x4E2D;&#x8FD0;&#x884C; Gitlab &#x7CFB;&#x7EDF;&#x3002; <a href="http://www.oschina.net/p/docker-gitlab" target="_blank" rel="external">&#x8BE6;&#x7EC6;</a></li>
<li><strong>&#x3010;&#x8F6F;&#x4EF6;&#x3011;</strong> <a href="http://www.oschina.net/p/jphp" target="_blank" rel="external"><strong>JVM &#x7684; PHP &#x7F16;&#x8BD1;&#x5668; JPHP</strong></a> JPHP &#x662F;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E; JVM &#x7684; PHP &#x7F16;&#x8BD1;&#x5668;&#x3002;&#x652F;&#x6301; PHP 5.6+ &#x7684;&#x5F88;&#x591A;&#x65B0;&#x7279;&#x6027;&#x3002;JPHP &#x7C7B;&#x4F3C; javac &#xFF0C;&#x53EF;&#x4EE5;&#x5C06; PHP &#x6E90;&#x7801;&#x7F16;&#x8BD1;&#x6210; JVM &#x7684;&#x5B57;&#x8282;&#x7801;&#x5E76;&#x5728; JVM &#x4E2D;&#x6267;&#x884C;&#x3002; <a href="http://www.oschina.net/p/jphp" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><strong>&#x3010;&#x535A;&#x5BA2;&#x3011;</strong> <a href="http://my.oschina.net/u/1024767/blog/406566" target="_blank" rel="external"><strong>ffmpeg &#x5B9E;&#x73B0;&#x672C;&#x5730;&#x6444;&#x50CF;&#x5934;&#x7684;&#x8FDC;&#x7A0B;&#x8BBF;&#x95EE;</strong></a> fserver&#x662F;&#x4E00;&#x4E2A;&#x97F3;&#x9891;&#x548C;&#x89C6;&#x9891;&#x7684;&#x6D41;&#x5F0F;&#x670D;&#x52A1;&#x5668;&#x3002;&#x5B83;&#x901A;&#x8FC7;&#x5728;&#x542F;&#x52A8;&#x65F6;&#x8BFB;&#x5165;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5B8C;&#x6210;&#x914D;&#x7F6E;&#xFF0C;&#x4E0D;&#x6307;&#x5B9A;&#x65F6;&#x7528;&#x9ED8;&#x8BA4;&#x7684;/etc/ffserver.conf&#x6587;&#x4EF6;&#x3002; ffserver&#x63A5;&#x53D7;&#x4E00;&#x4E9B;&#x6216;&#x8005;FFM&#x6D41;&#x4F5C;&#x4E3A;&#x8F93;&#x5165;&#x7136;&#x540E;&#x901A;&#x8FC7;RTP/RTSP/HTTP&#x63A8;&#x6D41;&#x3002; <a href="http://my.oschina.net/u/1024767/blog/406566" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><strong>&#x3010;&#x535A;&#x5BA2;&#x3011;</strong> <a href="http://my.oschina.net/robinyao/blog/408285" target="_blank" rel="external"><strong>BenchMark &#x5DE5;&#x5177; - JMH &#x4ECB;&#x7ECD;</strong></a> java Benchmark&#x5DE5;&#x5177; JMH,&#x7531;OpenJDK&#x5F00;&#x53D1;&#x7684;&#xFF0C;&#x4F7F;&#x7528;&#x5F88;&#x65B9;&#x4FBF;&#x3002; <a href="http://my.oschina.net/robinyao/blog/408285" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><p><strong>&#x3010;&#x8D44;&#x8BAF;&#x3011;</strong> <a href="http://www.oschina.net/news/61986/windows-10-can-run-android-and-ios-app" target="_blank" rel="external"><strong>&#x5FAE;&#x8F6F;&#x75AF;&#x4E86;&#xFF1A;iOS/&#x5B89;&#x5353;&#x5E94;&#x7528;&#x4E00;&#x952E;&#x79FB;&#x690D;Windows 10&#xFF01;</strong></a> &#x4E00;&#x76F4;&#x4EE5;&#x6765;&#x90FD;&#x6709;&#x4F20;&#x95FB;&#x79F0;&#xFF0C;Windows 10&#x5C06;&#x4F1A;&#x517C;&#x5BB9;&#x5B89;&#x5353;&#x5E94;&#x7528;&#xFF0C;&#x8FD9;&#x770B;&#x4E0A;&#x53BB;&#x4F3C;&#x4E4E;&#x662F;&#x5929;&#x65B9;&#x591C;&#x8C2D;&#xFF0C;&#x4F46;&#x5FAE;&#x8F6F;&#x771F;&#x7684;&#x505A;&#x5230;&#x4E86;&#xFF0C;&#x4EE5;&#x4E00;&#x79CD;&#x5F88;&#x7279;&#x522B;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x800C;&#x4E14;&#x4E0D;&#x4EC5;&#x662F;&#x5B89;&#x5353;&#xFF0C;&#x8FD8;&#x6709;iOS&#xFF01; <a href="http://www.oschina.net/news/61986/windows-10-can-run-android-and-ios-app" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></p>
<p><strong>Git@OSC &#x9879;&#x76EE;&#x63A8;&#x8350;</strong></p>
</li>
<li><p><a href="https://git.oschina.net/hanguofeng/gocaptcha" target="_blank" rel="external"><strong>Git@OSC &#x9879;&#x76EE;&#x63A8;&#x8350; &#x2014;&#x2014; Go &#x8BED;&#x8A00;&#x9A8C;&#x8BC1;&#x7801;&#x670D;&#x52A1;&#x5668;</strong></a> Go &#x8BED;&#x8A00;&#x9A8C;&#x8BC1;&#x7801;&#x670D;&#x52A1;&#x5668;&#x652F;&#x6301;&#x4E2D;&#x6587;&#x9A8C;&#x8BC1;&#x7801; &#x652F;&#x6301;&#x81EA;&#x5B9A;&#x4E49;&#x8BCD;&#x5E93;&#x3001;&#x5B57;&#x5E93; &#x652F;&#x6301;&#x81EA;&#x5B9A;&#x4E49;&#x6EE4;&#x955C;&#x673A;&#x5236;&#xFF0C;&#x901A;&#x8FC7;&#x6EE4;&#x955C;&#x6765;&#x589E;&#x52A0;&#x5E72;&#x6270;&#xFF0C;&#x52A0;&#x5927;&#x8BC6;&#x522B;&#x96BE;&#x5EA6;&#x3002; <a href="https://git.oschina.net/hanguofeng/gocaptcha" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></p>
</li>
<li><a href="https://git.oschina.net/long_608/docker_wordpress" target="_blank" rel="external"><strong>Git@OSC &#x9879;&#x76EE;&#x63A8;&#x8350; &#x2014;&#x2014; WordPress &#x7684; Docker &#x6620;&#x50CF;</strong></a> &#x4F7F;&#x7528;&#x7684;wordpress&#x4E2D;&#x6587;&#x7248;&#x672C;&#xFF0C;4.1 &#x4E2D;&#x6587;&#x7248;&#x672C;&#x7684;&#x7F51;&#x7AD9;&#x4E3A;&#xFF1A; cn.wordpress.org&#x3002; <a href="https://git.oschina.net/long_608/docker_wordpress" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><a href="https://git.oschina.net/596392912/JFinal-event" target="_blank" rel="external"><strong>Git@OSC &#x9879;&#x76EE;&#x63A8;&#x8350; &#x2014;&#x2014; JFinal-event &#x6D88;&#x606F;&#x63D2;&#x4EF6;</strong></a> &#x6A21;&#x4EFF;&#x7684;Spring&#x4E2D;&#x7684;&#x6D88;&#x606F;&#x4E8B;&#x4EF6;&#xFF1A;&#x8BE6;&#x89E3;Spring&#x4E8B;&#x4EF6;&#x9A71;&#x52A8;&#x6A21;&#x578B; &#xA0;JFinalevent &#x63D2;&#x4EF6;&#xFF0C;&#x4F7F;&#x7528;&#x8BF7;&#x67E5;&#x770B;test~&#x3002; <a href="https://git.oschina.net/596392912/JFinal-event" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><a href="https://git.oschina.net/xutongle/Yui.Compressor" target="_blank" rel="external"><strong>Git@OSC &#x9879;&#x76EE;&#x63A8;&#x8350; &#x2014;&#x2014; &#x56FE;&#x5F62;&#x5316; YUI &#x538B;&#x7F29;&#x5668;</strong></a> &#x7528;C# &#x5199;&#x7684; Yui.Compressor &#x7684; GUI,&#x8FD9;&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x540C;&#x6B65;&#x5E93;&#x3002; <a href="https://git.oschina.net/xutongle/Yui.Compressor" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><a href="http://git.oschina.net/876973190/JsoupX" target="_blank" rel="external"><strong>Git@OSC &#x9879;&#x76EE;&#x63A8;&#x8350; &#x2014;&#x2014; JsoupX (JSoup &#x6269;&#x5C55;&#xFF09;</strong></a> JsoupX &#x662F;&#x4E3A;&#x94FE;&#x8BD5;&#x4F7F;&#x7528;Jsoup &#x800C;&#x5C01;&#x88C5;&#x7684;&#x5C0F;&#x5DE5;&#x5177;&#x96C6;&#xFF0C; &#x76EE;&#x7684;&#x662F;&#x4E3A;&#x5FEB;&#x6377;&#x7684;&#x8FC7;&#x8651;&#x51FA;&#x9700;&#x8981;&#x7684;&#x8282;&#x70B9;&#xFF0C;&#x65B9;&#x4FBF;&#x7F16;&#x5199;&#x6570;&#x636E;&#x6293;&#x53D6;&#x4EE3;&#x7801;&#x7B49;&#x3002; <a href="http://git.oschina.net/876973190/JsoupX" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><a href="http://git.oschina.net/mooshroom/modal" target="_blank" rel="external"><strong>Git@OSC &#x9879;&#x76EE;&#x63A8;&#x8350; &#x2014;&#x2014; &#x57FA;&#x4E8E; Avalon &#x7684;&#x5F39;&#x51FA;&#x6846;</strong></a> modal.js&#x662F;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E;avalon&#x7684;&#x5F39;&#x51FA;&#x6846;&#x7EC4;&#x4EF6;,&#x7279;&#x70B9;&#x662F;&#x4ED6;&#x4F1A;&#x5728;&#x70B9;&#x51FB;&#x89E6;&#x53D1;&#x6309;&#x94AE;&#x7684;&#x4F4D;&#x7F6E;&#x5F00;&#x59CB;&#x5F39;&#x51FA;&#x3002;&#x52A8;&#x753B;&#x57FA;&#x4E8E;css3&#x3002; <a href="http://git.oschina.net/mooshroom/modal" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
<li><a href="http://git.oschina.net/iknown/Q.js" target="_blank" rel="external"><strong>Git@OSC &#x9879;&#x76EE;&#x63A8;&#x8350; &#x2014;&#x2014; Q.js &#x7B80;&#x5355;&#x7684;js&#x5E93;</strong></a> &#x7B80;&#x5355;&#x7684;js&#x5E93;&#xFF0C; &#x7EDD;&#x5BF9;&#x5E94;&#x7528;&#x7EA7;&#x7684;&#xFF0C; &#x9664;&#x4E86;wndx&#xFF08;&#x5F39;&#x51FA;&#x7A97;&#x53E3;&#x7C7B;&#xFF09;&#x4E4B;&#x5916;&#x51E0;&#x4E4E;&#x90FD;&#x4E0D;&#x9700;&#x8981;&#x7EE7;&#x627F;&#x548C;&#x6269;&#x5C55;&#xFF0C;&#x56E0;&#x4E3A;&#x53EA;&#x6709;&#x771F;&#x6B63;&#x9700;&#x8981;&#x7684;&#x4EBA;&#x624D;&#x4F1A;&#x53BB;&#x505A;&#x6269;&#x5C55;&#x3002; <a href="http://git.oschina.net/iknown/Q.js" target="_blank" rel="external">&#x8BE6;&#x60C5;</a></li>
</ul>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Apache-HTTP-Server/">Apache HTTP Server</a><a href="/tags/GitLab/">GitLab</a><a href="/tags/开源/">开源</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/02/f482d88/" title="深入JVM内部了解Java线程的创建与执行 -" itemprop="url">深入JVM内部了解Java线程的创建与执行 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-01T23:50:30.000Z" itemprop="datePublished"> 发表于 2015-07-02</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="&#x6DF1;&#x5165;JVM&#x5185;&#x90E8;&#x4E86;&#x89E3;Java&#x7EBF;&#x7A0B;&#x7684;&#x521B;&#x5EFA;&#x4E0E;&#x6267;&#x884C;">&#x6DF1;&#x5165;JVM&#x5185;&#x90E8;&#x4E86;&#x89E3;Java&#x7EBF;&#x7A0B;&#x7684;&#x521B;&#x5EFA;&#x4E0E;&#x6267;&#x884C;</h2><p><a href="https://github.com/liuxinglanyue/blog/edit/gh-pages/_posts/2015-05-04-jvm_native_thread.markdown" target="_blank" rel="external">&#x7EA0;&#x9519;</a> 04 May 2015 </p>
<p>&#x9996;&#x5148;&#x79D1;&#x666E;&#x4E0B;linux&#x7EBF;&#x7A0B;&#x77E5;&#x8BC6;&#xFF0C;linux&#x4E0B;&#x6709;&#x4E24;&#x79CD;&#x7EBF;&#x7A0B;&#xFF0C;&#x7528;&#x6237;&#x5C42;&#x7684;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#xFF0C;&#x5185;&#x6838;&#x5C42;&#x7684;&#x5185;&#x6838;&#x7EBF;&#x7A0B;</p>
<p>&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x7684;&#x8C03;&#x5EA6;&#x662F;&#x4EE5;&#x8FDB;&#x7A0B;&#x4E3A;&#x5355;&#x4F4D;&#x7684;&#xFF0C;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x5206;&#x914D;&#x7684;&#x6267;&#x884C;&#x65F6;&#x95F4;&#x5C31;&#x5F88;&#x5C11;</p>
<p>&#x5185;&#x6838;&#x7EBF;&#x7A0B;&#x662F;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x652F;&#x6301;&#x7684;&#xFF0C;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5185;&#x6838;&#x8D1F;&#x8D23;&#x521B;&#x5EFA;&#x3001;&#x8C03;&#x5EA6;&#x548C;&#x7BA1;&#x7406;</p>
<p>&#x5BF9;pthread&#x6765;&#x8BF4;&#xFF0C; Linux&#x5185;&#x6838;2.6&#x4E4B;&#x524D;&#x662F;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#xFF0C;2.6&#x5F00;&#x59CB;&#x6539;&#x4E3A;NPTL&#x3002;</p>
<p>NPTL&#x662F;&#x4E00;&#x4E2A;1*1&#x7684;&#x7EBF;&#x7A0B;&#x5E93;&#xFF0C;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x5F53;&#x4F60;&#x4F7F;&#x7528;pthread_create()&#x8C03;&#x7528;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x540E;&#xFF0C;&#x5728;&#x5185;&#x6838;&#x91CC;&#x5C31;&#x76F8;&#x5E94;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x8C03;&#x5EA6;&#x5B9E;&#x4F53;&#xFF0C;&#x5728;linux&#x91CC;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x65B0;&#x8FDB;&#x7A0B;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x6700;&#x5927;&#x53EF;&#x80FD;&#x7684;&#x7B80;&#x5316;&#x4E86;&#x7EBF;&#x7A0B;&#x7684;&#x5B9E;&#x73B0;&#x3002;&#xFF08;&#x53C2;&#x8003; <a href="http://blog.csdn.net/guosha/article/details/2960186" target="_blank" rel="external">&#x4ECB;&#x7ECD;NPTL</a> &#xFF09; </p>
<p>—————————————————————&#x5206;&#x5272;&#x7EBF;————————————————————————</p>
<p>&#x6267;&#x884C;Thread&#x65F6;&#xFF0C;&#x4F1A;&#x8C03;&#x7528;start()&#x65B9;&#x6CD5;</p>
<pre><code><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="function"><span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> </span>{
    <span class="keyword">if</span> (threadStatus != <span class="number">0</span>)
        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalThreadStateException();
    group.add(<span class="keyword">this</span>);
    <span class="keyword">boolean</span> started = <span class="keyword">false</span>;
    <span class="keyword">try</span> {
        start0();
        started = <span class="keyword">true</span>;
    } <span class="keyword">finally</span> {
        <span class="keyword">try</span> {
            <span class="keyword">if</span> (!started) {
                group.threadStartFailed(<span class="keyword">this</span>);
            }
        } <span class="keyword">catch</span> (Throwable ignore) {
            <span class="comment">/* do nothing. If start0 threw a Throwable then
              it will be passed up the call stack */</span>
        }
    }
}
<span class="keyword">private</span> <span class="keyword">native</span> <span class="function"><span class="keyword">void</span> <span class="title">start0</span><span class="params">()</span></span>;
</code></pre><p>&#x6700;&#x7EC8;&#x4F1A;&#x8C03;&#x7528;native&#x65B9;&#x6CD5;start0()</p>
<p>Jdk&#x672C;&#x5730;&#x5B9E;&#x73B0;</p>
<p>src/share/native/java/lang/Thread.c</p>
<pre><code>static JNINativeMethod methods[] = {
    {&amp;quot;start0&amp;quot;,           &amp;quot;<span class="params">()</span>V&amp;quot;,        <span class="params">(void *)</span>&amp;amp;JVM_StartThread},
    {&amp;quot;stop0&amp;quot;,            &amp;quot;<span class="params">(&amp;quot; OBJ &amp;quot;)</span>V&amp;quot;, <span class="params">(void *)</span>&amp;amp;JVM_StopThread},
    {&amp;quot;isAlive&amp;quot;,          &amp;quot;<span class="params">()</span>Z&amp;quot;,        <span class="params">(void *)</span>&amp;amp;JVM_IsThreadAlive},
    {&amp;quot;suspend0&amp;quot;,         &amp;quot;<span class="params">()</span>V&amp;quot;,        <span class="params">(void *)</span>&amp;amp;JVM_SuspendThread},
    {&amp;quot;resume0&amp;quot;,          &amp;quot;<span class="params">()</span>V&amp;quot;,        <span class="params">(void *)</span>&amp;amp;JVM_ResumeThread},
    {&amp;quot;setPriority0&amp;quot;,     &amp;quot;<span class="params">(I)</span>V&amp;quot;,       <span class="params">(void *)</span>&amp;amp;JVM_SetThreadPriority},
    {&amp;quot;yield&amp;quot;,            &amp;quot;<span class="params">()</span>V&amp;quot;,        <span class="params">(void *)</span>&amp;amp;JVM_Yield},
    {&amp;quot;sleep&amp;quot;,            &amp;quot;<span class="params">(J)</span>V&amp;quot;,       <span class="params">(void *)</span>&amp;amp;JVM_Sleep},
    {&amp;quot;currentThread&amp;quot;,    &amp;quot;<span class="params">()</span>&amp;quot; THD,     <span class="params">(void *)</span>&amp;amp;JVM_CurrentThread},
    {&amp;quot;countStackFrames&amp;quot;, &amp;quot;<span class="params">()</span>I&amp;quot;,        <span class="params">(void *)</span>&amp;amp;JVM_CountStackFrames},
    {&amp;quot;interrupt0&amp;quot;,       &amp;quot;<span class="params">()</span>V&amp;quot;,        <span class="params">(void *)</span>&amp;amp;JVM_Interrupt},
    {&amp;quot;isInterrupted&amp;quot;,    &amp;quot;<span class="params">(Z)</span>Z&amp;quot;,       <span class="params">(void *)</span>&amp;amp;JVM_IsInterrupted},
    {&amp;quot;holdsLock&amp;quot;,        &amp;quot;<span class="params">(&amp;quot; OBJ &amp;quot;)</span>Z&amp;quot;, <span class="params">(void *)</span>&amp;amp;JVM_HoldsLock},
    {&amp;quot;getThreads&amp;quot;,        &amp;quot;<span class="params">()</span>[&amp;quot; THD,   <span class="params">(void *)</span>&amp;amp;JVM_GetAllThreads},
    {&amp;quot;dumpThreads&amp;quot;,      &amp;quot;<span class="params">([&amp;quot; THD &amp;quot;)</span>[[&amp;quot; STE, <span class="params">(void *)</span>&amp;amp;JVM_DumpThreads},
};
</code></pre><p>&#x7136;&#x540E;&#x8C03;&#x7528;JVM_StartThread src/share/vm/prims/jvm.cpp</p>
<pre><code>JVM_ENTRY(<span class="literal">void</span>, JVM_StartThread(JNIEnv<span class="subst">*</span> env, jobject jthread))
  JVMWrapper(<span class="subst">&amp;</span>quot;JVM_StartThread<span class="subst">&amp;</span>quot;);
  JavaThread <span class="subst">*</span>native_thread <span class="subst">=</span> <span class="built_in">NULL</span>;

  <span class="comment">// We cannot hold the Threads_lock when we throw an exception,</span>
  <span class="comment">// due to rank ordering issues. Example:  we might need to grab the</span>
  <span class="comment">// Heap_lock while we construct the exception.</span>
  bool throw_illegal_thread_state <span class="subst">=</span> <span class="literal">false</span>;

  <span class="comment">// We must release the Threads_lock before we can post a jvmti event</span>
  <span class="comment">// in Thread::start.</span>
  {
    <span class="comment">// Ensure that the C++ Thread and OSThread structures aren&amp;apos;t freed before</span>
    <span class="comment">// we operate.</span>
    MutexLocker mu(Threads_lock);

    <span class="comment">// Since JDK 5 the java.lang.Thread threadStatus is used to prevent</span>
    <span class="comment">// re-starting an already started thread, so we should usually find</span>
    <span class="comment">// that the JavaThread is null. However for a JNI attached thread</span>
    <span class="comment">// there is a small window between the Thread object being created</span>
    <span class="comment">// (with its JavaThread set) and the update to its threadStatus, so we</span>
    <span class="comment">// have to check for this</span>
    <span class="keyword">if</span> (java_lang_Thread<span class="tag">::thread</span>(JNIHandles<span class="tag">::resolve_non_null</span>(jthread)) <span class="subst">!=</span> <span class="built_in">NULL</span>) {
      throw_illegal_thread_state <span class="subst">=</span> <span class="literal">true</span>;
    } <span class="keyword">else</span> {
      <span class="comment">// We could also check the stillborn flag to see if this thread was already stopped, but</span>
      <span class="comment">// for historical reasons we let the thread detect that itself when it starts running</span>

      jlong size <span class="subst">=</span>
             java_lang_Thread<span class="tag">::stackSize</span>(JNIHandles<span class="tag">::resolve_non_null</span>(jthread));
      <span class="comment">// Allocate the C++ Thread structure and create the native thread.  The</span>
      <span class="comment">// stack size retrieved from java is signed, but the constructor takes</span>
      <span class="comment">// size_t (an unsigned type), so avoid passing negative values which would</span>
      <span class="comment">// result in really large stacks.</span>
      size_t sz <span class="subst">=</span> size <span class="subst">&amp;</span><span class="literal">gt</span>; <span class="number">0</span> <span class="subst">?</span> (size_t) size : <span class="number">0</span>;
      native_thread <span class="subst">=</span> <span class="literal">new</span> JavaThread(<span class="subst">&amp;</span>amp;thread_entry, sz);

      <span class="comment">// At this point it may be possible that no osthread was created for the</span>
      <span class="comment">// JavaThread due to lack of memory. Check for this situation and throw</span>
      <span class="comment">// an exception if necessary. Eventually we may want to change this so</span>
      <span class="comment">// that we only grab the lock if the thread was created successfully -</span>
      <span class="comment">// then we can also do this check and throw the exception in the</span>
      <span class="comment">// JavaThread constructor.</span>
      <span class="keyword">if</span> (native_thread<span class="subst">-&amp;</span><span class="literal">gt</span>;osthread() <span class="subst">!=</span> <span class="built_in">NULL</span>) {
        <span class="comment">// <span class="doctag"><span class="keyword">Note</span></span>: the current thread is not being used within &amp;quot;prepare&amp;quot;.</span>
        native_thread<span class="subst">-&amp;</span><span class="literal">gt</span>;prepare(jthread);
      }
    }
  }

  <span class="keyword">if</span> (throw_illegal_thread_state) {
    THROW(vmSymbols<span class="tag">::java_lang_IllegalThreadStateException</span>());
  }

  assert(native_thread <span class="subst">!=</span> <span class="built_in">NULL</span>, <span class="subst">&amp;</span>quot;Starting <span class="built_in">null</span> <span class="keyword">thread</span><span class="subst">?&amp;</span>quot;);

  <span class="keyword">if</span> (native_thread<span class="subst">-&amp;</span><span class="literal">gt</span>;osthread() <span class="subst">==</span> <span class="built_in">NULL</span>) {
    <span class="comment">// No one should hold a reference to the &amp;apos;native_thread&amp;apos;.</span>
    delete native_thread;
    <span class="keyword">if</span> (JvmtiExport<span class="tag">::should_post_resource_exhausted</span>()) {
      JvmtiExport<span class="tag">::post_resource_exhausted</span>(
        JVMTI_RESOURCE_EXHAUSTED_OOM_ERROR <span class="subst">|</span> JVMTI_RESOURCE_EXHAUSTED_THREADS,
        <span class="subst">&amp;</span>quot;unable <span class="keyword">to</span> create <span class="literal">new</span> native <span class="keyword">thread</span><span class="subst">&amp;</span>quot;);
    }
    THROW_MSG(vmSymbols<span class="tag">::java_lang_OutOfMemoryError</span>(),
              <span class="subst">&amp;</span>quot;unable <span class="keyword">to</span> create <span class="literal">new</span> native <span class="keyword">thread</span><span class="subst">&amp;</span>quot;);
  }

  <span class="keyword">Thread</span><span class="tag">::start</span>(native_thread);

JVM_END
</code></pre><p>&#x4E0A;&#x9762;&#x65B9;&#x6CD5;&#x91CC;native <em>thread = new JavaThread(&amp;thread</em> entry, sz); &#x521B;&#x5EFA;JavaThread&#xFF0C;sz&#x4E3A;&#x7EBF;&#x7A0B;&#x6808;&#x5927;&#x5C0F; </p>
<p>Thread::start(native_thread);&#x6267;&#x884C;&#x8FD9;&#x4E2A;&#x7EBF;&#x7A0B;</p>
<p>JavaThread&#x65B9;&#x6CD5;&#x5728;&#xFF1A;src/share/vm/runtime/thread.cpp</p>
<pre><code>JavaThread::JavaThread(ThreadFunction entry_point, <span class="keyword">size_t</span> stack_sz) :
  Thread()
<span class="preprocessor">#ifndef SERIALGC</span>
  , _satb_mark_queue(&amp;amp;_satb_mark_queue_set),
  _dirty_card_queue(&amp;amp;_dirty_card_queue_set)
<span class="preprocessor">#<span class="keyword">endif</span> <span class="comment">// !SERIALGC</span></span>
{
  <span class="keyword">if</span> (TraceThreadEvents) {
    tty-&amp;gt;print_cr(&amp;quot;creating thread %p&amp;quot;, <span class="keyword">this</span>);
  }
  initialize();
  _jni_attach_state = _not_attaching_via_jni;
  set_entry_point(entry_point);
  <span class="comment">// Create the native thread itself.</span>
  <span class="comment">// %<span class="doctag"><span class="keyword">note</span></span> runtime_23</span>
  os::ThreadType <span class="keyword">thr_t</span>ype = os::<span class="keyword">java_t</span>hread;
  <span class="keyword">thr_t</span>ype = entry_point == &amp;amp;<span class="keyword">compiler_t</span>hread_entry ? os::<span class="keyword">compiler_t</span>hread :
                                                     os::<span class="keyword">java_t</span>hread;
  os::<span class="keyword">create_t</span>hread(<span class="keyword">this</span>, <span class="keyword">thr_t</span>ype, stack_sz);
  _safepoint_visible = <span class="keyword">false</span>;
  <span class="comment">// The _osthread may be NULL here because we ran out of memory (too many threads active).</span>
  <span class="comment">// We need to throw and OutOfMemoryError - however we cannot do this here because the caller</span>
  <span class="comment">// may hold a lock and all locks must be unlocked before throwing the exception (throwing</span>
  <span class="comment">// the exception consists of creating the exception object &amp;amp; initializing it, initialization</span>
  <span class="comment">// will leave the VM via a JavaCall and then all locks must be unlocked).</span>
  <span class="comment">//</span>
  <span class="comment">// The thread is still suspended when we reach here. Thread must be explicit started</span>
  <span class="comment">// by creator! Furthermore, the thread must also explicitly be added to the Threads list</span>
  <span class="comment">// by calling Threads:add. The reason why this is not done here, is because the thread</span>
  <span class="comment">// object must be fully initialized (take a look at JVM_Start)</span>
}
</code></pre><p>&#x4E0A;&#x9762;&#x65B9;&#x6CD5;&#x4E2D;os::create <em>thread(this, thr</em> type, stack_sz);&#x8C03;&#x7528;os&#x521B;&#x5EFA;&#x7EBF;&#x7A0B; </p>
<pre><code>void Thread::<span class="operator"><span class="keyword">start</span>(Thread* thread) {
  trace(&amp;quot;</span><span class="operator"><span class="keyword">start</span>&amp;quot;</span>, thread);
  // <span class="operator"><span class="keyword">Start</span> <span class="keyword">is</span> different <span class="keyword">from</span> resume <span class="keyword">in</span> that its safety <span class="keyword">is</span> guaranteed <span class="keyword">by</span> context <span class="keyword">or</span>
  // being called <span class="keyword">from</span> a Java method synchronized <span class="keyword">on</span> the Thread object.
  <span class="keyword">if</span> (!DisableStartThread) {
    <span class="keyword">if</span> (thread-&amp;gt;</span>is_Java_thread()) {
      // Initialize the thread state to RUNNABLE before starting this thread.
      // Can not <span class="operator"><span class="keyword">set</span> it <span class="keyword">after</span> the thread started because we <span class="keyword">do</span> <span class="keyword">not</span> know the
      // exact thread state <span class="keyword">at</span> that <span class="keyword">time</span>. It could be <span class="keyword">in</span> MONITOR_WAIT <span class="keyword">or</span>
      // <span class="keyword">in</span> SLEEPING <span class="keyword">or</span> <span class="keyword">some</span> other state.
      java_lang_Thread::set_thread_status(((JavaThread*)thread)-&amp;gt;</span>threadObj(),
                                          java_lang_Thread::RUNNABLE);
    }
    os::start_thread(thread);
  }
}
</code></pre><p>&#x8FD9;&#x91CC;&#x8C03;&#x7528;os::start_thread(thread);&#x6267;&#x884C;&#x7EBF;&#x7A0B;</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x770B;&#x4E0B;os::create_thread&#x7684;&#x5B9E;&#x73B0;</p>
<p>src/os/linux/vm/os_linux.cpp</p>
<p>src/os/bsd/vm/os_bsd.cpp</p>
<p>src/os/posix/vm/os_posix.cpp</p>
<p>src/os/solaris/vm/os_solaris.cpp</p>
<p>src/os/windows/vm/os_windows.cpp</p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x53EA;&#x770B;&#x4E0B;linux&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x4EE3;&#x7801;&#x6709;&#x4E9B;&#x957F;</p>
<p>int ret = pthread_create(&amp;tid, &amp;attr, (void<em> (</em>)(void*)) java_start, thread);</p>
<p>&#x73A9;linux&#x7684;&#x90FD;&#x77E5;&#x9053;pthread.h&#xFF0C;&#x4E0D;&#x591A;&#x8BF4;</p>
<pre><code>bool os<span class="tag">::create_thread</span>(<span class="keyword">Thread</span><span class="subst">*</span> <span class="keyword">thread</span>, ThreadType thr_type, size_t stack_size) {
  assert(<span class="keyword">thread</span><span class="subst">-&amp;</span><span class="literal">gt</span>;osthread() <span class="subst">==</span> <span class="built_in">NULL</span>, <span class="subst">&amp;</span>quot;caller responsible<span class="subst">&amp;</span>quot;);

  <span class="comment">// Allocate the OSThread object</span>
  OSThread<span class="subst">*</span> osthread <span class="subst">=</span> <span class="literal">new</span> OSThread(<span class="built_in">NULL</span>, <span class="built_in">NULL</span>);
  <span class="keyword">if</span> (osthread <span class="subst">==</span> <span class="built_in">NULL</span>) {
    <span class="keyword">return</span> <span class="literal">false</span>;
  }

  <span class="comment">// set the correct thread state</span>
  osthread<span class="subst">-&amp;</span><span class="literal">gt</span>;set_thread_type(thr_type);

  <span class="comment">// Initial state is ALLOCATED but not INITIALIZED</span>
  osthread<span class="subst">-&amp;</span><span class="literal">gt</span>;set_state(ALLOCATED);

  <span class="keyword">thread</span><span class="subst">-&amp;</span><span class="literal">gt</span>;set_osthread(osthread);

  <span class="comment">// init thread attributes</span>
  pthread_attr_t attr;
  pthread_attr_init(<span class="subst">&amp;</span>amp;attr);
  pthread_attr_setdetachstate(<span class="subst">&amp;</span>amp;attr, PTHREAD_CREATE_DETACHED);

  <span class="comment">// stack size</span>
  <span class="keyword">if</span> (os<span class="tag">::Linux</span><span class="tag">::supports_variable_stack_size</span>()) {
    <span class="comment">// calculate stack size if it&amp;apos;s not specified by caller</span>
    <span class="keyword">if</span> (stack_size <span class="subst">==</span> <span class="number">0</span>) {
      stack_size <span class="subst">=</span> os<span class="tag">::Linux</span><span class="tag">::default_stack_size</span>(thr_type);

      switch (thr_type) {
      <span class="keyword">case</span> os<span class="tag">::java_thread</span>:
        <span class="comment">// Java threads use ThreadStackSize which default value can be</span>
        <span class="comment">// changed with the flag -Xss</span>
        assert (JavaThread<span class="tag">::stack_size_at_create</span>() <span class="subst">&amp;</span><span class="literal">gt</span>; <span class="number">0</span>, <span class="subst">&amp;</span>quot;this should be <span class="built_in">set</span><span class="subst">&amp;</span>quot;);
        stack_size <span class="subst">=</span> JavaThread<span class="tag">::stack_size_at_create</span>();
        break;
      <span class="keyword">case</span> os<span class="tag">::compiler_thread</span>:
        <span class="keyword">if</span> (CompilerThreadStackSize <span class="subst">&amp;</span><span class="literal">gt</span>; <span class="number">0</span>) {
          stack_size <span class="subst">=</span> (size_t)(CompilerThreadStackSize <span class="subst">*</span> K);
          break;
        } <span class="comment">// else fall through:</span>
          <span class="comment">// use VMThreadStackSize if CompilerThreadStackSize is not defined</span>
      <span class="keyword">case</span> os<span class="tag">::vm_thread</span>:
      <span class="keyword">case</span> os<span class="tag">::pgc_thread</span>:
      <span class="keyword">case</span> os<span class="tag">::cgc_thread</span>:
      <span class="keyword">case</span> os<span class="tag">::watcher_thread</span>:
        <span class="keyword">if</span> (VMThreadStackSize <span class="subst">&amp;</span><span class="literal">gt</span>; <span class="number">0</span>) stack_size <span class="subst">=</span> (size_t)(VMThreadStackSize <span class="subst">*</span> K);
        break;
      }
    }

    stack_size <span class="subst">=</span> MAX2(stack_size, os<span class="tag">::Linux</span><span class="tag">::min_stack_allowed</span>);
    pthread_attr_setstacksize(<span class="subst">&amp;</span>amp;attr, stack_size);
  } <span class="keyword">else</span> {
    <span class="comment">// let pthread_create() pick the default value.</span>
  }

  <span class="comment">// glibc guard page</span>
  pthread_attr_setguardsize(<span class="subst">&amp;</span>amp;attr, os<span class="tag">::Linux</span><span class="tag">::default_guard_size</span>(thr_type));

  ThreadState state;

  {
    <span class="comment">// Serialize thread creation if we are running with fixed stack LinuxThreads</span>
    bool lock <span class="subst">=</span> os<span class="tag">::Linux</span><span class="tag">::is_LinuxThreads</span>() <span class="subst">&amp;</span>amp;<span class="subst">&amp;</span>amp; <span class="subst">!</span>os<span class="tag">::Linux</span><span class="tag">::is_floating_stack</span>();
    <span class="keyword">if</span> (lock) {
      os<span class="tag">::Linux</span><span class="tag">::createThread_lock</span>()<span class="subst">-&amp;</span><span class="literal">gt</span>;lock_without_safepoint_check();
    }

    pthread_t tid;
    int ret <span class="subst">=</span> pthread_create(<span class="subst">&amp;</span>amp;tid, <span class="subst">&amp;</span>amp;attr, (<span class="literal">void</span><span class="subst">*</span> (<span class="subst">*</span>)(<span class="literal">void</span><span class="subst">*</span>)) java_start, <span class="keyword">thread</span>);

    pthread_attr_destroy(<span class="subst">&amp;</span>amp;attr);

    <span class="keyword">if</span> (ret <span class="subst">!=</span> <span class="number">0</span>) {
      <span class="keyword">if</span> (PrintMiscellaneous <span class="subst">&amp;</span>amp;<span class="subst">&amp;</span>amp; (Verbose <span class="subst">||</span> WizardMode)) {
        perror(<span class="subst">&amp;</span>quot;pthread_create()<span class="subst">&amp;</span>quot;);
      }
      <span class="comment">// Need to clean up stuff we&amp;apos;ve allocated so far</span>
      <span class="keyword">thread</span><span class="subst">-&amp;</span><span class="literal">gt</span>;set_osthread(<span class="built_in">NULL</span>);
      delete osthread;
      <span class="keyword">if</span> (lock) os<span class="tag">::Linux</span><span class="tag">::createThread_lock</span>()<span class="subst">-&amp;</span><span class="literal">gt</span>;unlock();
      <span class="keyword">return</span> <span class="literal">false</span>;
    }

    <span class="comment">// Store pthread info into the OSThread</span>
    osthread<span class="subst">-&amp;</span><span class="literal">gt</span>;set_pthread_id(tid);

    <span class="comment">// Wait until child thread is either initialized or aborted</span>
    {
      Monitor<span class="subst">*</span> sync_with_child <span class="subst">=</span> osthread<span class="subst">-&amp;</span><span class="literal">gt</span>;startThread_lock();
      MutexLockerEx ml(sync_with_child, Mutex<span class="tag">::_no_safepoint_check_flag</span>);
      <span class="keyword">while</span> ((state <span class="subst">=</span> osthread<span class="subst">-&amp;</span><span class="literal">gt</span>;get_state()) <span class="subst">==</span> ALLOCATED) {
        sync_with_child<span class="subst">-&amp;</span><span class="literal">gt</span>;wait(Mutex<span class="tag">::_no_safepoint_check_flag</span>);
      }
    }

    <span class="keyword">if</span> (lock) {
      os<span class="tag">::Linux</span><span class="tag">::createThread_lock</span>()<span class="subst">-&amp;</span><span class="literal">gt</span>;unlock();
    }
  }

  <span class="comment">// Aborted due to thread limit being reached</span>
  <span class="keyword">if</span> (state <span class="subst">==</span> ZOMBIE) {
      <span class="keyword">thread</span><span class="subst">-&amp;</span><span class="literal">gt</span>;set_osthread(<span class="built_in">NULL</span>);
      delete osthread;
      <span class="keyword">return</span> <span class="literal">false</span>;
  }

  <span class="comment">// The thread is returned suspended (in state INITIALIZED),</span>
  <span class="comment">// and is started higher up in the call chain</span>
  assert(state <span class="subst">==</span> INITIALIZED, <span class="subst">&amp;</span>quot;race condition<span class="subst">&amp;</span>quot;);
  <span class="keyword">return</span> <span class="literal">true</span>;
}
</code></pre><p>&#x8FD9;&#x91CC;&#x6709;&#x4E2A;&#x65B9;&#x6CD5;&#x4E5F;&#x8D34;&#x4E00;&#x4E0B;</p>
<pre><code><span class="comment">// The first routine called by a new Java thread</span>
<span class="keyword">void</span> JavaThread::run() {
  <span class="comment">// initialize thread-local alloc buffer related fields</span>
  <span class="keyword">this</span>-&amp;gt;<span class="keyword">initialize_t</span>lab();

  <span class="comment">// used to test validitity of stack trace backs</span>
  <span class="keyword">this</span>-&amp;gt;record_base_of_stack_pointer();

  <span class="comment">// Record real stack base and size.</span>
  <span class="keyword">this</span>-&amp;gt;record_stack_base_and_size();

  <span class="comment">// Initialize thread local storage; set before calling MutexLocker</span>
  <span class="keyword">this</span>-&amp;gt;<span class="keyword">initialize_t</span>hread_local_storage();

  <span class="keyword">this</span>-&amp;gt;create_stack_guard_pages();

  <span class="keyword">this</span>-&amp;gt;cache_global_variables();

  <span class="comment">// Thread is now sufficient initialized to be handled by the safepoint code as being</span>
  <span class="comment">// in the VM. Change thread state from _thread_new to _thread_in_vm</span>
  ThreadStateTransition::transition_and_fence(<span class="keyword">this</span>, <span class="keyword">_t</span>hread_new, <span class="keyword">_t</span>hread_in_vm);

  assert(JavaThread::current() == <span class="keyword">this</span>, &amp;quot;sanity check&amp;quot;);
  assert(!Thread::current()-&amp;gt;owns_locks(), &amp;quot;sanity check&amp;quot;);

  DTRACE_THREAD_PROBE(start, <span class="keyword">this</span>);

  <span class="comment">// This operation might block. We call that after all safepoint checks for a new thread has</span>
  <span class="comment">// been completed.</span>
  <span class="keyword">this</span>-&amp;gt;set_active_handles(JNIHandleBlock::allocate_block());

  <span class="keyword">if</span> (JvmtiExport::<span class="keyword">should_post_t</span>hread_life()) {
    JvmtiExport::<span class="keyword">post_t</span>hread_start(<span class="keyword">this</span>);
  }

  EventThreadStart event;
  <span class="keyword">if</span> (event.should_commit()) {
     event.set_javalangthread(java_lang_Thread::thread_id(<span class="keyword">this</span>-&amp;gt;threadObj()));
     event.commit();
  }

  <span class="comment">// We call another function to do the rest so we are sure that the stack addresses used</span>
  <span class="comment">// from there will be lower than the stack base just computed</span>
  thread_main_inner();

  <span class="comment">// <span class="doctag">Note</span>, thread is no longer valid at this point!</span>
}
</code></pre>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/JVM/">JVM</a><a href="/tags/线程/">线程</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/02/f40a743/" title="Java 性能优化手册 — 提高 Java 代码性能的各种技巧 -" itemprop="url">Java 性能优化手册 — 提高 Java 代码性能的各种技巧 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-01T23:50:29.000Z" itemprop="datePublished"> 发表于 2015-07-02</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p> (&#x70B9;&#x51FB;&#x4E0A;&#x65B9;  &#x516C;&#x4F17;&#x53F7;  &#xFF0C;&#xFFFD;&#xFFFD;&#xFFFD;&#x5FEB;&#x901F;&#x5173;&#x6CE8;)</p>
<h4 id="Java_6,7,8_&#x4E2D;&#x7684;_String-intern_&#x2013;_&#x5B57;&#x7B26;&#x4E32;&#x6C60;">Java 6,7,8 &#x4E2D;&#x7684; String.intern &#x2013; &#x5B57;&#x7B26;&#x4E32;&#x6C60;</h4><p>&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x5C06;&#x8981;&#x8BA8;&#x8BBA; Java 6 &#x4E2D;&#x662F;&#x5982;&#x4F55;&#x5B9E;&#x73B0; String.intern &#x65B9;&#x6CD5;&#x7684;&#xFF0C;&#x4EE5;&#x53CA;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x5728; Java 7 &#x4EE5;&#x53CA; Java 8 &#x4E2D;&#x505A;&#x4E86;&#x54EA;&#x4E9B;&#x8C03;&#x6574;&#x3002;</p>
<h4 id="&#x5B57;&#x7B26;&#x4E32;&#x6C60;">&#x5B57;&#x7B26;&#x4E32;&#x6C60;</h4><p>&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#xFF08;&#x6709;&#x540D;&#x5B57;&#x7B26;&#x4E32;&#x6807;&#x51C6;&#x5316;&#xFF09;&#x662F;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x552F;&#x4E00;&#x7684;&#x5171;&#x4EAB; String &#x5BF9;&#x8C61;&#x6765;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x503C;&#x4E0D;&#x540C;&#x7684;&#x5730;&#x5740;&#x8868;&#x793A;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x8FC7;&#x7A0B;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x81EA;&#x5DF1;&#x5B9A;&#x4E49;&#x7684; Map&lt;String, String&gt; &#xFF08;&#x6839;&#x636E;&#x9700;&#x8981;&#x4F7F;&#x7528; weak &#x5F15;&#x7528;&#x6216;&#x8005; soft &#x5F15;&#x7528;&#xFF09;&#x5E76;&#x4F7F;&#x7528; map &#x4E2D;&#x7684;&#x503C;&#x4F5C;&#x4E3A;&#x6807;&#x51C6;&#x503C;&#x6765;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x76EE;&#x6807;&#xFF0C;&#x6216;&#x8005;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; JDK &#x63D0;&#x4F9B;&#x7684; String.intern()&#x3002;</p>
<p>&#x5F88;&#x591A;&#x6807;&#x51C6;&#x7981;&#x6B62;&#x5728; Java 6 &#x4E2D;&#x4F7F;&#x7528; String.intern() &#x56E0;&#x4E3A;&#x5982;&#x679C;&#x9891;&#x7E41;&#x4F7F;&#x7528;&#x6C60;&#x4F1A;&#x5E02;&#x533A;&#x63A7;&#x5236;&#xFF0C;&#x6709;&#x5F88;&#x5927;&#x7684;&#x51E0;&#x7387;&#x89E6;&#x53D1; OutOfMemoryException&#x3002;Oracle Java 7 &#x5BF9;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x505A;&#x4E86;&#x5F88;&#x591A;&#x6539;&#x8FDB;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4EE5;&#x4E0B;&#x5730;&#x5740;&#x8FDB;&#x884C;&#x4E86;&#x89E3; <a href="http://bugs.sun.com/view_bug.do?bug_id=6962931&#x4EE5;&amp;#x53CA" target="_blank" rel="external">http://bugs.sun.com/view_bug.do?bug_id=6962931&#x4EE5;&amp;#x53CA</a>; <a href="http://bugs.sun.com/view_bug.do?bug_id=6962930" target="_blank" rel="external">http://bugs.sun.com/view_bug.do?bug_id=6962930</a></p>
<h4 id="Java_6_&#x4E2D;&#x7684;_String-intern()">Java 6 &#x4E2D;&#x7684; String.intern()</h4><p>&#x5728;&#x7F8E;&#x597D;&#x7684;&#x8FC7;&#x53BB;&#x6240;&#x6709;&#x5171;&#x4EAB;&#x7684; String &#x5BF9;&#x8C61;&#x90FD;&#x5B58;&#x50A8;&#x5728; PermGen &#x4E2D; &#x2014; &#x5806;&#x4E2D;&#x56FA;&#x5B9A;&#x5927;&#x5C0F;&#x7684;&#x90E8;&#x5206;&#x4E3B;&#x8981;&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x52A0;&#x8F7D;&#x7684;&#x7C7B;&#x5BF9;&#x8C61;&#x548C;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x3002;&#x9664;&#x4E86;&#x660E;&#x786E;&#x7684;&#x5171;&#x4EAB;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;PermGen &#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x8FD8;&#x5305;&#x542B;&#x6240;&#x6709;&#x7A0B;&#x5E8F;&#x4E2D;&#x4F7F;&#x7528;&#x8FC7;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF08;&#x8FD9;&#x91CC;&#x8981;&#x6CE8;&#x610F;&#x662F;&#x4F7F;&#x7528;&#x8FC7;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5982;&#x679C;&#x7C7B;&#x6216;&#x8005;&#x65B9;&#x6CD5;&#x4ECE;&#x672A;&#x52A0;&#x8F7D;&#x6216;&#x8005;&#x88AB;&#x6761;&#x7528;&#xFF0C;&#x5728;&#x5176;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x4EFB;&#x4F55;&#x5E38;&#x91CF;&#x90FD;&#x4E0D;&#x4F1A;&#x88AB;&#x52A0;&#x8F7D;&#xFF09;</p>
<p>Java 6 &#x4E2D;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x7684;&#x6700;&#x5927;&#x95EE;&#x9898;&#x662F;&#x5B83;&#x7684;&#x4F4D;&#x7F6E; &#x2014; PermGen&#x3002;PermGen &#x7684;&#x5927;&#x5C0F;&#x662F;&#x56FA;&#x5B9A;&#x7684;&#x5E76;&#x4E14;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x662F;&#x65E0;&#x6CD5;&#x6269;&#x5C55;&#x7684;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; -XX:MaxPermSize=N &#x914D;&#x7F6E;&#x6765;&#x8C03;&#x6574;&#x5B83;&#x7684;&#x5927;&#x5C0F;&#x3002;&#x636E;&#x6211;&#x4E86;&#x89E3;&#xFF0C;&#x5BF9;&#x4E8E;&#x4E0D;&#x540C;&#x7684;&#x5E73;&#x53F0;&#x9ED8;&#x8BA4;&#x7684; PermGen &#x5927;&#x5C0F;&#x5728; 32M &#x5230; 96M &#x4E4B;&#x95F4;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x6269;&#x5C55;&#x5B83;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x4E0D;&#x8FC7;&#x5927;&#x5C0F;&#x4F7F;&#x7528;&#x90FD;&#x662F;&#x56FA;&#x5B9A;&#x7684;&#x3002;&#x8FD9;&#x4E2A;&#x9650;&#x5236;&#x9700;&#x8981;&#x4F60;&#x5728;&#x4F7F;&#x7528; String.intern &#x65F6;&#x9700;&#x8981;&#x975E;&#x5E38;&#x5C0F;&#x5FC3; &#x2014; &#x4F60;&#x6700;&#x597D;&#x4E0D;&#x8981;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5; intern &#x4EFB;&#x4F55;&#x65E0;&#x6CD5;&#x63A7;&#x5236;&#x7684;&#x7528;&#x6237;&#x8F93;&#x5165;&#x3002;&#x8FD9;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#x5728; JAVA6 &#x4E2D;&#x5927;&#x90E8;&#x5206;&#x4F7F;&#x7528;&#x624B;&#x52A8;&#x7BA1;&#x7406; Map &#x6765;&#x5B9E;&#x73B0;&#x5B57;&#x7B26;&#x4E32;&#x6C60;</p>
<h4 id="Java_7_&#x4E2D;&#x7684;_String-intern()">Java 7 &#x4E2D;&#x7684; String.intern()</h4><p>Java 7 &#x4E2D; Oracle &#x7684;&#x5DE5;&#x7A0B;&#x5E08;&#x5BF9;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x7684;&#x903B;&#x8F91;&#x505A;&#x4E86;&#x5F88;&#x5927;&#x7684;&#x6539;&#x53D8; &#x2014; &#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x7684;&#x4F4D;&#x7F6E;&#x88AB;&#x8C03;&#x6574;&#x5230; heap &#x4E2D;&#x4E86;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x4F60;&#x518D;&#x4E5F;&#x4E0D;&#x4F1A;&#x88AB;&#x56FA;&#x5B9A;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x9650;&#x5236;&#x4E86;&#x3002;&#x6240;&#x6709;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x90FD;&#x4FDD;&#x5B58;&#x5728;&#x5806;&#xFF08;heap&#xFF09;&#x4E2D;&#x540C;&#x5176;&#x4ED6;&#x666E;&#x901A;&#x5BF9;&#x8C61;&#x4E00;&#x6837;&#xFF0C;&#x8FD9;&#x4F7F;&#x5F97;&#x4F60;&#x5728;&#x8C03;&#x4F18;&#x5E94;&#x7528;&#x65F6;&#x4EC5;&#x9700;&#x8981;&#x8C03;&#x6574;&#x5806;&#x5927;&#x5C0F;&#x3002;&#x8FD9; &#x4E2A;&#x6539;&#x52A8;&#x4F7F;&#x5F97;&#x6211;&#x4EEC;&#x6709;&#x8DB3;&#x591F;&#x7684;&#x7406;&#x7531;&#x8BA9;&#x6211;&#x4EEC;&#x91CD;&#x65B0;&#x8003;&#x8651;&#x5728; Java 7 &#x4E2D;&#x4F7F;&#x7528; String.intern()&#x3002;</p>
<h4 id="&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x4F1A;&#x88AB;&#x5783;&#x573E;&#x6536;&#x96C6;">&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x4F1A;&#x88AB;&#x5783;&#x573E;&#x6536;&#x96C6;</h4><p>&#x6CA1;&#x9519;&#xFF0C;&#x5728; JVM &#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5B57;&#x7B26;&#x4E32;&#x4F1A;&#x88AB;&#x5783;&#x573E;&#x6536;&#x96C6;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x4E9B;&#x503C;&#x5728;&#x5E94;&#x7528;&#x4E2D;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5F15;&#x7528;&#x3002;&#x8FD9;&#x662F;&#x7528;&#x4E8E;&#x6240;&#x6709;&#x7248;&#x672C;&#x7684; Java&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5982;&#x679C; interned &#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5728;&#x4F5C;&#x7528;&#x57DF;&#x5916;&#x5E76;&#x4E14;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5F15;&#x7528; &#x2014; &#x5B83;&#x5C06;&#x4F1A;&#x4ECE; JVM &#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x4E2D;&#x88AB;&#x5783;&#x573E;&#x6536;&#x96C6;&#x6389;&#x3002;</p>
<p>&#x56E0;&#x4E3A;&#x88AB;&#x91CD;&#x65B0;&#x5B9A;&#x4F4D;&#x5230;&#x5806;&#x4E2D;&#x4EE5;&#x53CA;&#x4F1A;&#x88AB;&#x5783;&#x573E;&#x6536;&#x96C6;&#xFF0C;JVM &#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x770B;&#x4E0A;&#x53BB;&#x662F;&#x5B58;&#x653E;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5408;&#x9002;&#x4F4D;&#x7F6E;&#xFF0C;&#x662F;&#x5417;&#xFF1F;&#x7406;&#x8BBA;&#x4E0A;&#x662F; &#x2014; &#x8FDD;&#x80CC;&#x4F7F;&#x7528;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4F1A;&#x4ECE;&#x6C60;&#x4E2D;&#x6536;&#x96C6;&#x6389;&#xFF0C;&#x5F53;&#x5916;&#x90E8;&#x8F93;&#x5165;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4F20;&#x4E14;&#x6C60;&#x4E2D;&#x5B58;&#x5728;&#x65F6;&#x53EF;&#x4EE5;&#x8282;&#x7701;&#x5185;&#x5B58;&#x3002;&#x770B;&#x8D77;&#x6765;&#x662F;&#x4E00;&#x4E2A;&#x5B8C;&#x7F8E;&#x7684;&#x8282;&#x7701;&#x5185;&#x5B58;&#x7684;&#x7B56;&#x7565;&#xFF1F;&#x5728;&#x4F60;&#x56DE;&#x7B54;&#x8FD9;&#x4E2A;&#x4E4B;&#x524D;&#xFF0C;&#x53EF;&#x4EE5;&#x80AF;&#x5B9A;&#x7684;&#x662F;&#x4F60; &#x9700;&#x8981;&#x77E5;&#x9053;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x662F;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x7684;&#x3002;</p>
<h4 id="&#x5728;_Java_6&#xFF0C;7&#xFF0C;8_&#x4E2D;_JVM_&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x7684;&#x5B9E;&#x73B0;">&#x5728; Java 6&#xFF0C;7&#xFF0C;8 &#x4E2D; JVM &#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x7684;&#x5B9E;&#x73B0;</h4><p>&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x662F;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x62E5;&#x6709;&#x56FA;&#x5B9A;&#x5BB9;&#x91CF;&#x7684; HashMap &#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x5305;&#x542B;&#x5177;&#x6709;&#x76F8;&#x540C; hash &#x503C;&#x7684;&#xFFFD;&#xFFFD;&#xFFFD;&#x7B26;&#x4E32;&#x5217;&#x8868;&#x3002;&#x4E00;&#x4E9B;&#x5B9E;&#x73B0;&#x7684;&#x7EC6;&#x8282;&#x53EF;&#x4EE5;&#x4ECE; Java bug &#x62A5;&#x544A;&#x4E2D;&#x83B7;&#x5F97; <a href="http://bugs.sun.com/view_bug.do?bug_id=6962930" target="_blank" rel="external">http://bugs.sun.com/view_bug.do?bug_id=6962930</a></p>
<p>&#x9ED8;&#x8BA4;&#x7684;&#x6C60;&#x5927;&#x5C0F;&#x662F; 1009 (&#x51FA;&#x73B0;&#x5728;&#x4E0A;&#x9762;&#x63D0;&#x53CA;&#x7684; bug &#x62A5;&#x544A;&#x7684;&#x6E90;&#x7801;&#x4E2D;&#xFF0C;&#x5728; Java7u40 &#x4E2D;&#x589E;&#x52A0;&#x4E86;)&#x3002;&#x5728; JAVA 6 &#x65E9;&#x671F;&#x7248;&#x672C;&#x4E2D;&#x662F;&#x4E00;&#x4E2A;&#x5E38;&#x91CF;&#xFF0C;&#x5728;&#x968F;&#x540E;&#x7684; java6u30 &#x81F3; java6u41 &#x4E2D;&#x8C03;&#x6574;&#x4E3A;&#x53EF;&#x914D;&#x7F6E;&#x7684;&#x3002;&#x800C;&#x5728;java 7&#x4E2D;&#x4E00;&#x5F00;&#x59CB;&#x5C31;&#x662F;&#x53EF;&#x4EE5;&#x914D;&#x7F6E;&#x7684;&#xFF08;&#x81F3;&#x5C11;&#x5728;java7u02&#x4E2D;&#x662F;&#x53EF;&#x4EE5;&#x914D;&#x7F6E;&#x7684;&#xFF09;&#x3002;&#x4F60;&#x9700;&#x8981;&#x6307;&#x5B9A;&#x53C2;&#x6570; -XX:StringTableSize=N, N &#x662F;&#x5B57;&#x7B26;&#x4E32;&#x6C60; Map &#x7684;&#x5927;&#x5C0F;&#x3002;&#x786E;&#x4FDD;&#x5B83;&#x662F;&#x4E3A;&#x6027;&#x80FD;&#x8C03;&#x4F18;&#x800C;&#x9884;&#x5148;&#x51C6;&#x5907;&#x7684;&#x5927;&#x5C0F;&#x3002;</p>
<p>&#x5728; Java 6 &#x4E2D;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x6CA1;&#x6709;&#x592A;&#x591A;&#x5E2E;&#x52A9;&#xFF0C;&#x56E0;&#x4E3A;&#x4F60;&#x4ECD;&#x4EFB;&#x88AB;&#x9650;&#x5236;&#x5728;&#x56FA;&#x5B9A;&#x7684; PermGen &#x5185;&#x5B58;&#x5927;&#x5C0F;&#x4E2D;&#x3002;&#x540E;&#x7EED;&#x7684;&#x8BA8;&#x8BBA;&#x5C06;&#x76F4;&#x63A5;&#x5FFD;&#x7565; Java 6</p>
<h4 id="Java_7_&#xFF08;&#x76F4;&#x81F3;_Java7u40&#xFF09;">Java 7 &#xFF08;&#x76F4;&#x81F3; Java7u40&#xFF09;</h4><p>&#x5728; Java7 &#x4E2D;&#xFF0C;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x4F60;&#x88AB;&#x9650;&#x5236;&#x5728;&#x4E00;&#x4E2A;&#x66F4;&#x5927;&#x7684;&#x5806;&#x5185;&#x5B58;&#x4E2D;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x4F60;&#x53EF;&#x4EE5;&#x9884;&#x5148;&#x8BBE;&#x7F6E;&#x597D; String &#x6C60;&#x7684;&#x5927;&#x5C0F;&#xFF08;&#x8FD9;&#x4E2A;&#x503C;&#x53D6;&#x51B3;&#x4E8E;&#x4F60;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9700;&#x6C42;&#xFF09;&#x3002;&#x901A;&#x5E38;&#x8BF4;&#x6765;&#xFF0C;&#x4E00;&#x65E6;&#x7A0B;&#x5E8F;&#x5F00;&#x59CB;&#x5185;&#x5B58;&#x6D88;&#x8017;&#xFF0C;&#x5185;&#x5B58;&#x90FD;&#x662F;&#x6210;&#x767E;&#x5146;&#x7684;&#x589E;&#x957F;&#xFF0C;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x7ED9;&#x4E00;&#x4E2A;&#x62E5;&#x6709; 100 &#x4E07;&#x5B57;&#x7B26;&#x4E32;&#x5BF9;&#x8C61;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x5206;&#x914D; 8-16M &#x7684;&#x5185;&#x5B58;&#x770B;&#x8D77;&#x6765;&#x662F;&#x6BD4;&#x8F83;&#x9002;&#x5408;&#x7684;&#xFF08;&#x4E0D;&#x8981;&#x4F7F;&#x7528;1,000,000 &#x4F5C;&#x4E3A; -XX:StringTaleSize &#x7684;&#x503C; &#x2013; &#x5B83;&#x4E0D;&#x662F;&#x8D28;&#x6570;&#xFF1B;&#x4F7F;&#x7528; 1,000,003&#x4EE3;&#x66FF;&#xFF09;</p>
<p>&#x4F60;&#x53EF;&#x80FD;&#x671F;&#x5F85;&#x5173;&#x4E8E; String &#x5728; Map &#x4E2D;&#x7684;&#x5206;&#x914D; &#x2014; &#x53EF;&#x4EE5;&#x9605;&#x8BFB;&#x6211;&#x4E4B;&#x524D;&#x5173;&#x4E8E; HashCode &#x65B9;&#x6CD5;&#x8C03;&#x4F18;&#x7684;&#x7ECF;&#x9A8C;&#x3002;</p>
<p>&#x4F60;&#x5FC5;&#x987B;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x66F4;&#x5927;&#x7684; -XX:StringTalbeSize &#x503C;(&#x76F8;&#x6BD4;&#x8F83;&#x9ED8;&#x8BA4;&#x7684; 1009 ),&#x5982;&#x679C;&#x4F60;&#x5E0C;&#x671B;&#x66F4;&#x591A;&#x7684;&#x4F7F;&#x7528; String.intern() &#x2014; &#x5426;&#x5219;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x5C06;&#x5F88;&#x5FEB;&#x9012;&#x51CF;&#x5230; 0 &#xFF08;&#x6C60;&#x5927;&#x5C0F;&#xFF09;&#x3002;</p>
<p>&#x6211;&#x6CA1;&#x6709;&#x6CE8;&#x610F;&#x5230;&#x5728; intern &#x5C0F;&#x4E8E; 100 &#x5B57;&#x7B26;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x65F6;&#x7684;&#x4F9D;&#x8D56;&#x60C5;&#x51B5;&#xFF08;&#x6211;&#x8BA4;&#x4E3A;&#x5728;&#x4E00;&#x4E2A;&#x5305;&#x542B; 50 &#x4E2A;&#x91CD;&#x590D;&#x5B57;&#x7B26;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E0E;&#x73B0;&#x5B9E;&#x6570;&#x636E;&#x5E76;&#x4E0D;&#x76F8;&#x4F3C;&#xFF0C;&#x56E0;&#x6B64; 100 &#x4E2A;&#x5B57;&#x7B26;&#x770B;&#x4E0A;&#x53BB;&#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x597D;&#x7684;&#x6D4B;&#x8BD5;&#x9650;&#x5236;&#xFF09;</p>
<p>&#x4E0B;&#x9762;&#x662F;&#x9ED8;&#x8BA4;&#x6C60;&#x5927;&#x5C0F;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x65E5;&#x5FD7;&#xFF1A;&#x7B2C;&#x4E00;&#x5217;&#x662F;&#x5DF2;&#x7ECF; intern &#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6570;&#x91CF;&#xFF0C;&#x7B2C;&#x4E8C;&#x5217; intern 10,000 &#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x6240;&#x6709;&#x7684;&#x65F6;&#x95F4;&#xFF08;&#x79D2;&#xFF09;</p>
<p>0; time = 0.0 sec</p>
<p>50000; time = 0.03 sec</p>
<p>100000; time = 0.073 sec</p>
<p>150000; time = 0.13 sec</p>
<p>200000; time = 0.196 sec</p>
<p>250000; time = 0.279 sec</p>
<p>300000; time = 0.376 sec</p>
<p>350000; time = 0.471 sec</p>
<p>400000; time = 0.574 sec</p>
<p>450000; time = 0.666 sec</p>
<p>500000; time = 0.755 sec</p>
<p>550000; time = 0.854 sec</p>
<p>600000; time = 0.916 sec</p>
<p>650000; time = 1.006 sec</p>
<p>700000; time = 1.095 sec</p>
<p>750000; time = 1.273 sec</p>
<p>800000; time = 1.248 sec</p>
<p>850000; time = 1.446 sec</p>
<p>900000; time = 1.585 sec</p>
<p>950000; time = 1.635 sec</p>
<p>1000000; time = 1.913 sec</p>
<p>&#x6D4B;&#x8BD5;&#x662F;&#x5728; Core i5-3317U@1.7Ghz CPU &#x8BBE;&#x5907;&#x4E0A;&#x8FDB;&#x884C;&#x7684;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x5B83;&#x6210;&#x7EBF;&#x6027;&#x589E;&#x957F;&#xFF0C;&#x5E76;&#x4E14;&#x5728; JVM &#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x5305;&#x542B;&#x4E00;&#x767E;&#x4E07;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x65F6;&#xFF0C;&#x6211;&#x4ECD;&#x7136;&#x53EF;&#x4EE5;&#x8FD1;&#x4F3C;&#x6BCF;&#x79D2; intern 5000 &#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x8FD9;&#x5BF9;&#x4E8E;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x5904;&#x7406;&#x5927;&#x91CF;&#x6570;&#x636E;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6765;&#x8BF4;&#x592A;&#x6162;&#x4E86;&#x3002;</p>
<p>&#x73B0;&#x5728;&#xFF0C;&#x8C03;&#x6574; -XX:StringTableSize=100003 &#x53C2;&#x6570;&#x6765;&#x91CD;&#x65B0;&#x8FD0;&#x884C;&#x6D4B;&#x8BD5;&#xFF1A;</p>
<p>50000; time = 0.017 sec</p>
<p>100000; time = 0.009 sec</p>
<p>150000; time = 0.01 sec</p>
<p>200000; time = 0.009 sec</p>
<p>250000; time = 0.007 sec</p>
<p>300000; time = 0.008 sec</p>
<p>350000; time = 0.009 sec</p>
<p>400000; time = 0.009 sec</p>
<p>450000; time = 0.01 sec</p>
<p>500000; time = 0.013 sec</p>
<p>550000; time = 0.011 sec</p>
<p>600000; time = 0.012 sec</p>
<p>650000; time = 0.015 sec</p>
<p>700000; time = 0.015 sec</p>
<p>750000; time = 0.01 sec</p>
<p>800000; time = 0.01 sec</p>
<p>850000; time = 0.011 sec</p>
<p>900000; time = 0.011 sec</p>
<p>950000; time = 0.012 sec</p>
<p>1000000; time = 0.012 sec</p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x8FD9;&#x65F6;&#x63D2;&#x5165;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x65F6;&#x95F4;&#x8FD1;&#x4F3C;&#x4E8E;&#x5E38;&#x91CF;&#xFF08;&#x5728; Map &#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5217;&#x8868;&#x4E2D;&#x5E73;&#x5747;&#x5B57;&#x7B26;&#x4E32;&#x4E2A;&#x6570;&#x4E0D;&#x8D85;&#x8FC7; 10 &#x4E2A;&#xFF09;&#xFF0C;&#x4E0B;&#x9762;&#x662F;&#x76F8;&#x540C;&#x8BBE;&#x7F6E;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x4E0D;&#x8FC7;&#x8FD9;&#x6B21;&#x6211;&#x4EEC;&#x5C06;&#x5411;&#x6C60;&#x4E2D;&#x63D2;&#x5165; 1000 &#x4E07;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF08;&#x8FD9;&#x610F;&#x5473;&#x7740; Map &#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5217;&#x8868;&#x5E73;&#x5747;&#x5305;&#x542B; 100 &#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF09;</p>
<p>2000000; time = 0.024 sec</p>
<p>3000000; time = 0.028 sec</p>
<p>4000000; time = 0.053 sec</p>
<p>5000000; time = 0.051 sec</p>
<p>6000000; time = 0.034 sec</p>
<p>7000000; time = 0.041 sec</p>
<p>8000000; time = 0.089 sec</p>
<p>9000000; time = 0.111 sec</p>
<p>10000000; time = 0.123 sec</p>
<p>&#x73B0;&#x5728;&#x8BA9;&#x6211;&#x4EEC;&#x5C06;&#x5403;&#x7684;&#x5927;&#x5C0F;&#x589E;&#x52A0;&#x5230; 100 &#x4E07;&#xFF08;&#x7CBE;&#x786E;&#x7684;&#x8BF4;&#x662F; 1,000,003&#xFF09;</p>
<p>1000000; time = 0.005 sec</p>
<p>2000000; time = 0.005 sec</p>
<p>3000000; time = 0.005 sec</p>
<p>4000000; time = 0.004 sec</p>
<p>5000000; time = 0.004 sec</p>
<p>6000000; time = 0.009 sec</p>
<p>7000000; time = 0.01 sec</p>
<p>8000000; time = 0.009 sec</p>
<p>9000000; time = 0.009 sec</p>
<p>10000000; time = 0.009 sec</p>
<p>&#x5982;&#x4F60;&#x6240;&#x770B;&#x5230;&#x7684;,&#x65F6;&#x95F4;&#x975E;&#x5E38;&#x5E73;&#x5747;&#xFF0C;&#x5E76;&#x4E14;&#x4E0E; &#x201C;0 &#x5230; 100&#x4E07;&#x201D; &#x7684;&#x8868;&#x6CA1;&#x6709;&#x592A;&#x5927;&#x5DEE;&#x522B;&#x3002;&#x751A;&#x81F3;&#x5728;&#x6C60;&#x5927;&#x5C0F;&#x8DB3;&#x591F;&#x5927;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x7684;&#x7B14;&#x8BB0;&#x672C;&#x4E5F;&#x80FD;&#x6BCF;&#x79D2;&#x6DFB;&#x52A0;1,000,000&#x4E2A;&#x5B57;&#x7B26;&#x5BF9;&#x8C61;&#x3002;</p>
<h4 id="&#x6211;&#x4EEC;&#x8FD8;&#x9700;&#x8981;&#x624B;&#x5DE5;&#x7BA1;&#x7406;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x5417;&#xFF1F;">&#x6211;&#x4EEC;&#x8FD8;&#x9700;&#x8981;&#x624B;&#x5DE5;&#x7BA1;&#x7406;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x5417;&#xFF1F;</h4><p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5BF9;&#x6BD4; JVM &#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x548C; WeakHashMap&lt;String, WeakReference&lt;String&gt;&gt; &#x5B83;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x6A21;&#x62DF; JVM &#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x3002;&#x4E0B;&#x9762;&#x7684;&#x65B9;&#x6CD5;&#x7528;&#x6765;&#x66FF;&#x6362; String.intern&#xFF1A;</p>
<p>private static final WeakHashMap&lt;String, WeakReference&lt;String&gt;&gt; s_manualCache =</p>
<p>new WeakHashMap&lt;String, WeakReference&lt;String&gt;&gt;( 100000 );</p>
<p>private static String manualIntern( final String str )</p>
<p>{</p>
<p>final WeakReference&lt;String&gt; cached = s_manualCache.get( str );</p>
<p>if ( cached != null )</p>
<p>{</p>
<p>final String value = cached.get();</p>
<p>if ( value != null )</p>
<p>return value;</p>
<p>}</p>
<p>s_manualCache.put( str, new WeakReference&lt;String&gt;( str ) );</p>
<p>return str;</p>
<p>}</p>
<p>&#xFFFD;&#xFFFD;&#xFFFD;&#x9762;&#x9488;&#x5BF9;&#x624B;&#x5DE5;&#x6C60;&#x7684;&#x76F8;&#x540C;&#x6D4B;&#x8BD5;&#xFF1A;</p>
<p>0; manual time = 0.001 sec</p>
<p>50000; manual time = 0.03 sec</p>
<p>100000; manual time = 0.034 sec</p>
<p>150000; manual time = 0.008 sec</p>
<p>200000; manual time = 0.019 sec</p>
<p>250000; manual time = 0.011 sec</p>
<p>300000; manual time = 0.011 sec</p>
<p>350000; manual time = 0.008 sec</p>
<p>400000; manual time = 0.027 sec</p>
<p>450000; manual time = 0.008 sec</p>
<p>500000; manual time = 0.009 sec</p>
<p>550000; manual time = 0.008 sec</p>
<p>600000; manual time = 0.008 sec</p>
<p>650000; manual time = 0.008 sec</p>
<p>700000; manual time = 0.008 sec</p>
<p>750000; manual time = 0.011 sec</p>
<p>800000; manual time = 0.007 sec</p>
<p>850000; manual time = 0.008 sec</p>
<p>900000; manual time = 0.008 sec</p>
<p>950000; manual time = 0.008 sec</p>
<p>1000000; manual time = 0.008 sec</p>
<p>&#x5F53; JVM &#x6709;&#x8DB3;&#x591F;&#x5185;&#x5B58;&#x65F6;&#xFF0C;&#x624B;&#x5DE5;&#x7F16;&#x5199;&#x7684;&#x6C60;&#x63D0;&#x4F9B;&#x4E86;&#x826F;&#x597D;&#x7684;&#x6027;&#x80FD;&#x3002;&#x4E0D;&#x8FC7;&#x4E0D;&#x5E78;&#x7684;&#x662F;&#xFF0C;&#x6211;&#x7684;&#x6D4B;&#x8BD5;&#xFF08;&#x4FDD;&#x7559; String.valueOf(0 &lt; N &lt; 1,000,000,000)&#xFF09;&#x4FDD;&#x7559;&#x975E;&#x5E38;&#x77ED;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5728;&#x4F7F;&#x7528; -Xmx1280M &#x53C2;&#x6570;&#x65F6;&#x5B83;&#x5141;&#x8BB8;&#x6211;&#x4FDD;&#x7559;&#x6708;&#x4E3A; 2.5M &#x7684;&#x8FD9;&#x7C7B;&#x5B57;&#x7B26;&#x4E32;&#x3002;JVM &#x5B57;&#x7B26;&#x4E32;&#x6C60; (size=1,000,003&#xFF09;&#x4ECE;&#x53E6;&#x4E00;&#x65B9;&#x9762;&#x8BB2;&#x5728; JVM &#x5185;&#x5B58;&#x8DB3;&#x591F;&#x65F6;&#x63D0;&#x4F9B;&#x4E86;&#x76F8;&#x540C;&#x7684;&#x6027;&#x80FD;&#x7279;&#x6027;&#xFF0C;&#x77E5;&#x9053; JVM &#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x5305;&#x542B; 12.72M &#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5E76;&#x6D88;&#x8017;&#x6389;&#x6240;&#x6709;&#x5185;&#x5B58;&#xFF08;5&#x500D;&#x591A;&#xFF09;&#x3002;&#x6211;&#x8BA4;&#x4E3A;&#xFF0C;&#x8FD9;&#x975E;&#x5E38;&#x503C;&#x5F97;&#x4F60;&#x5728;&#x4F60;&#x7684;&#x5E94;&#x7528;&#x4E2D;&#x53BB;&#x6389;&#x6240;&#x6709;&#x624B;&#x5DE5;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x3002;</p>
<h4 id="&#x5728;_Java_7u40+_&#x4EE5;&#x53CA;_Java_8_&#x4E2D;&#x7684;_String-intern()">&#x5728; Java 7u40+ &#x4EE5;&#x53CA; Java 8 &#x4E2D;&#x7684; String.intern()</h4><p>Java7u40 &#x7248;&#x672C;&#x6269;&#x5C55;&#x4E86;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x7684;&#x5927;&#x5C0F;&#xFF08;&#x8FD9;&#x662F;&#x7EC4;&#x8981;&#x7684;&#x6027;&#x80FD;&#x66F4;&#x65B0;&#xFF09;&#x5230; 60013.&#x8FD9;&#x4E2A;&#x503C;&#x5141;&#x8BB8;&#x4F60;&#x5728;&#x6C60;&#x4E2D;&#x5305;&#x542B;&#x5927;&#x7EA6; 30000 &#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#x901A;&#x5E38;&#x6765;&#x8BF4;&#xFF0C;&#x8FD9;&#x5BF9;&#x4E8E;&#x9700;&#x8981;&#x4FDD;&#x5B58;&#x7684;&#x6570;&#x636E;&#x6765;&#x8BF4;&#x5DF2;&#x7ECF;&#x8DB3;&#x591F;&#x4E86;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; -XX:+PrintFlagsFinal JVM &#x53C2;&#x6570;&#x83B7;&#x5F97;&#x8FD9;&#x4E2A;&#x503C;&#x3002;</p>
<p>&#x6211;&#x5C1D;&#x8BD5;&#x5728;&#x539F;&#x59CB;&#x53D1;&#x5E03;&#x7684; Java 8 &#x4E2D;&#x8FD0;&#x884C;&#x76F8;&#x540C;&#x7684;&#x6D4B;&#x8BD5;&#xFF0C;Java 8 &#x4ECD;&#x7136;&#x652F;&#x6301; -XX:StringTableSize &#x53C2;&#x6570;&#x6765;&#x517C;&#x5BB9; Java 7 &#x7279;&#x6027;&#x3002;&#x4E3B;&#x8981;&#x7684;&#x533A;&#x522B;&#x5728;&#x4E8E; Java 8 &#x4E2D;&#x9ED8;&#x8BA4;&#x7684;&#x6C60;&#x5927;&#x5C0F;&#x589E;&#x52A0;&#x5230; 60013&#xFF1A;</p>
<p>50000; time = 0.019 sec</p>
<p>100000; time = 0.009 sec</p>
<p>150000; time = 0.009 sec</p>
<p>200000; time = 0.009 sec</p>
<p>250000; time = 0.009 sec</p>
<p>300000; time = 0.009 sec</p>
<p>350000; time = 0.011 sec</p>
<p>400000; time = 0.012 sec</p>
<p>450000; time = 0.01 sec</p>
<p>500000; time = 0.013 sec</p>
<p>550000; time = 0.013 sec</p>
<p>600000; time = 0.014 sec</p>
<p>650000; time = 0.018 sec</p>
<p>700000; time = 0.015 sec</p>
<p>750000; time = 0.029 sec</p>
<p>800000; time = 0.018 sec</p>
<p>850000; time = 0.02 sec</p>
<p>900000; time = 0.017 sec</p>
<p>950000; time = 0.018 sec</p>
<p>1000000; time = 0.021 sec</p>
<h4 id="&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;">&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;</h4><p>&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x7684;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x4E2D;&#x5FAA;&#x73AF;&#x521B;&#x5EFA;&#x5E76;&#x4FDD;&#x7559;&#x65B0;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x6D4B;&#x91CF;&#x5B83;&#x4FDD;&#x7559; 10000 &#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x6240;&#x9700;&#x8981;&#x7684;&#x65F6;&#x95F4;&#x3002;&#x6700;&#x597D;&#x914D;&#x5408; -verbose:gc JVM &#x53C2;&#x6570;&#x6765;&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x6D4B;&#x8BD5;&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x5783;&#x573E;&#x6536;&#x96C6;&#x662F;&#x4F55;&#x65F6;&#x4EE5;&#x53CA;&#x5982;&#x4F55;&#x53D1;&#x751F;&#x7684;&#x3002;&#x53E6;&#x5916;&#x6700;&#x597D;&#x4F7F;&#x7528; -Xmx &#x53C2;&#x6570;&#x6765;&#x6267;&#x884C;&#x5806;&#x7684;&#x6700;&#x5927;&#x503C;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x6709;&#x4E24;&#x4E2A;&#x6D4B;&#x8BD5;&#xFF1A;testStringPoolGarbageCollection &#x5C06;&#x663E;&#x793A; JVM &#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x88AB;&#x5783;&#x573E;&#x6536;&#x96C6; &#x2014; &#x68C0;&#x67E5;&#x5783;&#x573E;&#x6536;&#x96C6;&#x65E5;&#x5FD7;&#x6D88;&#x606F;&#x3002;&#x5728; Java 6 &#x7684;&#x9ED8;&#x8BA4; PermGen &#x5927;&#x5C0F;&#x914D;&#x7F6E;&#x4E0A;&#xFF0C;&#x8FD9;&#x4E2A;&#x6D4B;&#x8BD5;&#x4F1A;&#x5931;&#x8D25;&#xFF0C;&#x56E0;&#x6B64;&#x6700;&#x597D;&#x589E;&#x52A0;&#x8FD9;&#x4E2A;&#x503C;&#xFF0C;&#x6216;&#x8005;&#x66F4;&#x65B0;&#x6D4B;&#x8BD5;&#x65B9;&#x6CD5;&#xFF0C;&#x6216;&#x8005;&#x4F7F;&#x7528; Java 7.</p>
<p>&#x7B2C;&#x4E8C;&#x4E2A;&#x6D4B;&#x8BD5;&#x663E;&#x793A;&#x5185;&#x5B58;&#x4E2D;&#x4FDD;&#x7559;&#x4E86;&#x591A;&#x5C11;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#x5728; Java 6 &#x4E2D;&#x6267;&#x884C;&#x9700;&#x8981;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x5185;&#x5B58;&#x914D;&#x7F6E; &#x6BD4;&#x5982;&#xFF1A; -Xmx128M &#x4EE5;&#x53CA; -Xmx1280M &#xFF08;10 &#x500D;&#x4EE5;&#x4E0A;&#xFF09;&#x3002;&#x4F60;&#x53EF;&#x80FD;&#x53D1;&#x73B0;&#x8FD9;&#x4E2A;&#x503C;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x653E;&#x5165;&#x6C60;&#x4E2D;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x6570;&#x91CF;&#x3002;&#x53E6;&#x4E00;&#x65B9;&#x9762;&#xFF0C;&#x5728; Java 7 &#x4E2D;&#x4F60;&#x80FD;&#x591F;&#x5728;&#x5806;&#x4E2D;&#x586B;&#x6EE1;&#x4F60;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
<p>/**</p>
<ul>
<li>Testing String.intern.</li>
</ul>
<p>*</p>
<ul>
<li>Run this class at least with -verbose:gc JVM parameter.</li>
</ul>
<p>*/</p>
<p>public class InternTest {</p>
<p>public static void main( String[] args ) {</p>
<p>testStringPoolGarbageCollection();</p>
<p>testLongLoop();</p>
<p>}</p>
<p>/**</p>
<ul>
<li><p>Use this method to see where interned strings are stored</p>
</li>
<li><p>and how many of them can you fit for the given heap size.</p>
</li>
</ul>
<p>*/</p>
<p>private static void testLongLoop()</p>
<p>{</p>
<p>test( 1000 <em> 1000 </em> 1000 );</p>
<p>//uncomment the following line to see the hand-written cache performance</p>
<p>//testManual( 1000 <em> 1000 </em> 1000 );</p>
<p>}</p>
<p>/**</p>
<ul>
<li>Use this method to check that not used interned strings are garbage collected.</li>
</ul>
<p>*/</p>
<p>private static void testStringPoolGarbageCollection()</p>
<p>{</p>
<p>//first method call - use it as a reference</p>
<p>test( 1000 * 1000 );</p>
<p>//we are going to clean the cache here.</p>
<p>System.gc();</p>
<p>//check the memory consumption and how long does it take to intern strings</p>
<p>//in the second method call.</p>
<p>test( 1000 * 1000 );</p>
<p>}</p>
<p>private static void test( final int cnt )</p>
<p>{</p>
<p>final List&lt;String&gt; lst = new ArrayList&lt;String&gt;( 100 );</p>
<p>long start = System.currentTimeMillis();</p>
<p>for ( int i = 0; i &lt; cnt; ++i )</p>
<p>{</p>
<p>final String str = &quot;Very long test string, which tells you about something &quot; +</p>
<p>&quot;very-very important, definitely deserving to be interned #&quot; + i;</p>
<p>//uncomment the following line to test dependency from string length</p>
<p>// final String str = Integer.toString( i );</p>
<p>lst.add( str.intern() );</p>
<p>if ( i % 10000 == 0 )</p>
<p>{</p>
<p>System.out.println( i + &quot;; time = &quot; + ( System.currentTimeMillis() - start ) / 1000.0 + &quot; sec&quot; );</p>
<p>start = System.currentTimeMillis();</p>
<p>}</p>
<p>}</p>
<p>System.out.println( &quot;Total length = &quot; + lst.size() );</p>
<p>}</p>
<p>private static final WeakHashMap&lt;String, WeakReference&lt;String&gt;&gt; s_manualCache =</p>
<p>new WeakHashMap&lt;String, WeakReference&lt;String&gt;&gt;( 100000 );</p>
<p>private static String manualIntern( final String str )</p>
<p>{</p>
<p>final WeakReference&lt;String&gt; cached = s_manualCache.get( str );</p>
<p>if ( cached != null )</p>
<p>{</p>
<p>final String value = cached.get();</p>
<p>if ( value != null )</p>
<p>return value;</p>
<p>}</p>
<p>s_manualCache.put( str, new WeakReference&lt;String&gt;( str ) );</p>
<p>return str;</p>
<p>}</p>
<p>private static void testManual( final int cnt )</p>
<p>{</p>
<p>final List&lt;String&gt; lst = new ArrayList&lt;String&gt;( 100 );</p>
<p>long start = System.currentTimeMillis();</p>
<p>for ( int i = 0; i &lt; cnt; ++i )</p>
<p>{</p>
<p>final String str = &quot;Very long test string, which tells you about something &quot; +</p>
<p>&quot;very-very important, definitely deserving to be interned #&quot; + i;</p>
<p>lst.add( manualIntern( str ) );</p>
<p>if ( i % 10000 == 0 )</p>
<p>{</p>
<p>System.out.println( i + &quot;; manual time = &quot; + ( System.currentTimeMillis() - start ) / 1000.0 + &quot; sec&quot; );</p>
<p>start = System.currentTimeMillis();</p>
<p>}</p>
<p>}</p>
<p>System.out.println( &quot;Total length = &quot; + lst.size() );</p>
<p>}</p>
<p>}</p>
<h4 id="&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</h4><ul>
<li>&#x7531;&#x4E8E; Java 6 &#x4E2D;&#x4F7F;&#x7528;&#x56FA;&#x5B9A;&#x7684;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#xFF08;PermGen&#xFF09;&#x56E0;&#x6B64;&#x4E0D;&#x8981;&#x4F7F;&#x7528; String.intern() &#x65B9;&#x6CD5;</li>
<li>Java7 &#x548C; 8 &#x5728;&#x5806;&#x5185;&#x5B58;&#x4E2D;&#x5B9E;&#x73B0;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x3002;&#x8FD9;&#x4EE5;&#x4E3A;&#x8FD9;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x7684;&#x5185;&#x5B58;&#x9650;&#x5236;&#x7B49;&#x4E8E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x5185;&#x5B58;&#x9650;&#x5236;&#x3002;</li>
<li>&#x5728; Java 7 &#x548C; 8 &#x4E2D;&#x4F7F;&#x7528; -XX:StringTableSize &#x6765;&#x8BBE;&#x7F6E;&#x5B57;&#x7B26;&#x4E32;&#x6C60; Map &#x7684;&#x5927;&#x5C0F;&#x3002;&#x5B83;&#x662F;&#x56FA;&#x5B9A;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4F7F;&#x7528; HashMap &#x5B9E;&#x73B0;&#x3002;&#x8FD1;&#x4F3C;&#x4E8E;&#x4F60;&#x5E94;&#x7528;&#x5355;&#x72EC;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E2A;&#x6570;&#xFF08;&#x4F60;&#x5E0C;&#x671B;&#x4FDD;&#x7559;&#x7684;&#xFF09;&#x5E76;&#x4E14;&#x8BBE;&#x7F6E;&#x6C60;&#x7684;&#x5927;&#x5C0F;&#x4E3A;&#x6700;&#x63A5;&#x8FD1;&#x7684;&#x8D28;&#x6570;&#x5E76;&#x4E58;&#x4EE5; 2 &#xFF08;&#x51CF;&#x5C11;&#x78B0;&#x649E;&#x7684;&#x53EF;&#x80FD;&#x6027;&#xFF09;&#x3002;&#x5B83;&#x662F;&#x7684; String.intern &#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#xFF08;&#x56FA;&#x5B9A;&#xFF09;&#x7684;&#x65F6;&#x95F4;&#x5E76;&#x4E14;&#x5728;&#x6BCF;&#x6B21;&#x63D2;&#x5165;&#x65F6;&#x6D88;&#x8017;&#x66F4;&#x5C0F;&#x7684;&#x5185;&#x5B58;(&#x540C;&#x6837;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x4F7F;&#x7528;java WeakHashMap&#x5C06;&#x6D88;&#x8017;4-5&#x500D;&#x7684;&#x5185;&#x5B58;)&#x3002;</li>
<li>&#x5728; Java 6 &#x548C; 7&#xFF08;Java7u40&#x4EE5;&#x524D;&#xFF09; &#x4E2D; -XX:StringTableSize &#x53C2;&#x6570;&#x7684;&#x503C;&#x662F; 1009&#x3002;Java7u40 &#x4EE5;&#x540E;&#x8FD9;&#x4E2A;&#x503C;&#x8C03;&#x6574;&#x4E3A; 60013 &#xFF08;Java 8 &#x4E2D;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x503C;&#xFF09;</li>
<li>&#x5982;&#x679C;&#x4F60;&#x4E0D;&#x786E;&#x5B9A;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x7684;&#x7528;&#x91CF;&#xFF0C;&#x53C2;&#x8003;&#xFF1A;-XX:+PrintStringTableStatistics JVM &#x53C2;&#x6570;&#xFF0C;&#x5F53;&#x4F60;&#x7684;&#x5E94;&#x7528;&#x6302;&#x6389;&#x65F6;&#x5B83;&#x544A;&#x8BC9;&#x4F60;&#x5B57;&#x7B26;&#x4E32;&#x6C60;&#x7684;&#x4F7F;&#x7528;&#x91CF;&#x4FE1;&#x606F;&#x3002;</li>
</ul>
<p>&#x51FA;&#x5904;&#xFF1A;&#x5B57;&#x8282;&#x6280;&#x672F;</p>
<p>&#x94FE;&#x63A5;&#xFF1A;<a href="http://www.4byte.cn/learning/84930/java-xing-neng-you-hua-shou-ce-ti-gao-java-dai-ma-xing-neng-de-ge-zhong-ji-qiao.html" target="_blank" rel="external">http://www.4byte.cn/learning/84930/java-xing-neng-you-hua-shou-ce-ti-gao-java-dai-ma-xing-neng-de-ge-zhong-ji-qiao.html</a></p>
<p> <strong>ImportNew &#x4E13;&#x6CE8; Java &#x6280;&#x672F;&#x5206;&#x4EAB;&#xFF0C;&#x6B22;&#x8FCE;&#x5173;&#x6CE8;&#x3002;</strong></p>
<p>&#x5FAE;&#x4FE1;&#x53F7;&#xFF1A; ImportNew</p>
<p> <img src="http://taojinke.github.io/img/20150702/f4067c9.png" alt=""></p>
<p>&#xFF08;&#x957F;&#x6309;&#x4E0A;&#x56FE; &#x2191;&#x2191;&#x2191; &#x53EF;&#x81EA;&#x52A8;&#x8BC6;&#x522B;&#x4E8C;&#x7EF4;&#x7801;&#xFF09;</p>
<p><img src="http://taojinke.github.io/img/20150702/f40718d.jpg" alt=""></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/JVM/">JVM</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/02/f4019a9/" title="Java中的String、StringBuilder、StringBuffer -" itemprop="url">Java中的String、StringBuilder、StringBuffer -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-01T23:50:29.000Z" itemprop="datePublished"> 发表于 2015-07-02</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>Java&#x4E2D;&#x7684;String&#x662F;&#x4E2A;&#x6C38;&#x6052;&#x7684;&#x8BDD;&#x9898;&#xFF0C;&#x76F4;&#x8BF4;&#x6211;&#x60F3;&#x8BF4;&#x7684;&#x3002;</p>
<p>1&#x3001;String &#x662F;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x53D8;&#x7684;&#xFF0C;&#x4F20;&#x9012;&#x7684;&#x5F15;&#x7528;&#x7684;&#x4E00;&#x4E2A;Copy&#xFF0C;&#x65E0;&#x8BBA;&#x522E;&#x98CE;&#x4E0B;&#x96E8;&#xFF0C;&#x5B83;&#x90FD;&#x5728;&#x81EA;&#x5DF1;&#x7684;&#x5C0F;&#x7A9D;&#x91CC;&#x5446;&#x7684;&#x597D;&#x597D;&#x7684;&#x3002;</p>
<p>2&#x3001;&#x91CD;&#x8F7D;&#x201C;+&#x201D;&#x548C;StringBuilder</p>
<p>&#x8FDE;&#x63A5;&#x5B57;&#x7B26;&#x4E32;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x201C;+&#x201D;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;StringBuilder&#x4E2D;&#x7684;append();&#x6709;&#x65F6;&#x5019;&#x4E3A;&#x4E86;&#x5077;&#x61D2;&#x5C31;&#x76F4;&#x63A5; &#x7528;&#x201C;+&#x201D;&#xFF0C;&#x4F46;&#x662F;&#x7EA0;&#x7ED3;&#x5FC3;&#xFF0C;&#x603B;&#x5728;&#x89C9;&#x5F97;&#x662F;&#x4E0D;&#x662F;&#x4F1A;&#x5F71;&#x54CD;&#x6027;&#x80FD;&#x3002;&#x5148;&#x5BF9;&#x6B64;&#x8FDB;&#x884C;&#x8BF4;&#x660E;&#xFF1A;</p>
<p>&#x901A;&#x8FC7;jvm&#x53CD;&#x5E94;&#x7684;&#x5B57;&#x8282;&#x7801;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x201C;+&#x201D;&#x5B9E;&#x73B0;&#x8FDE;&#x63A5;&#x5B57;&#x7B26;&#x4E32;&#x65F6;&#xFF0C;JVM&#x4F1A;&#x81EA;&#x52A8;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x4F18;&#x5316;&#x5DE5;&#x4F5C;&#xFF0C;&#x5F15;&#x5165;StringBuilder&#x8FDB;&#x884C;&#x8FDE;&#x63A5;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#x6240;&#x4EE5;&#x5BF9;&#x4E8E;&#x7B80;&#x5355;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x8FDE;&#x63A5;&#xFF0C;&#x53EF;&#x4EE5;&#x4F9D;&#x9760;JVM&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x201C;+&#x201D;&#x8FDB;&#x884C;&#x8FDE;&#x63A5;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x4F46;&#x8FD9;&#x4E2A;&#x5C3D;&#x9650;&#x4E8E;&#x7B80;&#x5355;&#x7684;&#x62FC;&#x63A5;(&#x5F53;&#x7136;&#x96BE;&#x7684;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#xFF0C;&#x53EA;&#x662F;&#x3002;&#x3002;&#x3002;&#x4F60;&#x61C2;&#x7684;)&#xFF0C;&#x5BF9;&#x4E8E;&#x590D;&#x6742;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x62FC;&#x63A5;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x6D89;&#x53CA;&#x5230;&#x6709;&#x5FAA;&#x73AF;&#x7684;&#xFF0C;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;StringBuilder&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x5FAA;&#x73AF;&#x4E2D;&#x662F;&#x201C;+&#x201D;,&#x5728;JVM&#x8FDB;&#x884C;&#x5B9E;&#x73B0;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x91CD;&#x590D;&#x7684;&#x521B;&#x5EFA;StringBuilder&#x5BF9;&#x8C61;&#x3002;StringBuilder&#x53EF;&#x4EE5;&#x662F;&#x4F7F;&#x4EE3;&#x7801;&#x7B80;&#x77ED;&#xFF0C;&#x7B80;&#x5355;&#xFF0C;&#x800C;&#x4E14;&#x53EA;&#x4F1A;&#x751F;&#x6210;&#x4E00;&#x4E2A;StringBuilder&#x5BF9;&#x8C61;&#xFF0C;&#x800C;&#x4E14;&#x8FD8;&#x5141;&#x8BB8;&#x4F60;&#x9884;&#x5148;&#x6307;&#x5B9A;&#x5927;&#x5C0F;(&#x5982;&#x679C;&#x4F60;&#x5DF2;&#x7ECF;&#x5927;&#x6982;&#x77E5;&#x9053;&#x6700;&#x7EC8;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x957F;&#x5EA6;&#xFF0C;&#x9884;&#x5148;&#x6307;&#x5B9A;&#x5927;&#x5C0F;&#xFF0C;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x5BF9;&#x6B64;&#x91CD;&#x65B0;&#x5206;&#x914D;&#x7F13;&#x51B2;&#x533A;)&#x3002;</p>
<p>3&#x3001;StringBuilder&#x548C;StringBuffer</p>
<p>StringBuffer&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x5F00;&#x9500;&#x5927;&#x4E9B;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x662F;&#x6D89;&#x53CA;&#x5230;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x95EE;&#x9898;&#xFF0C;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;StringBuilder&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x66F4;&#x9AD8;&#x6548;&#xFF1B;</p>
<p> &#xFF01;&#xFF01;&#xFF01; &#x8981;&#x5C3D;&#x91CF;&#x675C;&#x7EDD;&#x4F7F;&#x7528;append(a+&quot;,&quot;+c);&#x56E0;&#xFFFD;&#xFFFD;&#xFFFD;&#x8FD9;&#x4E2A;JVM&#x4F1A;&#x518D;&#x4E3A;&#x4F60;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;StringBuilder&#x5BF9;&#x8C61;&#x5904;&#x7406;&#x62EC;&#x53F7;&#x5185;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x62FC;&#x63A5;&#x5DE5;&#x4F5C;&#x3002; </p>
<p>&#x4E0B;&#x8FB9;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;StingBuilder&#x7684;&#x7B80;&#x5355;&#x4F7F;&#x7528;&#x4F8B;&#x5B50;</p>
<pre><code><span class="keyword">import</span> java.util.<span class="type">Random</span>;

public class <span class="type">TestStringBuilder</span> {

    public <span class="keyword">static</span> <span class="type">Random</span> rand = new <span class="type">Random</span>();

    public <span class="type">String</span> toString(){
        <span class="type">StringBuilder</span> <span class="literal">result</span> = new <span class="type">StringBuilder</span>(&amp;quot;[&amp;quot;);
        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &amp;lt; <span class="number">25</span>; i++) {
            <span class="literal">result</span>.append(rand.nextInt(<span class="number">100</span>));
            <span class="literal">result</span>.append(&amp;quot;, &amp;quot;);
        }
        //&amp;<span class="comment">#x53BB;&amp;#x9664;&amp;#x6700;&amp;#x540E;&amp;#x7684;&amp;#x9017;&amp;#x53F7;&amp;#x548C;&amp;#x7A7A;&amp;#x683C;</span>
        <span class="literal">result</span>.delete(<span class="literal">result</span>.length()-<span class="number">2</span>, <span class="literal">result</span>.length());
        <span class="literal">result</span>.append(&amp;quot;]&amp;quot;);
        <span class="keyword">return</span> <span class="literal">result</span>.toString() ;
    }

    public <span class="keyword">static</span> <span class="type">void</span> main(<span class="type">String</span>[] args) {
        <span class="type">TestStringBuilder</span> ts = new <span class="type">TestStringBuilder</span>();
        <span class="type">System</span>.<span class="keyword">out</span>.println(ts);
    }
}
</code></pre>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/JVM/">JVM</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/02/f3dea94/" title="kafka-web-console -" itemprop="url">kafka-web-console -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-01T23:50:29.000Z" itemprop="datePublished"> 发表于 2015-07-02</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>kafka-web-console&#x5B83;&#x662F;&#x4E00;&#x6B3E;&#x5F00;&#x6E90;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x6E90;&#x7801;&#x7684;&#x5730;&#x5740;&#x5728;<a href="https://github.com/claudemamo/kafka-web-console&#x4E2D;&#x3002;Kafka" target="_blank" rel="external">https://github.com/claudemamo/kafka-web-console&#x4E2D;&#x3002;Kafka</a> Web Console&#x4E5F;&#x662F;&#x7528;Scala&#x8BED;&#x8A00;&#x7F16;&#x5199;&#x7684;Java web&#x7A0B;&#x5E8F;&#x7528;&#x4E8E;&#x76D1;&#x63A7;Apache Kafka&#x3002;</p>
<p>1&#x3001;&#x5B89;&#x88C5;&#xFF1A;</p>
<p> Shell</p>
<pre><code># wget http://downloads.typesafe.com/play/2.2.6/play-2.2.6.zip
# yum <span class="operator"><span class="keyword">install</span> unzip
# unzip play-<span class="number">2.2</span>.6.zip 
# mv play-<span class="number">2.2</span>.6 /usr/<span class="keyword">local</span>/play
# git clone https://github.com/claudemamo/kafka-web-console.git
# mv kafka-web-console /<span class="keyword">data</span>/
# cd  /<span class="keyword">data</span>/kafka-web-console/
# /usr/<span class="keyword">local</span>/play/framework/build
Java HotSpot(TM) <span class="number">64</span>-<span class="built_in">Bit</span> <span class="keyword">Server</span> VM warning: ignoring <span class="keyword">option</span> MaxPermSize=<span class="number">512</span>M;</span> support was removed in 8.0
[info] Loading project definition from /data/kafka-web-console/project

This project uses Play 2.2.1!
<span class="operator"><span class="keyword">Update</span> the Play sbt-<span class="keyword">plugin</span> <span class="keyword">version</span> <span class="keyword">to</span> <span class="number">2.2</span>.6 (usually <span class="keyword">in</span> project/plugins.sbt)

[info] <span class="keyword">Set</span> <span class="keyword">current</span> project <span class="keyword">to</span> kafka-web-console (<span class="keyword">in</span> build file:/<span class="keyword">data</span>/kafka-web-console/)
[kafka-web-console] $ exit

# /usr/<span class="keyword">local</span>/play/play</span>
</code></pre><p>2&#x3001;&#x8FD0;&#x884C;&#xFF1A;</p>
<p> Shell</p>
<pre><code>Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed <span class="keyword">in</span> 8.0
[info] Loading project definition from /home/kafka-web-console-master/project
This project uses Play 2.2.1!
<span class="keyword">Update</span> the Play sbt-<span class="keyword">plugin</span> <span class="keyword">version</span> to 2.2.6 (usually <span class="keyword">in</span> project/plugins.sbt)
[info] <span class="keyword">Set</span> current project to kafka-web-console (<span class="keyword">in</span> build <span class="keyword">file</span>:/home/kafka-web-console-master/)
    _
 _ __ | | __ _ _  _
| &amp;apos;_ | |/ _&amp;apos; | || |
|  __/|_|____|__ /
|_|         |__/
play 2.2.1 built with <span class="keyword">Scala</span> 2.10.2 (running Java 1.8.0_40), http:<span class="comment">//www.playframework.com</span>
&amp;gt; <span class="keyword">Type</span> &amp;quot;<span class="keyword">help</span> play&amp;quot; or &amp;quot;license&amp;quot; <span class="keyword">for</span> <span class="keyword">more</span> information.
&amp;gt; <span class="keyword">Type</span> &amp;quot;<span class="keyword">exit</span>&amp;quot; or <span class="keyword">use</span> Ctrl+<span class="keyword">D</span> to leave this console.
[kafka-web-console] $ <span class="keyword">help</span> play
Welcome to Play 2.2.1!
These commands are available:
-----------------------------
classpath            <span class="keyword">Display</span> the project classpath.
clean             Clean all generated files.
compile              Compile the current application.
console              Launch the interactive <span class="keyword">Scala</span> console (<span class="keyword">use</span> :quit to <span class="keyword">exit</span>).
dependencies         <span class="keyword">Display</span> the dependencies summary.
dist              Construct standalone application package.
<span class="keyword">exit</span>              <span class="keyword">Exit</span> the console.
h2-browser           Launch the H2 Web browser.
license              <span class="keyword">Display</span> licensing informations.
package              Package your application <span class="keyword">as</span> a JAR.
play-<span class="keyword">version</span>         <span class="keyword">Display</span> the Play <span class="keyword">version</span>.
publish              Publish your application <span class="keyword">in</span> a remote repository.
publish-<span class="keyword">local</span>        Publish your application <span class="keyword">in</span> the <span class="keyword">local</span> repository.
reload            Reload the current application build <span class="keyword">file</span>.
<span class="keyword">run</span> 

            <span class="keyword">Run</span> the current application <span class="keyword">in</span> DEV mode.
<span class="keyword">test</span>              <span class="keyword">Run</span> Junit tests and/or Specs from the command <span class="keyword">line</span>
eclipse              <span class="keyword">generate</span> eclipse project <span class="keyword">file</span>
idea              <span class="keyword">generate</span> Intellij IDEA project <span class="keyword">file</span>
<span class="keyword">sh</span> 
      execute a <span class="keyword">shell</span> command 
start 

           Start the current application <span class="keyword">in</span> another JVM <span class="keyword">in</span> PROD mode.
<span class="keyword">update</span>            <span class="keyword">Update</span> application dependencies.
<span class="keyword">Type</span> `<span class="keyword">help</span>` to get the standard sbt <span class="keyword">help</span>.
[kafka-web-console] $ <span class="keyword">run</span> 9000
[info] Updating {<span class="keyword">file</span>:/data/kafka-web-console/}kafka-web-console...
[info] Resolving org.fusesource.jansi#jansi;1.4 ...
[info] downloading http:<span class="comment">//repo.typesafe.com/typesafe/releases/com/typesafe/play/play-jdbc_2.10/2.2.1/play-jdbc_2.10-2.2.1.jar ...</span>
[info]  [SUCCESSFUL ] com.typesafe.play#play-jdbc_2.10;2.2.1!play-jdbc_2.10.jar (1781ms)
[info] downloading http:<span class="comment">//repo.typesafe.com/typesafe/releases/com/typesafe/play/play-cache_2.10/2.2.1/play-cache_2.10-2.2.1.jar ...</span>
[info]  [SUCCESSFUL ] com.typesafe.play#play-cache_2.10;2.2.1!play-cache_2.10.jar (918ms)
......
[info]  [SUCCESSFUL ] com.typesafe.play#play-docs_2.10;2.2.1!play-docs_2.10.jar (3160ms)
[info] Done updating.
--- (Running the application from SBT, auto-reloading is enabled) ---
[info] play - Listening <span class="keyword">for</span> HTTP <span class="keyword">on</span> /0:0:0:0:0:0:0:0:9000
(Server started, <span class="keyword">use</span> Ctrl+<span class="keyword">D</span> to stop and go back to the console...)
</code></pre><p>3&#x3001;&#x6253;&#x5F00;&#x9875;&#x9762;&#xFF0C;&#x6CE8;&#x518C;zookeeper&#xFF08;&#x7565;&#xFF09;</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Apache-HTTP-Server/">Apache HTTP Server</a><a href="/tags/JVM/">JVM</a><a href="/tags/Shell/">Shell</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/02/f3e86d4/" title="JVM如何操作缓冲区 -" itemprop="url">JVM如何操作缓冲区 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-01T23:50:29.000Z" itemprop="datePublished"> 发表于 2015-07-02</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;JVM&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x505A;&#x4E86;&#x5982;&#x4E0B;&#x51E0;&#x4EF6;&#x4E8B;&#xFF1A;</p>
<ol>
<li>JVM&#x786E;&#x4FDD;Heap&#x533A;&#x57DF;&#x5185;&#x7684;&#x7A7A;&#x95F4;&#x8DB3;&#x591F;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x591F;&#x5219;&#x4F7F;&#x7528;&#x89E6;&#x53D1;GC&#x5728;&#x5185;&#x7684;&#x65B9;&#x6CD5;&#x83B7;&#x5F97;&#x7A7A;&#x95F4;;</li>
<li>&#x83B7;&#x5F97;&#x7A7A;&#x95F4;&#x4E4B;&#x540E;&#x4F1A;&#x627E;&#x4E00;&#x7EC4;&#x5806;&#x5185;&#x7684;&#x8FDE;&#x7EED;&#x5730;&#x5740;&#x5206;&#x914D;&#x6570;&#x7EC4;, &#x8FD9;&#x91CC;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x5728;&#x7269;&#x7406;&#x5185;&#x5B58;&#x4E0A;&#xFF0C;&#x8FD9;&#x4E9B;&#x5B57;&#x8282;&#x662F;&#x4E0D;&#x4E00;&#x5B9A;&#x8FDE;&#x7EED;&#x7684;;</li>
</ol>
<p>&#x5BF9;&#x4E8E;&#x4E0D;&#x6D89;&#x53CA;&#x5230;IO&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x8FD9;&#x6837;&#x7684;&#x5904;&#x7406;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x662F;&#x5F53;&#x8FDB;&#x884C;IO&#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x4F1A;&#x51FA;&#x73B0;&#x4E00;&#x70B9;&#x6027;&#x80FD;&#x95EE;&#x9898;.</p>
<p>&#x6240;&#x6709;&#x7684;IO&#x64CD;&#x4F5C;&#x90FD;&#x9700;&#x8981;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x8FDB;&#x5165;&#x5185;&#x6838;&#x6001;&#x624D;&#x884C;&#xFF0C;&#x800C;JVM&#x8FDB;&#x7A0B;&#x5C5E;&#x4E8E;&#x7528;&#x6237;&#x6001;&#x8FDB;&#x7A0B;, &#x5F53;JVM&#x9700;&#x8981;&#x628A;&#x4E00;&#x4E2A;&#x7F13;&#x51B2;&#x533A;&#x5199;&#x5230;&#x67D0;&#x4E2A;Channel&#x6216;Socket&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x9700;&#x8981;&#x5207;&#x6362;&#x5230;&#x5185;&#x6838;&#x6001;.</p>
<p>&#x800C;&#x5185;&#x6838;&#x6001;&#x7531;&#x4E8E;&#x5E76;&#x4E0D;&#x77E5;&#x9053;JVM&#x91CC;&#x9762;&#x8FD9;&#x4E2A;&#x7F13;&#x51B2;&#x533A;&#x5B58;&#x50A8;&#x5728;&#x7269;&#x7406;&#x5185;&#x5B58;&#x7684;&#x4EC0;&#x4E48;&#x5730;&#x5740;&#xFF0C;&#x5E76;&#x4E14;&#x8FD9;&#x4E9B;&#x7269;&#x7406;&#x5730;&#x5740;&#x5E76;&#x4E0D;&#x4E00;&#x5B9A;&#x662F;&#x8FDE;&#x7EED;&#x7684;(&#x6216;&#x8005;&#x8BF4;&#x4E0D;&#x4E00;&#x5B9A;&#x662F;IO&#x64CD;&#x4F5C;&#x9700;&#x8981;&#x7684;&#x5757;&#x7ED3;&#x6784;)&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x5207;&#x6362;&#x4E4B;&#x524D;JVM&#x9700;&#x8981;&#x628A;&#x7F13;&#x51B2;&#x533A;&#x590D;&#x5236;&#x5230;&#x7269;&#x7406;&#x5185;&#x5B58;&#x4E00;&#x5757;&#x8FDE;&#x7EED;&#x7684;&#x5185;&#x5B58;&#x4E0A;, &#x7136;&#x540E;&#x7531;&#x5185;&#x6838;&#x53BB;&#x8BFB;&#x53D6;&#x8FD9;&#x5757;&#x7269;&#x7406;&#x5185;&#x5B58;&#xFF0C;&#x6574;&#x5408;&#x6210;&#x8FDE;&#x7EED;&#x7684;&#x3001;&#x5206;&#x5757;&#x7684;&#x5185;&#x5B58;.</p>
<p>&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;, Java&#x7684;&#x67D0;&#x4E9B;&#x7248;&#x672C;&#x4F1A;&#x628A;&#x7269;&#x7406;&#x533A;&#x57DF;&#x5206;&#x914D;&#x597D;&#x7684;&#x90E8;&#x5206;&#x5185;&#x5B58;&#x505A;&#x7F13;&#x5B58;&#x5C31;&#x4E0D;&#x7528;&#x6BCF;&#x6B21;&#x90FD;&#x5F00;&#x8F9F;&#x4E00;&#x5757;&#x7A7A;&#x95F4;&#xFF0C;&#x4F46;&#x6548;&#x679C;&#x8FD8;&#x4E0D;&#x591F;&#x597D;&#xFF0C;&#x6BD5;&#x7ADF;&#x590D;&#x5236;&#x7684;&#x90E8;&#x5206;&#x662F;&#x5C11;&#x4E0D;&#x4E86;&#x7684;.</p>
<p>JDK1.4&#x4E4B;&#x540E;&#x5F15;&#x5165;&#x4E86;NIO, &#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x5185;&#x5B58;&#x6620;&#x5C04;&#x6280;&#x672F;, &#x8BA9;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4ECE;Java&#x4EE3;&#x7801;&#x4E2D;&#x521B;&#x5EFA;DirectBuffer&#xFF0C;&#x8FD9;&#x79CD;Buffer&#x5728;&#x521B;&#x5EFA;&#x7684;&#x65F6;&#x5019;&#x76F4;&#x63A5;&#x5C31;&#x5728;&#x7269;&#x7406;&#x5185;&#x5B58;&#x4E2D;&#x5206;&#x914D;&#x4E00;&#x5757;&#x8FDE;&#x7EED;&#x5185;&#x5B58;&#xFF0C;&#x5F53;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x590D;&#x5236;&#xFF0C;&#x5185;&#x6838;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x5373;&#x53EF;. &#x4F46;&#x7F3A;&#x70B9;&#x4E5F;&#x662F;&#x663E;&#x800C;&#x6613;&#xFFFD;&#xFFFD;&#xFFFD;&#x7684;&#xFF0C;&#x5C31;&#x662F;&#x6BCF;&#x6B21;&#x5206;&#x914D;&#x90FD;&#x6BD4;&#x8F83;&#x6602;&#x8D35;&#x4E00;&#x70B9;&#xFF0C;&#x540C;&#x65F6;&#x7531;&#x4E8E;&#x5206;&#x914D;&#x7684;&#x5185;&#x5B58;&#x4E0D;&#x5728;Java Heap&#x4E2D;&#xFF0C;&#x6240;&#x4EE5;&#x4E5F;&#x4E0D;&#x4F1A;&#x53D7;&#x7528;&#x6237;&#x8BBE;&#x7F6E;&#x7684;&#x5806;&#x5927;&#x5C0F;&#x7684;&#x9650;&#x5236;.</p>
<p>&#x901A;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5927;&#x91CF;&#x4F7F;&#x7528;IO&#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x5019;&#x4F7F;&#x7528;&#x5185;&#x5B58;&#x6620;&#x5C04;&#x662F;&#x975E;&#x5E38;&#x503C;&#x5F97;&#x7684;&#xFF0C;&#x4E0B;&#x9762;&#x662F;&#x6211;&#x753B;&#x7684;&#x4E00;&#x5F20;&#x56FE;&#xFF0C;&#x65B9;&#x4FBF;&#x8BB0;&#x5FC6;:</p>
<p><img src="http://taojinke.github.io/img/20150702/f3e734c.png" alt=""></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/JVM/">JVM</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/02/f436181/" title="不同的垃圾回收器的比较 -" itemprop="url">不同的垃圾回收器的比较 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-01T23:50:29.000Z" itemprop="datePublished"> 发表于 2015-07-02</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p> (&#x70B9;&#x51FB;&#x4E0A;&#x65B9;  &#x516C;&#x4F17;&#x53F7;  &#xFF0C;&#x53EF;&#x5FEB;&#x901F;&#x5173;&#x6CE8;)</p>
<h4 id="4&#x6B3E;Java&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#x2014;&#x2014;&#x9519;&#x8BEF;&#x7684;&#x9009;&#x62E9;&#x5BFC;&#x81F4;&#x7CDF;&#x7CD5;&#x7684;&#x6027;&#x80FD;">4&#x6B3E;Java&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#x2014;&#x2014;&#x9519;&#x8BEF;&#x7684;&#x9009;&#x62E9;&#x5BFC;&#x81F4;&#x7CDF;&#x7CD5;&#x7684;&#x6027;&#x80FD;</h4><p>&#x8BF4;&#x8D77;&#x5783;&#x573E;&#x56DE;&#x6536;&#xFF0C;&#x8BB8;&#x591A;&#x4EBA;&#x90FD;&#x4E86;&#x89E3;&#x5B83;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x4E5F;&#x5728;&#x65E5;&#x5E38;&#x7684;&#x7F16;&#x7A0B;&#x4E2D;&#x6709;&#x6240;&#x5E94;&#x7528;&#x3002;&#x5C3D;&#x7BA1;&#x5982;&#x6B64;&#xFF0C;&#x4ECD;&#x6709;&#x8BB8;&#x591A;&#x6211;&#x4EEC;&#x4E0D;&#x592A;&#x4E86;&#x89E3;&#x7684;&#x4E1C;&#x897F;&#xFF0C;&#x800C;&#x8FD9;&#x6B63;&#x662F;&#x75DB;&#x82E6;&#x7684;&#x6839;&#x6E90;&#x3002;&#x5173;&#x4E8E;JVM&#x6700;&#x5927;&#x7684;&#x8BEF;&#x89E3;&#x5C31;&#x662F;&#x8BA4;&#x4E3A;&#x5B83;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#xFF0C;&#x800C;&#x4E8B;&#x5B9E;&#x4E0A;&#x5B83;&#x6709;&#x56DB;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x56DE;&#x6536;&#x5668;&#xFF0C;&#x6BCF;&#x4E2A;&#x90FD;&#x5404;&#x6709;&#x5176;&#x957F;&#x77ED;&#x3002;JVM&#x5E76;&#x4E0D;&#x4F1A;&#x81EA;&#x52A8;&#x5730;&#x9009;&#x62E9;&#x67D0;&#x4E00;&#x4E2A;&#xFF0C;&#x8FD9;&#x4E8B;&#x8FD8;&#x5F97;&#x843D;&#x5728;&#x4F60;&#x6211;&#x7684;&#x80A9;&#x4E0A;&#xFF0C;&#x56E0;&#x4E3A;&#x4E0D;&#x540C;&#x7684;&#x56DE;&#x6536;&#x5668;&#x4F1A;&#x5E26;&#x6765;&#x541E;&#x5410;&#x91CF;&#x53CA;&#x5E94;&#x7528;&#x7684;&#x6682;&#x505C;&#x65F6;&#x95F4;&#x7684;&#x663E;&#x8457;&#x7684;&#x5DEE;&#x5F02;&#x3002;</p>
<p>&#x8FD9;&#x56DB;&#x79CD;&#x56DE;&#x6536;&#x7B97;&#x6CD5;&#x7684;&#x5171;&#x540C;&#x4E4B;&#x5904;&#x5728;&#x4E8E;&#x5B83;&#x4EEC;&#x90FD;&#x662F;&#x5206;&#x4EE3;&#x7684;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5B83;&#x4EEC;&#x5C06;&#x6258;&#x7BA1;&#x7684;&#x5806;&#x5206;&#x6210;&#x4E86;&#x597D;&#x51E0;&#x4E2A;&#x533A;&#x57DF;&#xFF0C;&#x5B83;&#x5047;&#x8BBE;&#x5806;&#x4E2D;&#x7684;&#x8BB8;&#x591A;&#x5BF9;&#x8C61;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x90FD;&#x5F88;&#x77ED;&#xFF0C;&#x53EF;&#x4EE5;&#x5F88;&#x5FEB;&#x88AB;&#x56DE;&#x6536;&#x6389;&#x3002;&#x4ECB;&#x7ECD;&#x8FD9;&#x5757;&#x5185;&#x5BB9;&#x7684;&#x5DF2;&#x7ECF;&#x5F88;&#x591A;&#x4E86;&#xFF0C;&#x56E0;&#x6B64;&#x8FD9;&#x91CC;&#x6211;&#x6253;&#x7B97;&#x76F4;&#x63A5;&#x8BB2;&#x4E00;&#x4E0B;&#x8FD9;&#x51E0;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x7B97;&#x6CD5;&#xFF0C;&#x4EE5;&#x53CA;&#x5B83;&#x4EEC;&#x7684;&#x957F;&#x5904;&#x53CA;&#x77ED;&#x5904;&#x3002;</p>
<h4 id="1-&#x4E32;&#x884C;&#x56DE;&#x6536;&#x5668;">1.&#x4E32;&#x884C;&#x56DE;&#x6536;&#x5668;</h4><p>&#x4E32;&#x884C;&#x56DE;&#x6536;&#x5668;&#x662F;&#x6700;&#x7B80;&#x5355;&#x7684;&#x4E00;&#x4E2A;&#xFF0C;&#x4F60;&#x90FD;&#x4E0D;&#x4F1A;&#x8003;&#x8651;&#x4F7F;&#x7528;&#x5B83;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4E3B;&#x8981;&#x662F;&#x9762;&#x5411;&#x5355;&#x7EBF;&#x7A0B;&#x73AF;&#x5883;&#x7684;&#xFF08;&#x6BD4;&#x5982;&#x8BF4;32&#x4F4D;&#x7684;&#x6216;&#x8005;Windows&#xFF09;&#x4EE5;&#x53CA;&#x6BD4;&#x8F83;&#x5C0F;&#x7684;&#x5806;&#x3002;&#x8FD9;&#x4E2A;&#x56DE;&#x6536;&#x5668;&#x5DE5;&#x4F5C;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x5C06;&#x6240;&#x6709;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#x5168;&#x90E8;&#x51BB;&#x7ED3;&#xFF0C;&#x5C31;&#x8FD9;&#x4E00;&#x70B9;&#x800C;&#x8A00;&#x5C31;&#x4F7F;&#x5F97;&#x5B83;&#x5B8C;&#x5168;&#x4E0D;&#x53EF;&#x80FD;&#x4F1A;&#x88AB;&#x670D;&#x52A1;&#x7AEF;&#x5E94;&#x7528;&#x6240;&#x91C7;&#x7528;&#x3002;</p>
<p>&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x5B83;&#xFF1A;&#x4F60;&#x53EF;&#x4EE5;&#x6253;&#x5F00;-XX:+UseSerialGC&#x8FD9;&#x4E2A;JVM&#x53C2;&#x6570;&#x6765;&#x4F7F;&#x7528;&#x5B83;&#x3002;</p>
<h4 id="2-&#x5E76;&#x884C;/&#x541E;&#x5410;&#x91CF;&#x56DE;&#x6536;&#x5668;">2.&#x5E76;&#x884C;/&#x541E;&#x5410;&#x91CF;&#x56DE;&#x6536;&#x5668;</h4><p>&#x4E0B;&#x4E00;&#x4E2A;&#x662F;&#x5E76;&#x884C;&#x56DE;&#x6536;&#x5668;&#xFF08; Parallel collector&#xFF09;&#x3002;&#x8FD9;&#x662F;JVM&#x7684;&#x9ED8;&#x8BA4;&#x56DE;&#x6536;&#x5668;&#x3002;&#x6B63;&#x5982;&#x5B83;&#x7684;&#x540D;&#x5B57;&#x6240;&#x8BF4;&#x7684;&#x90A3;&#x6837;&#xFF0C;&#x5B83;&#x7684;&#x6700;&#x5927;&#x7684;&#x4F18;&#x70B9;&#x5C31;&#x662F;&#x5B83;&#x4F7F;&#x7528;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x6765;&#x626B;&#x63CF;&#x53CA;&#x538B;&#x7F29;&#x5806;&#x3002;&#x5B83;&#x7684;&#x7F3A;&#x70B9;&#x5C31;&#x662F;&#x4E0D;&#x7BA1;&#x6267;&#x884C;&#x7684;&#x662F;minor GC&#x8FD8;&#x662F;full GC&#x5B83;&#x90FD;&#x4F1A;&#x6682;&#x505C;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#x3002;&#x5E76;&#x884C;&#x56DE;&#x6536;&#x5668;&#x6700;&#x9002;&#x5408;&#x90A3;&#x4E9B;&#x53EF;&#x4EE5;&#x5BB9;&#x8BB8;&#x6682;&#x505C;&#x7684;&#x5E94;&#x7528;&#xFF0C;&#x5B83;&#x8BD5;&#x56FE;&#x51CF;&#x5C11;&#x7531;&#x56DE;&#x6536;&#x5668;&#x6240;&#x5F15;&#x8D77;&#x7684;CPU&#x5F00;&#x9500;&#x3002;</p>
<h4 id="3-CMS&#x56DE;&#x6536;&#x5668;">3.CMS&#x56DE;&#x6536;&#x5668;</h4><p>&#x5E76;&#x884C;&#x56DE;&#x6536;&#x5668;&#x4E4B;&#x540E;&#x5C31;&#x662F;CMS&#x56DE;&#x6536;&#x5668;&#x4E86;&#xFF08;concurrent-mark-sweep&#xFF09;&#x3002;&#x8FD9;&#x4E2A;&#x7B97;&#x6CD5;&#x4F7F;&#x7528;&#x4E86;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF08;concurrent&#xFF09;&#x6765;&#x626B;&#x63CF;&#x5806;&#x5E76;&#x6807;&#x8BB0;&#xFF08;mark&#xFF09;&#x90A3;&#x4E9B;&#x4E0D;&#x518D;&#x4F7F;&#x7528;&#x7684;&#x53EF;&#x4EE5;&#x56DE;&#x6536;(sweep)&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x8FD9;&#x4E2A;&#x7B97;&#x6CD5;&#x5728;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x4F1A;&#x8FDB;&#x5165;&#x4E00;&#x4E2A;&#x201D;stop the world&#x201D;&#x7684;&#x6A21;&#x5F0F;&#xFF1A;&#x5F53;&#x8FDB;&#x884C;&#x6839;&#x5BF9;&#x8C61;&#x7684;&#x521D;&#x59CB;&#x6807;&#x8BB0;&#x7684;&#x65F6;&#x5019; &#xFF08;&#x8001;&#x751F;&#x4EE3;&#x4E2D;&#x7EBF;&#x7A0B;&#x5165;&#x53E3;&#x70B9;&#x6216;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x53EF;&#x8FBE;&#x7684;&#x90A3;&#x4E9B;&#x5BF9;&#x8C61;&#xFF09;&#x4EE5;&#x53CA;&#x5F53;&#x8FD9;&#x4E2A;&#x7B97;&#x6CD5;&#x5728;&#x5E76;&#x53D1;&#x8FD0;&#x884C;&#x7684;&#x65F6;&#x5019;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6539;&#x53D8;&#x4E86;&#x5806;&#x7684;&#x72B6;&#x6001;&#x4F7F;&#x5F97;&#x5B83;&#x4E0D;&#x5F97;&#x4E0D;&#x56DE;&#x53BB;&#x518D;&#x6B21;&#x786E;&#x8BA4;&#x81EA;&#x5DF1;&#x6807;&#x8BB0;&#x7684;&#x5BF9;&#x8C61;&#x90FD;&#x662F;&#x6B63;&#x786E;&#x7684;&#x3002;</p>
<p>&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x56DE;&#x6536;&#x5668;&#x6700;&#x5927;&#x7684;&#x95EE;&#x9898;&#x5C31;&#x662F;&#x4F1A;&#x78B0;&#x5230;promotion failure&#xFF0C;&#x8FD9;&#x662F;&#x6307;&#x5728;&#x56DE;&#x6536;&#x65B0;&#x751F;&#x4EE3;&#x53CA;&#x5E74;&#x8001;&#x4EE3;&#x65F6;&#x51FA;&#x73B0;&#x4E86;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#x7684;&#x60C5;&#x51B5;&#x3002;&#x5982;&#x679C;&#x56DE;&#x6536;&#x5668;&#x9700;&#x8981;&#x5C06;&#x5E74;&#x8F7B;&#x7684;&#x5BF9;&#x8C61;&#x63D0;&#x5347;&#x5230;&#x5E74;&#x8001;&#x4EE3;&#x4E2D;&#xFF0C;&#x800C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5E74;&#x8001;&#x4EE3;&#x6CA1;&#x6709;&#x591A;&#x4F59;&#x7684;&#x7A7A;&#x95F4;&#x4E86;&#xFF0C;&#x5B83;&#x5C31;&#x53EA;&#x80FD;&#x5148;&#x8FDB;&#x884C;&#x4E00;&#x6B21;STW(Stop The World)&#x7684;full GC&#x4E86;&#x2014;&#x2014;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x6B63;&#x662F;CMS&#x6240;&#x5E0C;&#x671B;&#x907F;&#x514D;&#x7684;&#x3002;&#x4E3A;&#x4E86;&#x786E;&#x4FDD;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0D;&#x4F1A;&#x53D1;&#x751F;&#xFF0C;&#x4F60;&#x8981;&#x4E48;&#x5C31;&#x662F;&#x589E;&#x52A0;&#x8001;&#x751F;&#x4EE3;&#x7684;&#x5927;&#x5C0F;&#xFF08;&#x6216;&#x8005;&#x589E;&#x52A0;&#x6574;&#x4E2A;&#x5806;&#x7684;&#x5927;&#x5C0F;&#xFF09;&#xFF0C;&#x8981;&#x4E48;&#x5C31;&#x662F;&#x7ED9;&#x56DE;&#x6536;&#x5668;&#x5206;&#x914D;&#x4E00;&#x4E9B;&#x540E;&#x53F0;&#x7EBF;&#x7A0B;&#x4EE5;&#x4FBF;&#x4E0E;&#x5BF9;&#x8C61;&#x5206;&#x914D;&#x7684;&#x901F;&#x5EA6;&#x8FDB;&#x884C;&#x8D5B;&#x8DD1;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x7B97;&#x6CD5;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x7F3A;&#x70B9;&#x5C31;&#x662F;&#x548C;&#x5E76;&#x884C;&#x56DE;&#x6536;&#x5668;&#x76F8;&#x6BD4;&#xFF0C;&#x5B83;&#x4F7F;&#x7528;&#x7684;CPU&#x8D44;&#x6E90;&#x4F1A;&#x66F4;&#x591A;&#xFF0C;&#x5B83;&#x4F7F;&#x7528;&#x4E86;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x6765;&#x6267;&#x884C;&#x626B;&#x63CF;&#x548C;&#x56DE;&#x6536;&#xFF0C;&#x8FD9;&#x6837;&#x624D;&#x80FD;&#x8BA9;&#x5E94;&#x7528;&#x6301;&#x7EED;&#x63D0;&#x4F9B;&#x66F4;&#x9AD8;&#x7EA7;&#x522B;&#x7684;&#x541E;&#x5410;&#x91CF;&#x3002;&#x5BF9;&#x4E8E;&#x5927;&#x591A;&#x6570;&#x957F;&#x671F;&#x8FD0;&#x884C;&#x7684;&#x7A0B;&#x5E8F;&#x800C;&#x8A00;&#xFF0C;&#x5E94;&#x7528;&#x7684;&#x6682;&#x505C;&#x5BF9;&#x5B83;&#x4EEC;&#x662F;&#x5F88;&#x4E0D;&#x5229;&#x7684;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x4F7F;&#x7528;CMS&#x56DE;&#x6536;&#x5668;&#x3002;&#x5C3D;&#x7BA1;&#x5982;&#x6B64;&#xFF0C;&#x8FD9;&#x4E2A;&#x7B97;&#x6CD5;&#x4E5F;&#x4E0D;&#x662F;&#x9ED8;&#x8BA4;&#x5F00;&#x542F;&#x7684;&#x3002;&#x4F60;&#x5F97;&#x6307;&#x5B9A;XX:+UseConcMarkSweepGC&#x6765;&#x542F;&#x7528;&#x5B83;&#x3002;&#x5047;&#x8BBE;&#x4F60;&#x7684;&#x5806;&#x5C0F;&#x4E8E;4G&#xFF0C;&#x800C;&#x4F60;&#x53C8;&#x5E0C;&#x671B;&#x5206;&#x914D;&#x66F4;&#x591A;&#x7684;CPU&#x8D44;&#x6E90;&#x4EE5;&#x907F;&#x514D;&#x5E94;&#x7528;&#x6682;&#x505C;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x5C31;&#x662F;&#x4F60;&#x8981;&#x9009;&#x62E9;&#x7684;&#x56DE;&#x6536;&#x5668;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x5982;&#x679C;&#x5806;&#x5927;&#x4E8E;4G&#x7684;&#x8BDD;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x66F4;&#x5E0C;&#x671B;&#x4F7F;&#x7528;&#x6700;&#x540E;&#x7684;&#x8FD9;&#x4E2A;&#x2014;&#x2014;G1&#x56DE;&#x6536;&#x5668;&#x3002;</p>
<h4 id="4-G1&#x56DE;&#x6536;&#x5668;">4.G1&#x56DE;&#x6536;&#x5668;</h4><p>G1&#xFF08; Garbage first&#xFF09;&#x56DE;&#x6536;&#x5668;&#x5728;JDK 7update 4&#x4E2D;&#x9996;&#x6B21;&#x5F15;&#x5165;&#xFF0C;&#x5B83;&#x7684;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;&#x662F;&#x80FD;&#x66F4;&#x597D;&#x5730;&#x652F;&#x6301;&#x5927;&#x4E8E;4GB&#x7684;&#x5806;&#x3002;G1&#x56DE;&#x6536;&#x5668;&#x5C06;&#x5806;&#x5206;&#x4E3A;&#x591A;&#x4E2A;&#x533A;&#x57DF;&#xFF0C;&#x5927;&#x5C0F;&#x4ECE;1MB&#x5230;32MB&#x4E0D;&#x7B49;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x591A;&#x4E2A;&#x540E;&#x53F0;&#x7EBF;&#x7A0B;&#x6765;&#x626B;&#x63CF;&#x5B83;&#x4EEC;&#x3002;G1&#x56DE;&#x6536;&#x5668;&#x4F1A;&#x4F18;&#x5148;&#x626B;&#x63CF;&#x90A3;&#x4E9B;&#x5305;&#x542B;&#x5783;&#x573E;&#x6700;&#x591A;&#x7684;&#x533A;&#x57DF;&#xFF0C;&#x8FD9;&#x6B63;&#x662F;&#x5B83;&#x7684;&#x540D;&#x5B57;&#x7684;&#x7531;&#x6765;&#xFF08;Garbage first&#xFF09;&#x3002;&#x8FD9;&#x4E2A;&#x56DE;&#x6536;&#x5668;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;-XX:UseG1GC&#x6807;&#x8BB0;&#x6765;&#x542F;&#x7528;&#x3002;</p>
<p>&#x8FD9;&#x4E00;&#x7B56;&#x7565;&#x51CF;&#x5C11;&#x4E86;&#x540E;&#x53F0;&#x7EBF;&#x7A0B;&#x8FD8;&#x672A;&#x626B;&#x63CF;&#x5B8C;&#x65E0;&#x7528;&#x5BF9;&#x8C61;&#x524D;&#x5806;&#x5C31;&#x5DF2;&#x7ECF;&#x7528;&#x5149;&#x7684;&#x53EF;&#x80FD;&#x6027;&#xFF0C;&#x800C;&#x90A3;&#x79CD;&#x60C5;&#x51B5;&#x56DE;&#x6536;&#x5668;&#x5C31;&#x5FC5;&#x987B;&#x5F97;&#x6682;&#x505C;&#x5E94;&#x7528;&#xFF0C;&#x8FD9;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;STW&#x56DE;&#x6536;&#x3002;G1&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x597D;&#x5904;&#x5C31;&#x662F;&#x5B83;&#x603B;&#x662F;&#x4F1A;&#x8FDB;&#x884C;&#x5806;&#x7684;&#x538B;&#x7F29;&#xFF0C;&#x800C;CMS&#x56DE;&#x6536;&#x5668;&#x53EA;&#x6709;&#x5728;full GC&#x7684;&#x65F6;&#x5019;&#x624D;&#x4F1A;&#x5E72;&#x8FD9;&#x4E8B;&#x3002;</p>
<p>&#x8FC7;&#x53BB;&#x51E0;&#x5E74;&#x91CC;&#xFF0C;&#x5927;&#x5806;&#x4E00;&#x76F4;&#x90FD;&#x662F;&#x4E00;&#x4E2A;&#x5145;&#x6EE1;&#x4E89;&#x8BAE;&#x7684;&#x9886;&#x57DF;&#xFF0C;&#x5F88;&#x591A;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x4ECE;&#x5355;&#x673A;&#x5668;&#x5355;JVM&#x6A21;&#x578B;&#x8F6C;&#x5411;&#x4E86;&#x5355;&#x673A;&#x5668;&#x591A;JVM&#x7684;&#x5FAE;&#x670D;&#x52A1;&#xFF0C;&#x7EC4;&#x4EF6;&#x5316;&#x7684;&#x67B6;&#x6784;&#x3002;&#x8FD9;&#x662F;&#x8BB8;&#x591A;&#x56E0;&#x7D20;&#x6240;&#x9A71;&#x52A8;&#x7684;&#xFF0C;&#x5305;&#x62EC;&#x9694;&#x79BB;&#x7A0B;&#x5E8F;&#x7684;&#x7EC4;&#x4EF6;&#xFF0C;&#x7B80;&#x5316;&#x90E8;&#x7F72;&#xFF0C;&#x907F;&#x514D;&#x91CD;&#x65B0;&#x52A0;&#x8F7D;&#x5E94;&#x7528;&#x7C7B;&#x5230;&#x5185;&#x5B58;&#x6240;&#x4EA7;&#x751F;&#x7684;&#x5F00;&#x9500;&#xFF08;Java 8&#x4E2D;&#x8FD9;&#x70B9;&#x5DF2;&#x7ECF;&#x5F97;&#x5230;&#x4E86;&#x6539;&#x5584;&#xFF09;&#x3002;</p>
<p>&#x5C3D;&#x7BA1;&#x5982;&#x6B64;&#xFF0C;&#x8FD9;&#x4E48;&#x505A;&#x6700;&#x4E3B;&#x8981;&#x8FD8;&#x662F;&#x5E0C;&#x671B;&#x80FD;&#x907F;&#x514D;&#x5927;&#x5806;&#x7684;GC&#x4E2D;&#x957F;&#x65F6;&#x671F;&#x7684;&#x201D;stop the world&#x201D;&#x7684;&#x6682;&#x505C;&#xFF08;&#x5728;&#x4E00;&#x6B21;&#x5927;&#x7684;&#x56DE;&#x6536;&#x4E2D;&#x9700;&#x8981;&#x82B1;&#x8D39;&#x6570;&#x79D2;&#x624D;&#x80FD;&#x5B8C;&#x6210;&#xFF09;&#x3002;&#x50CF;Docker&#x8FD9;&#x6837;&#x7684;&#x5BB9;&#x5668;&#x6280;&#x672F;&#x4E5F;&#x52A0;&#x901F;&#x4E86;&#x8FD9;&#x4E00;&#x8FDB;&#x7A0B;&#xFF0C;&#x5B83;&#x4EEC;&#x4F7F;&#x5F97;&#x4F60;&#x53EF;&#x4EE5;&#x5F88;&#x8F7B;&#x677E;&#x5730;&#x5728;&#x540C;&#x4E00;&#x53F0;&#x7269;&#x7406;&#x673A;&#x4E0A;&#x90E8;&#x7F72;&#x591A;&#x4E2A;&#x5E94;&#x7528;&#x3002;</p>
<h4 id="Java_8&#x53CA;G1&#x56DE;&#x6536;&#x5668;">Java 8&#x53CA;G1&#x56DE;&#x6536;&#x5668;</h4><p>Java 8 update 20&#x6240;&#x5F15;&#x5165;&#x7684;&#x4E00;&#x4E2A;&#x5F88;&#x68D2;&#x7684;&#x4F18;&#x5316;&#x5C31;&#x662F;G1&#x56DE;&#x6536;&#x5668;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x53BB;&#x91CD;&#xFF08;String deduplication&#xFF09;&#x3002;&#x7531;&#x4E8E;&#x5B57;&#x7B26;&#x4E32;(&#x5305;&#x62EC;&#x5B83;&#x4EEC;&#x5185;&#x90E8;&#x7684;char[]&#x6570;&#x7EC4;&#xFF09;&#x5360;&#x7528;&#x4E86;&#x5927;&#x591A;&#x6570;&#x7684;&#x5806;&#x7A7A;&#x95F4;&#xFF0C;&#x8FD9;&#x9879;&#x65B0;&#x7684;&#x4F18;&#x5316;&#x65E8;&#x5728;&#x4F7F;&#x5F97;G1&#x56DE;&#x6536;&#x5668;&#x80FD;&#x8BC6;&#x522B;&#x51FA;&#x5806;&#x4E2D;&#x90A3;&#x4E9B;&#x91CD;&#x590D;&#x51FA;&#x73B0;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5E76;&#x5C06;&#x5B83;&#x4EEC;&#x6307;&#x5411;&#x540C;&#x4E00;&#x4E2A;&#x5185;&#x90E8;&#x7684;char[]&#x6570;&#x7EC4;&#xFF0C;&#x4EE5;&#x907F;&#x514D;&#x540C;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x591A;&#x4EFD;&#x62F7;&#x8D1D;&#xFF0C;&#x90A3;&#x6837;&#x5806;&#x7684;&#x4F7F;&#x7528;&#x6548;&#x7387;&#x4F1A;&#x53D8;&#x5F97;&#x5F88;&#x4F4E;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;-XX:+UseStringDeduplication&#x8FD9;&#x4E2A;JVM&#x53C2;&#x6570;&#x6765;&#x8BD5;&#x4E00;&#x4E0B;&#x8FD9;&#x4E2A;&#x7279;&#x6027;&#x3002;</p>
<h4 id="Java_8&#x53CA;&#x6301;&#x4E45;&#x4EE3;">Java 8&#x53CA;&#x6301;&#x4E45;&#x4EE3;</h4><p>Java 8&#x4E2D;&#x6700;&#x5927;&#x7684;&#x6539;&#x53D8;&#x5C31;&#x662F;&#x6301;&#x4E45;&#x4EE3;&#x7684;&#x79FB;&#x9664;&#xFF0C;&#x5B83;&#x539F;&#x672C;&#x662F;&#x7528;&#x6765;&#x7ED9;&#x7C7B;&#x5143;&#x6570;&#x636E;&#xFF0C;&#x9A7B;&#x7559;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x6765;&#x5206;&#x914D;&#x7A7A;&#x95F4;&#x7684;&#x3002;&#x8FD9;&#x5728;&#x4EE5;&#x524D;&#x90FD;&#x662F;&#x9700;&#x8981;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x6765;&#x9488;&#x5BF9;&#x90A3;&#x4E9B;&#x4F1A;&#x52A0;&#x8F7D;&#x5927;&#x91CF;&#x7C7B;&#x7684;&#x5E94;&#x7528;&#x6765;&#x4E13;&#x95E8;&#x8FDB;&#x884C;&#x5806;&#x6BD4;&#x4F8B;&#x7684;&#x4F18;&#x5316;&#x53CA;&#x8C03;&#x6574;&#x3002;&#x8BB8;&#x591A;&#x5E74;&#x6765;&#x90FD;&#x662F;&#x5982;&#x6B64;&#xFF0C;&#x8FD9;&#x4E5F;&#x6B63;&#x662F;&#x8BB8;&#x591A;OutOfMemory&#x5F02;&#x5E38;&#x7684;&#x6839;&#x6E90;&#xFF0C;&#x56E0;&#x6B64;&#x7531;JVM&#x6765;&#x63A5;&#x7BA1;&#x5B83;&#x771F;&#x662F;&#x518D;&#x597D;&#x4E0D;&#x8FC7;&#x4E86;&#x3002;&#x5373;&#x4FBF;&#x5982;&#x6B64;&#xFF0C;&#x5B83;&#x672C;&#x8EAB;&#x5E76;&#x4E0D;&#x4F1A;&#x51CF;&#x5C11;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x5C06;&#x5E94;&#x7528;&#x89E3;&#x8026;&#x5230;&#x4E0D;&#x540C;&#x7684;JVM&#x4E2D;&#x7684;&#x53EF;&#x80FD;&#x6027;&#x3002;</p>
<p>&#x6BCF;&#x4E2A;&#x56DE;&#x6536;&#x5668;&#x90FD;&#x6709;&#x8BB8;&#x591A;&#x4E0D;&#x540C;&#x7684;&#x5F00;&#x5173;&#x548C;&#x9009;&#x9879;&#x6765;&#x8FDB;&#x884C;&#x8C03;&#x4F18;&#xFF0C;&#x8FD9;&#x53EF;&#x80FD;&#x4F1A;&#x589E;&#x52A0;&#x541E;&#x5410;&#x91CF;&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x4F1A;&#x51CF;&#x5C11;&#xFF0C;&#x8FD9;&#x53D6;&#x51B3;&#x4E8E;&#x4F60;&#x7684;&#x5E94;&#x7528;&#x7684;&#x5177;&#x4F53;&#x7684;&#x884C;&#x4E3A;&#x4E86;&#x3002;&#x5728;&#x4E0B;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x4E2D;&#x6211;&#x4EEC;&#x4F1A;&#x6DF1;&#x5165;&#x8BB2;&#x89E3;&#x914D;&#x7F6E;&#x8FD9;&#x4E9B;&#x7B97;&#x6CD5;&#x7684;&#x5173;&#x952E;&#x7B56;&#x7565;&#x3002;</p>
<p>&#x51FA;&#x5904;&#xFF1A;&#x82B1;&#x540D;&#x6709;&#x5B5A;</p>
<p>&#x94FE;&#x63A5;&#xFF1A;<a href="http://it.deepinmind.com/gc/2014/09/12/garbage-collectors-serial-vs-parallel-vs-cms-vs-the-g1-and-whats-new-in-java-8.html" target="_blank" rel="external">http://it.deepinmind.com/gc/2014/09/12/garbage-collectors-serial-vs-parallel-vs-cms-vs-the-g1-and-whats-new-in-java-8.html</a></p>
<p> <strong>ImportNew &#x4E13;&#x6CE8; Java &#x6280;&#x672F;&#x5206;&#x4EAB;&#xFF0C;&#x6B22;&#x8FCE;&#x5173;&#x6CE8;&#x3002;</strong></p>
<p>&#x5FAE;&#x4FE1;&#x53F7;&#xFF1A; ImportNew</p>
<p> <img src="http://taojinke.github.io/img/20150702/f43506a.png" alt=""></p>
<p>&#xFF08;&#x957F;&#x6309;&#x4E0A;&#x56FE; &#x2191;&#x2191;&#x2191; &#x53EF;&#x81EA;&#x52A8;&#x8BC6;&#x522B;&#x4E8C;&#x7EF4;&#x7801;&#xFF09;</p>
<p>&#x70B9;&#x51FB;&#x201C;&#x9605;&#x8BFB;&#x539F;&#x6587;&#x201D;&#xFF0C;&#x67E5;&#x770B;&#x66F4;&#x591A; Java &#x6587;&#x7AE0;&#x3002;</p>
<p>&#x2193;&#x2193;&#x2193;</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/JVM/">JVM</a><a href="/tags/Java8/">Java8</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/02/f442260/" title="Jvm原理剖析与调优之内存结构 -" itemprop="url">Jvm原理剖析与调优之内存结构 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-01T23:50:29.000Z" itemprop="datePublished"> 发表于 2015-07-02</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="&#x4E00;&#x4E9B;&#x4E0D;&#x5F97;&#x4E0D;&#x8BF4;&#x7684;&#x6982;&#x5FF5;">&#x4E00;&#x4E9B;&#x4E0D;&#x5F97;&#x4E0D;&#x8BF4;&#x7684;&#x6982;&#x5FF5;</h4><p>JVM</p>
<p>JVM&#x662F;&#x4E00;&#x79CD;&#x7528;&#x4E8E;&#x8BA1;&#x7B97;&#x8BBE;&#x5907;&#x7684;&#x89C4;&#x8303;&#xFF0C;&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x865A;&#x6784;&#x51FA;&#x6765;&#x7684;&#x8BA1;&#x7B97;&#x673A;&#xFF0C;&#x662F;&#x901A;&#x8FC7;&#x5728;&#x5B9E;&#x9645;&#x7684;&#x8BA1;&#x7B97;&#x673A;&#x4E0A;&#x4EFF;&#x771F;&#x6A21;&#x62DF;&#x5404;&#x79CD;&#x8BA1;&#x7B97;&#x673A;&#x529F;&#x80FD;&#x6765;&#x5B9E;&#x73B0;&#x7684;&#x3002;Java&#x865A;&#x62DF;&#x673A;&#x5305;&#x62EC;&#x4E00;&#x5957;&#x5B57;&#x8282;&#x7801;&#x6307;&#x4EE4;&#x96C6;&#x3001;&#x4E00;&#x7EC4;&#x5BC4;&#x5B58;&#x5668;&#x3001;&#x4E00;&#x4E2A;&#x6808;&#x3001;&#x4E00;&#x4E2A;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5806;&#x548C;&#x4E00;&#x4E2A;&#x5B58;&#x50A8;&#x65B9;&#x6CD5;&#x57DF;&#x3002; JVM&#x5C4F;&#x853D;&#x4E86;&#x4E0E;&#x5177;&#x4F53;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5E73;&#x53F0;&#x76F8;&#x5173;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x4F7F;Java&#x7A0B;&#x5E8F;&#x53EA;&#x9700;&#x751F;&#x6210;&#x5728;Java&#x865A;&#x62DF;&#x673A;&#x4E0A;&#x8FD0;&#x884C;&#x7684;&#x76EE;&#x6807;&#x4EE3;&#x7801;&#xFF08;&#x5B57;&#x8282;&#x7801;&#xFF09;,&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x591A;&#x79CD;&#x5E73;&#x53F0;&#x4E0A;&#x4E0D;&#x52A0;&#x4FEE;&#x6539;&#x5730;&#x8FD0;&#x884C;&#x3002;&#x662F;&#x8FD0;&#x884C;java&#x5E94;&#x7528;&#x6700;&#x5E95;&#x5C42;&#x90E8;&#x5206;&#x3002; </p>
<p> JDK  &#xFF08;Java Development kit&#xFF09;</p>
<p>&#x6574;&#x4E2A;Java&#x7684;&#x6838;&#x5FC3;&#xFF0C;&#x5305;&#x62EC;&#x4E86;Java&#x8FD0;&#x884C;&#x73AF;&#x5883;&#xFF08;Java Runtime Envirnment&#xFF09;&#xFF0C;&#x4E00;&#x5806;Java&#x5DE5;&#x5177;&#xFF08;&#x7F16;&#x8BD1;&#xFF0C;debug&#x7B49;&#xFF09;&#x548C;Java&#x57FA;&#x7840;&#x7684;&#x7C7B;&#x5E93;(rt.jar)&#x3002;&#x662F;&#x5F00;&#x53D1;java&#x5E94;&#x7528;&#x7684;&#x57FA;&#x7840;&#x3002; </p>
<p> JRE &#xFF08;Java Runtime Environment&#xFF0C;Java&#x8FD0;&#x884C;&#x73AF;&#x5883;&#xFF09; </p>
<p>&#x8FD0;&#x884C;JAVA&#x7A0B;&#x5E8F;&#x6240;&#x5FC5;&#x987B;&#x7684;&#x73AF;&#x5883;&#x7684;&#x96C6;&#x5408;&#xFF0C;&#x5305;&#x542B;JVM&#x6807;&#x51C6;&#x5B9E;&#x73B0;&#x53CA;Java&#x6838;&#x5FC3;&#x7C7B;&#x5E93;&#x3002;&#x8FD0;&#x884C;java&#x5E94;&#x7528;&#x7684;&#x57FA;&#x7840;&#x3002;</p>
<p> J2SE (Java 2 Platform,Standard Edition)&#x3002;&#x5305;&#x542B;&#x90A3;&#x4E9B;&#x6784;&#x6210;Java&#x8BED;&#x8A00;&#x6838;&#x5FC3;&#x7684;&#x7C7B;&#x3002;&#x6BD4;&#x5982;&#xFF1A;&#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;&#x3001;&#x63A5;&#x53E3;&#x5B9A;&#x4E49;&#x3001;&#x8F93;&#x5165;/&#x8F93;&#x51FA;&#x3001;&#x7F51;&#x7EDC;&#x7F16;&#x7A0B; </p>
<p> J2EE (Java 2 Platform,Enterprise Edition)&#x3002;Enterprise Edition(&#x4F01;&#x4E1A;&#x7248;) J2EE &#x5305;&#x542B;J2SE &#x4E2D;&#x7684;&#x7C7B;&#xFF0C;&#x5E76;&#x4E14;&#x8FD8;&#x5305;&#x542B;&#x7528;&#x4E8E;&#x5F00;&#x53D1;&#x4F01;&#x4E1A;&#x7EA7;&#x5E94;&#x7528;&#x7684;&#x7C7B;&#x3002;&#x6BD4;&#x5982;&#xFF1A;EJB&#x3001;servlet&#x3001;JSP&#x3001;XML&#x3001;&#x4E8B;&#x52A1;&#x63A7;&#x5236; </p>
<p> J2ME (Java 2 Platform,Micro Editon) </p>
<h4 id="&#x4E3B;&#x8981;JVM">&#x4E3B;&#x8981;JVM</h4><p>&#x9996;&#x5148;&#xFF0C;JVM&#x662F;&#x4E00;&#x5957;&#x89C4;&#x8303;&#x3002;&#xFFFD;&#xFFFD;&#xFFFD;&#x591A;&#x516C;&#x53F8;&#x5747;&#x5B9E;&#x73B0;&#x4E86;&#x5404;&#x81EA;&#x7684;&#x865A;&#x62DF;&#x673A;&#x3002;&#x5E38;&#x89C1;&#x7684;&#x6709;</p>
<p>HotSpot JVM(sun)<br> Jrockit JVM&#xFF08;BEA&#x516C;&#x53F8;&#x7684;JVM&#xFF0C;&#x5E94;&#x7528;&#x4E8E;weblogic)<br> IBM JVM</p>
<p>Apache Harmony</p>
<p>&#x5176;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5E38;&#x7528;&#x7684;&#x662F;HotSpot JVM.</p>
<h4 id="JVM&#x7ED3;&#x6784;">JVM&#x7ED3;&#x6784;</h4><p> <img src="http://taojinke.github.io/img/20150702/f43fb50.gif" alt=""></p>
<p> <img src="http://taojinke.github.io/img/20150702/f43fdc1.jpg" alt="clipboard.png"></p>
<p>&#x7B2C; &#x4E00;&#x6B65;(&#x7F16;&#x8BD1;): </p>
<p>&#x521B;&#x5EFA;&#x5B8C;&#x6E90;&#x6587;&#x4EF6;&#x4E4B;&#x540E;&#xFF0C;&#x7A0B;&#x5E8F;&#x4F1A;&#x5148;&#x88AB;&#x7F16;&#x8BD1;&#x4E3A;.class&#x6587;&#x4EF6;&#x3002;Java&#x7F16;&#x8BD1;&#x4E00;&#x4E2A;&#x7C7B;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x7C7B;&#x6240;&#x4F9D;&#x8D56;&#x7684;&#x7C7B;&#x8FD8;&#x6CA1;&#x6709;&#x88AB;&#x7F16;&#x8BD1;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x5C31;&#x4F1A;&#x5148;&#x7F16;&#x8BD1;&#x8FD9;&#x4E2A;&#x88AB;&#x4F9D;&#x8D56;&#x7684;&#x7C7B;&#xFF0C;&#x7136;&#x540E; &#x5F15;&#x7528;&#xFF0C;&#x8FD9;&#x4E2A;&#x6709;&#x70B9;&#x8C61;make&#x3002;&#x5982;&#x679C;java&#x7F16;&#x8BD1;&#x5668;&#x5728;&#x6307;&#x5B9A;&#x76EE;&#x5F55;&#x4E0B;&#x627E;&#x4E0D;&#x5230;&#x8BE5;&#x7C7B;&#x6240;&#x5176;&#x4F9D;&#x8D56;&#x7684;&#x7C7B;&#x7684;.class&#x6587;&#x4EF6;&#x6216;&#x8005;.java&#x6E90;&#x6587;&#x4EF6;&#x7684;&#x8BDD;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x8BDD; &#x62A5;&#x201C;cant find symbol&#x201D;&#x7684;&#x9519;&#x8BEF;&#x3002;</p>
<p>&#x7B2C;&#x4E8C;&#x6B65;&#xFF08;&#x8FD0;&#x884C;&#xFF09;&#xFF1A;</p>
<p>java&#x7C7B;&#x8FD0;&#x884C;&#x7684;&#x8FC7;&#x7A0B;&#x5927;&#x6982;&#x53EF;&#x5206;&#x4E3A;&#x4E24;&#x4E2A;&#x8FC7;&#x7A0B;&#xFF1A;1&#x3001;&#x7C7B;&#x7684;&#x52A0;&#x8F7D; &#xA0;2&#x3001;&#x7C7B;&#x7684;&#x6267;&#x884C;&#x3002;</p>
<p>&#x9700;&#x8981;&#x8BF4;&#x660E;&#x7684;&#x662F;&#xFF1A;JVM&#x4E3B;&#x8981;&#x5728;&#x7A0B;&#x5E8F;&#x7B2C;&#x4E00;&#x6B21;&#x4E3B;&#x52A8;&#x4F7F;&#x7528;&#x7C7B;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x624D;&#x4F1A;&#x53BB;&#x52A0;&#x8F7D;&#x8BE5;&#x7C7B;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;JVM&#x5E76;&#x4E0D;&#x662F;&#x5728;&#x4E00;&#x5F00;&#x59CB;&#x5C31;&#x628A;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x5C31;&#x6240;&#x6709;&#x7684;&#x7C7B;&#x90FD;&#x52A0;&#x8F7D;&#x5230;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x800C;&#x662F;&#x5230;&#x4E0D;&#x5F97;&#x4E0D;&#x7528;&#x7684;&#x65F6;&#x5019;&#x624D;&#x628A;&#x5B83;&#x52A0;&#x8F7D;&#x8FDB;&#x6765;&#xFF0C;&#x800C;&#x4E14;&#x53EA;&#x52A0;&#x8F7D;&#x4E00;&#x6B21;&#x3002; </p>
<ol>
<li>&#x5728; &#x7F16;&#x8BD1;&#x597D;java&#x7A0B;&#x5E8F;&#x5F97;&#x5230;MainApp.class&#x6587;&#x4EF6;&#x540E;&#xFF0C;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x4E0A;&#x6572;java AppMain&#x3002;&#x7CFB;&#x7EDF;&#x5C31;&#x4F1A;&#x542F;&#x52A8;&#x4E00;&#x4E2A;jvm&#x8FDB;&#x7A0B;&#xFF0C;jvm&#x8FDB;&#x7A0B;&#x4ECE;classpath&#x8DEF;&#x5F84;&#x4E2D;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x540D;&#x4E3A;AppMain.class&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x6587;&#x4EF6;&#xFF0C;&#x5C06; MainApp&#x7684;&#x7C7B;&#x4FE1;&#x606F;&#x52A0;&#x8F7D;&#x5230;&#x8FD0;&#x884C;&#x65F6;&#x6570;&#x636E;&#x533A;&#x7684;&#x65B9;&#x6CD5;&#x533A;&#x5185;&#xFF0C;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x53EB;&#x505A;MainApp&#x7C7B;&#x7684;&#x52A0;&#x8F7D;&#x3002;</li>
<li>&#xFF08;java&#x547D;&#x4EE4;&#xFF09; &#x7136;&#x540E;JVM&#x627E;&#x5230;AppMain&#x7684;&#x4E3B;&#x51FD;&#x6570;&#x5165;&#x53E3;&#xFF0C;&#x5F00;&#x59CB;&#x6267;&#x884C;main&#x51FD;&#x6570;</li>
<li>&#xFF08;&#x7C7B;&#x52A0;&#x8F7D;&#x5668;&#xFF09;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x4F1A;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x3002;JVM&#x4F1A;&#x9996;&#x5148; &#x4ECE;&#x65B9;&#x6CD5;&#x533A; &#x52A0;&#x8F7D;&#x7C7B;&#x4FE1;&#x606F;&#x548C;&#x76F8;&#x5173;&#x5E38;&#x91CF;&#xFF0C;class&#x52A0;&#x8F7D;&#x5B8C;&#x6BD5;&#x4E4B;&#x540E;,&#x5728;&#x5806;&#x4E0A;&#x4E3A;&#x5BF9;&#x8C61;&#x5206;&#x914D;&#x5185;&#x5B58;&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;&#x521D;&#x59CB;&#x5316;&#x5B9E;&#x4F8B;&#xFF0C;&#x5F53;&#x7136;&#x8FD9;&#x65F6;&#x5019;&#x5B9E;&#x4F8B;&#x4FDD;&#x6301;&#x6307;&#x5411;class&#x7C7B;&#x578B;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x4E2A;&#x4FE1;&#x606F;&#x4FDD;&#x5B58;&#x5728;&#x65B9;&#x6CD5;&#x533A;&#x4E2D;&#x3002;</li>
<li>&#xFF08;&#x6267;&#x884C;&#x5F15;&#x64CE;&#xFF09;&#x8C03;&#x7528;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x4F1A;&#x6839;&#x636E;&#x5F15;&#x7528;&#x627E;&#x5230;&#x5BF9;&#x8C61;&#x4FE1;&#x606F;&#xFF0C;&#x8FDB;&#x800C;&#x53EF;&#x5B9A;&#x4F4D;&#x5BF9;&#x5E94;&#x7684;class&#x7C7B;&#x578B;&#x4FE1;&#x606F;&#xFF0C;&#x548C;&#x65B9;&#x6CD5;&#x8868;&#x3002;</li>
<li>( &#x6267;&#x884C;&#x5F15;&#x64CE;&#xFF09; &#x6267;&#x884C;&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x5728;&#x865A;&#x62DF;&#x673A;&#x6808;&#x4E2D;&#x8FDB;&#x884C;&#xFF0C;&#x5206;&#x914D;&#x6808;&#x5E27;&#xFF0C;&#x968F;&#x7740;&#x5165;&#x6808;&#x51FA;&#x6808;&#xFF0C;&#x5B8C;&#x6210;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x64CD;&#x4F5C;&#x3002;</li>
</ol>
<h4 id="&#x6267;&#x884C;&#x5F15;&#x64CE;">&#x6267;&#x884C;&#x5F15;&#x64CE;</h4><p>&#x8FD0;&#x884C;Java&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x662F;&#x4E00;&#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x865A;&#x62DF;&#x673A;&#x6267;&#x884C;&#x5F15;&#x64CE;&#x7684;&#x5B9E;&#x4F8B;&#x3002;&#x4ECE;&#x7EBF;&#x7A0B;&#x751F;&#x547D;&#x5468;&#x671F;&#x7684;&#x5F00;&#x59CB;&#x5230;&#x7ED3;&#x675F;&#xFF0C;&#x4ED6;&#x8981;&#x4E48;&#x5728;&#x6267;&#x884C;&#x5B57;&#x8282;&#x7801;&#xFF0C;&#x8981;&#x4E48;&#x5728;&#x6267;&#x884C;&#x672C;&#x5730;&#x65B9;&#x6CD5;&#x3002;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x53EF;&#x80FD;&#x901A;&#x8FC7;&#x89E3;&#x91CA;&#x6216;&#x8005;&#x4F7F;&#x7528;&#x82AF;&#x7247;&#x7EA7;&#x6307;&#x4EE4;&#x76F4;&#x63A5;&#x6267;&#x884C;&#x5B57;&#x8282;&#x7801;&#xFF0C;&#x6216;&#x8005;&#x95F4;&#x63A5;&#x901A;&#x8FC7;JIT&#x6267;&#x884C;&#x7F16;&#x8BD1;&#x8FC7;&#x7684;&#x672C;&#x5730;&#x4EE3;&#x7801;&#x3002;&#x6211;&#x4EEC;&#x4E0A;&#x6587;&#x8BB2;&#x5230;&#x7684;main&#x51FD;&#x6570;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x6267;&#x884C;&#x5F15;&#x64CE;&#x7684;&#x64CD;&#x4F5C;&#x5165;&#x53E3;&#x3002;</p>
<h4 id="Class&#x6587;&#x4EF6;">Class&#x6587;&#x4EF6;</h4><p>&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;Class&#x6587;&#x4EF6;&#x4E2D;&#x65B9;&#x6CD5;&#x7684;&#x5B57;&#x8282;&#x7801;&#x6D41;&#x5C31;&#x662F;&#x6709;JVM&#x7684;&#x6307;&#x4EE4;&#x5E8F;&#x5217;&#x6784;&#x6210;&#x7684;&#x3002;&#x6BCF;&#x4E00;&#x6761;&#x6307;&#x4EE4;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x5355;&#x5B57;&#x8282;&#x7684;&#x64CD;&#x4F5C;&#x7801;&#xFF0C;&#x540E;&#x9762;&#x8DDF;&#x968F;0&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x64CD;&#x4F5C;&#x6570;&#x3002; </p>
<p>iload_0 &#xA0; &#xA0;// &#x628A;&#x5B58;&#x50A8;&#x5728;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x533A;&#x4E2D;&#x7D22;&#x5F15;&#x4E3A;0&#x7684;&#x6574;&#x6570;&#x538B;&#x5165;&#x64CD;&#x4F5C;&#x6570;&#x6808;&#x3002;</p>
<p>iload_1 &#xA0; &#xA0;// &#x628A;&#x5B58;&#x50A8;&#x5728;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x533A;&#x4E2D;&#x7D22;&#x5F15;&#x4E3A;1&#x7684;&#x6574;&#x6570;&#x538B;&#x5165;&#x64CD;&#x4F5C;&#x6570;&#x6808;&#x3002;</p>
<p>iadd &#xA0; &#xA0; &#xA0; &#xA0; // &#x4ECE;&#x64CD;&#x4F5C;&#x6570;&#x6808;&#x4E2D;&#x5F39;&#x51FA;&#x4E24;&#x4E2A;&#x6574;&#x6570;&#x76F8;&#x52A0;&#xFF0C;&#x5728;&#x5C06;&#x7ED3;&#x679C;&#x538B;&#x5165;&#x64CD;&#x4F5C;&#x6570;&#x6808;&#x3002;</p>
<p>istore_2 &#xA0; // &#x4ECE;&#x64CD;&#x4F5C;&#x6570;&#x6808;&#x4E2D;&#x5F39;&#x51FA;&#x7ED3;&#x679C;</p>
<h4 id="JVM&#x8FD0;&#x884C;&#x65F6;&#x6570;&#x636E;&#x533A;">JVM&#x8FD0;&#x884C;&#x65F6;&#x6570;&#x636E;&#x533A;</h4><p>1)&#x7A0B;&#x5E8F;&#x8BA1;&#x6570;&#x5668;(&#x7EBF;&#x7A0B;&#x79C1;&#x6709;&#xFF09;</p>
<p>&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x6240;&#x6267;&#x884C;&#x7684;&#x5B57;&#x8282;&#x7801;&#x7684;&#x884C;&#x53F7;&#x6307;&#x793A;&#x5668;&#xFF0C;&#x901A;&#x8FC7;&#x6539;&#x53D8;&#x8FD9;&#x4E2A;&#x8BA1;&#x6570;&#x5668;&#x7684;&#x503C;&#xFF0C;&#x786E;&#x5B9A;&#x4E0B;&#x4E00;&#x6761;&#x8981;&#x6267;&#x884C;&#x7684;&#x547D;&#x4EE4;&#x3002;&#x5206;&#x652F;&#xFF0C;&#x5FAA;&#x73AF;&#xFF0C;&#x8DF3;&#x8F6C;&#x90FD;&#x9700;&#x8981;&#x5B83;&#x7684;&#x652F;&#x6301;&#x3002;</p>
<p>&#x5B83;&#x662F;&#x7EBF;&#x7A0B;&#x79C1;&#x6709;&#x7684;&#xFF0C;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x6709;&#x4E13;&#x5C5E;&#x4E8E;&#x81EA;&#x5DF1;&#x7684;&#x7A0B;&#x5E8F;&#x8BB0;&#x6570;&#x5668;&#xFF0C;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x4E92;&#x4E0D;&#x5F71;&#x54CD;&#xFF0C;&#x72EC;&#x7ACB;&#x5B58;&#x50A8;&#xFF0C;&#x4FDD;&#x8BC1;&#x4E86;&#x7EBF;&#x7A0B;&#x5207;&#x6362;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x6062;&#x590D;&#x5230;&#x539F;&#x5148;&#x6267;&#x884C;&#x4F4D;&#x7F6E;&#x3002;</p>
<p>2)Java&#x865A;&#x62DF;&#x673A;&#x6808;&#xFF08;&#x7EBF;&#x7A0B;&#x79C1;&#x6709;&#xFF09;</p>
<p>&#x6BCF;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x6267;&#x884C;&#xFF0C;&#x540C;&#x65F6;&#x90FD;&#x4F1A;&#x5728;&#x865A;&#x62DF;&#x673A;&#x6808;&#x4E0A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6808;&#x5E27;&#x3002;&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x8868;&#xFF0C;&#x64CD;&#x4F5C;&#x6570;&#x6808;&#xFF0C;&#x65B9;&#x6CD5;&#x51FA;&#x53E3;&#xFF0C;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x7B49;&#x3002;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x6267;&#x884C;&#x5468;&#x671F;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x5C31;&#x5BF9;&#x5E94;&#x7740;&#x6808;&#x5E27;&#x7684;&#x51FA;&#x6808;&#x5165;&#x6808;&#x64CD;&#x4F5C;&#x3002;&#x6709;&#x65F6;&#x5019;&#x65B9;&#x6CD5;&#x7684;&#x9012;&#x5F52;&#xFF0C;&#x4F1A;&#x9020;&#x6210;&#x5927;&#x91CF;&#x7684;&#x6808;&#x5E27;&#xFF0C;&#x8FBE;&#x5230;&#x4E00;&#x5B9A;&#x7684;&#x6DF1;&#x5EA6;&#xFF0C;&#x4F1A;&#x62A5;StackOverflowError&#x5F02;&#x5E38;&#x3002;&#x6709;&#x4E00;&#x70B9;&#x9700;&#x8981;&#x8BF4;&#x660E;:&#x5728;&#x7F16;&#x8BD1;&#x5668;&#x7F16;&#x8BD1;Java&#x4EE3;&#x7801;&#x65F6;&#xFF0C;&#x5C31;&#x5DF2;&#x7ECF;&#x5728;&#x5B57;&#x8282;&#x7801;&#x4E2D;&#x4E3A;&#x6BCF;&#x4E2A;&#x65B9;&#x6CD5;&#x90FD;&#x8BBE;&#x7F6E;&#x597D;&#x4E86;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x533A;&#x548C;&#x64CD;&#x4F5C;&#x6570;&#x6808;&#x7684;&#x6570;&#x636E;&#x548C;&#x5927;&#x5C0F;&#x3002;&#x5E76;&#x5728;JVM&#x9996;&#x6B21;&#x52A0;&#x8F7D;&#x65B9;&#x6CD5;&#x6240;&#x5C5E;&#x7684;Class&#x6587;&#x4EF6;&#x65F6;&#xFF0C; &#x5C31;&#x5C06;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#x653E;&#x8FDB;&#x4E86;&#x65B9;&#x6CD5;&#x533A;&#x3002;&#x56E0;&#x6B64;&#x5728;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x6839;&#x636E;&#x65B9;&#x6CD5;&#x533A;&#x4E2D;&#x7684;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x533A;&#x548C;&#x64CD;&#x4F5C;&#x6570;&#x6808;&#x7684;&#x5927;&#x5C0F;&#x6765;&#x5206;&#x914D;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x6808;&#x5E27;&#x7684;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#xFF0C;&#x5E76;&#x5806;&#x5165;Java&#x6808;&#x3002;</p>
<p>&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x533A;&#xFF1A; &#x7528;&#x6765;&#x5B58;&#x653E;&#x65B9;&#x6CD5;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x503C;&#xFF0C;&#x5305;&#x62EC;&#x4F20;&#x9012;&#x7684;&#x53C2;&#x6570;&#x3002;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#x4F1A;&#x88AB;&#x7EC4;&#x7EC7;&#x6210;&#x4EE5;&#x4E00;&#x4E2A;&#x5B57;&#x957F;(32bit&#x6216;64bit)&#x4E3A;&#x5355;&#x4F4D;&#x7684;&#x6570;&#x7EC4;&#x7ED3;&#x6784;(&#x4EE5;&#x7D22;&#x5F15;0&#x5F00;&#x59CB;)&#x4E2D;&#x3002;&#x5176;&#x4E2D;&#x7C7B; &#x578B;&#x4E3A;int, float, reference(&#x5F15;&#x7528;&#x7C7B;&#x578B;&#xFF0C;&#x8BB0;&#x5F55;&#x5BF9;&#x8C61;&#x5728;&#x5806;&#x4E2D;&#x5730;&#x5740;)&#x548C;returnAddress(&#x4E00;&#x79CD;JVM&#x5185;&#x90E8;&#x4F7F;&#x7528;&#x7684;&#x57FA;&#x672C;&#x7C7B;&#x578B;)&#x7684;&#x503C;&#x5360;&#x7528;1&#x4E2A;&#x5B57;&#x957F;&#xFF0C;&#x800C;byte, char&#x548C;shot&#x4F1A;&#x6269;&#x5927;&#x6210;1&#x4E2A;&#x5B57;&#x957F;&#x5B58;&#x50A8;&#xFF0C;long&#xFF0C;double&#x5219;&#x4F7F;&#x7528;2&#x4E2A;&#x5B57;&#x957F;&#x3002;</p>
<p>&#x64CD;&#x4F5C;&#x6570;&#x6808;&#xFF1A; &#x7528;&#x6765;&#x5728;&#x6267;&#x884C;&#x6307;&#x4EE4;&#x7684;&#x65F6;&#x5019;&#x5B58;&#x50A8;&#x548C;&#x4F7F;&#x7528;&#x4E2D;&#x95F4;&#x7ED3;&#x679C;&#x6570;&#x636E;&#x3002;</p>
<p>&#x5E27;&#x6570;&#x636E;&#x533A;&#xFF1A; &#x5E38;&#x91CF;&#x6C60;&#x7684;&#x89E3;&#x6790;&#xFF0C;&#x6B63;&#x5E38;&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x4EE5;&#x53CA;&#x5F02;&#x5E38;&#x6D3E;&#x53D1;&#x673A;&#x5236;&#x7684;&#x4FE1;&#x606F;&#x6570;&#x636E;&#x90FD;&#x5B58;&#x50A8;&#x5728;&#x5176;&#x4E2D;&#x3002;</p>
<p>3&#xFF09;&#x672C;&#x5730;&#x65B9;&#x6CD5;&#x6808;&#xFF08;&#x7EBF;&#x7A0B;&#x79C1;&#x6709;&#xFF09;</p>
<p>&#x4E0E;Java&#x865A;&#x62DF;&#x673A;&#x6808;&#x7C7B;&#x4F3C;&#xFF0C;&#x53EA;&#x4E0D;&#x8FC7;&#x8BE5;&#x533A;&#x57DF;&#x662F;&#x4E3A;native&#x65B9;&#x6CD5;&#x63D0;&#x4F9B;&#x670D;&#x52A1;&#x3002;</p>
<p>4&#xFF09;&#x65B9;&#x6CD5;&#x533A;(Perm)&#xFF08;&#x7EBF;&#x7A0B;&#x5171;&#x4EAB;&#xFF09;</p>
<p>&#x5B58;&#x50A8;&#x5DF2;&#x88AB;&#x865A;&#x62DF;&#x673A;&#x52A0;&#x8F7D;&#x7684;&#x7C7B;&#x4FE1;&#x606F;&#xFF0C;&#x5E38;&#x91CF;&#xFF0C;&#x9759;&#x6001;&#x53D8;&#x91CF;&#xFF0C;&#x5373;&#x65F6;&#x7F16;&#x8BD1;&#x540E;&#x7684;&#x4EE3;&#x7801;&#x7B49;&#x6570;&#x636E;&#x3002;&#x5305;&#x542B;&#x8FD0;&#x884C;&#x65F6;&#x5E38;&#x91CF;&#x6C60;&#xFF0C;&#x7528;&#x4E8E;&#x5B58;&#x653E;&#x7F16;&#x8BD1;&#x5668;&#x751F;&#x6210;&#x7684;&#x5404;&#x79CD;&#x5B57;&#x9762;&#x91CF;&#x548C;&#x7B26;&#x53F7;&#x5F15;&#x7528;&#xFF0C;&#x8FD9;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#x662F;&#x5728;&#x7C7B;&#x52A0;&#x8F7D;&#x540E;&#x8FDB;&#x5165;&#x65B9;&#x6CD5;&#x533A;&#x8FD0;&#x884C;&#x65F6;&#x5E38;&#x91CF;&#x6C60;&#x4E2D;&#x3002;</p>
<p>5&#xFF09;&#x5806;</p>
<p><img src="http://taojinke.github.io/img/20150702/f440032.jpg" alt="clipboard.png"></p>
<p>&#x5806;&#x662F;&#x6574;&#x4E2A;&#x5185;&#x5B58;&#x6570;&#x636E;&#x533A;&#x6700;&#x8D1F;&#x8D23;&#x7684;&#x90E8;&#x5206;&#xFF0C;&#x8D1F;&#x8D23;&#x5BF9;&#x8C61;&#x7684;&#x521B;&#x5EFA;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x5783;&#x573E;&#x56DE;&#x6536;&#x7684;&#x4E3B;&#x8981;&#x5DE5;&#x4F5C;&#x4E5F;&#x5728;&#x4E8E;&#x6B64;&#x3002;&#x5806;&#x53C8;&#x8FDB;&#x4E00;&#x6B65;&#x8FDB;&#x884C;&#x7EC6;&#x5206;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x4E3A;&#x4E86;&#x6EE1;&#x8DB3;&#x5783;&#x573E;&#x56DE;&#x6536;&#x3002; </p>
<p>&#x5806;&#x7684;&#x7EC4;&#x6210; </p>
<p> Eden(&#x4F0A;&#x7538;&#x56ED;&#xFF09; &#xFF1A;&#x5BF9;&#x8C61;&#x521B;&#x5EFA;&#x7684;&#x5165;&#x53E3;&#x3002; </p>
<p> Survivor Space: &#x7528;&#x4E8E;&#x4FDD;&#x5B58;&#x5728;eden space&#x5185;&#x5B58;&#x6C60;&#x4E2D;&#x7ECF;&#x8FC7;&#x5783;&#x573E;&#x56DE;&#x6536;&#x540E;&#x6CA1;&#x6709;&#x88AB;&#x56DE;&#x6536;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x201C;&#x5E78;&#x5B58;&#x8FD8;&#x6D3B;&#x7740;&#x201D;&#x7684;&#x5BF9;&#x8C61;&#x3002; </p>
<p>&#x5E78;&#x5B58;&#x8005;0&#x533A;&#xFF08;Survivor 0 space&#xFF09;&#x548C;&#x5E78;&#x5B58;&#x8005;1&#x533A;&#xFF08;Survivor1 space&#xFF09;&#xFF1A;&#x5F53;&#x4F0A;&#x7538;&#x56ED;&#x7684;&#x7A7A;&#x95F4;&#x7528;&#x5B8C;&#x65F6;&#xFF0C;&#x7A0B;&#x5E8F;&#x53C8;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#xFF1B;&#x6B64;&#x65F6;JVM&#x7684;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#x5C06;&#x5BF9;&#x4F0A;&#x7538;&#x56ED;&#x533A;&#x8FDB;&#x884C;&#x5783;&#x573E;&#x56DE;&#x6536;&#xFF0C;&#x5C06;&#x4F0A;&#x7538;&#x56ED;&#x533A;&#x4E2D;&#x7684;&#x4E0D;&#x518D;&#x88AB;&#x5176;&#x4ED6;&#x5BF9;&#x8C61;&#x6240;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61; &#x8FDB;&#x884C;&#x9500;&#x6BC1;&#x5DE5;&#x4F5C;&#x3002;&#x540C;&#x65F6;&#x5C06;&#x4F0A;&#x7538;&#x56ED;&#x4E2D;&#x7684;&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#x5BF9;&#x8C61;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#x79FB;&#x52A8;&#x5230;&#x5E78;&#x5B58;&#x8005;0&#x533A;&#x3002;&#x5E78;&#x5B58;&#x8005;0&#x533A;&#x5C31;&#x662F;&#x7528;&#x4E8E;&#x5B58;&#x653E;&#x4F0A;&#x7538;&#x56ED;&#x5783;&#x573E;&#x56DE;&#x6536;&#x65F6;&#x6240;&#x5E78;&#x5B58;&#x4E0B;&#x6765;&#x7684;JAVA&#x5BF9;&#x8C61;&#x3002;</p>
<p>&#x5F53;&#x5C06;&#x4F0A;&#x7538;&#x56ED;&#x4E2D;&#x7684;&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#x5BF9;&#x8C61;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#x79FB;&#x52A8;&#x5230;&#x5E78;&#x5B58;&#x8005;0&#x533A;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x5E78;&#x5B58;&#x8005;0&#x533A;&#x4E5F;&#x6CA1;&#x6709;&#x7A7A;&#x95F4;&#x6765;&#x5B58;&#x653E;&#x8FD9;&#x4E9B;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;JVM&#x7684;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#x5C06;&#x5BF9;&#x5E78;&#x5B58;&#x8005;0&#x533A;&#x8FDB;&#x884C;&#x5783;&#x573E; &#x56DE;&#x6536;&#x5904;&#x7406;&#xFF0C;&#x5C06;&#x5E78;&#x5B58;&#x8005;0&#x533A;&#x4E2D;&#x4E0D;&#x5728;&#x6709;&#x5176;&#x4ED6;&#x5BF9;&#x8C61;&#x5F15;&#x7528;&#x7684;JAVA&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x9500;&#x6BC1;&#xFF0C;&#x5C06;&#x5E78;&#x5B58;&#x8005;0&#x533A;&#x4E2D;&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#x5BF9;&#x8C61;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#x79FB;&#x52A8;&#x5230;&#x5E78;&#x5B58;&#x8005;1&#x533A;&#x3002;&#x5E78;&#x5B58;&#x8005;1&#x533A;&#x7684;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x7528;&#x4E8E; &#x5B58;&#x653E;&#x5E78;&#x5B58;&#x8005;0&#x533A;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5904;&#x7406;&#x6240;&#x5E78;&#x5B58;&#x4E0B;&#x6765;&#x7684;JAVA&#x5BF9;&#x8C61;&#x3002;</p>
<p> Tenured : &#x5BF9;&#x8C61;&#x7ECF;&#x8FC7;survivor 1 space&#x5185;&#x5B58;&#x6C60;&#xFF0C;&#x6BCF;&#x7ECF;&#x5386;&#x8FC7;&#x4E00;&#x6B21;&#x5783;&#x573E;&#x56DE;&#x6536;&#xFF0C;&#x5E74;&#x9F84;&#x5C31;&#x589E;&#x52A0;1&#xFF0C;&#x8D85;&#x8FC7;&#x8BBE;&#x5B9A;&#x9600;&#x503C;&#x540E;&#xFF0C;&#x88AB;&#x79FB;&#x5165;&#x7EC8;&#x8EAB;&#x4EE3;&#xFF0C;&#x5F53;&#x7136;&#x4E5F;&#x5305;&#x62EC;&#x7531;&#x4E8E;&#x62C5;&#x4FDD;&#x673A;&#x5236;&#x79FB;&#x5165;&#x7684;&#x5BF9;&#x8C61;&#x3002; </p>
<p>&#x5BF9;&#x4E8E;&#x65B0;&#x751F;&#x4EE3;&#x548C;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#x5BF9;&#x5176;&#x6001;&#x5EA6;&#x4E0D;&#x540C;&#x3002;</p>
<p>&#x53D1;&#x751F;&#x5728;&#x65B0;&#x751F;&#x4EE3;&#x7684;&#x56DE;&#x6536;&#x9891;&#x7387;&#x9891;&#x7E41;&#xFF0C;&#x5927;&#x90E8;&#x5206;&#x5BF9;&#x8C61;&#x662F;&#x201C;&#x671D;&#x751F;&#x5915;&#x6B7B;&#x201D;&#xFF0C;&#x6536;&#x96C6;&#x7B97;&#x6CD5;&#x4E00;&#x822C;&#x91C7;&#x7528;&#x9AD8;&#x6548;&#x7B80;&#x5355;&#x7684;&#x590D;&#x5236;&#x7B97;&#x6CD5;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x4E0A;&#x6587;&#x63CF;&#x8FF0;&#x7684;&#x5BF9;&#x8C61;&#x8F6C;&#x79FB;&#x64CD;&#x4F5C;&#xFF08;Eden-&gt;survivor 0,survivor 0-&gt;survivor 1)&#x3002; &#x53D1;&#x751F;&#x5728;&#x8BE5;&#x533A;&#x57DF;&#x7684;&#x5783;&#x573E;&#x56DE;&#x6536;&#x4E3A;Young GC.</p>
<p>&#x5BF9;&#x4E8E;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x7531;&#x4E8E;&#x5927;&#x90E8;&#x5206;&#x5BF9;&#x8C61;&#x4E3B;&#x8981;&#x4E3A;&#x5B58;&#x6D3B;&#x7387;&#x9AD8;&#x7684;&#x5BF9;&#x8C61;&#xFF0C; &#x5783;&#x573E;&#x56DE;&#x6536;&#x5668; &#x91C7;&#x7528;&#x201D;&#x6807;&#x8BB0;-&#x6574;&#x7406;&#x201C;&#x7B97;&#x6CD5;&#x3002;&#x53D1;&#x751F;&#x5728;&#x8BE5;&#x533A;&#x57DF;&#x7684;&#x5783;&#x573E;&#x56DE;&#x6536;&#x4E3A;FULL GC. </p>
<h4 id="&#x5806;&#x76F8;&#x5173;&#x53C2;&#x6570;">&#x5806;&#x76F8;&#x5173;&#x53C2;&#x6570;</h4><p>&#xFF08;&#x5F71;&#x54CD;&#x5806;&#x7A7A;&#x95F4;&#x5212;&#x5206;&#xFF0C;&#x8FDB;&#x800C;&#x4F1A;&#x5F71;&#x54CD;GC&#x53D1;&#x751F;&#x9891;&#x7387;&#xFF09;JVM&#x8C03;&#x4F18;&#x5DE5;&#x4F5C;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x57FA;&#x4E8E;&#x8FD9;&#x4E9B;&#x53C2;&#x6570;&#xFF0C;&#x8FDB;&#x884C;&#x9002;&#x5F53;&#x8C03;&#x6574;&#x7BA1;&#x7406;&#xFF0C;&#x8FBE;&#x5230;&#x8C03;&#x6574;&#x5806;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x53CA;&#x6BD4;&#x4F8B;&#x5927;&#x5C0F;&#xFF0C;&#x4EE5;&#x6EE1;&#x8DB3;&#x5B9E;&#x9645;&#x4E1A;&#x52A1;&#x9700;&#x6C42;&#x3002;&#x53E6;&#x5916;&#x8FD8;&#x5305;&#x62EC;&#x65B9;&#x6CD5;&#x533A;&#x3002;</p>
<p>-Xms&#xFF1A;&#x8BBE;&#x7F6E; Java &#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x65F6;&#x7684;&#x521D;&#x59CB;&#x5806;&#x5927;&#x5C0F;&#xFF1B;</p>
<p>-Xmx&#xFF1A;&#x8BBE;&#x7F6E; Java &#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x80FD;&#x83B7;&#x5F97;&#x7684;&#x6700;&#x5927;&#x5806;&#x5927;&#x5C0F;&#xFF1B;</p>
<p>-Xss&#xFF1A;&#x8BBE;&#x7F6E;&#x7EBF;&#x7A0B;&#x6808;&#x7684;&#x5927;&#x5C0F;&#xFF1B;</p>
<p>-XX&#xFF1A;MinHeapFreeRatio&#xFF1A;&#x8BBE;&#x7F6E;&#x5806;&#x7A7A;&#x95F4;&#x6700;&#x5C0F;&#x7A7A;&#x95F2;&#x6BD4;&#x4F8B;&#x3002;&#x5F53;&#x5806;&#x7A7A;&#x95F4;&#x7684;&#x7A7A;&#x95F2;&#x5185;&#x5B58;&#x5C0F;&#x4E8E;&#x8FD9;&#x4E2A;&#x6570;&#x503C;&#x65F6;&#xFF0C;JVM &#x4FBF;&#x4F1A;&#x6269;&#x5C55;&#x5806;&#x7A7A;&#x95F4;&#xFF1B;</p>
<p>-XX&#xFF1A;MaxHeapFreeRatio&#xFF1A;&#x8BBE;&#x7F6E;&#x5806;&#x7A7A;&#x95F4;&#x7684;&#x6700;&#x5927;&#x7A7A;&#x95F2;&#x6BD4;&#x4F8B;&#x3002;&#x5F53;&#x5806;&#x7A7A;&#x95F4;&#x7684;&#x7A7A;&#x95F2;&#x5185;&#x5B58;&#x5927;&#x4E8E;&#x8FD9;&#x4E2A;&#x6570;&#x503C;&#x65F6;&#xFF0C;&#x4FBF;&#x4F1A;&#x538B;&#x7F29;&#x5806;&#x7A7A;&#x95F4;&#xFF0C;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x8F83;&#x5C0F;&#x7684;&#xFFFD;&#xFFFD;&#xFFFD;&#xFF1B;</p>
<p>-XX&#xFF1A;NewSize&#xFF1A;&#x8BBE;&#x7F6E;&#x65B0;&#x751F;&#x4EE3;&#x7684;&#x5927;&#x5C0F;&#xFF1B;</p>
<p>-XX&#xFF1A;NewRatio&#xFF1A;&#x8BBE;&#x7F6E;&#x8001;&#x5E74;&#x4EE3;&#x4E0E;&#x65B0;&#x751F;&#x4EE3;&#x7684;&#x6BD4;&#x4F8B;&#xFF0C;&#x5B83;&#x7B49;&#x4E8E;&#x8001;&#x5E74;&#x4EE3;&#x5927;&#x5C0F;&#x9664;&#x4EE5;&#x65B0;&#x751F;&#x4EE3;&#x5927;&#x5C0F;&#xFF1B;</p>
<p>-XX&#xFF1A;SurvivorRatio&#xFF1A;&#x65B0;&#x751F;&#x4EE3;&#x4E2D; eden &#x533A;&#x4E0E; survivor &#x533A;&#x7684;&#x6BD4;&#x4F8B;&#xFF1B;</p>
<p>-XX&#xFF1A;MaxPermSize&#xFF1A;&#x8BBE;&#x7F6E;&#x6700;&#x5927;&#x7684;&#x6301;&#x4E45;&#x533A;&#x5927;&#x5C0F;&#xFF1B;</p>
<p>-XX&#xFF1A;TargetSurvivorRatio&#xFF1A; &#x8BBE;&#x7F6E; survivor &#x533A;&#x7684;&#x53EF;&#x4F7F;&#x7528;&#x7387;&#x3002;&#x5F53; survivor &#x533A;&#x7684;&#x7A7A;&#x95F4;&#x4F7F;&#x7528;&#x7387;&#x8FBE;&#x5230;&#x8FD9;&#x4E2A;&#x6570;&#x503C;&#x65F6;&#xFF0C;&#x4F1A;&#x5C06;&#x5BF9;&#x8C61;&#x9001;&#x5165;&#x8001;&#x5E74;&#x4EE3;&#x3002;</p>
<h4 id="&#x5BF9;&#x8C61;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;">&#x5BF9;&#x8C61;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;</h4><h4 id="&#x521B;&#x5EFA;&#x9636;&#x6BB5;">&#x521B;&#x5EFA;&#x9636;&#x6BB5;</h4><p>1&#xFF09;&#x68C0;&#x67E5;&#x6307;&#x4EE4;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x662F;&#x5426;&#x80FD;&#x5728;&#x5E38;&#x91CF;&#x6C60;&#x4E2D;&#x5B9A;&#x4F4D;&#x5230;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x7B26;&#x53F7;&#x5F15;&#x7528;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x5F15;&#x7528;&#xFF0C;&#x5224;&#x65AD;&#x4EE3;&#x8868;&#x7684;&#x7C7B;&#x662F;&#x5426;&#x52A0;&#x8F7D;&#xFF0C;&#x89E3;&#x6790;&#x548C;&#x521D;&#x59CB;&#x5316;&#x8FC7;</p>
<p>2&#xFF09;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x52A0;&#x8F7D;&#xFF0C;&#x5219;&#x5FC5;&#x987B;&#x8FDB;&#x884C;&#x52A0;&#x8F7D;&#xFF0C;&#x89E3;&#x6790;&#x548C;&#x521D;&#x59CB;&#x5316;</p>
<p>3&#xFF09;&#x7C7B;&#x52A0;&#x8F7D;&#x68C0;&#x67E5;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x5DF2;&#x7ECF;&#x77E5;&#x9053;&#x6240;&#x9700;&#x5185;&#x5B58;&#x7684;&#x5927;&#x5C0F;&#x3002;</p>
<p>4&#xFF09;&#x5206;&#x914D;&#x5185;&#x5B58;&#x3002;&#x4ECE;java&#x5806;&#x4E2D;&#x5212;&#x5206;&#x4E00;&#x5757;&#x5927;&#x5C0F;&#x786E;&#x5B9A;&#x7684;&#x5185;&#x5B58;&#x3002;&#x652F;&#x6301;2&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x81F3;&#x4E8E;&#x9009;&#x62E9;&#x54EA;&#x79CD;&#x65B9;&#x5F0F;&#x5206;&#x914D;&#x5185;&#x5B58;&#xFF0C;&#x4E0E;java&#x5806;&#x662F;&#x5426;&#x89C4;&#x6574;&#x6709;&#x5173;&#xFF08;&#x4E5F;&#x5C31;&#x662F;&#x662F;&#x5426;&#x7A7A;&#x95F4;&#x7A7A;&#x95F4;&#x548C;&#x4F7F;&#x7528;&#x7A7A;&#x95F4;&#x76F8;&#x4E92;&#x4EA4;&#x9519;&#x60C5;&#x51B5;&#xFF09;&#x3002;1.&#x6307;&#x9488;&#x78B0;&#x649E;&#xFF08;&#x5206;&#x754C;&#x70B9;&#x7684;&#x6307;&#x793A;&#x5668;&#x79FB;&#x52A8;&#xFF09;&#xFF1B;2.&#x7A7A;&#x95F2;&#x5217;&#x8868;&#x65B9;&#x5F0F;&#x3002;&#x7136;&#x800C;&#xFF0C;java&#x5806;&#x662F;&#x5426;&#x89C4;&#x6574;&#xFF0C;&#x5219;&#x53D6;&#x51B3;&#x4E8E;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x7684;&#x5DE5;&#x4F5C;&#x65B9;&#x5F0F;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5728;&#x5206;&#x914D;&#x5185;&#x5B58;&#x65F6;&#x8FD8;&#x8981;&#x8003;&#x8651;&#x591A;&#x7EBF;&#x7A0B;&#x60C5;&#x51B5;&#xFF0C;&#x4FDD;&#x8BC1;&#x539F;&#x5B50;&#x6027;&#x3002;&#x5206;&#x914D;&#x5185;&#x5B58;&#x7684;&#x539F;&#x5B50;&#x6027;&#x6709;2&#x79CD;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x4FDD;&#x8BC1;&#xFF08;CAS &#x548C; &#x672C;&#x5730;&#x7EBF;&#x7A0B;&#x5206;&#x914D;&#x7F13;&#x51B2;-XX +/- UseTLAB&#xFF09;&#x3002;</p>
<p>5) &#x5206;&#x914D;&#x5185;&#x5B58;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x521D;&#x59CB;&#x5316;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#xFF08;&#x521D;&#x59CB;&#x5316;&#x4E3A;0&#xFF09;</p>
<p>6&#xFF09;&#x7EF4;&#x62A4;&#x5BF9;&#x8C61;&#x7684;&#x5BF9;&#x8C61;&#x5934;&#x4FE1;&#x606F;&#x3002;&#x5982;&#x5143;&#x6570;&#x636E;&#x4FE1;&#x606F;&#xFF0C;&#x54C8;&#x5E0C;&#x7801;&#xFF0C;GC&#x5206;&#x4EE3;&#x5E74;&#x9F84;&#xFF0C;&#x9501;&#x4FE1;&#x606F;&#xFF0C;&#x7C7B;&#x5143;&#x6307;&#x9488;&#x3002;</p>
<p>7&#xFF09;&#x8C03;&#x7528;init&#x65B9;&#x6CD5;&#xFF0C;&#x6309;&#x7167;&#x7A0B;&#x5E8F;&#x5458;&#x610F;&#x613F;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#x3002;</p>
<p>  &lt;7.1&gt; &#x4ECE;&#x8D85;&#x7C7B;&#x5230;&#x5B50;&#x7C7B;&#x5BF9;static&#x6210;&#x5458;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#xFF1B;&#xA0;<br>    &#xA0;&#xA0;&#xA0;&#xA0; &lt;7.2&gt; &#x8D85;&#x7C7B;&#x6210;&#x5458;&#x53D8;&#x91CF;&#x6309;&#x987A;&#x5E8F;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x9012;&#x5F52;&#x8C03;&#x7528;&#x8D85;&#x7C7B;&#x7684;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#xFF1B;&#xA0;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;    &lt;7.3&gt; &#x5B50;&#x7C7B;&#x6210;&#x5458;&#x53D8;&#x91CF;&#x6309;&#x987A;&#x5E8F;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x5B50;&#x7C7B;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x3002;</p>
<h4 id="&#x5E94;&#x7528;&#x9636;&#x6BB5;">&#x5E94;&#x7528;&#x9636;&#x6BB5;</h4><p>&#x5206;&#x4E3A;&#x5F3A;&#x5F15;&#x7528;&#x3001;&#x8F6F;&#x5F15;&#x7528;&#x3001;&#x865A;&#x5F15;&#x7528;&#x3001;&#x82E5;&#x5F15;&#x7528; </p>
<h4 id="&#x4E0D;&#x53EF;&#x89C6;&#x9636;&#x6BB5;&#xFF1B;&#xA0;">&#x4E0D;&#x53EF;&#x89C6;&#x9636;&#x6BB5;&#xFF1B;&#xA0;</h4><p>&#x5F53;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5904;&#x4E8E;&#x4E0D;&#x53EF;&#x89C6;&#x9636;&#x6BB5;&#xFF0C;&#x8BF4;&#x660E;&#x6211;&#x4EEC;&#x5728;&#x5176;&#x4ED6;&#x533A;&#x57DF;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#x5DF2;&#x7ECF;&#x4E0D;&#x53EF;&#x4EE5;&#x5728;&#x5F15;&#x7528;&#x5B83;&#xFF0C;&#x5176;&#x5F3A;&#x5F15;&#x7528;&#x5DF2;&#x7ECF;&#x6D88;&#x5931;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x672C;&#x5730;&#x53D8;&#x91CF;&#x8D85;&#x51FA;&#x4E86;&#x5176;&#x53EF;&#x89C6;&#x7684;&#x8303;&#x56F4;&#x3002;&#xA0;</p>
<h4 id="&#x4E0D;&#x53EF;&#x5230;&#x8FBE;&#x9636;&#x6BB5;&#xFF1B;&#xA0;">&#x4E0D;&#x53EF;&#x5230;&#x8FBE;&#x9636;&#x6BB5;&#xFF1B;&#xA0;</h4><p>&#x5904;&#x4E8E;JVM&#x5BF9;&#x8C61;&#x751F;&#x547D;&#x5468;&#x671F;&#x4E0D;&#x53EF;&#x5230;&#x8FBE;&#x9636;&#x6BB5;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5728;&#x865A;&#x62DF;&#x673A;&#x6240;&#x7BA1;&#x7406;&#x7684;&#x5BF9;&#x8C61;&#x5F15;&#x7528;&#x6839;&#x96C6;&#x5408;&#x4E2D;&#x518D;&#x4E5F;&#x627E;&#x4E0D;&#x5230;&#x76F4;&#x63A5;&#x6216;&#x95F4;&#x63A5;&#x7684;&#x5F3A;&#x5F15;&#x7528;&#xFF0C; &#x8FD9;&#x4E9B;&#x5BF9;&#x8C61;&#x901A;&#x5E38;&#x662F;&#x6307;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x6808;&#x4E2D;&#x7684;&#x4E34;&#x65F6;&#x53D8;&#x91CF; &#xFF0C; &#x6240;&#x6709;&#x5DF2;&#x88C5;&#x8F7D;&#x7684;&#x7C7B;&#x7684;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x6216;&#x8005;&#x5BF9;&#x672C;&#x5730;&#x4EE3;&#x7801;&#x63A5;&#x53E3;&#xFF08;JNI&#xFF09;&#x7684;&#x5F15;&#x7528;&#x3002;&#x8FD9;&#x4E9B;&#x5BF9;&#x8C61;&#x90FD;&#x662F;&#x8981;&#x88AB;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#x56DE;&#x6536;&#x7684;&#x9884;&#x5907;&#x5BF9;&#x8C61;&#xFF0C;&#x4F46;&#x6B64;&#x65F6;&#x8BE5;&#x5BF9;&#x8C61;&#x5E76;&#x4E0D;&#x80FD;&#x88AB;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#x76F4;&#x63A5;&#x56DE;&#x6536;&#x3002;&#x5176; &#x5B9E;&#x6240;&#x6709;&#x5783;&#x573E;&#x56DE;&#x6536;&#x7B97;&#x6CD5;&#x6240;&#x9762;&#x4E34;&#x7684;&#x95EE;&#x9898;&#x662F;&#x76F8;&#x540C;&#x7684;&#x2015;&#x2015;&#x627E;&#x51FA;&#x7531;&#x5206;&#x914D;&#x5668;&#x5206;&#x914D;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x7528;&#x6237;&#x7A0B;&#x5E8F;&#x4E0D;&#x53EF;&#x5230;&#x8FBE;&#x7684;&#x5185;&#x5B58;&#x5757;&#x3002; </p>
<p>&#x53EF;&#x6536;&#x96C6;&#x9636;&#x6BB5;&#x3001; &#x7EC8;&#x7ED3;&#x9636;&#x6BB5;&#x3001; <strong>&#x91CA;&#x653E;&#x9636;&#x6BB5;</strong> &#xA0; &#xFF1B;&#xA0; </p>
<p>&#x5F53;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5904;&#x4E8E;&#x53EF;&#x6536;&#x96C6;&#x9636;&#x6BB5;&#x3001;&#x7EC8;&#x7ED3;&#x9636;&#x6BB5;&#x4E0E;&#x91CA;&#x653E;&#x9636;&#x6BB5;&#x65F6;</p>
<p>&lt;1&gt; &#x56DE;&#x6536;&#x5668;&#x53D1;&#x73B0;&#x8BE5;&#x5BF9;&#x8C61;&#x5DF2;&#x7ECF;&#x4E0D;&#x53EF;&#x8FBE;&#x3002;&#xA0;<br>&lt;2&gt; finalize&#x65B9;&#x6CD5;&#x5DF2;&#x7ECF;&#x88AB;&#x6267;&#x884C;&#x3002;&#xA0;<br>&lt;3&gt; &#x5BF9;&#x8C61;&#x7A7A;&#xFFFD;&#xFFFD;&#xFFFD;&#x5DF2;&#x88AB;&#x91CD;&#x7528;&#x3002; </p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/JVM/">JVM</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/02/f4575bb/" title="Tomcat的JVM内存溢出解决方法 -" itemprop="url">Tomcat的JVM内存溢出解决方法 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-01T23:50:29.000Z" itemprop="datePublished"> 发表于 2015-07-02</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p> &#x4E00;&#x3001;  &#x5728;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x4E2D;&#xFF0C;tomcat&#x5185;&#x5B58;&#x8BBE;&#x7F6E;&#x4E0D;&#x597D;&#x5F88;&#x5BB9;&#x6613;&#x51FA;&#x73B0;JVM&#x5185;&#x5B58;&#x6EA2;&#xFF0C;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#x5C31;&#x662F;&#x4FEE;&#x6539;Tomcat&#x4E2D;&#x7684;catalina.sh&#x6587;&#x4EF6;&#x3002;</p>
<h1 id="vim_TOMCAT_HOME/bin/catalina-sh">vim TOMCAT_HOME/bin/catalina.sh</h1><p>&#x5728;catalina.sh&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x627E;&#x5230;cygwin=false&#xFF0C;&#x5728;&#x8FD9;&#x4E00;&#x884C;&#x7684;&#x524D;&#x9762;&#x52A0;&#x5165;&#x53C2;&#x6570;&#xFF0C;&#x5177;&#x4F53;&#x5982;&#x4E0B;</p>
<p>JAVA_OPTS=&quot;-server -Xms1024m -Xmx2048m -XX:PermSize=512m -XX:MaxPermSize=1024m -XX:MaxNewSize=512m&quot;</p>
<p>&#x5176;&#x4ED6;&#x8BF4;&#x660E;&#xFF1A;</p>
<p>1.&#x201C;m&#x201D;&#x8BF4;&#x660E;&#x5355;&#x4F4D;&#x662F;MB&#xFF0C;&#x5426;&#x5219;&#x9ED8;&#x8BA4;&#x662F;KB</p>
<p>2.&#x4E00;&#x822C;&#x4F7F;&#x7528;&#x7269;&#x7406;&#x5185;&#x5B58;&#x7684;80%&#x4F5C;&#x4E3A;&#x5806;&#x5927;&#x5C0F;</p>
<p>3.&#x4E00;&#x822C;&#x628A;-Xms&#x548C;-Xmx&#x8BBE;&#x4E3A;&#x4E00;&#x6837;&#x5927;</p>
<p>4.&#x4E00;&#x822C;&#x628A;-Xmn&#x8BBE;&#x7F6E;&#x4E3A;-Xmx&#x503C;&#x7684;1/4</p>
<p>5.&#x4E00;&#x822C;&#x5C06;&#x5806;&#x7684;&#x603B;&#x5927;&#x5C0F;&#x7684;50%&#x5230;60%&#x5206;&#x914D;&#x7ED9;&#x65B0;&#x751F;&#x6210;&#x7684;&#x6C60;</p>
<p>&#x4E8C;&#x3001;jvm&#x53C2;&#x6570;&#x8BF4;&#x660E;&#xFF1A;</p>
<pre><code><span class="attribute">-server</span>                 <span class="subst">&amp;</span><span class="variable">#x4E00</span>;<span class="subst">&amp;</span><span class="variable">#x5B9A</span>;<span class="subst">&amp;</span><span class="variable">#x8981</span>;<span class="subst">&amp;</span><span class="variable">#x4F5C</span>;<span class="subst">&amp;</span><span class="variable">#x4E3A</span>;<span class="subst">&amp;</span><span class="variable">#x7B2C</span>;<span class="subst">&amp;</span><span class="variable">#x4E00</span>;<span class="subst">&amp;</span><span class="variable">#x4E2A</span>;<span class="subst">&amp;</span><span class="variable">#x53C2</span>;<span class="subst">&amp;</span><span class="variable">#x6570</span>;<span class="subst">&amp;</span><span class="variable">#xFF0C</span>;<span class="subst">&amp;</span><span class="variable">#x542F</span>;<span class="subst">&amp;</span><span class="variable">#x7528</span>;JDK<span class="subst">&amp;</span><span class="variable">#x7684</span>;server<span class="subst">&amp;</span><span class="variable">#x7248</span>;<span class="subst">&amp;</span><span class="variable">#x672C</span>;<span class="subst">&amp;</span><span class="variable">#xFF0C</span>;<span class="subst">&amp;</span><span class="variable">#x5728</span>;<span class="subst">&amp;</span><span class="variable">#x591A</span>;<span class="subst">&amp;</span><span class="variable">#x4E2A</span>;CPU<span class="subst">&amp;</span><span class="variable">#x65F6</span>;<span class="subst">&amp;</span><span class="variable">#x6027</span>;<span class="subst">&amp;</span><span class="variable">#x80FD</span>;<span class="subst">&amp;</span><span class="variable">#x4F73</span>; 
<span class="attribute">-Xms</span>                    java Heap<span class="subst">&amp;</span><span class="variable">#x521D</span>;<span class="subst">&amp;</span><span class="variable">#x59CB</span>;<span class="subst">&amp;</span><span class="variable">#x5927</span>;<span class="subst">&amp;</span><span class="variable">#x5C0F</span>;<span class="subst">&amp;</span><span class="variable">#x3002</span>; <span class="subst">&amp;</span><span class="variable">#x9ED8</span>;<span class="subst">&amp;</span><span class="variable">#x8BA4</span>;<span class="subst">&amp;</span><span class="variable">#x662F</span>;<span class="subst">&amp;</span><span class="variable">#x7269</span>;<span class="subst">&amp;</span><span class="variable">#x7406</span>;<span class="subst">&amp;</span><span class="variable">#x5185</span>;<span class="subst">&amp;</span><span class="variable">#x5B58</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="number">1</span>/<span class="number">64</span><span class="subst">&amp;</span><span class="variable">#x3002</span>;
<span class="attribute">-Xmx</span>                    java heap<span class="subst">&amp;</span><span class="variable">#x6700</span>;<span class="subst">&amp;</span><span class="variable">#x5927</span>;<span class="subst">&amp;</span><span class="variable">#x503C</span>;<span class="subst">&amp;</span><span class="variable">#x3002</span>;<span class="subst">&amp;</span><span class="variable">#x5EFA</span>;<span class="subst">&amp;</span><span class="variable">#x8BAE</span>;<span class="subst">&amp;</span><span class="variable">#x5747</span>;<span class="subst">&amp;</span><span class="variable">#x8BBE</span>;<span class="subst">&amp;</span><span class="variable">#x4E3A</span>;<span class="subst">&amp;</span><span class="variable">#x7269</span>;<span class="subst">&amp;</span><span class="variable">#x7406</span>;<span class="subst">&amp;</span><span class="variable">#x5185</span>;<span class="subst">&amp;</span><span class="variable">#x5B58</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="number">80</span><span class="subst">%&amp;</span><span class="variable">#x3002</span>;<span class="subst">&amp;</span><span class="variable">#x4E0D</span>;<span class="subst">&amp;</span><span class="variable">#x53EF</span>;<span class="subst">&amp;</span><span class="variable">#x8D85</span>;<span class="subst">&amp;</span><span class="variable">#x8FC7</span>;<span class="subst">&amp;</span><span class="variable">#x7269</span>;<span class="subst">&amp;</span><span class="variable">#x7406</span>;<span class="subst">&amp;</span><span class="variable">#x5185</span>;<span class="subst">&amp;</span><span class="variable">#x5B58</span>;<span class="subst">&amp;</span><span class="variable">#x3002</span>;
<span class="attribute">-Xmn</span>                    java heap<span class="subst">&amp;</span><span class="variable">#x6700</span>;<span class="subst">&amp;</span><span class="variable">#x5C0F</span>;<span class="subst">&amp;</span><span class="variable">#x503C</span>;<span class="subst">&amp;</span><span class="variable">#xFF0C</span>;<span class="subst">&amp;</span><span class="variable">#x4E00</span>;<span class="subst">&amp;</span><span class="variable">#x822C</span>;<span class="subst">&amp;</span><span class="variable">#x8BBE</span>;<span class="subst">&amp;</span><span class="variable">#x7F6E</span>;<span class="subst">&amp;</span><span class="variable">#x4E3A</span>;Xmx<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="number">3</span><span class="subst">&amp;</span><span class="variable">#x3001</span>;<span class="number">4</span><span class="subst">&amp;</span><span class="variable">#x5206</span>;<span class="subst">&amp;</span><span class="variable">#x4E4B</span>;<span class="subst">&amp;</span><span class="variable">#x4E00</span>;<span class="subst">&amp;</span><span class="variable">#x3002</span>;
<span class="attribute">-XX</span>:PermSize            <span class="subst">&amp;</span><span class="variable">#x8BBE</span>;<span class="subst">&amp;</span><span class="variable">#x5B9A</span>;<span class="subst">&amp;</span><span class="variable">#x5185</span>;<span class="subst">&amp;</span><span class="variable">#x5B58</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x6C38</span>;<span class="subst">&amp;</span><span class="variable">#x4E45</span>;<span class="subst">&amp;</span><span class="variable">#x4FDD</span>;<span class="subst">&amp;</span><span class="variable">#x5B58</span>;<span class="subst">&amp;</span><span class="variable">#x533A</span>;<span class="subst">&amp;</span><span class="variable">#x521D</span>;<span class="subst">&amp;</span><span class="variable">#x59CB</span>;<span class="subst">&amp;</span><span class="variable">#x5927</span>;<span class="subst">&amp;</span><span class="variable">#x5C0F</span>;<span class="subst">&amp;</span><span class="variable">#xFF0C</span>;<span class="subst">&amp;</span><span class="variable">#x7F3A</span>;<span class="subst">&amp;</span><span class="variable">#x7701</span>;<span class="subst">&amp;</span><span class="variable">#x503C</span>;<span class="subst">&amp;</span><span class="variable">#x4E3A</span>;<span class="number">64</span>M<span class="subst">&amp;</span><span class="variable">#x3002</span>;
<span class="attribute">-XX</span>:MaxPermSize         <span class="subst">&amp;</span><span class="variable">#x8BBE</span>;<span class="subst">&amp;</span><span class="variable">#x5B9A</span>;<span class="subst">&amp;</span><span class="variable">#x5185</span>;<span class="subst">&amp;</span><span class="variable">#x5B58</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x6C38</span>;<span class="subst">&amp;</span><span class="variable">#x4E45</span>;<span class="subst">&amp;</span><span class="variable">#x4FDD</span>;<span class="subst">&amp;</span><span class="variable">#x5B58</span>;<span class="subst">&amp;</span><span class="variable">#x533A</span>;<span class="subst">&amp;</span><span class="variable">#x6700</span>;<span class="subst">&amp;</span><span class="variable">#x5927</span>;<span class="subst">&amp;</span><span class="variable">#x5927</span>;<span class="subst">&amp;</span><span class="variable">#x5C0F</span>;<span class="subst">&amp;</span><span class="variable">#xFF0C</span>;<span class="subst">&amp;</span><span class="variable">#x7F3A</span>;<span class="subst">&amp;</span><span class="variable">#x7701</span>;<span class="subst">&amp;</span><span class="variable">#x503C</span>;<span class="subst">&amp;</span><span class="variable">#x4E3A</span>;<span class="number">64</span>M<span class="subst">&amp;</span><span class="variable">#x3002</span>;
<span class="attribute">-XX</span>:SurvivorRatio<span class="subst">=</span><span class="number">2</span>     <span class="subst">&amp;</span><span class="variable">#x751F</span>;<span class="subst">&amp;</span><span class="variable">#x8FD8</span>;<span class="subst">&amp;</span><span class="variable">#x8005</span>;<span class="subst">&amp;</span><span class="variable">#x6C60</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x5927</span>;<span class="subst">&amp;</span><span class="variable">#x5C0F</span>;<span class="subst">&amp;</span><span class="variable">#xFF0C</span>;<span class="subst">&amp;</span><span class="variable">#x9ED8</span>;<span class="subst">&amp;</span><span class="variable">#x8BA4</span>;<span class="subst">&amp;</span><span class="variable">#x662F</span>;<span class="number">2</span><span class="subst">&amp;</span><span class="variable">#x3002</span>;<span class="subst">&amp;</span><span class="variable">#x5982</span>;<span class="subst">&amp;</span><span class="variable">#x679C</span>;<span class="subst">&amp;</span><span class="variable">#x5783</span>;<span class="subst">&amp;</span><span class="variable">#x573E</span>;<span class="subst">&amp;</span><span class="variable">#x56DE</span>;<span class="subst">&amp;</span><span class="variable">#x6536</span>;<span class="subst">&amp;</span><span class="variable">#x53D8</span>;<span class="subst">&amp;</span><span class="variable">#x6210</span>;<span class="subst">&amp;</span><span class="variable">#x4E86</span>;<span class="subst">&amp;</span><span class="variable">#x74F6</span>;<span class="subst">&amp;</span><span class="variable">#x9888</span>;<span class="subst">&amp;</span><span class="variable">#xFF0C</span>;<span class="subst">&amp;</span><span class="variable">#x60A8</span>;<span class="subst">&amp;</span><span class="variable">#x53EF</span>;<span class="subst">&amp;</span><span class="variable">#x4EE5</span>;<span class="subst">&amp;</span><span class="variable">#x5C1D</span>;<span class="subst">&amp;</span><span class="variable">#x8BD5</span>;<span class="subst">&amp;</span><span class="variable">#x5B9A</span>;<span class="subst">&amp;</span><span class="variable">#x5236</span>;<span class="subst">&amp;</span><span class="variable">#x751F</span>;<span class="subst">&amp;</span><span class="variable">#x6210</span>;<span class="subst">&amp;</span><span class="variable">#x6C60</span>;<span class="subst">&amp;</span><span class="variable">#x8BBE</span>;<span class="subst">&amp;</span><span class="variable">#x7F6E</span>;
<span class="attribute">-XX</span>:NewSize             <span class="subst">&amp;</span><span class="variable">#x65B0</span>;<span class="subst">&amp;</span><span class="variable">#x751F</span>;<span class="subst">&amp;</span><span class="variable">#x6210</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x6C60</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x521D</span>;<span class="subst">&amp;</span><span class="variable">#x59CB</span>;<span class="subst">&amp;</span><span class="variable">#x5927</span>;<span class="subst">&amp;</span><span class="variable">#x5C0F</span>;<span class="subst">&amp;</span><span class="variable">#x3002</span>; <span class="subst">&amp;</span><span class="variable">#x7F3A</span>;<span class="subst">&amp;</span><span class="variable">#x7701</span>;<span class="subst">&amp;</span><span class="variable">#x503C</span>;<span class="subst">&amp;</span><span class="variable">#x4E3A</span>;<span class="number">2</span>M<span class="subst">&amp;</span><span class="variable">#x3002</span>;
<span class="attribute">-XX</span>:MaxNewSize          <span class="subst">&amp;</span><span class="variable">#x65B0</span>;<span class="subst">&amp;</span><span class="variable">#x751F</span>;<span class="subst">&amp;</span><span class="variable">#x6210</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x6C60</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x6700</span>;<span class="subst">&amp;</span><span class="variable">#x5927</span>;<span class="subst">&amp;</span><span class="variable">#x5927</span>;<span class="subst">&amp;</span><span class="variable">#x5C0F</span>;<span class="subst">&amp;</span><span class="variable">#x3002</span>; <span class="subst">&amp;</span><span class="variable">#x7F3A</span>;<span class="subst">&amp;</span><span class="variable">#x7701</span>;<span class="subst">&amp;</span><span class="variable">#x503C</span>;<span class="subst">&amp;</span><span class="variable">#x4E3A</span>;<span class="number">32</span>M<span class="subst">&amp;</span><span class="variable">#x3002</span>;
<span class="subst">+</span>XX:AggressiveHeap      <span class="subst">&amp;</span><span class="variable">#x8BA9</span>;jvm<span class="subst">&amp;</span><span class="variable">#x5FFD</span>;<span class="subst">&amp;</span><span class="variable">#x7565</span>;Xmx<span class="subst">&amp;</span><span class="variable">#x53C2</span>;<span class="subst">&amp;</span><span class="variable">#x6570</span>;<span class="subst">&amp;</span><span class="variable">#xFF0C</span>;<span class="subst">&amp;</span><span class="variable">#x75AF</span>;<span class="subst">&amp;</span><span class="variable">#x72C2</span>;<span class="subst">&amp;</span><span class="variable">#x5730</span>;<span class="subst">&amp;</span><span class="variable">#x5403</span>;<span class="subst">&amp;</span><span class="variable">#x5B8C</span>;<span class="subst">&amp;</span><span class="variable">#x4E00</span>;<span class="subst">&amp;</span><span class="variable">#x4E2A</span>;G<span class="subst">&amp;</span><span class="variable">#x7269</span>;<span class="subst">&amp;</span><span class="variable">#x7406</span>;<span class="subst">&amp;</span><span class="variable">#x5185</span>;<span class="subst">&amp;</span><span class="variable">#x5B58</span>;<span class="subst">&amp;</span><span class="variable">#xFF0C</span>;<span class="subst">&amp;</span><span class="variable">#x518D</span>;<span class="subst">&amp;</span><span class="variable">#x5403</span>;<span class="subst">&amp;</span><span class="variable">#x5C3D</span>;<span class="subst">&amp;</span><span class="variable">#x4E00</span>;<span class="subst">&amp;</span><span class="variable">#x4E2A</span>;G<span class="subst">&amp;</span><span class="variable">#x7684</span>;swap<span class="subst">&amp;</span><span class="variable">#x3002</span>; 
<span class="attribute">-Xss</span>                    <span class="subst">&amp;</span><span class="variable">#x6BCF</span>;<span class="subst">&amp;</span><span class="variable">#x4E2A</span>;<span class="subst">&amp;</span><span class="variable">#x7EBF</span>;<span class="subst">&amp;</span><span class="variable">#x7A0B</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="built_in">Stack</span><span class="subst">&amp;</span><span class="variable">#x5927</span>;<span class="subst">&amp;</span><span class="variable">#x5C0F</span>;
<span class="attribute">-verbose</span>:gc             <span class="subst">&amp;</span><span class="variable">#x73B0</span>;<span class="subst">&amp;</span><span class="variable">#x5B9E</span>;<span class="subst">&amp;</span><span class="variable">#x5783</span>;<span class="subst">&amp;</span><span class="variable">#x573E</span>;<span class="subst">&amp;</span><span class="variable">#x6536</span>;<span class="subst">&amp;</span><span class="variable">#x96C6</span>;<span class="subst">&amp;</span><span class="variable">#x4FE1</span>;<span class="subst">&amp;</span><span class="variable">#x606F</span>;
<span class="attribute">-Xloggc</span>:gc<span class="built_in">.</span><span class="keyword">log</span>          <span class="subst">&amp;</span><span class="variable">#x6307</span>;<span class="subst">&amp;</span><span class="variable">#x5B9A</span>;<span class="subst">&amp;</span><span class="variable">#x5783</span>;<span class="subst">&amp;</span><span class="variable">#x573E</span>;<span class="subst">&amp;</span><span class="variable">#x6536</span>;<span class="subst">&amp;</span><span class="variable">#x96C6</span>;<span class="subst">&amp;</span><span class="variable">#x65E5</span>;<span class="subst">&amp;</span><span class="variable">#x5FD7</span>;<span class="subst">&amp;</span><span class="variable">#x6587</span>;<span class="subst">&amp;</span><span class="variable">#x4EF6</span>;
<span class="attribute">-XX</span>:<span class="subst">+</span>UseParNewGC        <span class="subst">&amp;</span><span class="variable">#x7F29</span>;<span class="subst">&amp;</span><span class="variable">#x77ED</span>;minor<span class="subst">&amp;</span><span class="variable">#x6536</span>;<span class="subst">&amp;</span><span class="variable">#x96C6</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x65F6</span>;<span class="subst">&amp;</span><span class="variable">#x95F4</span>;
<span class="attribute">-XX</span>:<span class="subst">+</span>UseConcMarkSweepGC <span class="subst">&amp;</span><span class="variable">#x7F29</span>;<span class="subst">&amp;</span><span class="variable">#x77ED</span>;major<span class="subst">&amp;</span><span class="variable">#x6536</span>;<span class="subst">&amp;</span><span class="variable">#x96C6</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x65F6</span>;<span class="subst">&amp;</span><span class="variable">#x95F4</span>;
<span class="attribute">-XX</span>:userParNewGC        <span class="subst">&amp;</span><span class="variable">#x53EF</span>;<span class="subst">&amp;</span><span class="variable">#x7528</span>;<span class="subst">&amp;</span><span class="variable">#x6765</span>;<span class="subst">&amp;</span><span class="variable">#x8BBE</span>;<span class="subst">&amp;</span><span class="variable">#x7F6E</span>;<span class="subst">&amp;</span><span class="variable">#x5E76</span>;<span class="subst">&amp;</span><span class="variable">#x884C</span>;<span class="subst">&amp;</span><span class="variable">#x6536</span>;<span class="subst">&amp;</span><span class="variable">#x96C6</span>;(<span class="subst">&amp;</span><span class="variable">#x591A</span>;CPU)
<span class="attribute">-XX</span>:ParallelGCThreads   <span class="subst">&amp;</span><span class="variable">#x53EF</span>;<span class="subst">&amp;</span><span class="variable">#x7528</span>;<span class="subst">&amp;</span><span class="variable">#x6765</span>;<span class="subst">&amp;</span><span class="variable">#x589E</span>;<span class="subst">&amp;</span><span class="variable">#x52A0</span>;<span class="subst">&amp;</span><span class="variable">#x5E76</span>;<span class="subst">&amp;</span><span class="variable">#x884C</span>;<span class="subst">&amp;</span><span class="variable">#x5EA6</span>;(<span class="subst">&amp;</span><span class="variable">#x591A</span>;CPU)
<span class="attribute">-XX</span>:UseParallelGC       <span class="subst">&amp;</span><span class="variable">#x8BBE</span>;<span class="subst">&amp;</span><span class="variable">#x7F6E</span>;<span class="subst">&amp;</span><span class="variable">#x540E</span>;<span class="subst">&amp;</span><span class="variable">#x53EF</span>;<span class="subst">&amp;</span><span class="variable">#x4EE5</span>;<span class="subst">&amp;</span><span class="variable">#x4F7F</span>;<span class="subst">&amp;</span><span class="variable">#x7528</span>;<span class="subst">&amp;</span><span class="variable">#x5E76</span>;<span class="subst">&amp;</span><span class="variable">#x884C</span>;<span class="subst">&amp;</span><span class="variable">#x6E05</span>;<span class="subst">&amp;</span><span class="variable">#x9664</span>;<span class="subst">&amp;</span><span class="variable">#x6536</span>;<span class="subst">&amp;</span><span class="variable">#x96C6</span>;<span class="subst">&amp;</span><span class="variable">#x5668</span>;(<span class="subst">&amp;</span><span class="variable">#x591A</span>;CPU)
</code></pre>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/JVM/">JVM</a><a href="/tags/Tomcat/">Tomcat</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/42/"><span></span>Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/41/">41</a><a class="page-number" href="/page/42/">42</a><span class="page-number current">43</span><a class="page-number" href="/page/44/">44</a><a class="page-number" href="/page/45/">45</a><span class="space">&hellip;</span><a class="page-number" href="/page/60/">60</a><a class="extend next" rel="next" href="/page/44/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/transcribe/" title="transcribe">transcribe<sup>587</sup></a></li>
		  
		
		  
			<li><a href="/categories/日志/" title="日志">日志<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/ZooKeeper/" title="ZooKeeper">ZooKeeper<sup>80</sup></a></li>
			
		
			
				<li><a href="/tags/Node-js/" title="Node.js">Node.js<sup>75</sup></a></li>
			
		
			
				<li><a href="/tags/Memcached/" title="Memcached">Memcached<sup>71</sup></a></li>
			
		
			
				<li><a href="/tags/JVM/" title="JVM">JVM<sup>65</sup></a></li>
			
		
			
				<li><a href="/tags/io-js/" title="io.js">io.js<sup>35</sup></a></li>
			
		
			
				<li><a href="/tags/Spring-MVC/" title="Spring MVC">Spring MVC<sup>33</sup></a></li>
			
		
			
				<li><a href="/tags/数据库/" title="数据库">数据库<sup>32</sup></a></li>
			
		
			
				<li><a href="/tags/Gulp/" title="Gulp">Gulp<sup>29</sup></a></li>
			
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>28</sup></a></li>
			
		
			
				<li><a href="/tags/Nosql/" title="Nosql">Nosql<sup>27</sup></a></li>
			
		
			
				<li><a href="/tags/C/" title="C++">C++<sup>24</sup></a></li>
			
		
			
				<li><a href="/tags/MongoDB/" title="MongoDB">MongoDB<sup>23</sup></a></li>
			
		
			
				<li><a href="/tags/开源/" title="开源">开源<sup>16</sup></a></li>
			
		
			
				<li><a href="/tags/Java/" title="Java">Java<sup>16</sup></a></li>
			
		
			
				<li><a href="/tags/Redis/" title="Redis">Redis<sup>14</sup></a></li>
			
		
			
				<li><a href="/tags/Dubbo/" title="Dubbo">Dubbo<sup>13</sup></a></li>
			
		
			
				<li><a href="/tags/程序员/" title="程序员">程序员<sup>13</sup></a></li>
			
		
			
				<li><a href="/tags/Net/" title=".Net">.Net<sup>11</sup></a></li>
			
		
			
				<li><a href="/tags/源码分析/" title="源码分析">源码分析<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/MySQL/" title="MySQL">MySQL<sup>9</sup></a></li>
			
		
		</ul>
</div>


<div class="weiboshow">
	<p class="asidetitle">新浪微博</p>
	<iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=1289635200&verifier=e6bef170&dpc=1"></iframe>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Larry Page in Google. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/512316815" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/sblig" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/sblig" target="_blank" title="fblog">fblog</a> © 2015
		
		<a href="/about" target="_blank" title="edwin">edwin</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
