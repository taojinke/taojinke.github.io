
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="baidu-site-verification" content="1XvvwQ7Apt" />
  
    <title>A Gulp.js tutorial - | dianzi blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="edwin">
    

    
    <meta name="description" content="Gulp is a build tool that helps you automate your development workflow. In this article, we will dive deep into Gulp to show you how to use it effectively to create a simple workflow.
Let&amp;#x2019;s get">
<meta property="og:type" content="article">
<meta property="og:title" content="A Gulp.js tutorial -">
<meta property="og:url" content="http://taojinke.github.io/2015/07/03/2f2ef4e/index.html">
<meta property="og:site_name" content="dianzi blog">
<meta property="og:description" content="Gulp is a build tool that helps you automate your development workflow. In this article, we will dive deep into Gulp to show you how to use it effectively to create a simple workflow.
Let&amp;#x2019;s get">
<meta property="og:image" content="http://taojinke.github.io/img/20150703/2f2a39f.png">
<meta property="og:image" content="http://taojinke.github.io/img/20150703/2f2a39f.png">
<meta property="og:image" content="http://taojinke.github.io/img/20150703/2f2a610.png">
<meta property="og:image" content="http://taojinke.github.io/img/20150703/2f2a610.png">
<meta property="og:image" content="http://taojinke.github.io/img/20150703/2f2a881.png">
<meta property="og:image" content="http://taojinke.github.io/img/20150703/2f2a881.png">
<meta property="og:image" content="http://taojinke.github.io/img/20150703/2f2aaf2.png">
<meta property="og:image" content="http://taojinke.github.io/img/20150703/2f2aaf2.png">
<meta property="og:image" content="http://taojinke.github.io/img/20150703/2f2ad63.png">
<meta property="og:image" content="http://taojinke.github.io/img/20150703/2f2ad63.gif">
<meta property="og:image" content="http://taojinke.github.io/img/20150703/2f2ad63.png">
<meta property="og:image" content="http://taojinke.github.io/img/20150703/2f2afd4.png">
<meta property="og:image" content="http://taojinke.github.io/img/20150703/2f2afd4.gif">
<meta property="og:image" content="http://taojinke.github.io/img/20150703/2f2b245.gif">
<meta property="og:image" content="http://taojinke.github.io/img/20150703/2f2b4b6.gif">
<meta property="og:updated_time" content="2015-07-03T14:09:57.244Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A Gulp.js tutorial -">
<meta name="twitter:description" content="Gulp is a build tool that helps you automate your development workflow. In this article, we will dive deep into Gulp to show you how to use it effectively to create a simple workflow.
Let&amp;#x2019;s get">

    
    <link rel="alternative" href="/atom.xml" title="dianzi blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">

  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?345f95aea4ada2935d6f9ea4177b51ab";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>

</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="dianzi blog" title="dianzi blog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="dianzi blog">dianzi blog</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
						<a href="/music/index.html" target="_blank">Music</a>
					</li>
					<li>
 					
						<form class="search" action="http://taojinke.github.io/" target="_blank">
							<label>Search</label>
						<input name="s" type="hidden" value= null ><input type="text" name="q" size="30" placeholder="搜索"><br>
						</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/03/2f2ef4e/" title="A Gulp.js tutorial -" itemprop="url">A Gulp.js tutorial -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-03T02:09:57.000Z" itemprop="datePublished"> 发表于 2015-07-03</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Installing_Gulp"><span class="toc-number">1.</span> <span class="toc-text">Installing Gulp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Creating_a_Gulp_Project"><span class="toc-number">2.</span> <span class="toc-text">Creating a Gulp Project</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Determining_Project_Structure"><span class="toc-number">3.</span> <span class="toc-text">Determining Project Structure</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Writing_Your_First_Task"><span class="toc-number">4.</span> <span class="toc-text">Writing Your First Task</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Creating_a_Real_Task"><span class="toc-number">5.</span> <span class="toc-text">Creating a Real Task</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Adding_more_functionality_to_the_sass_task"><span class="toc-number">6.</span> <span class="toc-text">Adding more functionality to the sass task</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Automatically_update_the_CSS_file_when_you_save"><span class="toc-number">7.</span> <span class="toc-text">Automatically update the CSS file when you save</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Automatically_Refreshing_the_Browser_when_you_save"><span class="toc-number">8.</span> <span class="toc-text">Automatically Refreshing the Browser when you save</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Wrapping_Up"><span class="toc-number">9.</span> <span class="toc-text">Wrapping Up</span></a></li></ol>
		
		</div>
		
		<p>Gulp is a build tool that helps you automate your development workflow. In this article, we will dive deep into Gulp to show you how to use it effectively to create a simple workflow.</p>
<p>Let&#x2019;s get started.</p>
<h2 id="Installing_Gulp">Installing Gulp</h2><p>We&#x2019;ll start off the process by installing Gulp onto your computer. Gulp requires you to have Node.js and Node Package Manager (NPM) installed on your system, so if you haven&#x2019;t gotten them yet, just head over to <a href="https://nodejs.org" target="_blank" rel="external">Node.js&#x2019;s website</a> and download the installer. </p>
<p>Once you&#x2019;re done installing Node.js and NPM, you can install Gulp by typing the following command in the command line:</p>
<pre><code>$ sudo npm <span class="keyword">install</span> gulp -g
<span class="comment"># <span class="doctag"><span class="keyword">Note</span></span>: Only Mac users require the `sudo` keyword</span>
</code></pre><p>This command installs gulp globally and allows you to use the gulp command anywhere on your computer. </p>
<p>We&#x2019;re now done with installing Gulp and we can move on to create a new project that uses Gulp.</p>
<h2 id="Creating_a_Gulp_Project">Creating a Gulp Project</h2><p>Let&#x2019;s create a folder named project as we work through this article. Once you have created the folder, you&#x2019;ll want to run npm init in it. </p>
<pre><code>$ <span class="built_in">npm</span> init
</code></pre><p>This npm init command asks you a few questions and creates a package.json file to store information about dependencies that you&#x2019;ll use in this project. </p>
<p><img src="http://taojinke.github.io/img/20150703/2f2a39f.png" alt=""></p>
<p>The first dependency in our project is Gulp since we&#x2019;re using it as our build tool. You&#x2019;ll have to install gulp within the project folder by augmenting the install code slightly: </p>
<pre><code>$ npm install gulp --<span class="built_in">save</span>-<span class="built_in">dev</span>
</code></pre><p>See that we have removed sudo from the command and replaced the -g flag with the —save-dev flag? </p>
<p>This —save-dev flag tells NPM to install gulp locally in (a dev term for within) the project, and save this dependency information in the package.json file. </p>
<p>Since we&#x2019;re installing a package locally, we don&#x2019;t have a need for administrator rights and hence the sudo was dropped. Removing this sudo is important and could potentially cause errors if you don&#x2019;t. </p>
<p>Now, if you take a look at your package.json file, you should see that Gulp has been added as a dev dependency. </p>
<p><img src="http://taojinke.github.io/img/20150703/2f2a39f.png" alt=""></p>
<p>You should also see a gulp folder within the new node_modules folder that was created when you ran the npm install gulp —save-dev command. </p>
<p><img src="http://taojinke.github.io/img/20150703/2f2a610.png" alt=""></p>
<p>Next, we&#x2019;ll have to create a gulpfile.js file to store all our Gulp configurations. </p>
<p>There&#x2019;s one more thing to do before we start configuring Gulp to create a workflow. We have to make sure we&#x2019;re clear on how the project is structured.</p>
<h2 id="Determining_Project_Structure">Determining Project Structure</h2><p>Let&#x2019;s start off with a generic structure for a webapp:</p>
<pre><code>project/
  <span class="string">|- app/</span>
      <span class="string">|- css/</span>
      <span class="string">|- fonts/</span>
      <span class="string">|- images/ </span>
      <span class="string">|- index.html</span>
      <span class="string">|- js/ </span>
      <span class="string">|- scss/</span>
  <span class="string">|- dist/</span>
  <span class="string">|- gulpfile.js</span>
  <span class="string">|- node_modules/</span>
  <span class="string">|- package.json</span>
</code></pre><p>In this structure, the app folder will store all our written code, and the dist folder will be used to store code that&#x2019;s production-ready. </p>
<p>Don&#x2019;t worry if your actual projects has a structure that&#x2019;s different from the current one we&#x2019;re using right now. Once you&#x2019;ve gotten the hang of Gulp, you&#x2019;ll see how to tweak the gulpfile to work with your structure easily. So let&#x2019;s work with this structure for now.</p>
<p>Once you&#x2019;ve created the project structure with the corresponding folders, we can proceed on to writing your first Gulp task.</p>
<h2 id="Writing_Your_First_Task">Writing Your First Task</h2><p>To configure Gulp, you&#x2019;ll first have to require gulp within your gulpfile.js : </p>
<pre><code><span class="comment">// Requiring Gulp</span>
<span class="keyword">var</span> gulp = <span class="built_in">require</span>(&amp;apos;gulp&amp;apos;); 
</code></pre><p>This require statement tells Node.js to look under the node_modules folder, find a package named gulp and pass it to the gulp variable. </p>
<p>Once we have this gulp variable, we can use it to write different Gulp tasks. Here&#x2019;s the basic syntax of a gulp task. </p>
<pre><code><span class="comment">// Basic Gulp task syntax</span>
gulp.task(&amp;apos;task-name&amp;apos;, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>{
  <span class="comment">// Stuff here</span>
})
</code></pre><p>Let&#x2019;s write a task named &#x2018;hello&#x2019; for a start, and let the task do a log that says &#x201C;Hello Zell!&#x201D;.</p>
<pre><code><span class="comment">// Basic Gulp task syntax</span>
gulp.task(&amp;apos;hello&amp;apos;, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{
  <span class="built_in">console</span>.log(&amp;apos;Hello Zell!&amp;apos;);
})
</code></pre><p>The task name is important since you&#x2019;ll be able to use the task anywhere else in the Gulpfile to run the task.</p>
<p>You can also use run a task with the command line by using gulp plus the name of the task. </p>
<pre><code><span class="variable">$ </span>gulp hello
</code></pre><p>You should see a log from the terminal saying &#x201C;Hello Zell!&#x201D; once you ran the code in the terminal.</p>
<p><img src="http://taojinke.github.io/img/20150703/2f2a610.png" alt=""></p>
<p>In reality, gulp tasks are slightly more complex that what we have written so far. You&#x2019;ll have to use two other gulp methods, gulp.src and gulp.dest . </p>
<h2 id="Creating_a_Real_Task">Creating a Real Task</h2><p>Here&#x2019;s what a real task may look like:</p>
<pre><code>gulp.task<span class="comment">(&amp;apos;task-name&amp;apos;, function ()</span> {
  gulp.src<span class="comment">(&amp;apos;src&amp;apos;)</span> <span class="comment">// Get source files with gulp.src</span>
    .pipe<span class="comment">(somePlugin()</span>) <span class="comment">// Sends it through a gulp plugin</span>
    .pipe<span class="comment">(gulp.dest(&amp;apos;dest&amp;apos;)</span>) <span class="comment">// Outputs the file in the destination folder</span>
})
</code></pre><p>Let&#x2019;s put this template to use with a real example where we compile Sass to CSS. I&#x2019;ll explain how to set up the task while we&#x2019;re at it.</p>
<p>First, we&#x2019;ll need to install a gulp plugin, gulp-sass , to compile Sass to CSS. We can install it with the npm install command with the —save-dev flag like what we did above. </p>
<pre><code>$ npm install gulp-sass --<span class="built_in">save</span>-<span class="built_in">dev</span>
</code></pre><p>We will then need to require this plugin in the gulpfile.</p>
<pre><code><span class="keyword">var</span> gulp = <span class="built_in">require</span>(&amp;apos;gulp&amp;apos;);
<span class="comment">// Requires the gulp-sass plugin</span>
<span class="keyword">var</span> sass = <span class="built_in">require</span>(&amp;apos;gulp-sass&amp;apos;);
</code></pre><p>Now, create a styles.scss file within the app/scss folder and give it some styles to convert from Sass to CSS. </p>
<pre><code><span class="comment">// Scss</span>
<span class="class">.testing</span> {
  <span class="attribute">display</span>: flex;
  <span class="attribute">width</span>: <span class="function">percentage</span>(<span class="number">5</span>/<span class="number">7</span>); 
  <span class="comment">// Percentage is a Sass function that will be evaluated to CSS when compiled</span>
}
</code></pre><p>This styles.scss file will be converted into CSS by passing through the gulp-sass plugin we installed. After passing through the plugin, it&#x2019;ll be created as styles.css in the app/css folder. </p>
<p><img src="http://taojinke.github.io/img/20150703/2f2a881.png" alt=""></p>
<p>Here&#x2019;s how the task would look like:</p>
<pre><code>gulp.task<span class="comment">(&amp;apos;sass&amp;apos;, function()</span> {
  gulp.src<span class="comment">(&amp;apos;app/scss/styles.scss&amp;apos;)</span> <span class="comment">// Gets the styles.scss file</span>
    .pipe<span class="comment">(sass()</span>) <span class="comment">// Passes it through a gulp-sass task</span>
    .pipe<span class="comment">(gulp.dest(&amp;apos;app/css&amp;apos;)</span>) <span class="comment">// Outputs it in the css folder</span>
});
</code></pre><p>We can test this sass task by running it in the command line. </p>
<pre><code><span class="variable">$ </span>gulp sass
</code></pre><p>Now, if you take a look at the styles.css file in app/css , you&#x2019;ll see that the percentage() function has been evaluated into the following code: </p>
<pre><code><span class="class">.testing</span> <span class="rules">{
  <span class="rule"><span class="attribute">display</span>:<span class="value"> flex</span></span>;
  <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">71.42857%</span></span></span>; }</span>
</code></pre><p>This means our styles.scss file has successfully been compiled into CSS. </p>
<h2 id="Adding_more_functionality_to_the_sass_task">Adding more functionality to the sass task</h2><p>Just compiling from Sass to CSS isn&#x2019;t good enough. Sometimes it makes more sense to add more plugins to make thing simpler for us. One of the best plugins that you&#x2019;ll ever use when converting from Sass to CSS is <a href="https://github.com/postcss/autoprefixer" target="_blank" rel="external">autoprefixer</a> ,which helps you write vendor prefixes according to <a href="http://www.caniuse.com" target="_blank" rel="external">caniuse</a> . </p>
<p>Let&#x2019;s try adding autoprefixer to our sass task. </p>
<p>To do so, we&#x2019;ll have to install the gulp plugin for autoprefixer.</p>
<pre><code>$ npm install gulp-autoprefixer --<span class="built_in">save</span>-<span class="built_in">dev</span>
</code></pre><p>Then we&#x2019;ll have to require autoprefixer . </p>
<pre><code><span class="keyword">var</span> gulp = <span class="built_in">require</span>(&amp;apos;gulp&amp;apos;);
<span class="keyword">var</span> sass = <span class="built_in">require</span>(&amp;apos;gulp-sass&amp;apos;);
<span class="comment">// Requiring autoprefixer</span>
<span class="keyword">var</span> autoprefixer = <span class="built_in">require</span>(&amp;apos;gulp-autoprefixer&amp;apos;);
</code></pre><p>Autoprefixer is usually placed after Sass is compiled into CSS. In Gulp, we&#x2019;ll want to add another .pipe() so the resultant CSS gets passed through autoprefixer before it&#x2019;s created as styles.css in app/css . </p>
<p><img src="http://taojinke.github.io/img/20150703/2f2a881.png" alt=""></p>
<p>The modified code is hence:</p>
<pre><code>gulp.task<span class="params">(&amp;apos;sass&amp;apos;, function<span class="params">()</span> {
  gulp.src<span class="params">(&amp;apos;app/scss/styles.scss&amp;apos;)</span> 
    .pipe<span class="params">(sass<span class="params">()</span>)</span> 
    .pipe<span class="params">(autoprefixer<span class="params">()</span>)</span> // Passes it through gulp-autoprefixer 
    .pipe<span class="params">(gulp.dest<span class="params">(&amp;apos;app/css&amp;apos;)</span>)</span>
})</span>
</code></pre><p>Now if you run gulp sass again, you&#x2019;ll notice that the output in the styles.css file has changed to include vendor prefixes for the display flex property: </p>
<pre><code><span class="class">.testing</span> <span class="rules">{
  <span class="rule"><span class="attribute">display</span>:<span class="value"> -webkit-box</span></span>;
  <span class="rule"><span class="attribute">display</span>:<span class="value"> -webkit-flex</span></span>;
  <span class="rule"><span class="attribute">display</span>:<span class="value"> -ms-flexbox</span></span>;
  <span class="rule"><span class="attribute">display</span>:<span class="value"> flex</span></span>;
  <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">71.42857%</span></span></span>; }</span>
</code></pre><p>Another task that&#x2019;ll help you out during development is to add sourcemaps.</p>
<p>A sourcemap is a string of information that tells the browser where different sections of the code is stored. With a CSS sourcemap, you can easily locate the original source code of specific lines of CSS just by checking out the inspector.</p>
<p><img src="http://taojinke.github.io/img/20150703/2f2aaf2.png" alt=""></p>
<p>To add sourcemaps to the sass task, we&#x2019;ll have to install the gulp-sourcemaps plugin. </p>
<pre><code>$ npm install gulp-sourcemaps --<span class="built_in">save</span>-<span class="built_in">dev</span>


<span class="comment">// Requiring Sourcemaps</span>
<span class="built_in">var</span> sourcemaps = require(&amp;apos;gulp-sourcemaps&amp;apos;);
</code></pre><p>The process to adding sourcemaps to our sass task is slightly different from adding autoprefixer. We&#x2019;ll have to add two pipes instead of one. </p>
<p>First, we&#x2019;ll need to initialize the sourcemap plugin right after getting source files from gulp.</p>
<p>Then, we&#x2019;ll have to let the files pass through gulp-sass and gulp-autoprefixer before writing the sourcemaps at the end of the css file. </p>
<p><img src="http://taojinke.github.io/img/20150703/2f2aaf2.png" alt=""></p>
<pre><code>gulp.task<span class="params">(&amp;apos;sass&amp;apos;, function<span class="params">()</span> {
  gulp.src<span class="params">(&amp;apos;app/scss/styles.scss&amp;apos;)</span> // Gets the styles.scss file
    .pipe<span class="params">(sourcemaps.init<span class="params">()</span>)</span> // Initialize sourcemap plugin
    .pipe<span class="params">(sass<span class="params">()</span>)</span>
    .pipe<span class="params">(autoprefixer<span class="params">()</span>)</span> 
    .pipe<span class="params">(sourcemaps.write<span class="params">()</span>)</span> // Writing sourcemaps 
    .pipe<span class="params">(gulp.dest<span class="params">(&amp;apos;app/css&amp;apos;)</span>)</span>
})</span>
</code></pre><p>Now if you run gulp sass on the terminal, you should be able to see that Gulp has written a sourcemap at the end of your CSS file. </p>
<pre><code><span class="class">.testing</span> <span class="rules">{
  <span class="rule"><span class="attribute">display</span>:<span class="value"> -webkit-box</span></span>;
  <span class="rule"><span class="attribute">display</span>:<span class="value"> -webkit-flex</span></span>;
  <span class="rule"><span class="attribute">display</span>:<span class="value"> -ms-flexbox</span></span>;
  <span class="rule"><span class="attribute">display</span>:<span class="value"> flex</span></span>;
  <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">71.42857%</span></span></span>; }</span>

<span class="comment">/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN0eWxlcy5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UscUJBQWM7RUFBZCxzQkFBYztFQUFkLHFCQUFjO0VBQWQsY0FBYztFQUNkLGlCQUFpQixFQUZUIiwiZmlsZSI6InN0eWxlcy5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIudGVzdGluZyB7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIHdpZHRoOiBwZXJjZW50YWdlKDUvNyk7XG59Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9 */</span>
</code></pre><h2 id="Automatically_update_the_CSS_file_when_you_save">Automatically update the CSS file when you save</h2><p>Now it&#x2019;s quite some work to run the gulp sass task whenever we want to compile Sass to CSS. Wouldn&#x2019;t it be awesome if Gulp would run it automatically? </p>
<p>Gulp can do that! You&#x2019;ll just have to let Gulp check whether the styles.scss file was changed when you save it. This checking process is called watching in programming terms. </p>
<p>Gulp does this watching by providing us with a watch method that allows you to run any task whenever a file is changed. </p>
<pre><code>// Gulp watch <span class="keyword">syntax</span>
gulp.watch(&amp;apos;<span class="keyword">files</span>-<span class="keyword">to</span>-watch&amp;apos;, [&amp;apos;tasks&amp;apos;, &amp;apos;<span class="keyword">to</span>&amp;apos;, &amp;apos;run&amp;apos;]); 
</code></pre><p>Instead of just watching the Sass files alone, you&#x2019;ll often want to watch many types of files and run different tasks during a development process. In order to achieve that, we can create a watch gulp task that watches different files. </p>
<pre><code>gulp.task(&amp;apos;watch&amp;apos;, <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{
  gulp.watch(&amp;apos;app/scss/styles.scss&amp;apos;, [&amp;apos;sass&amp;apos;]);
  <span class="comment">// ... Other watchers</span>
});
</code></pre><p>Now if you run the watch command you&#x2019;ll see that gulp immediately starts watching your files for changes.</p>
<p><img src="http://taojinke.github.io/img/20150703/2f2ad63.png" alt=""></p>
<p>And if you change a line in styles.scss , Gulp will automatically run the sass task. </p>
<p><img src="http://taojinke.github.io/img/20150703/2f2ad63.gif" alt=""></p>
<p>There&#x2019;s only one thing that&#x2019;s lacking here. Gulp didn&#x2019;t run the sass task first before running watch , which means the CSS might not be the most updated one. Hence, we&#x2019;ll want to make sure the watch task runs after the sass task. </p>
<p>We can do so by adding a second parameter to the watch task. This second parameter is an array of tasks that must be completed before Gulp runs watch . </p>
<pre><code>gulp.task(&amp;apos;watch&amp;apos;, [&amp;apos;sass&amp;apos;], <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{
  gulp.watch(&amp;apos;app/scss/styles.scss&amp;apos;, [&amp;apos;sass&amp;apos;]);
  <span class="comment">// ... Other watchers</span>
}); 
</code></pre><p>Now if you run the watch task, you&#x2019;ll see that Gulp tells the command line to first run the sass task, followed by the watch task. </p>
<p><img src="http://taojinke.github.io/img/20150703/2f2ad63.png" alt=""></p>
<p>Since we&#x2019;re already watching and recompiling Sass files when it&#x2019;s changed, why not bring it further and reload the browser each time the file is saved?</p>
<h2 id="Automatically_Refreshing_the_Browser_when_you_save">Automatically Refreshing the Browser when you save</h2><p>Having the browser automatically refreshing when you save a file is a task that saves you lots of time and hand-ache.</p>
<p>The best project for refreshing the browser right now is <a href="http://www.browsersync.io" target="_blank" rel="external">Browser Sync</a> , and we can use with Gulp easily. </p>
<p>First, we&#x2019;ll have to install Browser Sync.</p>
<pre><code>$ npm install browser-sync --<span class="built_in">save</span>-<span class="built_in">dev</span>
</code></pre><p>You&#x2019;ll notice that there&#x2019;s no more gulp- prefix when installing Browser Sync. This is because Browser Sync can be made to work with Gulp right out of the box; you don&#x2019;t need a Gulp plugin. </p>
<p>We&#x2019;ll have to require Browser Sync, as usual. </p>
<pre><code><span class="label">var</span> <span class="keyword">browserSync </span>= <span class="preprocessor">require</span>(&amp;apos<span class="comment">;browser-sync&amp;apos;);</span>
</code></pre><p>Browser Sync spins up a local server to load static HTML files. We&#x2019;ll have to provide it with some initial configurations so it knows where to find our index.html file. </p>
<p>Let&#x2019;s make a browserSync task for spinning up this server. </p>
<pre><code><span class="comment">// Start browserSync server</span>
gulp.task(&amp;apos;browserSync&amp;apos;, <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{
  browserSync({
    server: {
      baseDir: &amp;apos;app&amp;apos;
    }
  })
})
</code></pre><p>Next, we&#x2019;ll need to change the sass task slightly to allow Browser Sync to inject new CSS into the HTML. To do so, we&#x2019;ll hav eto add a return before gulp.src and we&#x2019;ll have to .pipe() a Browser Sync reload method. </p>
<pre><code>gulp.task<span class="params">(&amp;apos;sass&amp;apos;, function<span class="params">()</span> {
  return gulp.src<span class="params">(&amp;apos;app/scss/styles.scss&amp;apos;)</span> // added return 
    .pipe<span class="params">(sourcemaps.init<span class="params">()</span>)</span>
    .pipe<span class="params">(sass<span class="params">()</span>)</span>
    .pipe<span class="params">(autoprefixer<span class="params">()</span>)</span>
    .pipe<span class="params">(sourcemaps.write<span class="params">()</span>)</span>
    .pipe<span class="params">(gulp.dest<span class="params">(&amp;apos;app/css&amp;apos;)</span>)</span>
    // Reloading the stream
    .pipe<span class="params">(browserSync.reload<span class="params">({
      stream: <span class="literal">true</span>
    })</span>)</span>;
})</span>;
</code></pre><p>We&#x2019;ll also have to make sure the browserSync task runs before the watch task. </p>
<pre><code>gulp.task(&amp;apos;watch&amp;apos;, [&amp;apos;browserSync&amp;apos;, &amp;apos;sass&amp;apos;], <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{
  gulp.watch(&amp;apos;app/scss/styles.scss&amp;apos;, [&amp;apos;sass&amp;apos;]);
});
</code></pre><p>If you run gulp watch in the terminal now, you&#x2019;ll see that browserSync and sass runs concurrently, followed by watch . In addition, a browser pops up to show you the current index.html file. </p>
<p><img src="http://taojinke.github.io/img/20150703/2f2afd4.png" alt=""></p>
<p>So if you change the styles.scss file and save&#x2026; </p>
<p><img src="http://taojinke.github.io/img/20150703/2f2afd4.gif" alt=""></p>
<p>Viola! </p>
<p><img src="http://taojinke.github.io/img/20150703/2f2b245.gif" alt=""></p>
<p>Since we&#x2019;re already watching for changes and refreshing the browser when we save styles.scss , why not do it for index.html as well? </p>
<pre><code><span class="component">gulp.task(&amp;apos;watch&amp;apos;, [&amp;apos;sass&amp;apos;], function() {
  gulp<span class="string">.watch(&amp;apos</span>;app/scss/styles<span class="string">.scss&amp;apos</span>;, [&amp;apos;sass&amp;apos;]);
  gulp<span class="string">.watch(&amp;apos</span>;app/index<span class="string">.html&amp;apos</span>;, [browserSync<span class="string">.reload])</span>;
}</span>); 
</code></pre><p>Now that&#x2019;s an example of a decent workflow that converts Sass to CSS. Of course, there&#x2019;s a lot of improvements you can make to it. For instance, you can configure options for each of the plugins used, and you can also watch more files with some node globbing knowledge.</p>
<p>We&#x2019;ll cover those in the next article </p>
<p><img src="http://taojinke.github.io/img/20150703/2f2b4b6.gif" alt=""></p>
<p>Now let&#x2019;s do a quick summary.</p>
<h2 id="Wrapping_Up">Wrapping Up</h2><p>So in this article we learned how to install Gulp and we learn to set up a basic task with Gulp.</p>
<p>Then we went ahead and setup a real task by adding different gulp plugins to the mix.</p>
<p>Eventually, we made it much better by watching the files for change and refreshing the browser whenever possible.</p>
<p>There&#x2019;s still a whole lot more to configuring Gulp, but we&#x2019;ll pause here for now. Let&#x2019;s continue in the next article.</p>
<p>What is one thing you&#x2019;ve learned about Gulp in this tutorial? Let me know in the comments below!</p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Gulp/">Gulp</a><a href="/tags/Sass/">Sass</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	<div class="share-jiathis">
	  
<div class="jiathis_style_24x24">
	<a class="jiathis_button_tsina"></a>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_renren"></a>
	<a class="jiathis_button_qzone"></a>
	<a class="jiathis_button_googleplus"></a>
	<a class="jiathis_button_douban"></a>
	<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
    var jiathis_config={
    data_track_clickback:true,
    sm:"copy,renren,cqq",
    pic:"",
    summary:"",
    
  </script> 
<script type="text/javascript" src="//v3.jiathis.com/code/jia.js?uid=
1696217" charset="utf-8"></script>      

	 </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/07/03/2f37324/" title="How to Grunt and Gulp Your Way to Workflow Automation -">
  <strong>上一篇：</strong><br/>
  <span>
  How to Grunt and Gulp Your Way to Workflow Automation -</span>
</a>
</div>


<div class="next">
<a href="/2015/07/03/2f40811/"  title="The long road to Async/Await in JavaScript -">
 <strong>下一篇：</strong><br/> 
 <span>The long road to Async/Await in JavaScript -
</span>
</a>
</div>

</nav>

	


	<!--���ٰ�-->
	<div id="SOHUCS"></div>
	<script charset="utf-8" type="text/javascript" src="http://assets.changyan.sohu.com/upload/changyan.js" ></script>
	<script type="text/javascript">
		window.changyan.api.config({
			appid: 'cyrNEabSF',
			conf: 'prod_034326b8fb64167667674dc334104436'
		});
	</script>
</div>


      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Installing_Gulp"><span class="toc-number">1.</span> <span class="toc-text">Installing Gulp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Creating_a_Gulp_Project"><span class="toc-number">2.</span> <span class="toc-text">Creating a Gulp Project</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Determining_Project_Structure"><span class="toc-number">3.</span> <span class="toc-text">Determining Project Structure</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Writing_Your_First_Task"><span class="toc-number">4.</span> <span class="toc-text">Writing Your First Task</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Creating_a_Real_Task"><span class="toc-number">5.</span> <span class="toc-text">Creating a Real Task</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Adding_more_functionality_to_the_sass_task"><span class="toc-number">6.</span> <span class="toc-text">Adding more functionality to the sass task</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Automatically_update_the_CSS_file_when_you_save"><span class="toc-number">7.</span> <span class="toc-text">Automatically update the CSS file when you save</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Automatically_Refreshing_the_Browser_when_you_save"><span class="toc-number">8.</span> <span class="toc-text">Automatically Refreshing the Browser when you save</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Wrapping_Up"><span class="toc-number">9.</span> <span class="toc-text">Wrapping Up</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/transcribe/" title="transcribe">transcribe<sup>472</sup></a></li>
		  
		
		  
			<li><a href="/categories/日志/" title="日志">日志<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/ZooKeeper/" title="ZooKeeper">ZooKeeper<sup>73</sup></a></li>
			
		
			
				<li><a href="/tags/JVM/" title="JVM">JVM<sup>65</sup></a></li>
			
		
			
				<li><a href="/tags/Memcached/" title="Memcached">Memcached<sup>61</sup></a></li>
			
		
			
				<li><a href="/tags/Node-js/" title="Node.js">Node.js<sup>52</sup></a></li>
			
		
			
				<li><a href="/tags/Spring-MVC/" title="Spring MVC">Spring MVC<sup>30</sup></a></li>
			
		
			
				<li><a href="/tags/Nosql/" title="Nosql">Nosql<sup>25</sup></a></li>
			
		
			
				<li><a href="/tags/C/" title="C++">C++<sup>24</sup></a></li>
			
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>22</sup></a></li>
			
		
			
				<li><a href="/tags/数据库/" title="数据库">数据库<sup>22</sup></a></li>
			
		
			
				<li><a href="/tags/Gulp/" title="Gulp">Gulp<sup>21</sup></a></li>
			
		
			
				<li><a href="/tags/开源/" title="开源">开源<sup>15</sup></a></li>
			
		
			
				<li><a href="/tags/Dubbo/" title="Dubbo">Dubbo<sup>13</sup></a></li>
			
		
			
				<li><a href="/tags/Java/" title="Java">Java<sup>13</sup></a></li>
			
		
			
				<li><a href="/tags/源码分析/" title="源码分析">源码分析<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/Net/" title=".Net">.Net<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/Mac-OS-X/" title="Mac OS X">Mac OS X<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/io-js/" title="io.js">io.js<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/程序员/" title="程序员">程序员<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/Ubuntu/" title="Ubuntu">Ubuntu<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/Kafka/" title="Kafka">Kafka<sup>7</sup></a></li>
			
		
		</ul>
</div>


<div class="weiboshow">
	<p class="asidetitle">新浪微博</p>
	<iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=1289635200&verifier=e6bef170&dpc=1"></iframe>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Larry Page in Google. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/512316815" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/sblig" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/sblig" target="_blank" title="fblog">fblog</a> © 2015
		
		<a href="/about" target="_blank" title="edwin">edwin</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
