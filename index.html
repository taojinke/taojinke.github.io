
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="baidu-site-verification" content="F8h0dyO2hk" />
  <meta name="baidu-site-verification" content="1XvvwQ7Apt" />
  
    <title>dianzi blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="edwin">
    

    
    <meta name="description" content="edwin jin dianzi blog">
<meta property="og:type" content="website">
<meta property="og:title" content="dianzi blog">
<meta property="og:url" content="http://taojinke.github.io/index.html">
<meta property="og:site_name" content="dianzi blog">
<meta property="og:description" content="edwin jin dianzi blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="dianzi blog">
<meta name="twitter:description" content="edwin jin dianzi blog">

    
    <link rel="alternative" href="/atom.xml" title="dianzi blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">

  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?345f95aea4ada2935d6f9ea4177b51ab";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>

</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="dianzi blog" title="dianzi blog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="dianzi blog">dianzi blog</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
                        <a href="http://nodejs-xx.sblig.club/" target="_blank">NodeJs</a>
                    </li>
					<li>
						<a href="/music/index.html" target="_blank">Music</a>
					</li>
					<li>
 					
						<form class="search" action="http://taojinke.github.io/" target="_blank">
							<label>Search</label>
						<input name="s" type="hidden" value= null ><input type="text" name="q" size="30" placeholder="搜索"><br>
						</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/08/4db3bc8/" title="MongoDB 数据库管理（不定时更新） -" itemprop="url">MongoDB 数据库管理（不定时更新） -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-08T02:33:30.000Z" itemprop="datePublished"> 发表于 2015-07-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>&#x4E4B;&#x524D;&#x7684;&#x51E0;&#x7BC7;&#x6587;&#x7AE0;&#x5927;&#x81F4;&#x8BF4;&#x4E86;&#x526F;&#x672C;&#x96C6;&#x7684;&#x642D;&#x5EFA;&#x3001;&#x526F;&#x672C;&#x96C6;&#x7684;&#x7BA1;&#x7406;&#xFF0C;&#x73B0;&#x5728;&#x8BF4;&#x4E0B;MongoDB&#x6570;&#x636E;&#x5E93;&#xFFFD;&#xFFFD;&#xFFFD;&#x7BA1;&#x7406;&#x3002;</p>
<p>&#x4E00;&#xFF1A;&#x67E5;&#x770B;&#x670D;&#x52A1;&#x5668;&#x72B6;&#x6001;&#xFF1A; db.serverStatus()</p>
<pre><code>zjy<span class="value">:PRIMARY&amp;gt;</span> db<span class="class">.serverStatus</span>()
{
    &amp;quot;**host**&amp;quot; <span class="value">: &amp;quot;</span>zhoujinyi&amp;quot;,
    &amp;quot;**version**&amp;quot; <span class="value">: &amp;quot;</span>3<span class="class">.0</span><span class="class">.4</span>&amp;quot;,
    &amp;quot;process&amp;quot; <span class="value">: &amp;quot;</span>mongod&amp;quot;,
    &amp;quot;pid&amp;quot; <span class="value">: <span class="function">NumberLong</span>(<span class="number">3939</span>),
    &amp;quot;</span>uptime&amp;quot; <span class="value">: <span class="number">149427</span>,
    &amp;quot;</span>uptimeMillis&amp;quot; <span class="value">: <span class="function">NumberLong</span>(<span class="number">149427393</span>),
    &amp;quot;</span>uptimeEstimate&amp;quot; <span class="value">: <span class="number">140539</span>,
    &amp;quot;</span>localTime&amp;quot; <span class="value">: <span class="function">ISODate</span>(&amp;quot;</span>2015-07-01T14<span class="value">:<span class="number">06</span>:<span class="number">12.922</span>Z&amp;quot;</span>),
    &amp;quot;asserts&amp;quot; <span class="value">: {
        &amp;quot;</span>regular&amp;quot; <span class="value">: <span class="number">0</span>,
        &amp;quot;</span>warning&amp;quot; <span class="value">: <span class="number">0</span>,
        &amp;quot;</span>msg&amp;quot; <span class="value">: <span class="number">0</span>,
        &amp;quot;</span>user&amp;quot; <span class="value">: <span class="number">30</span>,
        &amp;quot;</span>rollovers&amp;quot; <span class="value">: <span class="number">0</span>
    },
    &amp;quot;</span>**backgroundFlushing**&amp;quot; <span class="value">: {
        &amp;quot;</span>flushes&amp;quot; <span class="value">: <span class="number">2490</span>,
        &amp;quot;</span>total_ms&amp;quot; <span class="value">: <span class="number">10410</span>,
        &amp;quot;</span>average_ms&amp;quot; <span class="value">: <span class="number">4.180722891566265</span>,
        &amp;quot;</span>last_ms&amp;quot; <span class="value">: <span class="number">10</span>,
        &amp;quot;</span>last_finished&amp;quot; <span class="value">: <span class="function">ISODate</span>(&amp;quot;</span>2015-07-01T14<span class="value">:<span class="number">05</span>:<span class="number">47.284</span>Z&amp;quot;</span>)
    },
    &amp;quot;**connections**&amp;quot; <span class="value">: {
        &amp;quot;</span>**current**&amp;quot; <span class="value">: <span class="number">7</span>,
        &amp;quot;</span>available&amp;quot; <span class="value">: <span class="number">43</span>,
        &amp;quot;</span>totalCreated&amp;quot; <span class="value">: <span class="function">NumberLong</span>(<span class="number">10016</span>)
    },
...
...
    &amp;quot;</span>**network**&amp;quot; <span class="value">: {
        &amp;quot;</span>bytesIn&amp;quot; <span class="value">: <span class="number">23165291</span>,
        &amp;quot;</span>bytesOut&amp;quot; <span class="value">: <span class="number">25295567</span>,
        &amp;quot;</span>numRequests&amp;quot; <span class="value">: <span class="number">209093</span>
    },
    &amp;quot;</span>**opcounters**&amp;quot; <span class="value">: {
        &amp;quot;</span>insert&amp;quot; <span class="value">: <span class="number">9</span>,
        &amp;quot;</span>query&amp;quot; <span class="value">: <span class="number">53</span>,
        &amp;quot;</span>update&amp;quot; <span class="value">: <span class="number">9</span>,
        &amp;quot;</span>delete&amp;quot; <span class="value">: <span class="number">0</span>,
        &amp;quot;</span>getmore&amp;quot; <span class="value">: <span class="number">59219</span>,
        &amp;quot;</span><span class="tag">command</span>&amp;quot; <span class="value">: <span class="number">149822</span>
    },
    &amp;quot;</span>opcountersRepl&amp;quot; <span class="value">: {
        &amp;quot;</span>insert&amp;quot; <span class="value">: <span class="number">0</span>,
        &amp;quot;</span>query&amp;quot; <span class="value">: <span class="number">0</span>,
        &amp;quot;</span>update&amp;quot; <span class="value">: <span class="number">0</span>,
        &amp;quot;</span>delete&amp;quot; <span class="value">: <span class="number">0</span>,
        &amp;quot;</span>getmore&amp;quot; <span class="value">: <span class="number">0</span>,
        &amp;quot;</span><span class="tag">command</span>&amp;quot; <span class="value">: <span class="number">0</span>
    },
    &amp;quot;</span>**repl**&amp;quot; <span class="value">: {
        &amp;quot;</span>**setName**&amp;quot; <span class="value">: &amp;quot;</span>zjy&amp;quot;,
        &amp;quot;setVersion&amp;quot; <span class="value">: <span class="number">31303</span>,
        &amp;quot;</span>**ismaster**&amp;quot; <span class="value">: true,
        &amp;quot;</span>secondary&amp;quot; <span class="value">: false,
        &amp;quot;</span>**hosts**&amp;quot; <span class="value">: [
            &amp;quot;</span>127<span class="class">.0</span><span class="class">.0</span><span class="class">.1</span><span class="value">:<span class="number">27017</span>&amp;quot;</span>,
            &amp;quot;127<span class="class">.0</span><span class="class">.0</span><span class="class">.1</span><span class="value">:<span class="number">27018</span>&amp;quot;</span>,
            &amp;quot;127<span class="class">.0</span><span class="class">.0</span><span class="class">.1</span><span class="value">:<span class="number">27019</span>&amp;quot;</span>
        ],
        &amp;quot;**primary**&amp;quot; <span class="value">: &amp;quot;</span>127<span class="class">.0</span><span class="class">.0</span><span class="class">.1</span><span class="value">:<span class="number">27017</span>&amp;quot;</span>,
        &amp;quot;me&amp;quot; <span class="value">: &amp;quot;</span>127<span class="class">.0</span><span class="class">.0</span><span class="class">.1</span><span class="value">:<span class="number">27017</span>&amp;quot;</span>,
        &amp;quot;electionId&amp;quot; <span class="value">: <span class="function">ObjectId</span>(&amp;quot;</span>5592be327c7062c30c3bff24&amp;quot;),
        &amp;quot;rbid&amp;quot; <span class="value">: <span class="number">652411007</span>
    },
    &amp;quot;</span>**storageEngine**&amp;quot; <span class="value">: {
        &amp;quot;</span>name&amp;quot; <span class="value">: &amp;quot;</span>mmapv1&amp;quot;
    },
    &amp;quot;writeBacksQueued&amp;quot; <span class="value">: false,
    &amp;quot;</span>**mem**&amp;quot; <span class="value">: {
        &amp;quot;</span>bits&amp;quot; <span class="value">: <span class="number">64</span>,
        &amp;quot;</span>**resident**&amp;quot; <span class="value">: <span class="number">130</span>,
        &amp;quot;</span>**virtual**&amp;quot; <span class="value">: <span class="number">9710</span>,
        &amp;quot;</span>supported&amp;quot; <span class="value">: true,
        &amp;quot;</span>**mapped**&amp;quot; <span class="value">: <span class="number">4574</span>,
        &amp;quot;</span>mappedWithJournal&amp;quot; <span class="value">: <span class="number">9148</span>
    },
...
...
    &amp;quot;</span>ok&amp;quot; <span class="value">: <span class="number">1</span>
}</span>
</code></pre><p>&#x901A;&#x8FC7;&#x4E0A;&#x9762;&#x770B;&#x5230;MongoDB&#x7684;&#x7248;&#x672C;&#x3001;&#x540E;&#x53F0;&#x5237;&#x5199;&#x60C5;&#x51B5;&#x3001;&#x526F;&#x672C;&#x96C6;&#x60C5;&#x51B5;&#x3001;&#x64CD;&#x4F5C;&#x6570;&#x91CF;&#x60C5;&#x51B5;&#x3001;&#x8FDB;&#x51FA;&#x7F51;&#x7EDC;&#x60C5;&#x51B5;&#x3001;&#x8FDE;&#x63A5;&#x6570;&#x60C5;&#x51B5;&#x548C;&#x5185;&#x5B58;&#x60C5;&#x51B5;&#x3002;</p>
<p>&#x5176;&#x4E2D;&#x5185;&#x5B58;&#x76F8;&#x5173;&#x5B57;&#x6BB5;&#x7684;&#x542B;&#x4E49;&#x662F;&#xFF1A;&#x5355;&#x4F4D;&#x662F;M</p>
<p>mapped&#xFF1A;&#x6620;&#x5C04;&#x5230;&#x5185;&#x5B58;&#x7684;&#x6570;&#x636E;&#x5927;&#x5C0F;</p>
<p>visze&#xFF1A;&#x5360;&#x7528;&#x7684;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x5927;&#x5C0F;</p>
<p>res&#xFF1A;&#x5B9E;&#x9645;&#x4F7F;&#x7528;&#x7684;&#x5185;&#x5B58;&#x5927;&#x5C0F;</p>
<p>&#x5728;&#x4E0A;&#x9762;&#x7684;&#x7ED3;&#x679C;&#x4E2D;&#xFF0C;virtual&#x662F;mapped&#x7684;&#x4E24;&#x500D;&#xFF0C;&#x800C;mapped&#x7B49;&#x4E8E;&#x6570;&#x636E;&#x6587;&#x4EF6;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x6240;&#x4EE5;&#x8BF4;vsize&#x662F;&#x6570;&#x636E;&#x6587;&#x4EF6;&#x7684;&#x4E24;&#x500D;&#xFF0C;&#x4E4B;&#x6240;&#x4EE5;&#x4F1A;&#x8FD9;&#x6837;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x672C;&#x4F8B;&#x4E2D;&#xFF0C;MongoDB&#x5F00;&#x542F;&#x4E86;journal&#xFF0C;&#x9700;&#x8981;&#x5728;&#x5185;&#x5B58;&#x91CC;&#x591A;&#x6620;&#x5C04;&#x4E00;&#x6B21;&#x6570;&#x636E;&#x6587;&#x4EF6;&#xFF0C;&#x5982;&#x679C;&#x5173;&#x95ED;journal&#xFF0C;&#x5219;virtual&#x548C;mapped&#x5927;&#x81F4;&#x76F8;&#x5F53;&#x3002;</p>
<p>&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;mongostat&#x6765;&#x67E5;&#x770B;&#xFF1A; </p>
<pre><code>root<span class="comment">@zhoujinyi:~# mongostat</span>
insert query update delete getmore command flushes mapped vsize    res faults qr|<span class="string">qw ar</span>|<span class="string">aw netIn netOut conn set repl     time
    *0    *0     *0     *0       1     2</span>|<span class="string">0       0   4.5G  9.5G 133.0M      0   0</span>|<span class="string">0   0</span>|<span class="string">0  262b    11k    7 zjy  PRI 10:23:13
    *0    *0     *0     *0       0     2</span>|<span class="string">0       0   4.5G  9.5G 133.0M      0   0</span>|<span class="string">0   0</span>|<span class="string">0  215b    11k    7 zjy  PRI 10:23:14
    *0    *0     *0     *0       0     2</span>|<span class="string">0       0   4.5G  9.5G 133.0M      0   0</span>|<span class="string">0   0</span>|<span class="string">0  215b    11k    7 zjy  PRI 10:23:15</span>
</code></pre><p>&#x4E8C;&#xFF1A;&#x67E5;&#x770B;&#x6570;&#x636E;&#x5E93;/&#x8868;&#x72B6;&#x6001;&#xFF1A;db.stats()/db.coll.stats() </p>
<pre><code><span class="xml">zjy:PRIMARY&amp;gt;**db.stats()**
</span><span class="expression">{
    &amp;<span class="variable">quot</span>;**<span class="variable">db</span>**&amp;<span class="variable">quot</span>; : &amp;<span class="variable">quot</span>;<span class="variable">test</span>&amp;<span class="variable">quot</span>;,
    **&amp;<span class="variable">quot</span>;<span class="variable">collections</span>&amp;<span class="variable">quot</span>;** : 7,
    &amp;<span class="variable">quot</span>;<span class="variable">objects</span>&amp;<span class="variable">quot</span>; : 36,
    &amp;<span class="variable">quot</span>;<span class="variable">avgObjSize</span>&amp;<span class="variable">quot</span>; : 417<span class="variable">.</span>1111111111111,
    &amp;<span class="variable">quot</span>;**<span class="variable">dataSize</span>**&amp;<span class="variable">quot</span>; : 15016,      #&amp;<span class="begin-block">#x</span>6570;&amp;<span class="begin-block">#x</span>636<span class="variable">E</span>;&amp;<span class="begin-block">#x</span>6587;&amp;<span class="begin-block">#x</span>4<span class="variable">EF</span>6;&amp;<span class="begin-block">#x</span>5927;&amp;<span class="begin-block">#x</span>5<span class="variable">C</span>0<span class="variable">F</span>;&amp;<span class="begin-block">#x</span>3002;
    &amp;<span class="variable">quot</span>;**<span class="variable">storageSize</span>**&amp;<span class="variable">quot</span>; : 1093632, #&amp;<span class="begin-block">#x</span>5<span class="variable">B</span>58;&amp;<span class="begin-block">#x</span>50<span class="variable">A</span>8;&amp;<span class="begin-block">#x</span>7<span class="variable">A</span>7<span class="variable">A</span>;&amp;<span class="begin-block">#x</span>95<span class="variable">F</span>4;&amp;<span class="begin-block">#x</span>5927;&amp;<span class="begin-block">#x</span>5<span class="variable">C</span>0<span class="variable">F</span>;&amp;<span class="begin-block">#xFF</span>1<span class="variable">A</span>;<span class="variable">datasize</span>+&amp;<span class="begin-block">#x</span>96<span class="variable">C</span>6;&amp;<span class="begin-block">#x</span>5408;&amp;<span class="begin-block">#x</span>4<span class="variable">E</span>24;&amp;<span class="begin-block">#x</span>7<span class="variable">AEF</span>;&amp;<span class="begin-block">#x</span>9884;&amp;<span class="begin-block">#x</span>7559;&amp;<span class="begin-block">#x</span>7684;&amp;<span class="begin-block">#x</span>672<span class="variable">A</span>;&amp;<span class="begin-block">#x</span>4<span class="variable">F</span>7<span class="variable">F</span>;&amp;<span class="begin-block">#x</span>7528;&amp;<span class="begin-block">#x</span>7<span class="variable">A</span>7<span class="variable">A</span>;&amp;<span class="begin-block">#x</span>95<span class="variable">F</span>4;&amp;<span class="begin-block">#x</span>3002;
    &amp;<span class="variable">quot</span>;<span class="variable">numExtents</span>&amp;<span class="variable">quot</span>; : 7,
    &amp;<span class="variable">quot</span>;**<span class="variable">indexes</span>**&amp;<span class="variable">quot</span>; : 4,
    &amp;<span class="variable">quot</span>;<span class="variable">indexSize</span>&amp;<span class="variable">quot</span>; : 32704,
    &amp;<span class="variable">quot</span>;**<span class="variable">fileSize</span>**&amp;<span class="variable">quot</span>; : 67108864, #&amp;<span class="begin-block">#x</span>7269;&amp;<span class="begin-block">#x</span>7406;&amp;<span class="begin-block">#x</span>6587;&amp;<span class="begin-block">#x</span>4<span class="variable">EF</span>6;&amp;<span class="begin-block">#x</span>5927;&amp;<span class="begin-block">#x</span>5<span class="variable">C</span>0<span class="variable">F</span>;&amp;<span class="begin-block">#xFF</span>1<span class="variable">A</span>;&amp;<span class="begin-block">#x</span>5305;&amp;<span class="begin-block">#x</span>62<span class="variable">EC</span>;&amp;<span class="begin-block">#x</span>9884;&amp;<span class="begin-block">#x</span>5206;&amp;<span class="begin-block">#x</span>914<span class="variable">D</span>;
    &amp;<span class="variable">quot</span>;<span class="variable">nsSizeMB</span>&amp;<span class="variable">quot</span>; : 16,
    &amp;<span class="variable">quot</span>;<span class="variable">extentFreeList</span>&amp;<span class="variable">quot</span>; : {
        &amp;<span class="variable">quot</span>;<span class="variable">num</span>&amp;<span class="variable">quot</span>; : 0,
        &amp;<span class="variable">quot</span>;<span class="variable">totalSize</span>&amp;<span class="variable">quot</span>; : 0
    }</span><span class="xml">,
    &amp;quot;dataFileVersion&amp;quot; : </span><span class="expression">{
        &amp;<span class="variable">quot</span>;<span class="variable">major</span>&amp;<span class="variable">quot</span>; : 4,
        &amp;<span class="variable">quot</span>;<span class="variable">minor</span>&amp;<span class="variable">quot</span>; : 22
    }</span><span class="xml">,
    &amp;quot;ok&amp;quot; : 1
}</span>
</code></pre><p>&#x901A;&#x8FC7;&#x4E0A;&#x9762;&#x770B;&#x5230;&#x6570;&#x636E;&#x5E93;&#x7684;&#x540D;&#x79F0;&#xFF0C;&#x96C6;&#x5408;&#xFF08;&#x8868;&#xFF09;&#x6570;&#x91CF;&#xFF0C;&#x7D22;&#x5F15;&#x6570;&#x91CF;&#x3001;&#x5927;&#x5C0F;&#xFF0C;&#x6570;&#x636E;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#xFF0C;&#x5B58;&#x50A8;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;&#x548C;&#x7269;&#x7406;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x3002;</p>
<p>&#x4E09;&#xFF0C;&#x67E5;&#x770B;&#x5F53;&#x524D;Query&#x6267;&#x884C;&#x60C5;&#x51B5;&#xFF1A; db.currentOP():</p>
<pre><code><span class="method">zjy:</span><span class="class">PRIMARY</span>&amp;gt; db.currentOP()
{
    &amp;quot;inprog&amp;quot; : [
        {
            &amp;quot;**desc**&amp;quot; : &amp;quot;conn4732&amp;quot;,   #&amp;<span class="symbol">#x53EF</span>;&amp;<span class="symbol">#x4E0E</span>;&amp;<span class="symbol">#x65E5</span>;&amp;<span class="symbol">#x5FD7</span>;&amp;<span class="symbol">#x4FE1</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x8054</span>;&amp;<span class="symbol">#x7CFB</span>;&amp;<span class="symbol">#x8D77</span>;&amp;<span class="symbol">#x6765</span>;
            &amp;quot;threadId&amp;quot; : &amp;quot;<span class="number">0x33903c0</span>&amp;quot;,
            &amp;quot;**connectionId**&amp;quot; : <span class="number">4732</span>, #&amp;<span class="symbol">#x8FDE</span>;&amp;<span class="symbol">#x63A5</span>;<span class="class">ID</span>
            &amp;quot;**opid**&amp;quot; : <span class="number">221672</span>,       #&amp;<span class="symbol">#x64CD</span>;&amp;<span class="symbol">#x4F5C</span>;&amp;<span class="symbol">#x6807</span>;&amp;<span class="symbol">#x8BC6</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x53EF</span>;&amp;<span class="symbol">#x4EE5</span>;&amp;<span class="symbol">#x7528</span>;&amp;<span class="symbol">#x8FD9</span>;&amp;<span class="symbol">#x4E2A</span>;<span class="class">ID</span>&amp;<span class="symbol">#x6765</span>;&amp;<span class="symbol">#x7EC8</span>;&amp;<span class="symbol">#x6B62</span>;&amp;<span class="symbol">#x8BE5</span>;&amp;<span class="symbol">#x64CD</span>;&amp;<span class="symbol">#x4F5C</span>;&amp;<span class="symbol">#xFF1A</span>;**db.killOP(opid)**&amp;quot;**active**&amp;quot; : <span class="keyword">true</span>,       #&amp;<span class="symbol">#x8868</span>;&amp;<span class="symbol">#x793A</span>;&amp;<span class="symbol">#x7EBF</span>;&amp;<span class="symbol">#x7A0B</span>;&amp;<span class="symbol">#x662F</span>;&amp;<span class="symbol">#x5426</span>;&amp;<span class="symbol">#x5728</span>;&amp;<span class="symbol">#x8FD0</span>;&amp;<span class="symbol">#x884C</span>;
            &amp;quot;**secs_running**&amp;quot; : <span class="number">4</span>,    #&amp;<span class="symbol">#x6267</span>;&amp;<span class="symbol">#x884C</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x65F6</span>;&amp;<span class="symbol">#x95F4</span>;
            &amp;quot;microsecs_running&amp;quot; : <span class="class">NumberLong</span>(<span class="number">4999899</span>),
            &amp;quot;**op**&amp;quot; : &amp;quot;getmore&amp;quot;,      #&amp;<span class="symbol">#x64CD</span>;&amp;<span class="symbol">#x4F5C</span>;&amp;<span class="symbol">#x7C7B</span>;&amp;<span class="symbol">#x578B</span>;&amp;<span class="symbol">#xFF1A</span>;&amp;<span class="symbol">#x63D2</span>;&amp;<span class="symbol">#x5165</span>;&amp;<span class="symbol">#x3001</span>;&amp;<span class="symbol">#x5220</span>;&amp;<span class="symbol">#x9664</span>;&amp;<span class="symbol">#x3001</span>;&amp;<span class="symbol">#x66F4</span>;&amp;<span class="symbol">#x65B0</span>;&amp;<span class="symbol">#x3001</span>;&amp;<span class="symbol">#x67E5</span>;&amp;<span class="symbol">#x8BE2</span>;
            &amp;quot;**ns**&amp;quot; : &amp;quot;local.oplog.rs&amp;quot;, #&amp;<span class="symbol">#x64CD</span>;&amp;<span class="symbol">#x4F5C</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x96C6</span>;&amp;<span class="symbol">#x5408</span>;
            &amp;quot;**query**&amp;quot; : {
                &amp;quot;ts&amp;quot; : {
                    &amp;quot;<span class="char">$g</span>te&amp;quot; : <span class="class">Timestamp</span>(<span class="number">1435674461</span>, <span class="number">1</span>)
                }
            },
            &amp;quot;**client**&amp;quot; : &amp;quot;<span class="number">127.0</span>.0.1:<span class="number">52101</span>&amp;quot;, 
            &amp;quot;numYields&amp;quot; : <span class="number">0</span>, #&amp;<span class="symbol">#x8868</span>;&amp;<span class="symbol">#x793A</span>;&amp;<span class="symbol">#x8BE5</span>;&amp;<span class="symbol">#x64CD</span>;&amp;<span class="symbol">#x4F5C</span>;&amp;<span class="symbol">#x4EA4</span>;&amp;<span class="symbol">#x51FA</span>;&amp;<span class="symbol">#x9501</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x800C</span>;&amp;<span class="symbol">#x4F7F</span>;&amp;<span class="symbol">#x5176</span>;&amp;<span class="symbol">#x4ED6</span>;&amp;<span class="symbol">#x64CD</span>;&amp;<span class="symbol">#x4F5C</span>;&amp;<span class="symbol">#x5F97</span>;&amp;<span class="symbol">#x4EE5</span>;&amp;<span class="symbol">#x8FD0</span>;&amp;<span class="symbol">#x884C</span>;&amp;<span class="symbol">#x3002</span>;
            &amp;quot;locks&amp;quot; : {      #&amp;<span class="symbol">#x9501</span>;&amp;<span class="symbol">#x4FE1</span>;&amp;<span class="symbol">#x606F</span>;
            },
            &amp;quot;waitingForLock&amp;quot; : <span class="keyword">false</span>,
            &amp;quot;lockStats&amp;quot; : {
                &amp;quot;<span class="class">Global</span>&amp;quot; : {
                    &amp;quot;acquireCount&amp;quot; : {
                        &amp;quot;r&amp;quot; : <span class="class">NumberLong</span>(<span class="number">10</span>)
                    }
                },
                &amp;quot;<span class="class">MMAPV1Journal</span>&amp;quot; : {
                    &amp;quot;acquireCount&amp;quot; : {
                        &amp;quot;r&amp;quot; : <span class="class">NumberLong</span>(<span class="number">5</span>)
                    }
                },
                &amp;quot;<span class="class">Database</span>&amp;quot; : {
                    &amp;quot;acquireCount&amp;quot; : {
                        &amp;quot;r&amp;quot; : <span class="class">NumberLong</span>(<span class="number">5</span>)
                    }
                },
                &amp;quot;oplog&amp;quot; : {
                    &amp;quot;acquireCount&amp;quot; : {
                        &amp;quot;<span class="class">R</span>&amp;quot; : <span class="class">NumberLong</span>(<span class="number">5</span>)
                    }
                }
            }
        }  
</code></pre><p>…<br>…  </p>
<p>&#x901A;&#x8FC7;&#x4E0A;&#x9762;&#x770B;&#x5230;&#x5F53;&#x524D;&#x6267;&#x884C;&#x7684;&#x8FDB;&#x7A0B;&#xFF0C;&#x7C7B;&#x4F3C;MySQL&#x7684;show processlist&#x3002;&#x53EF;&#x4EE5;&#x6DFB;&#x52A0;&#x8FC7;&#x6EE4;&#x6761;&#x4EF6;&#xFF1A;</p>
<pre><code><span class="symbol">zjy:</span><span class="constant">PRIMARY&amp;</span>gt; db.currentOP({&amp;quot;ns&amp;quot;<span class="symbol">:&amp;quot</span>;test&amp;quot;})
</code></pre><p>&#x56DB;&#xFF1A;&#x76D1;&#x63A7;MongoDB&#x5404;&#x4E2A;&#x72B6;&#x6001;&#xFF1A;mongotop&#x3001;mongostat </p>
<pre><code><span class="tag">root</span><span class="at_rule">@<span class="keyword">zhoujinyi:~#</span> mongotop     #&amp;#x67E5</span>;&amp;<span class="id">#x770B</span>;&amp;<span class="id">#x90A3</span>;&amp;<span class="id">#x4E2A</span>;&amp;<span class="id">#x51E0</span>;&amp;<span class="id">#x4E2A</span>;&amp;<span class="id">#x6700</span>;&amp;<span class="id">#x7E41</span>;&amp;<span class="id">#x5FD9</span>;
                     <span class="tag">ns</span>    <span class="tag">total</span>    <span class="tag">read</span>    <span class="tag">write</span>    2015<span class="tag">-07-01T11</span><span class="pseudo">:24</span><span class="pseudo">:43-04</span><span class="pseudo">:00</span>
                    <span class="tag">abc</span>      0<span class="tag">ms</span>     0<span class="tag">ms</span>      0<span class="tag">ms</span>                             
                <span class="tag">abc</span><span class="class">.AOE</span>      0<span class="tag">ms</span>     0<span class="tag">ms</span>      0<span class="tag">ms</span>                             
                <span class="tag">abc</span><span class="class">.aoe</span>      0<span class="tag">ms</span>     0<span class="tag">ms</span>      0<span class="tag">ms</span>                             
     <span class="tag">abc</span><span class="class">.system</span><span class="class">.indexes</span>      0<span class="tag">ms</span>     0<span class="tag">ms</span>      0<span class="tag">ms</span>                             
          <span class="tag">abc</span><span class="class">.system</span><span class="class">.js</span>      0<span class="tag">ms</span>     0<span class="tag">ms</span>      0<span class="tag">ms</span>                             
  <span class="tag">abc</span><span class="class">.system</span><span class="class">.namespaces</span>      0<span class="tag">ms</span>     0<span class="tag">ms</span>      0<span class="tag">ms</span>                             
               <span class="tag">abc</span><span class="class">.test</span>      0<span class="tag">ms</span>     0<span class="tag">ms</span>      0<span class="tag">ms</span>                             
   <span class="tag">admin</span><span class="class">.system</span><span class="class">.indexes</span>      0<span class="tag">ms</span>     0<span class="tag">ms</span>      0<span class="tag">ms</span>                             
<span class="tag">admin</span><span class="class">.system</span><span class="class">.namespaces</span>      0<span class="tag">ms</span>     0<span class="tag">ms</span>      0<span class="tag">ms</span>                             
     <span class="tag">admin</span><span class="class">.system</span><span class="class">.roles</span>   

<span class="tag">root</span><span class="at_rule">@<span class="keyword">zhoujinyi:~#</span> mongostat
insert query update delete getmore command flushes mapped vsize    res faults qr|qw ar|aw netIn netOut conn set repl     time
    *<span class="number">0</span>    *<span class="number">0</span>     *<span class="number">0</span>     *<span class="number">0</span>       <span class="number">0</span>     <span class="number">2</span>|<span class="number">0</span>       <span class="number">0</span>   <span class="number">4.5</span>G  <span class="number">9.5</span>G <span class="number">133.0</span>M      <span class="number">0</span>   <span class="number">0</span>|<span class="number">0</span>   <span class="number">0</span>|<span class="number">0</span>  <span class="number">215</span>b    <span class="number">11</span>k    <span class="number">7</span> zjy  PRI <span class="number">11</span>:<span class="number">26</span>:<span class="number">21</span>
    *<span class="number">0</span>    *<span class="number">0</span>     *<span class="number">0</span>     *<span class="number">0</span>       <span class="number">0</span>     <span class="number">2</span>|<span class="number">0</span>       <span class="number">0</span>   <span class="number">4.5</span>G  <span class="number">9.5</span>G <span class="number">133.0</span>M      <span class="number">0</span>   <span class="number">0</span>|<span class="number">0</span>   <span class="number">0</span>|<span class="number">0</span>  <span class="number">215</span>b    <span class="number">11</span>k    <span class="number">7</span> zjy  PRI <span class="number">11</span>:<span class="number">26</span>:<span class="number">22</span>
    *<span class="number">0</span>    *<span class="number">0</span>     *<span class="number">0</span>     *<span class="number">0</span>       <span class="number">0</span>     <span class="number">2</span>|<span class="number">0</span>       <span class="number">0</span>   <span class="number">4.5</span>G  <span class="number">9.5</span>G <span class="number">133.0</span>M      <span class="number">0</span>   <span class="number">0</span>|<span class="number">0</span>   <span class="number">0</span>|<span class="number">0</span>  <span class="number">215</span>b    <span class="number">11</span>k    <span class="number">7</span> zjy  PRI <span class="number">11</span>:<span class="number">26</span>:<span class="number">23</span>
    *<span class="number">0</span>    *<span class="number">0</span>     *<span class="number">0</span>     *<span class="number">0</span>       <span class="number">1</span>     <span class="number">2</span>|<span class="number">0</span>       <span class="number">0</span>   <span class="number">4.5</span>G  <span class="number">9.5</span>G <span class="number">133.0</span>M      <span class="number">0</span>   <span class="number">0</span>|<span class="number">0</span>   <span class="number">0</span>|<span class="number">0</span>  <span class="number">262</span>b    <span class="number">11</span>k    <span class="number">7</span> zjy  PRI <span class="number">11</span>:<span class="number">26</span>:<span class="number">24</span></span>
</code></pre><p>&#x4E0A;&#x9762;insert&#x3001;query&#x3001;update&#x3001;delete&#x3001;getmore&#x3001;command &#x6BCF;&#x79CD;&#x5BF9;&#x5E94;&#x64CD;&#x4F5C;&#x7684;&#x53D1;&#x751F;&#x6B21;&#x6570;&#x3002;</p>
<pre><code>flushes<span class="subst">&amp;</span><span class="variable">#xFF1A</span>;<span class="subst">&amp;</span><span class="variable">#x8868</span>;<span class="subst">&amp;</span><span class="variable">#x793A</span>;<span class="subst">&amp;</span><span class="variable">#x5237</span>;<span class="subst">&amp;</span><span class="variable">#x5199</span>;<span class="subst">&amp;</span><span class="variable">#x5230</span>;<span class="subst">&amp;</span><span class="variable">#x78C1</span>;<span class="subst">&amp;</span><span class="variable">#x76D8</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x6B21</span>;<span class="subst">&amp;</span><span class="variable">#x6570</span>;<span class="subst">&amp;</span><span class="variable">#x3002</span>;
mapped<span class="subst">&amp;</span><span class="variable">#xFF1A</span>;<span class="subst">&amp;</span><span class="variable">#x8868</span>;<span class="subst">&amp;</span><span class="variable">#x793A</span>;<span class="subst">&amp;</span><span class="variable">#x6620</span>;<span class="subst">&amp;</span><span class="variable">#x5C04</span>;<span class="subst">&amp;</span><span class="variable">#x5230</span>;<span class="subst">&amp;</span><span class="variable">#x5185</span>;<span class="subst">&amp;</span><span class="variable">#x5B58</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x6570</span>;<span class="subst">&amp;</span><span class="variable">#x91CF</span>;<span class="subst">&amp;</span><span class="variable">#xFF0C</span>;<span class="subst">&amp;</span><span class="variable">#x7EA6</span>;<span class="subst">&amp;</span><span class="variable">#x7B49</span>;<span class="subst">&amp;</span><span class="variable">#x4E8E</span>;<span class="subst">&amp;</span><span class="variable">#x6570</span>;<span class="subst">&amp;</span><span class="variable">#x636E</span>;<span class="subst">&amp;</span><span class="variable">#x76EE</span>;<span class="subst">&amp;</span><span class="variable">#x5F55</span>;<span class="subst">&amp;</span><span class="variable">#x5927</span>;<span class="subst">&amp;</span><span class="variable">#x5C0F</span>;<span class="subst">&amp;</span><span class="variable">#x3002</span>;
vsize<span class="subst">&amp;</span><span class="variable">#xFF1A</span>;<span class="subst">&amp;</span><span class="variable">#x8868</span>;<span class="subst">&amp;</span><span class="variable">#x793A</span>;<span class="subst">&amp;</span><span class="variable">#x6B63</span>;<span class="subst">&amp;</span><span class="variable">#x5728</span>;<span class="subst">&amp;</span><span class="variable">#x4F7F</span>;<span class="subst">&amp;</span><span class="variable">#x7528</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x865A</span>;<span class="subst">&amp;</span><span class="variable">#x62DF</span>;<span class="subst">&amp;</span><span class="variable">#x5185</span>;<span class="subst">&amp;</span><span class="variable">#x5B58</span>;<span class="subst">&amp;</span><span class="variable">#x5927</span>;<span class="subst">&amp;</span><span class="variable">#x5C0F</span>;<span class="subst">&amp;</span><span class="variable">#xFF0C</span>;<span class="subst">&amp;</span><span class="variable">#x901A</span>;<span class="subst">&amp;</span><span class="variable">#x5E38</span>;<span class="subst">&amp;</span><span class="variable">#x4E3A</span>;<span class="subst">&amp;</span><span class="variable">#x6570</span>;<span class="subst">&amp;</span><span class="variable">#x636E</span>;<span class="subst">&amp;</span><span class="variable">#x76EE</span>;<span class="subst">&amp;</span><span class="variable">#x5F55</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="number">2</span><span class="subst">&amp;</span><span class="variable">#x500D</span>;<span class="subst">&amp;</span><span class="variable">#x3002</span>;<span class="subst">&amp;</span><span class="variable">#xFF08</span>;<span class="subst">&amp;</span><span class="variable">#x4E00</span>;<span class="subst">&amp;</span><span class="variable">#x6B21</span>;<span class="subst">&amp;</span><span class="variable">#x7528</span>;<span class="subst">&amp;</span><span class="variable">#x4E8E</span>;<span class="subst">&amp;</span><span class="variable">#x6620</span>;<span class="subst">&amp;</span><span class="variable">#x5C04</span>;<span class="subst">&amp;</span><span class="variable">#xFF0C</span>;<span class="subst">&amp;</span><span class="variable">#x4E00</span>;<span class="subst">&amp;</span><span class="variable">#x6B21</span>;<span class="subst">&amp;</span><span class="variable">#x7528</span>;<span class="subst">&amp;</span><span class="variable">#x4E8E</span>;<span class="subst">&amp;</span><span class="variable">#x65E5</span>;<span class="subst">&amp;</span><span class="variable">#x5FD7</span>;<span class="subst">&amp;</span><span class="variable">#x7CFB</span>;<span class="subst">&amp;</span><span class="variable">#x7EDF</span>;<span class="subst">&amp;</span><span class="variable">#xFF09</span>;
res<span class="subst">&amp;</span><span class="variable">#xFF1A</span>;<span class="subst">&amp;</span><span class="variable">#x8868</span>;<span class="subst">&amp;</span><span class="variable">#x793A</span>;<span class="subst">&amp;</span><span class="variable">#x6B63</span>;<span class="subst">&amp;</span><span class="variable">#x5728</span>;<span class="subst">&amp;</span><span class="variable">#x4F7F</span>;<span class="subst">&amp;</span><span class="variable">#x7528</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x5185</span>;<span class="subst">&amp;</span><span class="variable">#x5B58</span>;<span class="subst">&amp;</span><span class="variable">#x5927</span>;<span class="subst">&amp;</span><span class="variable">#x5C0F</span>;<span class="subst">&amp;</span><span class="variable">#x3002</span>;
qr<span class="subst">|</span>qw<span class="subst">&amp;</span><span class="variable">#xFF1A</span>;<span class="subst">&amp;</span><span class="variable">#x8868</span>;<span class="subst">&amp;</span><span class="variable">#x793A</span>;<span class="subst">&amp;</span><span class="variable">#x8BFB</span>;<span class="subst">&amp;</span><span class="variable">#x5199</span>;<span class="subst">&amp;</span><span class="variable">#x64CD</span>;<span class="subst">&amp;</span><span class="variable">#x4F5C</span>;<span class="subst">&amp;</span><span class="variable">#x961F</span>;<span class="subst">&amp;</span><span class="variable">#x5217</span>;<span class="subst">&amp;</span><span class="variable">#x5927</span>;<span class="subst">&amp;</span><span class="variable">#x5C0F</span>;<span class="subst">&amp;</span><span class="variable">#xFF0C</span>;<span class="subst">&amp;</span><span class="variable">#x5373</span>;<span class="subst">&amp;</span><span class="variable">#x6709</span>;<span class="subst">&amp;</span><span class="variable">#x591A</span>;<span class="subst">&amp;</span><span class="variable">#x5C11</span>;<span class="subst">&amp;</span><span class="variable">#x8BFB</span>;<span class="subst">&amp;</span><span class="variable">#x5199</span>;<span class="subst">&amp;</span><span class="variable">#x64CD</span>;<span class="subst">&amp;</span><span class="variable">#x4F5C</span>;<span class="subst">&amp;</span><span class="variable">#x88AB</span>;<span class="subst">&amp;</span><span class="variable">#x963B</span>;<span class="subst">&amp;</span><span class="variable">#x585E</span>;<span class="subst">&amp;</span><span class="variable">#xFF0C</span>;<span class="subst">&amp;</span><span class="variable">#x7B49</span>;<span class="subst">&amp;</span><span class="variable">#x5F85</span>;<span class="subst">&amp;</span><span class="variable">#x8FDB</span>;<span class="subst">&amp;</span><span class="variable">#x884C</span>;<span class="subst">&amp;</span><span class="variable">#x5904</span>;<span class="subst">&amp;</span><span class="variable">#x7406</span>;<span class="subst">&amp;</span><span class="variable">#x3002</span>;
ar<span class="subst">|</span>aw<span class="subst">&amp;</span><span class="variable">#xFF1A</span>;<span class="subst">&amp;</span><span class="variable">#x8868</span>;<span class="subst">&amp;</span><span class="variable">#x793A</span>;<span class="subst">&amp;</span><span class="variable">#x6D3B</span>;<span class="subst">&amp;</span><span class="variable">#x52A8</span>;<span class="subst">&amp;</span><span class="variable">#x5BA2</span>;<span class="subst">&amp;</span><span class="variable">#x6237</span>;<span class="subst">&amp;</span><span class="variable">#x7AEF</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x6570</span>;<span class="subst">&amp;</span><span class="variable">#x91CF</span>;<span class="subst">&amp;</span><span class="variable">#xFF0C</span>;<span class="subst">&amp;</span><span class="variable">#x5373</span>;<span class="subst">&amp;</span><span class="variable">#x6B63</span>;<span class="subst">&amp;</span><span class="variable">#x5728</span>;<span class="subst">&amp;</span><span class="variable">#x8FDB</span>;<span class="subst">&amp;</span><span class="variable">#x884C</span>;<span class="subst">&amp;</span><span class="variable">#x8BFB</span>;<span class="subst">&amp;</span><span class="variable">#x5199</span>;<span class="subst">&amp;</span><span class="variable">#x64CD</span>;<span class="subst">&amp;</span><span class="variable">#x4F5C</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x5BA2</span>;<span class="subst">&amp;</span><span class="variable">#x6237</span>;<span class="subst">&amp;</span><span class="variable">#x7AEF</span>;<span class="subst">&amp;</span><span class="variable">#x3002</span>;
netId<span class="subst">&amp;</span><span class="variable">#xFF1A</span>;<span class="subst">&amp;</span><span class="variable">#x8868</span>;<span class="subst">&amp;</span><span class="variable">#x793A</span>;<span class="subst">&amp;</span><span class="variable">#x901A</span>;<span class="subst">&amp;</span><span class="variable">#x8FC7</span>;<span class="subst">&amp;</span><span class="variable">#x7F51</span>;<span class="subst">&amp;</span><span class="variable">#x7EDC</span>;<span class="subst">&amp;</span><span class="variable">#x4F20</span>;<span class="subst">&amp;</span><span class="variable">#x8F93</span>;<span class="subst">&amp;</span><span class="variable">#x8FDB</span>;<span class="subst">&amp;</span><span class="variable">#x6765</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x5B57</span>;<span class="subst">&amp;</span><span class="variable">#x8282</span>;<span class="subst">&amp;</span><span class="variable">#x6570</span>;<span class="subst">&amp;</span><span class="variable">#x3002</span>;
netou<span class="subst">&amp;</span><span class="variable">#xFF1A</span>;t<span class="subst">&amp;</span><span class="variable">#x8868</span>;<span class="subst">&amp;</span><span class="variable">#x793A</span>;<span class="subst">&amp;</span><span class="variable">#x901A</span>;<span class="subst">&amp;</span><span class="variable">#x8FC7</span>;<span class="subst">&amp;</span><span class="variable">#x7F51</span>;<span class="subst">&amp;</span><span class="variable">#x7EDC</span>;<span class="subst">&amp;</span><span class="variable">#x4F20</span>;<span class="subst">&amp;</span><span class="variable">#x8F93</span>;<span class="subst">&amp;</span><span class="variable">#x51FA</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x5B57</span>;<span class="subst">&amp;</span><span class="variable">#x8282</span>;<span class="subst">&amp;</span><span class="variable">#x6570</span>;<span class="subst">&amp;</span><span class="variable">#x3002</span>;
Conn<span class="subst">&amp;</span><span class="variable">#xFF1A</span>;<span class="subst">&amp;</span><span class="variable">#x8868</span>;<span class="subst">&amp;</span><span class="variable">#x793A</span>;<span class="subst">&amp;</span><span class="variable">#x670D</span>;<span class="subst">&amp;</span><span class="variable">#x52A1</span>;<span class="subst">&amp;</span><span class="variable">#x5668</span>;<span class="subst">&amp;</span><span class="variable">#x6253</span>;<span class="subst">&amp;</span><span class="variable">#x5F00</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x8FDE</span>;<span class="subst">&amp;</span><span class="variable">#x63A5</span>;<span class="subst">&amp;</span><span class="variable">#x6570</span>;<span class="subst">&amp;</span><span class="variable">#x3002</span>;
time<span class="subst">&amp;</span><span class="variable">#xFF1A</span>;<span class="subst">&amp;</span><span class="variable">#x8868</span>;<span class="subst">&amp;</span><span class="variable">#x793A</span>;<span class="subst">&amp;</span><span class="variable">#x7EDF</span>;<span class="subst">&amp;</span><span class="variable">#x8BA1</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x65F6</span>;<span class="subst">&amp;</span><span class="variable">#x95F4</span>;<span class="subst">&amp;</span><span class="variable">#x3002</span>;
</code></pre><p>&#x4E94;&#xFF1A;&#x65E5;&#x5FD7;&#x5206;&#x5272;&#xFF0C; db.adminCommand({&quot;logRotate&quot;:1})</p>
<pre><code>zjy:PRIMARY&amp;gt;<span class="keyword">*</span><span class="keyword">*</span>db.adminCommand({&amp;quot;logRotate&amp;quot;:1<span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span>})<span class="keyword">*</span><span class="keyword">*</span>
{ &amp;quot;ok&amp;quot; : 1 }
</code></pre><p>&#x7C7B;&#x4F3C;MySQL&#x7684;flush log&#x3002;</p>
<h4 id="&#x516D;&#xFF1A;">&#x516D;&#xFF1A;</h4>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/MongoDB/">MongoDB</a><a href="/tags/数据库/">数据库</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/08/4d8e814/" title="Node.js(express) + MongoDB(mongoose) 简单开发（一） -" itemprop="url">Node.js(express) + MongoDB(mongoose) 简单开发（一） -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-08T02:33:30.000Z" itemprop="datePublished"> 发表于 2015-07-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>IDE&#xFF1A;webstorm</p>
<ol>
<li>&#x5EFA;&#x7ACB;&#x9879;&#x76EE;</li>
</ol>
<p>Node&#x53CA;express&#x7684;&#x5B89;&#x88C5;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x518D;&#x8D58;&#x8FF0;&#xFF0C;&#x7F51;&#x4E0A;&#x6709;&#x5F88;&#x591A;&#x5B89;&#x88C5;&#x7684;&#x6559;&#x7A0B;&#xFF0C;&#x4E0D;&#x4F1A;&#x7684;&#x540C;&#x5B66;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x67E5;&#x627E;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x91C7;&#x7528;express4.x&#x7248;&#x672C;</p>
<p>&#x5B89;&#x88C5;express&#x5E93;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;express&#x547D;&#x4EE4;&#x6765;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x81EA;&#x5DF1;&#x7684;&#x9879;&#x76EE;&#xFF1A; express -e vlan</p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;express&#x5E2E;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x5B8C;&#x6574;&#x7684;&#x9879;&#x76EE;&#x7EA7;&#x76EE;&#x5F55;</p>
<p><img src="http://taojinke.github.io/img/20150708/4d84e45.png" alt="1_thumb5"></p>
<p>express&#x9ED8;&#x8BA4;&#x7684;&#x662F;jade&#x7684;&#x6A21;&#x7248;&#xFF0C; -e&#x4EE3;&#x8868;&#x4F7F;&#x7528;ejs&#xFF0C; &#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;ejs</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x8FDB;&#x5165;&#x9879;&#x76EE;&#x76EE;&#x5F55;&#x5E76;&#x5B89;&#x88C5;express&#x6240;&#x9700;&#x7684;&#x4F9D;&#x8D56;</p>
<p><img src="http://taojinke.github.io/img/20150708/4d850b6.png" alt="3_thumb2"></p>
<p>2.&#x76EE;&#x5F55;&#x7ED3;&#x6784;</p>
<p><img src="http://taojinke.github.io/img/20150708/4d85327.png" alt="2_thumb3"></p>
<p>www&#x6587;&#x4EF6;&#x5C31;&#x662F;&#x542F;&#x52A8;&#x6587;&#x4EF6;</p>
<p>node_modules &#x5B58;&#x653E;&#x6240;&#x6709;&#x9879;&#x76EE;&#x7684;&#x4F9D;&#x8D56;</p>
<p>public&#x4E3A;&#x9759;&#x6001;&#x8D44;&#x6E90;&#x5B58;&#x653E;&#x76EE;&#x5F55;&#xFF0C;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;</p>
<p>routes&#x4E3A;&#x8DEF;&#x7531;&#x6587;&#x4EF6;</p>
<p>views&#x5C31;&#x662F;&#x89C6;&#x56FE;&#x4E86;&#xFF08;&#x9875;&#x9762;&#x6587;&#x4EF6;&#xFF0C;ejs&#x6A21;&#x677F;&#xFF09;</p>
<ol>
<li>app.js&#x6838;&#x5FC3;&#x6587;&#x4EF6;</li>
</ol>
<p>&#x4E00;&#x822C;&#x53EF;&#x80FD;&#x4F1A;&#x6539;&#x52A8;&#x7684;&#x5730;&#x65B9;&#x6211;&#x90FD;&#x6CE8;&#x91CA;&#x4E86;&#x51FA;&#x6765;&#xFF0C; &#x5B8C;&#x6574;&#x7684;app.js&#x6587;&#x4EF6;&#x5982;&#x4E0B;</p>
<pre><code><span class="keyword">var</span> express = require(&amp;apos;express&amp;apos;);
<span class="keyword">var</span> path = require(&amp;apos;path&amp;apos;);
<span class="keyword">var</span> favicon = require(&amp;apos;serve-favicon&amp;apos;);
<span class="keyword">var</span> logger = require(&amp;apos;morgan&amp;apos;);
<span class="keyword">var</span> cookieParser = require(&amp;apos;cookie-parser&amp;apos;);
<span class="keyword">var</span> bodyParser = require(&amp;apos;body-parser&amp;apos;);

<span class="keyword">var</span> routes = require(&amp;apos;./routes/index&amp;apos;);
<span class="comment">//var users = require(&amp;apos;./routes/users&amp;apos;);</span>
<span class="keyword">var</span> ejs = require(&amp;quot;ejs&amp;quot;);
<span class="keyword">var</span> <span class="keyword">app</span> = express();

<span class="comment">// &amp;#x89C6;&amp;#x56FE;&amp;#x76EE;&amp;#x5F55;</span>
<span class="keyword">app</span>.<span class="keyword">set</span>(&amp;apos;views&amp;apos;, path.join(__dirname, &amp;apos;views&amp;apos;));
<span class="comment">// &amp;#x4F7F;&amp;#x7528;ejs&amp;#x6A21;&amp;#x677F; &amp;#xFF08;&amp;#x66FF;&amp;#x6362;&amp;#x4E3A;html&amp;#x6587;&amp;#x4EF6;&amp;#xFF09;</span>
<span class="keyword">app</span>.engine(&amp;apos;.html&amp;apos;, ejs.__express);
<span class="keyword">app</span>.<span class="keyword">set</span>(&amp;apos;<span class="keyword">view</span> engine&amp;apos;, &amp;apos;html&amp;apos;);
<span class="comment">//app.set(&amp;apos;view engine&amp;apos;, &amp;apos;ejs&amp;apos;);</span>

<span class="comment">// uncomment after placing your favicon in /public</span>
<span class="comment">//app.use(favicon(__dirname + &amp;apos;/public/favicon.ico&amp;apos;));</span>
<span class="keyword">app</span>.<span class="keyword">use</span>(logger(&amp;apos;dev&amp;apos;));
<span class="keyword">app</span>.<span class="keyword">use</span>(bodyParser.json());
<span class="keyword">app</span>.<span class="keyword">use</span>(bodyParser.urlencoded({ extended: false }));
<span class="keyword">app</span>.<span class="keyword">use</span>(cookieParser());
<span class="comment">// &amp;#x9759;&amp;#x6001;&amp;#x8D44;&amp;#x6E90;&amp;#x5B58;&amp;#x653E;&amp;#x76EE;&amp;#x5F55;</span>
<span class="keyword">app</span>.<span class="keyword">use</span>(express.static(path.join(__dirname, &amp;apos;public&amp;apos;)));

<span class="keyword">app</span>.<span class="keyword">use</span>(&amp;apos;/&amp;apos;, routes);
<span class="comment">//app.use(&amp;apos;/users&amp;apos;, users);</span>

<span class="comment">// catch 404 and forward to error handler</span>
<span class="keyword">app</span>.<span class="keyword">use</span>(function(req, res, next) {
  <span class="keyword">var</span> <span class="keyword">err</span> = new <span class="keyword">Error</span>(&amp;apos;Not Found&amp;apos;);
  <span class="keyword">err</span>.status = 404;
  next(<span class="keyword">err</span>);
});

<span class="comment">// error handlers</span>

<span class="comment">// development error handler</span>
<span class="comment">// will print stacktrace</span>
<span class="keyword">if</span> (<span class="keyword">app</span>.<span class="literal">get</span>(&amp;apos;env&amp;apos;) === &amp;apos;development&amp;apos;) {
  <span class="keyword">app</span>.<span class="keyword">use</span>(function(<span class="keyword">err</span>, req, res, next) {
    res.status(<span class="keyword">err</span>.status || 500);
    res.render(&amp;apos;<span class="keyword">error</span>&amp;apos;, {
      message: <span class="keyword">err</span>.message,
      <span class="keyword">error</span>: <span class="keyword">err</span>
    });
  });
}

<span class="comment">// production error handler</span>
<span class="comment">// no stacktraces leaked to user</span>
<span class="keyword">app</span>.<span class="keyword">use</span>(function(<span class="keyword">err</span>, req, res, next) {
  res.status(<span class="keyword">err</span>.status || 500);
  res.render(&amp;apos;<span class="keyword">error</span>&amp;apos;, {
    message: <span class="keyword">err</span>.message,
    <span class="keyword">error</span>: {}
  });
});


module.exports = <span class="keyword">app</span>;
</code></pre><p>&#x67E5;&#x770B;./bin/www&#x6587;&#x4EF6;&#x3002;</p>
<pre><code>#!<span class="regexp">/usr/</span>bin/env node

<span class="comment">/**
 * Module dependencies.
 */</span>

<span class="keyword">var</span> app = <span class="built_in">require</span>(&amp;apos;../app&amp;apos;);
<span class="keyword">var</span> debug = <span class="built_in">require</span>(&amp;apos;debug&amp;apos;)(&amp;apos;vlan:server&amp;apos;);
<span class="keyword">var</span> http = <span class="built_in">require</span>(&amp;apos;http&amp;apos;);

<span class="comment">/**
 * Get port from environment and store in Express.
 */</span>

<span class="comment">/*
* &amp;#x5B9A;&amp;#x4E49;&amp;#x542F;&amp;#x52A8;&amp;#x7AEF;&amp;#x53E3;
* */</span>
<span class="keyword">var</span> port = normalizePort(process.env.PORT || &amp;apos;<span class="number">8080</span>&amp;apos;);
app.set(&amp;apos;port&amp;apos;, port);

<span class="comment">/**
 * Create HTTP server.
 */</span>

<span class="keyword">var</span> server = http.createServer(app);

<span class="comment">/**
 * Listen on provided port, on all network interfaces.
 */</span>

server.listen(port);
server.on(&amp;apos;error&amp;apos;, onError);
server.on(&amp;apos;listening&amp;apos;, onListening);

<span class="comment">/**
 * Normalize a port into a number, string, or false.
 */</span>

<span class="function"><span class="keyword">function</span> <span class="title">normalizePort</span>(<span class="params">val</span>) </span>{
  <span class="keyword">var</span> port = <span class="built_in">parseInt</span>(val, <span class="number">10</span>);

  <span class="keyword">if</span> (<span class="built_in">isNaN</span>(port)) {
    <span class="comment">// named pipe</span>
    <span class="keyword">return</span> val;
  }

  <span class="keyword">if</span> (port &amp;gt;= <span class="number">0</span>) {
    <span class="comment">// port number</span>
    <span class="keyword">return</span> port;
  }

  <span class="keyword">return</span> <span class="literal">false</span>;
}

<span class="comment">/**
 * Event listener for HTTP server &amp;quot;error&amp;quot; event.
 */</span>

<span class="function"><span class="keyword">function</span> <span class="title">onError</span>(<span class="params">error</span>) </span>{
  <span class="keyword">if</span> (error.syscall !== &amp;apos;listen&amp;apos;) {
    <span class="keyword">throw</span> error;
  }

  <span class="keyword">var</span> bind = <span class="keyword">typeof</span> port === &amp;apos;string&amp;apos;
    ? &amp;apos;Pipe &amp;apos; + port
    : &amp;apos;Port &amp;apos; + port;

  <span class="comment">// handle specific listen errors with friendly messages</span>
  <span class="keyword">switch</span> (error.code) {
    <span class="keyword">case</span> &amp;apos;EACCES&amp;apos;:
      <span class="built_in">console</span>.error(bind + &amp;apos; requires elevated privileges&amp;apos;);
      process.exit(<span class="number">1</span>);
      <span class="keyword">break</span>;
    <span class="keyword">case</span> &amp;apos;EADDRINUSE&amp;apos;:
      <span class="built_in">console</span>.error(bind + &amp;apos; is already <span class="keyword">in</span> use&amp;apos;);
      process.exit(<span class="number">1</span>);
      <span class="keyword">break</span>;
    <span class="keyword">default</span>:
      <span class="keyword">throw</span> error;
  }
}

<span class="comment">/**
 * Event listener for HTTP server &amp;quot;listening&amp;quot; event.
 */</span>

<span class="function"><span class="keyword">function</span> <span class="title">onListening</span>(<span class="params"></span>) </span>{
  <span class="keyword">var</span> addr = server.address();
  <span class="keyword">var</span> bind = <span class="keyword">typeof</span> addr === &amp;apos;string&amp;apos;
    ? &amp;apos;pipe &amp;apos; + addr
    : &amp;apos;port &amp;apos; + addr.port;
  debug(&amp;apos;Listening on &amp;apos; + bind);
}
</code></pre><p>4.&#x8DEF;&#x7531;&#x529F;&#x80FD;</p>
<p>&#x9996;&#x5148;&#x5728;&#x9879;&#x76EE;&#x76EE;&#x5F55;&#x91CC;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;controller&#x5373;&#x63A7;&#x5236;&#x5C42;</p>
<p>&#x5728;controller&#x4E0B;&#x65B0;&#x5EFA;index.js &#x8FD9;&#x91CC;&#x9762;&#x6211;&#x4EEC;&#x7B80;&#x5355;&#x7684;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;title&#x6765;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;</p>
<pre><code>exports<span class="built_in">.</span>index <span class="subst">=</span> function (){
    <span class="keyword">return</span> {title: <span class="subst">&amp;</span>quot;<span class="subst">&amp;</span><span class="variable">#x6B22</span>;<span class="subst">&amp;</span><span class="variable">#x8FCE</span>;<span class="subst">&amp;</span><span class="variable">#x6765</span>;<span class="subst">&amp;</span><span class="variable">#x5230</span>;<span class="subst">&amp;</span><span class="variable">#x6211</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="variable">#x9996</span>;<span class="subst">&amp;</span><span class="variable">#x9875</span>;<span class="subst">&amp;</span><span class="variable">#xFF01</span>;<span class="subst">&amp;</span>quot;};
};
</code></pre><p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x5728;&#x8DEF;&#x7531;&#x5C42;&#x91CC;&#x9762;&#x8BBE;&#x7F6E;index.js</p>
<pre><code>var express = require<span class="params">(&amp;apos;express&amp;apos;)</span>;
var router = express.Router<span class="params">()</span>;

<span class="comment">// &amp;#x5F15;&amp;#x5165;c&amp;#x5C42;&amp;#x7684;&amp;#x5404;&amp;#x4E2A;&amp;#x63A7;&amp;#x5236;&amp;#x5668;</span>
var indexController = require<span class="params">(&amp;quot;../controller/index&amp;quot;)</span>;

<span class="comment">/* GET index page. */</span>
router.get<span class="params">(&amp;apos;/index&amp;apos;, function<span class="params">(req, res, next)</span> {
  res.render<span class="params">(&amp;apos;index&amp;apos;, indexController.index<span class="params">()</span>)</span>;
})</span>;

<span class="function"><span class="keyword">module</span>.<span class="title">exports</span> =</span> router;
</code></pre><p>&#x7136;&#x540E;&#x5BF9;V&#x5C42;&#x7684;index.html&#x6A21;&#x677F;&#x8FDB;&#x884C;&#x4FEE;&#x6539;</p>
<pre><code><span class="subst">&amp;</span><span class="literal">lt</span>;<span class="subst">!</span>DOCTYPE html<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;html<span class="subst">&amp;</span><span class="literal">gt</span>;
  <span class="subst">&amp;</span><span class="literal">lt</span>;head<span class="subst">&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="literal">lt</span>;title<span class="subst">&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;<span class="subst">%=</span> title <span class="subst">%&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;/title<span class="subst">&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="literal">lt</span>;<span class="keyword">link</span> rel<span class="subst">=&amp;</span>apos;stylesheet<span class="subst">&amp;</span>apos; href<span class="subst">=&amp;</span>apos;/css/style<span class="built_in">.</span>css<span class="subst">&amp;</span>apos; <span class="subst">/</span><span class="subst">&amp;</span><span class="literal">gt</span>;
  <span class="subst">&amp;</span><span class="literal">lt</span>;/head<span class="subst">&amp;</span><span class="literal">gt</span>;
  <span class="subst">&amp;</span><span class="literal">lt</span>;body<span class="subst">&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="literal">lt</span>;h1<span class="subst">&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;<span class="subst">%=</span> title <span class="subst">%&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;/h1<span class="subst">&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="literal">lt</span>;p<span class="subst">&amp;</span><span class="literal">gt</span>;Welcome <span class="keyword">to</span> <span class="subst">&amp;</span><span class="literal">lt</span>;<span class="subst">%=</span> title <span class="subst">%&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;/p<span class="subst">&amp;</span><span class="literal">gt</span>;
  <span class="subst">&amp;</span><span class="literal">lt</span>;/body<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;/html<span class="subst">&amp;</span><span class="literal">gt</span>;
</code></pre><p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x91C7;&#x7528;&#x7684;&#x662F;ejs&#x6A21;&#x677F;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x4E25;&#x683C;&#x6309;&#x7167;ejs&#x7684;&#x6A21;&#x677F;&#x89C4;&#x5219;&#xFF0C;&#x5F53;&#x7136;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x5176;&#x4ED6;&#x6A21;&#x7248;&#x5F15;&#x64CE;&#xFF0C;&#x6BD4;&#x5982;jade&#x7B49;&#x7B49;</p>
<p>&#x53E6;&#x5916;&#x6211;&#x5BF9;&#x9759;&#x6001;&#x8D44;&#x6E90;&#x76EE;&#x5F55;&#x8FDB;&#x884C;&#x4E86;&#x4E00;&#x4E9B;&#x5C0F;&#x4FEE;&#x6539;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x4E2A;&#x4EBA;&#x4E60;&#x60EF;&#xFF0C;</p>
<p>&#x539F;&#x672C;&#x7684;&#x9759;&#x6001;&#x8D44;&#x6E90;&#x76EE;&#x5F55;&#xFF1A;</p>
<p><img src="http://taojinke.github.io/img/20150708/4d85809.png" alt="4_thumb1"></p>
<p>&#x6539;&#x8FC7;&#x540E;&#x7684;&#x9759;&#x6001;&#x8D44;&#x6E90;&#x76EE;&#x5F55;&#xFF1A;</p>
<p><img src="http://taojinke.github.io/img/20150708/4d85809.png" alt="image_thumb1"></p>
<p>&#x6240;&#x4EE5;&#x9875;&#x9762;&#x5F15;&#x7528;&#x7684;&#x65F6;&#x5019;&#x8981;&#x7A0D;&#x5FAE;&#x6CE8;&#x610F;&#x4E0B;&#xFF0C;&#x5F53;&#x8D44;&#x6E90;&#x52A0;&#x8F7D;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x9ED8;&#x8BA4;&#x4ECE;public&#x4E0B;&#x67E5;&#x627E;&#xFF0C;&#x6240;&#x4EE5;&#x5F15;&#x7528;&#x7684;&#x8DEF;&#x5F84;&#xFF1A;&lt;link rel=&apos;stylesheet&apos; href=&apos;/css/style.css&apos; /&gt;</p>
<p>&#x4E00;&#x5207;&#x5927;&#x529F;&#x544A;&#x6210;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x542F;&#x52A8;&#x670D;&#x52A1;&#xFF0C;&#x6765;&#x8BBF;&#x95EE;&#x6211;&#x4EEC;&#x7684;&#x6D4B;&#x8BD5;&#x9875;&#x9762;&#xFF0C;&#x7EC8;&#x7AEF;&#x53EF;&#x4EE5;&#x7528;npm start&#x8FDB;&#x884C;&#x8BBF;&#x95EE;&#xFF0C;&#x6211;&#x7528;&#x7684;webstorm&#x76F4;&#x63A5;debug&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6548;&#x679C;</p>
<p><img src="http://taojinke.github.io/img/20150708/4d85a7a.png" alt="image_thumb3"></p>
<p><img src="http://taojinke.github.io/img/20150708/4d85a7a.png" alt="image_thumb5"></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6210;&#x529F;&#x8BBF;&#x95EE;&#x9875;&#x9762;&#xFF0C;&#x5E76;&#x4E14;css&#x4E5F;&#x6210;&#x529F;&#x52A0;&#x8F7D;&#x3002;</p>
<p>&#x5230;&#x8FD9;&#x4E3A;&#x6B62;&#xFF0C;&#x5176;&#x5B9E;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;express&#x7684;&#x642D;&#x5EFA;&#x5C31;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#xFF0C;&#x611F;&#x89C9;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5BF9;&#x4E0D;&#x5BF9;&#xFF1F; &#x53EA;&#x8981;&#x6574;&#x7AD9;&#x7684;&#x67B6;&#x6784;&#x601D;&#x7EF4;&#x7406;&#x987A;&#xFF0C;&#x4E00;&#x5207;&#x90FD;&#x80FD;&#x8FCE;&#x5203;&#x800C;&#x89E3;&#xFF01;</p>
<p>5.&#x5B8C;&#x6574;&#x7684;&#x9879;&#x76EE;</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x505A;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x767B;&#x5F55;&#x6CE8;&#x518C;&#xFF0C;&#x4F7F;&#x7528;MongoDB&#x505A;&#x4E3A;&#x6211;&#x4EEC;&#x7684;&#x6570;&#x636E;&#x5E93;&#x3002;</p>
<p>&#x505A;&#x4E4B;&#x524D;&#x6211;&#x4EEC;&#x5148;&#x6765;&#x89C4;&#x5212;&#x4E00;&#x4E0B;&#x601D;&#x8DEF;&#xFF1A;</p>
<p>&#x2460;&#x65B0;&#x5EFA;&#x4E24;&#x4E2A;&#x9875;&#x9762;&#xFF0C;&#x4E00;&#x4E2A;&#x767B;&#x5F55;&#x9875;&#xFF08;login.html&#xFF09;, &#x767B;&#x5F55;&#x6210;&#x529F;&#x540E;&#x7684;&#x8DF3;&#x8F6C;&#x9875;&#xFF08;home.html&#xFF09;</p>
<p>&#x2461;&#x7167;&#x846B;&#x82A6;&#x753B;&#x74E2;&#xFF0C;&#x6309;&#x7167;&#x521A;&#x521A;&#x7684;&#x987A;&#x5E8F;&#xFF0C;&#x5148;&#x8DD1;&#x901A;&#x8FD9;&#x4E24;&#x4E2A;&#x9875;&#x9762;</p>
<p>&#x2462;&#x5199;&#x767B;&#x5F55;&#x548C;&#x6CE8;&#x518C;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x5C31;&#x9700;&#x8981;&#x7528;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4E86;&#xFF0C;&#x6CE8;&#x518C;&#x4E4B;&#x524D;&#x5148;&#x8FDB;&#x884C;&#x67E5;&#x8BE2;&#xFF0C;&#x6570;&#x636E;&#x5E93;&#x91CC;&#x662F;&#x5426;&#x6709;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x540D;&#xFF0C;&#x7136;&#x540E;&#x662F;&#x767B;&#x5F55;&#xFF0C;&#x8D26;&#x6237;&#x4E0E;&#x5BC6;&#x7801;&#x662F;&#x5426;&#x5339;&#x914D;</p>
<p>&#x2463;&#x524D;&#x7AEF;&#x7684;&#x6CE8;&#x518C;&#x548C;&#x767B;&#x5F55;&#x7684;&#x529F;&#x80FD;&#x5B9E;&#x73B0;</p>
<p>&#x5927;&#x4F53;&#x4E0A;&#x5C31;&#x8FD9;&#x4E2A;&#x601D;&#x8DEF;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x6765;&#x4E00;&#x6B65;&#x6B65;&#x8FDB;&#x884C;&#x3002;</p>
<p>1.&#x521B;&#x5EFA;&#x767B;&#x5F55;&#x9875;&#x4EE5;&#x53CA;&#x767B;&#x5F55;&#x6210;&#x529F;&#x9875;</p>
<p>&#x5728;&#x8DEF;&#x7531;&#x5C42;&#x7684;index.js&#x91CC;&#x9762;&#x65B0;&#x589E;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre><code><span class="keyword">var</span> loginController = require(&amp;quot;../controller/login&amp;quot;);

<span class="comment">/* GET login page. */</span>
router.<span class="keyword">get</span>(&amp;apos;/login&amp;apos;, <span class="function"><span class="keyword">function</span><span class="params">(req, res, next)</span> </span>{
  res.render(&amp;apos;login&amp;apos;, loginController.login());
});
</code></pre><p>C&#x5C42;&#x7684;login.js&#xFF1A;</p>
<pre><code>exports<span class="built_in">.</span>login <span class="subst">=</span> function (){
    <span class="keyword">return</span> {title: <span class="subst">&amp;</span>quot;<span class="subst">&amp;</span><span class="variable">#x8FD9</span>;<span class="subst">&amp;</span><span class="variable">#x91CC</span>;<span class="subst">&amp;</span><span class="variable">#x662F</span>;<span class="subst">&amp;</span><span class="variable">#x767B</span>;<span class="subst">&amp;</span><span class="variable">#x5F55</span>;<span class="subst">&amp;</span><span class="variable">#x9875</span>;<span class="subst">&amp;</span>quot;};
};
</code></pre><p>V&#x5C42;&#x7684;login.html&#xFF1A;</p>
<pre><code><span class="subst">&amp;</span><span class="literal">lt</span>;<span class="subst">!</span>DOCTYPE html<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;html<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;head<span class="subst">&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="literal">lt</span>;meta charset<span class="subst">=&amp;</span>quot;utf<span class="subst">-</span><span class="number">8</span><span class="subst">&amp;</span>quot;<span class="subst">&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="literal">lt</span>;title<span class="subst">&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;<span class="subst">%=</span>title<span class="subst">%&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;/title<span class="subst">&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="literal">lt</span>;script<span class="subst">&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;/script<span class="subst">&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="literal">lt</span>;<span class="keyword">link</span> rel<span class="subst">=&amp;</span>quot;stylesheet<span class="subst">&amp;</span>quot; href<span class="subst">=&amp;</span>quot;/css/login<span class="built_in">.</span>css<span class="subst">&amp;</span>quot;<span class="subst">/</span><span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;/head<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;body<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;h1<span class="subst">&amp;</span><span class="literal">gt</span>;~<span class="subst">&amp;</span><span class="literal">lt</span>;<span class="subst">%=</span>title<span class="subst">%&amp;</span><span class="literal">gt</span>;~<span class="subst">&amp;</span><span class="literal">lt</span>;/h1<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;form id<span class="subst">=&amp;</span>quot;myForm<span class="subst">&amp;</span>quot;<span class="subst">&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="variable">#x5E10</span>;<span class="subst">&amp;</span><span class="variable">#x53F7</span>;<span class="subst">&amp;</span><span class="variable">#xFF1A</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;input <span class="keyword">type</span><span class="subst">=&amp;</span>quot;text<span class="subst">&amp;</span>quot; name<span class="subst">=&amp;</span>quot;username<span class="subst">&amp;</span>quot;<span class="subst">/</span><span class="subst">&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;br<span class="subst">/</span><span class="subst">&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;br<span class="subst">/</span><span class="subst">&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="variable">#x5BC6</span>;<span class="subst">&amp;</span><span class="variable">#x7801</span>;<span class="subst">&amp;</span><span class="variable">#xFF1A</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;input <span class="keyword">type</span><span class="subst">=&amp;</span>quot;password<span class="subst">&amp;</span>quot; name<span class="subst">=&amp;</span>quot;password<span class="subst">&amp;</span>quot;<span class="subst">/</span><span class="subst">&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;br<span class="subst">/</span><span class="subst">&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;br<span class="subst">/</span><span class="subst">&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="literal">lt</span>;input <span class="keyword">type</span><span class="subst">=&amp;</span>quot;button<span class="subst">&amp;</span>quot; value<span class="subst">=&amp;</span>quot;<span class="subst">&amp;</span><span class="variable">#x6CE8</span>;<span class="subst">&amp;</span><span class="variable">#x518C</span>;<span class="subst">&amp;</span>quot; node<span class="attribute">-type</span><span class="subst">=&amp;</span>quot;register<span class="subst">&amp;</span>quot; <span class="subst">/</span><span class="subst">&amp;</span><span class="literal">gt</span>;   <span class="subst">&amp;</span><span class="literal">lt</span>;input <span class="keyword">type</span><span class="subst">=&amp;</span>quot;button<span class="subst">&amp;</span>quot; value<span class="subst">=&amp;</span>quot;<span class="subst">&amp;</span><span class="variable">#x767B</span>;<span class="subst">&amp;</span><span class="variable">#x5F55</span>;<span class="subst">&amp;</span>quot; node<span class="attribute">-type</span><span class="subst">=&amp;</span>quot;submit<span class="subst">&amp;</span>quot;<span class="subst">/</span><span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;/form<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;script src<span class="subst">=&amp;</span>quot;/js/jquery<span class="built_in">.</span>js<span class="subst">&amp;</span>quot;<span class="subst">&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;/script<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;script src<span class="subst">=&amp;</span>quot;/js/login<span class="built_in">.</span>js<span class="subst">&amp;</span>quot;<span class="subst">&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;/script<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;/body<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;/html<span class="subst">&amp;</span><span class="literal">gt</span>;
</code></pre><p>&#x6837;&#x5F0F;&#x7B80;&#x5355;&#x7684;&#x5199;&#x5199;&#x5C31;&#x53EF;&#x4EE5;&#x5566;~</p>
<p>&#x91CD;&#x542F;&#x670D;&#x52A1;&#xFF0C;&#x8BBF;&#x95EE;login&#xFF1A;</p>
<p><img src="http://taojinke.github.io/img/20150708/4d85ceb.png" alt="image_thumb8"></p>
<p><img src="http://taojinke.github.io/img/20150708/4d85f5c.png" alt="image_thumb11"></p>
<p>&#x5168;&#x90E8;OK&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x662F;home&#x9875;&#x9762;&#xFF0C;&#x7531;&#x4E8E;home&#x9875;&#x662F;&#x767B;&#x9646;&#x6210;&#x529F;&#x9875;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x505A;&#x4E2A;&#x5047;&#x7684;&#x5E10;&#x53F7;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;:</p>
<p>&#x8DEF;&#x7531;&#x5C42;&#x7684;index.js&#x6DFB;&#x52A0;&#x8BBF;&#x95EE;home&#x7684;&#x65B9;&#x6CD5;&#xFF1A;</p>
<pre><code><span class="comment">/* GET home page. */</span>
router<span class="built_in">.</span>get(<span class="subst">&amp;</span>apos;/home<span class="subst">&amp;</span>apos;, function(req, res, next) {
  res<span class="built_in">.</span>render(<span class="subst">&amp;</span>apos;home<span class="subst">&amp;</span>apos;, {
    title: <span class="subst">&amp;</span>quot;<span class="subst">&amp;</span><span class="variable">#x767B</span>;<span class="subst">&amp;</span><span class="variable">#x5F55</span>;<span class="subst">&amp;</span><span class="variable">#x6210</span>;<span class="subst">&amp;</span><span class="variable">#x529F</span>;<span class="subst">&amp;</span><span class="variable">#x9875</span>;<span class="subst">&amp;</span>quot;,
    username: <span class="subst">&amp;</span>quot;<span class="subst">&amp;</span><span class="variable">#x6D4B</span>;<span class="subst">&amp;</span><span class="variable">#x8BD5</span>;<span class="subst">&amp;</span><span class="variable">#x5E10</span>;<span class="subst">&amp;</span><span class="variable">#x53F7</span>;<span class="subst">&amp;</span>quot;
  });
});
</code></pre><p>V&#x5C42;&#x7684;home.html&#xFF1A;</p>
<pre><code><span class="subst">&amp;</span><span class="literal">lt</span>;<span class="subst">!</span>DOCTYPE html<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;html<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;head<span class="subst">&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="literal">lt</span>;meta charset<span class="subst">=&amp;</span>quot;utf<span class="subst">-</span><span class="number">8</span><span class="subst">&amp;</span>quot;<span class="subst">&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="literal">lt</span>;title<span class="subst">&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="variable">#x606D</span>;<span class="subst">&amp;</span><span class="variable">#x559C</span>;~<span class="subst">&amp;</span><span class="literal">lt</span>;<span class="subst">%=</span> title <span class="subst">%&amp;</span><span class="literal">gt</span>;~<span class="subst">&amp;</span><span class="variable">#x606D</span>;<span class="subst">&amp;</span><span class="variable">#x559C</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;/title<span class="subst">&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="literal">lt</span>;<span class="keyword">link</span> rel<span class="subst">=&amp;</span>quot;stylesheet<span class="subst">&amp;</span>quot; href<span class="subst">=&amp;</span>quot;/css/home<span class="built_in">.</span>css<span class="subst">&amp;</span>quot;<span class="subst">/</span><span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;/head<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;body<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;h1<span class="subst">&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="variable">#x5C0A</span>;<span class="subst">&amp;</span><span class="variable">#x656C</span>;<span class="subst">&amp;</span><span class="variable">#x7684</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;<span class="subst">%=</span> username <span class="subst">%&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="variable">#xFF0C</span>;<span class="subst">&amp;</span><span class="variable">#x6B22</span>;<span class="subst">&amp;</span><span class="variable">#x8FCE</span>;<span class="subst">&amp;</span><span class="variable">#x60A8</span>;<span class="subst">&amp;</span><span class="variable">#xFF01</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;/h1<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;a class<span class="subst">=&amp;</span>quot;logout<span class="subst">&amp;</span>quot; href<span class="subst">=&amp;</span>quot;/logout<span class="subst">&amp;</span>quot;<span class="subst">&amp;</span><span class="literal">gt</span>;<span class="subst">&amp;</span><span class="variable">#x9000</span>;<span class="subst">&amp;</span><span class="variable">#x51FA</span>;<span class="subst">&amp;</span><span class="variable">#x767B</span>;<span class="subst">&amp;</span><span class="variable">#x5F55</span>;<span class="subst">&amp;</span><span class="literal">lt</span>;/a<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;/body<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;/html<span class="subst">&amp;</span><span class="literal">gt</span>;
</code></pre><p>&#x540C;&#x6837;&#x6837;&#x5F0F;&#x7B80;&#x5355;&#x5199;&#x5199;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;</p>
<p>&#x91CD;&#x542F;&#x670D;&#x52A1;&#xFF0C;&#x8BBF;&#x95EE;home&#x9875;&#xFF1A;</p>
<p><img src="http://taojinke.github.io/img/20150708/4d866af.png" alt="image_thumb13"></p>
<p><img src="http://taojinke.github.io/img/20150708/4d86920.png" alt="image_thumb16"></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8BBF;&#x95EE;&#x6210;&#x529F;&#xFF0C;&#x8FD9;&#x91CC;&#x5176;&#x5B9E;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x6709;&#x4E00;&#x4E2A;&#x9000;&#x51FA;&#x767B;&#x5F55;&#x7684;&#x9875;&#x9762;&#xFF0C;&#x6211;&#x5C31;&#x4E0D;&#x518D;&#x5355;&#x5199;&#x4E00;&#x4E2A;&#x9875;&#x9762;&#x4E86;&#xFF0C;&#x9000;&#x51FA;&#x767B;&#x9646;&#x540E;&#x76F4;&#x63A5;&#x8DF3;&#x8F6C;&#x5230;&#x767B;&#x5F55;&#x9875;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;~~~</p>
<p>&#x8DEF;&#x7531;&#x5C42;&#x66FE;&#x52A0;&#x4E00;&#x4E2A;&#x8BBF;&#x95EE;logout&#x7684;&#x65B9;&#x6CD5;&#x5C31;&#x53EF;&#x4EE5;&#xFF1A;</p>
<pre><code><span class="comment">/*GET logout page.*/</span>
router.<span class="keyword">get</span>(&amp;apos;/logout&amp;apos;, <span class="function"><span class="keyword">function</span> <span class="params">(req, res)</span></span>{
  res.redirect(&amp;quot;/login&amp;quot;);
});
</code></pre><p>&#x91CD;&#x542F;&#x670D;&#x52A1;&#x540E;&#x6211;&#x4EEC;&#x70B9;&#x9000;&#x51FA;&#x767B;&#x5F55;&#x6309;&#x94AE;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x76F4;&#x63A5;&#x8DF3;&#x8F6C;&#x5230;&#x4E86;&#x767B;&#x5F55;&#x9875;~</p>
<p><img src="http://taojinke.github.io/img/20150708/4d86920.png" alt="image_thumb19"></p>
<p>&#x597D;&#x4E86;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x8BE5;&#x5B9E;&#x73B0;&#x524D;&#x7AEF;&#x767B;&#x5F55;&#x6CE8;&#x518C;&#x7684;&#x529F;&#x80FD;&#x4E86;&#xFF0C;&#x8FD9;&#x91CC;&#x5148;&#x6765;&#x5199;&#x767B;&#x5F55;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x6765;&#x89C4;&#x5B9A;&#x4E0B;&#x63A5;&#x53E3;&#x7684;&#x683C;&#x5F0F;&#xFF1A;{&#x201C;code&#x201D;: 200, &#x201C;msg&#x201D;: &#x201C;&#x767B;&#x5F55;&#x6210;&#x529F;&#x201D;}</p>
<p>code&#x7B49;&#x4E8E;200&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E3A;&#x767B;&#x5F55;&#x6210;&#x529F;&#xFF0C;201&#x4E3A;&#x767B;&#x5F55;&#x5931;&#x8D25;&#x3002;&#x6211;&#x4EEC;&#x5148;&#x7528;get&#x65B9;&#x5F0F;&#x6765;&#x6D4B;&#x8BD5;&#x9875;&#x9762;&#xFF0C;&#x8DD1;&#x901A;&#x9875;&#x9762;&#x4EE5;&#x540E;&#x518D;&#x7528;post&#x65B9;&#x5F0F;&#x63D0;&#x4EA4;</p>
<p>&#x5728;C&#x5C42;&#x65B0;&#x5EFA;getLogin.js&#xFF1A;</p>
<pre><code><span class="built_in">var</span> userList <span class="subst">=</span> {};
exports<span class="built_in">.</span>getLogin <span class="subst">=</span> function (req, res){
    res<span class="built_in">.</span>send({
        code:<span class="number">200</span>,
        msg: <span class="subst">&amp;</span>quot;<span class="subst">&amp;</span><span class="variable">#x767B</span>;<span class="subst">&amp;</span><span class="variable">#x5F55</span>;<span class="subst">&amp;</span><span class="variable">#x6210</span>;<span class="subst">&amp;</span><span class="variable">#x529F</span>;<span class="subst">&amp;</span><span class="variable">#xFF08</span>;<span class="subst">&amp;</span><span class="variable">#x672C</span>;<span class="subst">&amp;</span><span class="variable">#x6761</span>;<span class="subst">&amp;</span><span class="variable">#x6D88</span>;<span class="subst">&amp;</span><span class="variable">#x606F</span>;<span class="subst">&amp;</span><span class="variable">#x6765</span>;<span class="subst">&amp;</span><span class="variable">#x81EA</span>;<span class="subst">&amp;</span><span class="variable">#x540E</span>;<span class="subst">&amp;</span><span class="variable">#x53F0</span>;<span class="subst">&amp;</span><span class="variable">#xFF09</span>;<span class="subst">&amp;</span>quot;
    });
    userList <span class="subst">=</span> {
        username: req<span class="built_in">.</span>param(<span class="subst">&amp;</span>quot;username<span class="subst">&amp;</span>quot;)
    }
};
exports<span class="built_in">.</span>userList <span class="subst">=</span> function (){
    <span class="keyword">return</span> userList;
};
</code></pre><p>userList&#x7528;&#x6765;&#x5B58;&#x50A8;&#x767B;&#x5F55;&#x65F6;&#x6240;&#x586B;&#x5199;&#x7684;&#x7528;&#x6237;&#x4FE1;&#x606F;&#xFF08;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x6210;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x91CC;&#x8BFB;&#x53D6;&#x5185;&#x5BB9;&#xFF09;</p>
<p>&#x5728;&#x8DEF;&#x7531;&#x5C42;&#x7684;index.js&#x505A;&#x5982;&#x4E0B;&#x6539;&#x52A8;&#xFF1A;</p>
<pre><code><span class="built_in">var</span> getLoginController <span class="subst">=</span> <span class="keyword">require</span>(<span class="subst">&amp;</span>quot;<span class="built_in">..</span>/controller/getLogin<span class="subst">&amp;</span>quot;);
<span class="comment">/* GET home page. */</span>
router<span class="built_in">.</span>get(<span class="subst">&amp;</span>apos;/home<span class="subst">&amp;</span>apos;, function (req, res){
  res<span class="built_in">.</span>render(<span class="subst">&amp;</span>apos;home<span class="subst">&amp;</span>apos;, {
      title: <span class="subst">&amp;</span>quot;<span class="subst">&amp;</span><span class="variable">#x767B</span>;<span class="subst">&amp;</span><span class="variable">#x5F55</span>;<span class="subst">&amp;</span><span class="variable">#x6210</span>;<span class="subst">&amp;</span><span class="variable">#x529F</span>;<span class="subst">&amp;</span><span class="variable">#x9875</span>;<span class="subst">&amp;</span>quot;,
      username: getLoginController<span class="built_in">.</span>userList()<span class="built_in">.</span>username
  });
});
router<span class="built_in">.</span>get(<span class="subst">&amp;</span>apos;/userData<span class="subst">&amp;</span>apos;, getLoginController<span class="built_in">.</span>getLogin);
</code></pre><p>userData&#x5373;&#x524D;&#x7AEF;&#x7684;&#x63A5;&#x53E3;&#x5730;&#x5740;</p>
<p>&#x73B0;&#x5728;&#x5C31;&#x53EF;&#x4EE5;&#x6765;&#x5199;&#x5199;&#x524D;&#x7AEF;&#x767B;&#x5F55;&#x7684;&#x529F;&#x80FD;&#x4E86;&#xFF1A;</p>
<pre><code>;(<span class="function"><span class="keyword">function</span> <span class="params">($)</span></span>{
    <span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span> <span class="params">(options)</span></span>{
        <span class="keyword">var</span> <span class="keyword">self</span> = this;
            <span class="keyword">self</span>.options = $.extend({
                <span class="keyword">parent</span>: $(&amp;quot;<span class="comment">#myForm&amp;quot;),</span>
                register: $(&amp;quot;[node-type=register]&amp;quot;),
                submit: $(&amp;quot;[node-type=submit]&amp;quot;)
            }, options);
        <span class="keyword">self</span>.bindEvent();
    };
    foo.prototype = {
        bindEvent: <span class="function"><span class="keyword">function</span> <span class="params">()</span></span>{
            <span class="keyword">var</span> <span class="keyword">self</span> = this;
            <span class="keyword">self</span>.login();
        },
        login: <span class="function"><span class="keyword">function</span> <span class="params">()</span></span>{
            <span class="keyword">var</span> <span class="keyword">self</span> = this,
                <span class="keyword">parent</span> = <span class="keyword">self</span>.options.<span class="keyword">parent</span>,
                submit = <span class="keyword">self</span>.options.submit;
            submit.on(&amp;quot;click&amp;quot;, <span class="function"><span class="keyword">function</span> <span class="params">()</span></span>{
                <span class="keyword">var</span> jqXML = $.ajax({
                    url: &amp;quot;/userData&amp;quot;,
                    dataType: &amp;quot;json&amp;quot;,
                    type: &amp;quot;get&amp;quot;,
                    data: <span class="keyword">parent</span>.serialize()
                });
                jqXML.done(<span class="function"><span class="keyword">function</span> <span class="params">(data)</span></span>{
                    <span class="keyword">if</span>(data.code == <span class="number">200</span>){
                        location.href = &amp;quot;/home&amp;quot;;
                    }
                });
            });
        }
    };
    <span class="keyword">new</span> foo();
})(jQuery);
</code></pre><p>&#x7B80;&#x5355;&#x7684;get&#x63D0;&#x4EA4;&#x65B9;&#x5F0F;&#xFF0C;&#x8BB0;&#x5F97;&#x5728;login.html&#x9875;&#x9762;&#x4E0A;&#x5F15;&#x7528;~</p>
<p>&#x4E00;&#x5207;OK&#xFF0C;&#x91CD;&#x542F;&#x670D;&#x52A1;&#xFF0C;&#x8BBF;&#x95EE;login&#x9875;&#x9762;</p>
<p><img src="http://taojinke.github.io/img/20150708/4d86b91.png" alt="image_thumb23"></p>
<p>&#x8F93;&#x5165;&#x7528;&#x6237;&#x540D;&#x4EE5;&#x540E;&#x70B9;&#x51FB;&#x767B;&#x5F55;&#xFF1A;</p>
<p><img src="http://taojinke.github.io/img/20150708/4d86b91.png" alt="image_thumb29"></p>
<p><img src="http://taojinke.github.io/img/20150708/4d87073.png" alt="image_thumb32"></p>
<p>&#x606D;&#x559C;&#xFF01;&#x8BBF;&#x95EE;&#x6210;&#x529F;&#xFF01;</p>
<p>&#x4E0B;&#x4E00;&#x8282;&#x6211;&#x4EEC;&#x5C06;&#x8DDF;&#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;&#x8D77;&#x6765;&#xFF0C;&#x505A;&#x4E00;&#x4E2A;&#x771F;&#x6B63;&#x610F;&#x4E49;&#x4E0A;&#x7684;&#x767B;&#x5F55;&#x6CE8;&#x518C;&#x3002;</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Html/">Html</a><a href="/tags/JavaScript/">JavaScript</a><a href="/tags/MongoDB/">MongoDB</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/08/4d75c92/" title="基于MongoDB的全国电影票预定系统 -" itemprop="url">基于MongoDB的全国电影票预定系统 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-08T02:33:30.000Z" itemprop="datePublished"> 发表于 2015-07-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <pre><code>**&amp;<span class="id">#x524D</span>;&amp;<span class="id">#x8A00</span>;**&amp;<span class="id">#x53D7</span>;&amp;<span class="id">#x5230</span>;&amp;<span class="id">#x4E2D</span>;&amp;<span class="id">#x6587</span>;&amp;<span class="id">#x793E</span>;&amp;<span class="id">#x533A</span>;&amp;<span class="id">#x300A</span>;&amp;<span class="id">#x7535</span>;&amp;<span class="id">#x5546</span>;&amp;<span class="id">#x53C2</span>;&amp;<span class="id">#x8003</span>;&amp;<span class="id">#x67B6</span>;&amp;<span class="id">#x6784</span>;&amp;<span class="id">#x7B2C</span>;&amp;<span class="id">#x4E8C</span>;&amp;<span class="id">#x90E8</span>;&amp;<span class="id">#x5206</span>;&amp;<span class="id">#xFF1A</span>;&amp;<span class="id">#x5E93</span>;&amp;<span class="id">#x5B58</span>;&amp;<span class="id">#x4F18</span>;&amp;<span class="id">#x5316</span>;&amp;<span class="id">#x65B9</span>;&amp;<span class="id">#x6CD5</span>;&amp;<span class="id">#x300B</span>;&amp;<span class="id">#x542F</span>;&amp;<span class="id">#x53D1</span>;&amp;<span class="id">#xFF0C</span>;&amp;<span class="id">#x60F3</span>;&amp;<span class="id">#x5230</span>;&amp;<span class="id">#x4E86</span>;&amp;<span class="id">#x53BB</span>;&amp;<span class="id">#x5E74</span>;&amp;<span class="id">#x505A</span>;&amp;<span class="id">#x8FC7</span>;&amp;<span class="id">#x7C7B</span>;&amp;<span class="id">#x4F3C</span>;&amp;<span class="id">#x7684</span>;&amp;<span class="id">#x7535</span>;&amp;<span class="id">#x5F71</span>;&amp;<span class="id">#x7968</span>;&amp;<span class="id">#x9884</span>;&amp;<span class="id">#x5B9A</span>;&amp;<span class="id">#x7CFB</span>;&amp;<span class="id">#x7EDF</span>;&amp;<span class="id">#xFF0C</span>;&amp;<span class="id">#x5982</span>;&amp;<span class="id">#x679C</span>;&amp;<span class="id">#x7528</span>;<span class="tag">MongoDB</span>&amp;<span class="id">#x53BB</span>;&amp;<span class="id">#x505A</span>;&amp;<span class="id">#x5B58</span>;&amp;<span class="id">#x50A8</span>;&amp;<span class="id">#x652F</span>;&amp;<span class="id">#x6491</span>;&amp;<span class="id">#xFF0C</span>;&amp;<span class="id">#x90A3</span>;&amp;<span class="id">#x5E94</span>;&amp;<span class="id">#x8BE5</span>;&amp;<span class="id">#x662F</span>;&amp;<span class="id">#x600E</span>;&amp;<span class="id">#x6837</span>;&amp;<span class="id">#x67B6</span>;&amp;<span class="id">#x6784</span>;&amp;<span class="id">#x7684</span>;&amp;<span class="id">#x5462</span>;&amp;<span class="id">#xFF1F</span>;&amp;<span class="id">#x672C</span>;&amp;<span class="id">#x6587</span>;&amp;<span class="id">#x7684</span>;&amp;<span class="id">#x76EE</span>;&amp;<span class="id">#x7684</span>;&amp;<span class="id">#x662F</span>;&amp;<span class="id">#xFFFD</span>;&amp;<span class="id">#xFFFD</span>;&amp;<span class="id">#xFFFD</span>;&amp;<span class="id">#x4E86</span>;&amp;<span class="id">#x66F4</span>;&amp;<span class="id">#x597D</span>;&amp;<span class="id">#x7684</span>;&amp;<span class="id">#x5B66</span>;&amp;<span class="id">#x4E60</span>;&amp;<span class="id">#x638C</span>;&amp;<span class="id">#x63E1</span>;<span class="tag">MongoDB</span>&amp;<span class="id">#xFF0C</span>;&amp;<span class="id">#x6240</span>;&amp;<span class="id">#x4EE5</span>;&amp;<span class="id">#x67D0</span>;&amp;<span class="id">#x4E9B</span>;&amp;<span class="id">#x8BBE</span>;&amp;<span class="id">#x8BA1</span>;&amp;<span class="id">#x4E0A</span>;&amp;<span class="id">#x66F4</span>;&amp;<span class="id">#x504F</span>;&amp;<span class="id">#x5411</span>;&amp;<span class="id">#x4E8E</span>;&amp;<span class="id">#x529F</span>;&amp;<span class="id">#x80FD</span>;&amp;<span class="id">#x7684</span>;&amp;<span class="id">#x5C55</span>;&amp;<span class="id">#x793A</span>;&amp;<span class="id">#xFF0C</span>;&amp;<span class="id">#x5728</span>;&amp;<span class="id">#x5B9E</span>;&amp;<span class="id">#x9645</span>;&amp;<span class="id">#x4F7F</span>;&amp;<span class="id">#x7528</span>;&amp;<span class="id">#x4E0A</span>;&amp;<span class="id">#x8981</span>;&amp;<span class="id">#x56E0</span>;&amp;<span class="id">#x5730</span>;&amp;<span class="id">#x5236</span>;&amp;<span class="id">#x5B9C</span>;&amp;<span class="id">#x7684</span>;&amp;<span class="id">#x6539</span>;&amp;<span class="id">#x53D8</span>;&amp;<span class="id">#xFF0C</span>;&amp;<span class="id">#x5408</span>;&amp;<span class="id">#x9002</span>;&amp;<span class="id">#x624D</span>;&amp;<span class="id">#x662F</span>;&amp;<span class="id">#x6700</span>;&amp;<span class="id">#x597D</span>;&amp;<span class="id">#x7684</span>;&amp;<span class="id">#x3002</span>;
</code></pre><h2 id="&#x9700;&#x6C42;">&#x9700;&#x6C42;</h2><p>&#x7535;&#x5F71;&#x7968;&#x9884;&#x5B9A;&#x7CFB;&#x7EDF;&#x4E0E;&#x7535;&#x5546;&#x7CFB;&#x7EDF;&#x975E;&#x5E38;&#x7C7B;&#x4F3C;&#xFF0C;&#x90FD;&#x53EF;&#x4EE5;&#x62BD;&#x8C61;&#x7406;&#x89E3;&#x4E3A;&#x5546;&#x54C1;&#x7684;&#x552E;&#x5356;&#x3002;&#x8FDB;&#x4E00;&#x6B65;&#x7684;&#x8BB2;&#x7535;&#x5F71;&#x7968;&#x7CFB;&#x7EDF;&#x662F;&#x7535;&#x5546;&#x7CFB;&#x7EDF;&#x7684;&#x4E00;&#x4E2A;&#x5E93;&#x5B58;&#x7279;&#x4F8B;&#x573A;&#x666F;&#xFF1A;</p>
<ul>
<li>&#x6BCF;&#x4E2A;&#x573A;&#x6B21;&#xFF0C;&#x6BCF;&#x4E2A;&#x5EA7;&#x4F4D;&#xFF0C;&#x90FD;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5E93;&#x5B58;</li>
<li>&#x6BCF;&#x4E2A;&#x8BA2;&#x5355;&#x6240;&#x9884;&#x5B9A;&#x7684;&#x5EA7;&#x4F4D;&#x6709;&#x9501;&#x5B9A;&#x72B6;&#x6001;&#xFF0C;&#x5728;&#x652F;&#x4ED8;&#x524D;&#x5BF9;&#x5E94;&#x7684;&#x4F5C;&#x4E3A;&#x4E0D;&#x80FD;&#x88AB;&#x518D;&#x6B21;&#x8D2D;&#x4E70;</li>
<li>&#x8BA2;&#x5355;&#x6D89;&#x53CA;&#x5230;&#x7684;&#x5EA7;&#x4F4D;&#x8981;&#x4E0D;&#x5168;&#x6210;&#x529F;&#xFF0C;&#x8981;&#x4E0D;&#x5168;&#x5931;&#x8D25;</li>
<li><p>&#x201C;&#x5168;&#x56FD;&#x201D;&#x7EA7;&#x7684;&#xFF0C;&#x6570;&#x636E;&#x5BB9;&#x91CF;&#x4E0D;&#x662F;&#x592A;&#x5927;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x6027;&#x80FD;&#x4E0A;&#x8981;&#x652F;&#x6301;&#x6C34;&#x5E73;&#x6269;&#x5C55;</p>
<p>  PS&#xFF1A;&#x5B9E;&#x9645;&#x4E0A;&#x7684;&#x7406;&#x8BBA;TPS&#x5E76;&#x4E0D;&#x9AD8;&#xFF0C;&#x76EE;&#x524D;&#x5168;&#x56FD;5000&#x5BB6;&#x5F71;&#x9662;&#xFF0C;&#x5047;&#x8BBE;&#x5E73;&#x5747;8&#x4E2A;&#x5F71;&#x5385;&#xFF0C;&#x6BCF;&#x4E2A;&#x5F71;&#x5385;6&#x4E2A;&#x573A;&#x6B21;&#xFF0C;&#x6BCF;&#x573A;&#x6B21;200&#x4E2A;&#x5EA7;&#x4F4D;&#xFF0C;&#x65E9;&#x4E2D;&#x665A;&#x5404;3&#x4E2A;&#x9AD8;&#x5CF0;&#xFF0C;&#x6BCF;&#x4E2A;&#x9AD8;&#x5CF0;1&#x4E2A;&#x5C0F;&#x65F6;&#x3002;&#x8BA1;&#x7B97;&#x5F97;&#x51FA;TPS&#x5927;&#x6982;&#x662F;&#xFF1A;5000 <em> 8 </em> 6 * 200/ 3 / 3600 &#xFF1D; 4444 TPS&#xFF1B;&#x4F46;&#x662F;&#x8BBE;&#x8BA1;&#x4E0A;&#x6211;&#x4EEC;&#x8FD8;&#x662F;&#x8981;&#x4FDD;&#x8BC1;&#x6027;&#x80FD;&#x7684;&#x53EF;&#x6C34;&#x5E73;&#x6269;&#x5C55;&#xFF0C;&#x5426;&#x5219;&#x600E;&#x4E48;&#x4F53;&#x73B0;MongoDB&#x7684;&#x7279;&#x8272;&#x5462;&#xFF1F;^-^</p>
</li>
</ul>
<h2 id="&#x63CF;&#x8FF0;&#x4FE1;&#x606F;&#x6587;&#x6863;&#x7ED3;&#x6784;">&#x63CF;&#x8FF0;&#x4FE1;&#x606F;&#x6587;&#x6863;&#x7ED3;&#x6784;</h2><h2 id="&#x5F71;&#x9662;&#x63CF;&#x8FF0;&#x4FE1;&#x606F;">&#x5F71;&#x9662;&#x63CF;&#x8FF0;&#x4FE1;&#x606F;</h2><p>&#x4FDD;&#x5B58;&#x6700;&#x57FA;&#x672C;&#x7684;&#x5F71;&#x9662;&#x4FE1;&#x606F;&#xFF0C;&#x5305;&#x62EC;&#x5730;&#x7406;&#x4FE1;&#x606F;&#xFF0C;&#x540D;&#x79F0;&#xFF0C;_id&#x4E3A;MongoDB&#x7531;MongoDB&#x81EA;&#x52A8;&#x5206;&#x914D;</p>
<p>CinemaManager.cinema_detail</p>
<p>{</p>
<p>_id: ,</p>
<p>name: &#x201C;&#x201D;,</p>
<p>city: &#x201C;&#x201D;</p>
<p>location: [, ],</p>
<p>comments: &#x201C;&#x201D;</p>
<p>}</p>
<p>&#x4F8B;&#x5982;&#xFF1A;</p>
<p>rs0:PRIMARY&amp;gt; db.cinema_detail.insert({&lt;br /&gt; &amp;quot;name&amp;quot; : &amp;quot;&#x5927;&#x65F6;&#x4EE3;&#x7535;&#x5F71;&#x9662;&amp;quot;,&lt;br /&gt; &amp;quot;city&amp;quot; : &amp;quot;&#x676D;&#x5DDE;&amp;quot;,&lt;br /&gt; &amp;quot;location&amp;quot; : [ 120.13, 30.16 ],&lt;br /&gt; &amp;quot;comments&amp;quot; : &amp;quot;IMAX 4K&#xFF0C;&#x6709;&#x505C;&#x8F66;&#x4F4D;&amp;quot;&lt;br /&gt; });&lt;br /&gt;</p>
<p>&#x56E0;&#x4E3A;&#x5F71;&#x9662;&#x4FE1;&#x606F;&#x7684;&#x67E5;&#x8BE2;&#x4E00;&#x822C;&#x90FD;&#x662F;&#x6309;&#x7167;&#x57CE;&#x5E02;&#x548C;&#x540D;&#x79F0;&#xFF0C;&#x6216;&#x8005;&#x5730;&#x7406;&#x5750;&#x6807;&#x68C0;&#x7D22;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x5EFA;&#x7ACB;&#x4E24;&#x4E2A;&#x7D22;&#x5F15;</p>
<p>Index1&#xFF1A;&#x57CE;&#x5E02;+&#x540D;&#x79F0;&#x7684;&#x590D;&#x5408;&#x7D22;&#x5F15;&#xFF0C;&#x56E0;&#x4E3A;&#x67E5;&#x8BE2;&#x7535;&#x5F71;&#x9662;&#x65F6;&#x4E00;&#x822C;&#x90FD;&#x4F1A;&#x6307;&#x5B9A;&#x57CE;&#x5E02;&#x540D;</p>
<p>&lt;br /&gt; rs0:PRIMARY&amp;gt; db.cinema_detail.ensureIndex({city:1, name:1})&lt;br /&gt; {&lt;br /&gt; &amp;quot;createdCollectionAutomatically&amp;quot; : false,&lt;br /&gt; &amp;quot;numIndexesBefore&amp;quot; : 2,&lt;br /&gt; &amp;quot;numIndexesAfter&amp;quot; : 2,&lt;br /&gt; &amp;quot;ok&amp;quot; : 1&lt;br /&gt; }</p>
<p>&#x6CE8;&#x610F;&#xFF0C;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x590D;&#x5408;&#x7D22;&#x5F15;&#xFF0C;&#x6240;&#x4EE5;&#x9488;&#x5BF9; city + name&#x7684;&#x67E5;&#x8BE2;&#xFF0C;&#x6216;&#x8005; city&#x7684;&#x67E5;&#x8BE2;&#x662F;&#x6709;&#x6548;&#x7684;&#xFF0C;&#x53EA;&#x67E5;&#x627E;name&#x5B57;&#x6BB5;&#x662F;&#x65E0;&#x6CD5;&#x901A;&#x8FC7;&#x7D22;&#x5F15;&#x4F18;&#x5316;&#x7684;&#x3002;&#x8FD9;&#x91CC;&#x8BF4;&#x660E;&#x4E0B;&#x4E3A;&#x4F55;&#x4E0D;&#x5206;&#x522B;&#x7B80;&#x5386;city&#xFF0C;&#x548C;name&#x7684;&#x7D22;&#x5F15;&#xFF0C;&#x9996;&#x5148;&#xFF0C;&#x4ECE;&#x4E1A;&#x52A1;&#x4E0A;&#x7535;&#x5F71;&#x9662;&#x7684;&#x67E5;&#x627E;&#x90FD;&#x662F;&#x7ED9;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x57CE;&#x5E02;&#x4FE1;&#x606F;&#xFF0C;&#x5168;&#x56FD;&#x8303;&#x56F4;&#x7684;&#x67E5;&#x627E;&#x9700;&#x6C42;&#x975E;&#x5E38;&#x5C11;&#xFF0C;&#x4E3A;&#x6B64;&#x591A;&#x7EF4;&#x62A4;&#x4E00;&#x4E2A;&#x7D22;&#x5F15;&#x6CA1;&#x6709;&#x7279;&#x522B;&#x5FC5;&#x8981;&#x6027;&#x3002;</p>
<p>Index2&#xFF1A;&#x5730;&#x7406;&#x5750;&#x6807;&#x7D22;&#x5F15;&#xFF0C;&#x7528;&#x6765;&#x5E94;&#x4ED8;&#x201D;&#x6700;&#x8FD1;&#x7684;&#x7535;&#x5F71;&#x9662;&#x201D;&#x7C7B;&#x67E5;&#x8BE2;</p>
<p>rs0:PRIMARY&amp;gt; db.cinema_detail.ensureIndex({location: &amp;quot;2d&amp;quot;})&lt;br /&gt; {&lt;br /&gt; &amp;quot;createdCollectionAutomatically&amp;quot; : false,&lt;br /&gt; &amp;quot;numIndexesBefore&amp;quot; : 3,&lt;br /&gt; &amp;quot;numIndexesAfter&amp;quot; : 4,&lt;br /&gt; &amp;quot;ok&amp;quot; : 1&lt;br /&gt; }&lt;br /&gt;</p>
<p>&#x4F8B;&#x5982;&#xFF0C;&#x67E5;&#x8BE2;&#x5728;&#x676D;&#x5DDE;&#x6700;&#x8FD1;&#x7684;&#x67D0;&#x4E2A;&#x7535;&#x5F71;&#x9662;</p>
<p> rs0:PRIMARY&gt; db.cinema_detail.find({city:&#x201D;&#x676D;&#x5DDE;&#x201D;, location: { $near: [  120.9  , 30.11] }}).pretty()</p>
<p>{&lt;br /&gt; &amp;quot;_id&amp;quot; : ObjectId(&amp;quot;559a3ef8c6058dae1ac49ce8&amp;quot;),&lt;br /&gt; &amp;quot;name&amp;quot; : &amp;quot;&#x5927;&#x65F6;&#x4EE3;&#x7535;&#x5F71;&#x9662;&amp;quot;,&lt;br /&gt; &amp;quot;city&amp;quot; : &amp;quot;&#x676D;&#x5DDE;&amp;quot;,&lt;br /&gt; &amp;quot;location&amp;quot; : [&lt;br /&gt; 120.13,&lt;br /&gt; 30.16&lt;br /&gt; ],&lt;br /&gt; &amp;quot;comments&amp;quot; : &amp;quot;IMAX 4K&#xFF0C;&#x6709;&#x505C;&#x8F66;&#x4F4D;&amp;quot;&lt;br /&gt; }</p>
<h2 id="&#x5F71;&#x5385;&#x63CF;&#x8FF0;&#x4FE1;&#x606F;">&#x5F71;&#x5385;&#x63CF;&#x8FF0;&#x4FE1;&#x606F;</h2><p>theater_detail.cinema_id&#x4E0E;cinema_detail._id&#x96C6;&#x5408;&#x5F62;&#x6210;references&#x5173;&#x7CFB;&#xFF0C;&#x901A;&#x8FC7;cinema_detail._id&#x53EF;&#x4EE5;&#x5FEB;&#x901F;&#x627E;&#x5230;&#x6240;&#x5C5E;&#x5F71;&#x5385;&#x7684;&#x4FE1;&#x606F;&#x3002;&#x53E6;&#x4E00;&#x4E2A;&#x5173;&#x952E;&#x5B57;&#x6BB5;theater_detail.seat&#x7528;&#x6765;&#x63CF;&#x8FF0;&#x5EA7;&#x4F4D;&#x4FE1;&#x606F;&#xFF0C;&#x6BCF;&#x6392;&#x6240;&#x6709;&#x7684;&#x5EA7;&#x4F4D;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF0C;&#x4E0D;&#x540C;&#x6392;&#x53EF;&#x4EE5;&#x6709;&#x4E0D;&#x540C;&#x6570;&#x91CF;&#x7684;&#x5EA7;&#x4F4D;&#x3002;</p>
<p>CinemaManager.theater_detail</p>
<p>&lt;br /&gt; {&lt;br /&gt; _id: ,&lt;br /&gt; cinema_id: ,&lt;br /&gt; name: ,&lt;br /&gt; seat:&lt;br /&gt; {&lt;br /&gt; row1: [],&lt;br /&gt; row2: [],&lt;br /&gt; row3: [],&lt;br /&gt; : []&lt;br /&gt; }&lt;br /&gt; comments: &amp;quot;&amp;quot;&lt;br /&gt; }&lt;br /&gt;</p>
<p>&lt;br /&gt; rs0:PRIMARY&amp;gt; db.theater_detail.insert({&lt;br /&gt; cinema_id:ObjectId(&amp;quot;559a3ef8c6058dae1ac49ce8&amp;quot;),&lt;br /&gt; name:&amp;quot;IMAX&#x5385;&amp;quot;,&lt;br /&gt; seat:&lt;br /&gt; {&lt;br /&gt; row1: [1, 1, 1, 1],&lt;br /&gt; row2: [1, 1, 1],&lt;br /&gt; row3: [1, 1, 1, 1],&lt;br /&gt; row4: [1, 1, 1, 1, 1],&lt;br /&gt; },&lt;br /&gt; comments: &amp;quot;&#x53EF;&#x5BB9;&#x7EB3;&#x54E6;xxx&#x4EBA;&#xFF0C;&#x5F27;&#x5F62;&#x8367;&#x5E55;&amp;quot;&lt;br /&gt; })</p>
<p>rs0:PRIMARY&gt; db.theater_detail.insert({</p>
<p>cinema_id:ObjectId(&#x201C;559a3ef8c6058dae1ac49ce8&#x2033;),</p>
<p>name:&#x201D;&#x4E2D;&#x56FD;&#x5DE8;&#x5E55;&#x5385;&#x201D;,</p>
<p>seat:</p>
<p>{</p>
<p>row1: [1, 1, 1, 1],</p>
<p>row2: [1, 1, 1],</p>
<p>row3: [1, 1, 1, 1]</p>
<p>},</p>
<p>comments: &#x201C;&#x53EF;&#x5BB9;&#x7EB3;&#x54E6;xxx&#x4EBA;&#xFF0C;&#x5F27;&#x5F62;&#x8367;&#x5E55;&#x201D;</p>
<p>})</p>
<p>&#x5EFA;&#x7ACB;&#x7D22;&#x5F15;</p>
<p>&lt;br /&gt; rs0:PRIMARY&amp;gt; db.theater_detail.ensureIndex({cinema_id:1})&lt;br /&gt; {&lt;br /&gt; &amp;quot;createdCollectionAutomatically&amp;quot; : false,&lt;br /&gt; &amp;quot;numIndexesBefore&amp;quot; : 1,&lt;br /&gt; &amp;quot;numIndexesAfter&amp;quot; : 2,&lt;br /&gt; &amp;quot;ok&amp;quot; : 1&lt;br /&gt; }&lt;br /&gt;</p>
<h2 id="&#x5F71;&#x7247;&#x63CF;&#x8FF0;&#x4FE1;&#x606F;">&#x5F71;&#x7247;&#x63CF;&#x8FF0;&#x4FE1;&#x606F;</h2><p>&#x5F71;&#x7247;&#x8BF4;&#x660E;</p>
<p>{&lt;br /&gt; _id: ,&lt;br /&gt; name: &amp;quot;&amp;quot;,&lt;br /&gt; director: &amp;quot;director name&amp;quot;&lt;br /&gt; actor: []&lt;br /&gt; comments: &amp;quot;&amp;quot;&lt;br /&gt; }&lt;br /&gt;</p>
<p>&lt;br /&gt; rs0:PRIMARY&amp;gt; db.movie_detail.insert({&lt;br /&gt; name: &amp;quot;&#x4E00;&#x8DEF;&#x5411;&#x897F;&amp;quot;,&lt;br /&gt; director: &amp;quot;&#x80E1;&#x8000;&#x8F89;&amp;quot;,&lt;br /&gt; actor:[&amp;quot;&#x5F20;&#x5EFA;&#x58F0;&amp;quot;, &amp;quot;&#x738B;&#x5B97;&#x5C27;&amp;quot;, &amp;quot;&#x80E1;&#x8000;&#x8F89;&amp;quot;, &amp;quot;&#x4F55;&#x4F69;&#x745C;&amp;quot;, &amp;quot;&#x5F20;&#x6696;&#x96C5;&amp;quot;, &amp;quot;&#x90ED;&#x9896;&#x513F;&amp;quot;],&lt;br /&gt; comments: &amp;quot;&#x8BE5;&#x5F71;&#x7247;&#x63CF;&#x5199;&#x7684;&#x662F;&#x5F53;&#x4EE3;&#x9999;&#x6E2F;&#x793E;&#x4F1A;&#x4E2D;&#x666E;&#x901A;&#x5E74;&#x8F7B;&#x4EBA;&#x5BF9;&#x201C;&#x7231;&#x201D;&#x4E0E;&#x201C;&#x6027;&#x201D;&#x7684;&#x8FFD;&#x6C42;&#x800C;&#x9010;&#x6E10;&#x6539;&#x53D8;&#x7684;&#x5FC3;&#x8DEF;&#x5386;&#x7A0B;&#x7684;&#x6545;&#x4E8B;&amp;quot;&lt;br /&gt; })&lt;br /&gt;</p>
<p>&#x7D22;&#x5F15;</p>
<p>&lt;br /&gt; rs0:PRIMARY&amp;gt; db.movie_detail.ensureIndex({name:1})&lt;br /&gt; {&lt;br /&gt; &amp;quot;createdCollectionAutomatically&amp;quot; : false,&lt;br /&gt; &amp;quot;numIndexesBefore&amp;quot; : 1,&lt;br /&gt; &amp;quot;numIndexesAfter&amp;quot; : 2,&lt;br /&gt; &amp;quot;ok&amp;quot; : 1&lt;br /&gt; }&lt;br /&gt;</p>
<h2 id="&#x5F71;&#x7247;&#x653E;&#x6620;&#x6587;&#x6863;&#x7ED3;&#x6784;">&#x5F71;&#x7247;&#x653E;&#x6620;&#x6587;&#x6863;&#x7ED3;&#x6784;</h2><p>&#x653E;&#x6620;&#x4FE1;&#x606F;&#x5305;&#x542B;&#x653E;&#x6620;&#x65F6;&#x95F4;&#x6BB5;&#xFF0C;&#x653E;&#x6620;&#x5F71;&#x5385;&#xFF0C;&#x7968;&#x4EF7;&#x3002;&#x867D;&#x7136;Document&#x7ED3;&#x6784;&#x53EF;&#x4EE5;&#x505A;&#x590D;&#x6742;&#x7684;&#x5D4C;&#x5957;&#xFF0C;&#x4F46;&#x539F;&#x5219;&#x4E0A;&#x671F;&#x671B;Document&#x5C3D;&#x91CF;&#x5C0F;&#xFF0C;&#x5229;&#x7528;&#x6570;&#x636E;Shard&#xFF0C;&#x6027;&#x80FD;&#x4F18;&#x5316;&#x3002;&#x6240;&#x4EE5;&#x5728;movie_schedule&#x7684;&#x8BBE;&#x8BA1;&#x4E0A;&#x6BCF;&#x4E2A;&#x5F71;&#x7247;&#x7684;&#x6BCF;&#x573A;&#x653E;&#x6620;&#x72EC;&#x7ACB;&#x4E00;&#x4E2A;Document&#x8868;&#x8FBE;&#x3002;</p>
<p>&lt;br /&gt; {&lt;br /&gt; _id: ,&lt;br /&gt; cinema_id:&lt;br /&gt; movie_id: ,&lt;br /&gt; theater_id: ,&lt;br /&gt; start_time: ,&lt;br /&gt; end_time: ,&lt;br /&gt; comments: &amp;quot;&amp;quot;&lt;br /&gt; }&lt;br /&gt;</p>
<p>movie_schedule&#x7684;References&#x5173;&#x7CFB;&#x8F83;&#x591A;&#xFF0C;&#x9700;&#x8981;&#x4E0E;&#x7535;&#x5F71;&#x9662;&#xFF0C;&#x5F71;&#x5385;&#xFF0C;&#x7535;&#x5F71;&#x4E09;&#x8005;&#x5206;&#x522B;&#x5EFA;&#x7ACB;&#x5173;&#x7CFB;&#x3002;</p>
<p>&lt;br /&gt; db.movie_schedule.insert({&lt;br /&gt; cinema_id:ObjectId(&amp;quot;559a3ef8c6058dae1ac49ce8&amp;quot;),&lt;br /&gt; movie_id:ObjectId(&amp;quot;559b68f372b34f216246cb1d&amp;quot;),&lt;br /&gt; theater_id:ObjectId(&amp;quot;559b625072b34f216246cb1b&amp;quot;),&lt;br /&gt; start_time: ISODate(&amp;quot;2015-07-07T10:00:00.00Z&amp;quot;),&lt;br /&gt; end_time: ISODate(&amp;quot;2015-07-07T12:00:00.000Z&amp;quot;),&lt;br /&gt; comments: &amp;quot;&#x9996;&#x6620;&amp;quot;&lt;br /&gt; )}</p>
<p>db.movie_schedule.insert({</p>
<p>cinema_id:ObjectId(&#x201C;559a3ef8c6058dae1ac49ce8&#x2033;),</p>
<p>movie_id:ObjectId(&#x201C;559b68f372b34f216246cb1d&#x201D;),</p>
<p>theater_id:ObjectId(&#x201C;559b625072b34f216246cb1b&#x201D;),</p>
<p>start_time: ISODate(&#x201C;2015-07-07T12:30:00.00Z&#x201D;),</p>
<p>end_time: ISODate(&#x201C;2015-07-07T14:30:00.000Z&#x201D;),</p>
<p>comments: &#x201C;&#x201D;</p>
<p>)}</p>
<p>&#x8FD8;&#x662F;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x590D;&#x5408;&#x7D22;&#x5F15;&#xFF0C;&#x4F18;&#x5316;&#x67E5;&#x8BE2;&#x67D0;&#x4E00;&#x7535;&#x5F71;&#x9662;&#x7684;&#x67D0;&#x90E8;&#x5F71;&#x7247;&#xFF08;&#x7684;&#x67D0;&#x4E00;&#x5F71;&#x5385;&#xFF09;&#x4E0A;&#x6620;&#x4FE1;&#x606F;</p>
<p>&lt;br /&gt; rs0:PRIMARY&amp;gt; db.movie_schedule.ensureIndex({cinema_id:1, movie_id:1, theater_id:1})&lt;br /&gt; {&lt;br /&gt; &amp;quot;createdCollectionAutomatically&amp;quot; : false,&lt;br /&gt; &amp;quot;numIndexesBefore&amp;quot; : 1,&lt;br /&gt; &amp;quot;numIndexesAfter&amp;quot; : 2,&lt;br /&gt; &amp;quot;ok&amp;quot; : 1&lt;br /&gt; }&lt;br /&gt;</p>
<p>PS&#xFF1A;&#x4E5F;&#x53EF;&#x4EE5;&#x5EFA;&#x7ACB;&#x76F8;&#x5E94;&#x7684;&#x7D22;&#x5F15;&#xFF0C;&#x7528;&#x6765;&#x4F18;&#x5316;&#x67D0;&#x4E00;&#x65F6;&#x95F4;&#x6BB5;&#x5185;&#x7684;&#x5F71;&#x7247;&#x4FE1;&#x606F;&#x67E5;&#x8BE2;&#xFF0C;&#x8BFB;&#x8005;&#x81EA;&#x884C;&#x601D;&#x8003;</p>
<h2 id="&#x4EA4;&#x6613;&#x7CFB;&#x7EDF;">&#x4EA4;&#x6613;&#x7CFB;&#x7EDF;</h2><p>&#x81F3;&#x6B64;&#xFF0C;&#x57FA;&#x672C;&#x7684;&#x4FE1;&#x606F;&#x6587;&#x6863;&#x96C6;&#x5408;&#x5747;&#x5DF2;&#x5EFA;&#x7ACB;&#x5B8C;&#x6210;&#xFF0C;&#x4E00;&#x822C;&#x7684;&#x67E5;&#x8BE2;&#x9700;&#x6C42;&#x90FD;&#x53EF;&#x4EE5;&#x6EE1;&#x8DB3;&#x4E86;&#x3002;&#x63A5;&#x4E0B;&#x6765;&#x662F;&#x91CD;&#x70B9;&#xFF1A;&#x5E93;&#x5B58;&#x552E;&#x5356;&#x7CFB;&#x7EDF;&#x3002;&#x62BD;&#x8C61;&#x7684;&#x6765;&#x770B;&#xFF0C;&#x552E;&#x5356;&#x7CFB;&#x7EDF;&#x5C31;&#x662F;&#x5BF9;&#x4E0A;&#x8BC9;&#x6240;&#x6709;&#x96C6;&#x5408;&#x7684;&#x4E00;&#x4E2A;&#x6574;&#x5408;&#xFF0C;&#x5916;&#x52A0;&#x4E00;&#x5957;&#xFFFD;&#xFFFD;&#xFFFD;&#x5B58;&#x5B57;&#x6BB5;&#x3002;&#x6211;&#x4EEC;&#x8BA4;&#x4E3A;&#x4E00;&#x573A;&#x653E;&#x6620;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x4E3B;&#x5546;&#x54C1;&#xFF0C;&#x6BCF;&#x4E2A;&#x5EA7;&#x4F4D;&#x53EF;&#x4EE5;&#x8BA4;&#x4E3A;&#x662F;&#x8FD9;&#x4E2A;&#x5546;&#x54C1;&#x7684;SKU&#xFF0C;&#x6BCF;&#x4E2A;SKU&#x90FD;&#x662F;1&#x4EFD;&#x3002;</p>
<p>&#x901A;&#x8FC7;Reference&#x5173;&#x7CFB;&#x7ED3;&#x5408;movie_schedule&#x4E0E;theater_detail&#xFF0C;&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x5F15;&#x7528;&#x4E86;</p>
<p>&lt;br /&gt; {&lt;br /&gt; _id: ,&lt;br /&gt; movie_schedule_id:&lt;br /&gt; theater_id: ,&lt;br /&gt; seat:&lt;br /&gt; {&lt;br /&gt; row1: [2, 2, 2, 2],&lt;br /&gt; row2: [2, 2, 2],&lt;br /&gt; row3: [2, 2, 2, 2],&lt;br /&gt; row4: [2, 2, 2, 2, 2],&lt;br /&gt; }&lt;br /&gt; }&lt;br /&gt;</p>
<p>&#x6CE8;&#x610F;&#xFF0C;&#x8FD9;&#x91CC;&#x4E0D;&#x4EC5;&#x4EC5;&#x662F;Reference&#x7684;&#x5F15;&#x7528;&#x5173;&#x7CFB;&#xFF0C;&#x8FD8;&#x590D;&#x5236;&#x4E86;theater_detail.seat&#x5B57;&#x6BB5;&#xFF0C;&#x6BCF;&#x4E2A;seat&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x5E93;&#x5B58;&#x6570;&#x5B57;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;MongoDB&#x4E2D;&#x4E00;&#x4E2A;Document&#x7684;&#x64CD;&#x4F5C;&#x662F;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x539F;&#x5B50;&#x7684;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x5BF9;Collection&#x52A0;&#x4EFB;&#x4F55;&#x9501;&#x3002;&#x6570;&#x5B57;2&#x5E76;&#x4E0D;&#x662F;&#x8868;&#x793A;&#x53EF;&#x4EE5;&#x5356;2&#x6B21;&#xFF1A;</p>
<ul>
<li>&#x6570;&#x5B57;2&#x8868;&#x793A;&#xFF0C;&#x53EF;&#x9500;&#x552E;</li>
<li>&#x6570;&#x5B57;1&#x8868;&#x793A;&#xFF0C;&#x5DF2;&#x9501;&#x5B9A;</li>
<li>&#x6570;&#x5B57;0&#x8868;&#x793A;&#xFF0C;&#x5DF2;&#x552E;&#x5B8C;</li>
</ul>
<p>&#x4EA4;&#x6613;&#x903B;&#x8F91;&#x4E0A;&#x53EF;&#x901A;&#x8FC7;FindAndModify + $inc&#xFF0C;&#x539F;&#x5B50;&#x6027;&#x7684;&#x4FEE;&#x6539;&#x5E93;&#x5B58;&#x4FE1;&#x606F;&#x3002;&#x5176;&#x4ED6;&#x7684;&#x63CF;&#x8FF0;&#x4FE1;&#x606F;&#x662F;&#x5426;&#x9700;&#x8981;&#x518D;&#x6B21;&#x5197;&#x4F59;&#x53D6;&#x51B3;&#x4E8E;&#x5177;&#x4F53;&#x7684;&#x4E1A;&#x52A1;&#x72B6;&#x51B5;&#x4E86;&#xFF0C;&#x5177;&#x4F53;&#x95EE;&#x9898;&#x5177;&#x4F53;&#x5206;&#x6790;&#x3002;&#x6211;&#x672C;&#x4EBA;&#x66F4;&#x503E;&#x5411;&#x4E8E;&#x76EE;&#x524D;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x65B9;&#x6848;&#xFF0C;&#x4E0D;&#x505A;&#x8FC7;&#x591A;&#x7684;&#x5197;&#x4F59;&#xFF0C;&#x539F;&#x56E0;&#xFF1A;</p>
<ol>
<li>&#x6570;&#x636E;&#x8BA2;&#x6B63;&#x590D;&#x6742;&#xFF0C;&#x591A;&#x4E00;&#x4E2A;&#x5197;&#x4F59;&#xFF0C;&#x591A;&#x4E00;&#x4EFD;&#x590D;&#x6742;2. &#x5176;&#x4ED6;&#x4FE1;&#x606F;&#x57FA;&#x672C;&#x90FD;&#x662F;&#x9759;&#x6001;&#x6570;&#x636E;&#xFF0C;&#x6570;&#x636E;&#x91CF;&#x53C8;&#x5C0F;&#xFF0C;&#x5B8C;&#x5168;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;Cache&#x6280;&#x672F;&#x89E3;&#x51B3;&#x8BFB;&#x53D6;&#x95EE;&#x9898; </li>
</ol>
<p>&#x5148;&#x63D2;&#x5165;&#x4E00;&#x4E2A;&#x6211;&#x4EEC;&#x7684;&#x5546;&#x54C1;</p>
<p>&lt;br /&gt; db.movie_item.insert({&lt;br /&gt; movie_schedule_id : ObjectId(&amp;quot;559b6ee472b34f216246cb1e&amp;quot;),&lt;br /&gt; theater_id : ObjectId(&amp;quot;559b625072b34f216246cb1b&amp;quot;),&lt;br /&gt; seat :&lt;br /&gt; {&lt;br /&gt; row1: [2, 2, 2, 2],&lt;br /&gt; row2: [2, 2, 2],&lt;br /&gt; row3: [2, 2, 2, 2],&lt;br /&gt; row4: [2, 2, 2, 2, 2],&lt;br /&gt; }&lt;br /&gt; })&lt;br /&gt;</p>
<p>&#x7D22;&#x5F15;</p>
<p>rs0:PRIMARY&gt; db.movie_item.ensureIndex({movie_schedule_id:1})<br>{<br>&quot;createdCollectionAutomatically&quot; : false,<br>&quot;numIndexesBefore&quot; : 1,<br>&quot;numIndexesAfter&quot; : 2,<br>&quot;ok&quot; : 1<br>}<br>&#x9501;&#x5B9A;&#x5EA7;&#x4F4D;&#x7684;&#x52A8;&#x4F5C;&#xFF0C;&#x9501;&#x5B9A;&#x7B2C;4&#x6392;&#x7684;3&#x53F7;&#x4F4D;&#x7F6E;&#xFF08;&#x4ECE;1&#x5F00;&#x59CB;&#x8BA1;&#x6570;&#xFF0C;&#x7535;&#x5F71;&#x9662;&#x7684;&#x5EA7;&#x4F4D;&#x53F7;&#x6700;&#x5C0F;&#x90FD;&#x662F;0&#xFF09;&#x548C;&#x9501;&#x5B9A;&#x7B2C;4&#x6392;&#x7684;2&#x53F7;&#x4F4D;&#x7F6E;&#xFF1A; </p>
<p>&lt;br /&gt; db.movie_item.findAndModify({&lt;br /&gt; query: { &amp;quot;_id&amp;quot;:ObjectId(&amp;quot;559b790f72b34f216246cb22&amp;quot;), &amp;quot;seat.row4.2&amp;quot;:2 },&lt;br /&gt; update: { $inc: {&amp;quot;seat.row4.2&amp;quot;:-1}},&lt;br /&gt; upsert: false&lt;br /&gt; })</p>
<p>db.movie_item.findAndModify({</p>
<p>query: { &#x201C;_id&#x201D;:ObjectId(&#x201C;559b790f72b34f216246cb22&#x2033;), &#x201C;seat.row4.1&#x2033;:2 },</p>
<p>update: { $inc: {&#x201C;seat.row4.1&#x2033;:-1}},</p>
<p>upsert: false</p>
<p>})</p>
<p>&#x5206;&#x522B;&#x9501;&#x5B9A;&#x4E86;&#x7B2C;4&#x6392;3&#x53F7;&#xFF08;row4[2]&#xFF09;&#xFF0C;&#x7B2C;4&#x6392;2&#x53F7;&#xFF08;row4[1])&#xFF0C;&#x6CE8;&#x610F;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x5206;&#x4E24;&#x6B21;&#x9501;&#x5B9A;&#x7684;&#xFF0C;&#x9501;&#x5B9A;&#x64CD;&#x4F5C;&#x5E76;&#x4E0D;&#x9700;&#x8981;&#x539F;&#x5B50;&#x5B8C;&#x6210;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x9020;&#x6210;&#x7528;&#x6237;&#x9501;&#x5B9A;&#x5931;&#x8D25;&#x6982;&#x7387;&#x7684;&#x4E0A;&#x5347;&#x3002;&#x540E;&#x9762;&#x90A3;&#x6B21;&#x5047;&#x8BBE;&#x9501;&#x5B9A;&#x5931;&#x8D25;&#x540E;&#xFF0C;&#x7528;&#x6237;&#x4E00;&#x822C;&#x662F;&#x4F1A;&#x91CD;&#x65B0;&#x9009;&#x62E9;&#x53E6;&#x4E00;&#x4FA7;&#x76F8;&#x90BB;&#x7684;&#x4F4D;&#x7F6E;&#x3002; </p>
<p>&lt;br /&gt; rs0:PRIMARY&amp;gt; db.movie_item.find({_id:ObjectId(&amp;quot;559b790f72b34f216246cb22&amp;quot;)}).pretty()&lt;br /&gt; {&lt;br /&gt; &amp;quot;_id&amp;quot; : ObjectId(&amp;quot;559b790f72b34f216246cb22&amp;quot;),&lt;br /&gt; &amp;quot;movie_schedule_id&amp;quot; : ObjectId(&amp;quot;559b6ee472b34f216246cb1e&amp;quot;),&lt;br /&gt; &amp;quot;theater_id&amp;quot; : ObjectId(&amp;quot;559b625072b34f216246cb1b&amp;quot;),&lt;br /&gt; &amp;quot;seat&amp;quot; : {&lt;br /&gt; &amp;quot;row1&amp;quot; : [&lt;br /&gt; 2,&lt;br /&gt; 2,&lt;br /&gt; 2,&lt;br /&gt; 2&lt;br /&gt; ],&lt;br /&gt; &amp;quot;row2&amp;quot; : [&lt;br /&gt; 2,&lt;br /&gt; 2,&lt;br /&gt; 2&lt;br /&gt; ],&lt;br /&gt; &amp;quot;row3&amp;quot; : [&lt;br /&gt; 2,&lt;br /&gt; 2,&lt;br /&gt; 2,&lt;br /&gt; 2&lt;br /&gt; ],&lt;br /&gt; &amp;quot;row4&amp;quot; : [&lt;br /&gt; 2,&lt;br /&gt; 1,&lt;br /&gt; 1,&lt;br /&gt; 2,&lt;br /&gt; 2&lt;br /&gt; ]&lt;br /&gt; }&lt;br /&gt; }&lt;br /&gt;</p>
<p>OK&#xFF0C;&#x4EA4;&#x6613;&#x6210;&#x529F;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#xFF0C;&#x540C;&#x65F6;&#x4FEE;&#x6539;&#x4E24;&#x4E2A;&#x5E93;&#x5B58;&#x5230;0&#xFF0C;&#x8FD9;&#x91CC;&#x5229;&#x7528;&#x4E86;findAndModify&#x7684;&#x539F;&#x5B50;&#x7279;&#x6027;</p>
<p>&lt;br /&gt; db.movie_item.findAndModify({&lt;br /&gt; query: {&lt;br /&gt; _id:ObjectId(&amp;quot;559b790f72b34f216246cb22&amp;quot;),&lt;br /&gt; $and:[ {&amp;quot;seat.row4.2&amp;quot;:1}, {&amp;quot;seat.row4.1&amp;quot;:1}]&lt;br /&gt; },&lt;br /&gt; update: {&lt;br /&gt; $inc: {&amp;quot;seat.row4.2&amp;quot;:-1, &amp;quot;seat.row4.1&amp;quot;:-1}&lt;br /&gt; },&lt;br /&gt; upsert: false&lt;br /&gt; })&lt;br /&gt;</p>
<p>&#x518D;&#x67E5;&#x4E0B;&#x96C6;&#x5408;&#x770B;&#x770B;&#xFF1A;</p>
<p>&lt;br /&gt; rs0:PRIMARY&amp;gt; db.movie_item.find({_id:ObjectId(&amp;quot;559b790f72b34f216246cb22&amp;quot;)}).pretty()&lt;br /&gt; {&lt;br /&gt; &amp;quot;_id&amp;quot; : ObjectId(&amp;quot;559b790f72b34f216246cb22&amp;quot;),&lt;br /&gt; &amp;quot;movie_schedule_id&amp;quot; : ObjectId(&amp;quot;559b6ee472b34f216246cb1e&amp;quot;),&lt;br /&gt; &amp;quot;theater_id&amp;quot; : ObjectId(&amp;quot;559b625072b34f216246cb1b&amp;quot;),&lt;br /&gt; &amp;quot;seat&amp;quot; : {&lt;br /&gt; &amp;quot;row1&amp;quot; : [&lt;br /&gt; 2,&lt;br /&gt; 2,&lt;br /&gt; 2,&lt;br /&gt; 2&lt;br /&gt; ],&lt;br /&gt; &amp;quot;row2&amp;quot; : [&lt;br /&gt; 2,&lt;br /&gt; 2,&lt;br /&gt; 2&lt;br /&gt; ],&lt;br /&gt; &amp;quot;row3&amp;quot; : [&lt;br /&gt; 2,&lt;br /&gt; 2,&lt;br /&gt; 2,&lt;br /&gt; 2&lt;br /&gt; ],&lt;br /&gt; &amp;quot;row4&amp;quot; : [&lt;br /&gt; 2,&lt;br /&gt; 0,&lt;br /&gt; 0,&lt;br /&gt; 2,&lt;br /&gt; 2&lt;br /&gt; ]&lt;br /&gt; }&lt;br /&gt; }&lt;br /&gt;</p>
<h2 id="&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</h2><p>&#x4E00;&#x5957;&#x5168;&#x56FD;&#x7EA7;&#x7684;&#x7535;&#x5F71;&#x7968;&#x7CFB;&#x7EDF;&#x4F1A;&#x6BD4;&#x8FD9;&#x590D;&#x6742;&#x7684;&#x591A;&#xFF0C;&#x672C;&#x6587;&#x7684;&#x76EE;&#x7684;&#x8FD8;&#x662F;&#x4EE5;&#x6559;&#x7A0B;&#x4E3A;&#x4E3B;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x8BF4;&#x660E;MongoDB&#x5982;&#x4F55;&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x7535;&#x5F71;&#x7968;&#x7CFB;&#x7EDF;&#xFF0C;&#x4F46;&#x8DDD;&#x79BB;&#x751F;&#x957F;&#x7CFB;&#x7EDF;&#x8FD8;&#x662F;&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x4ECD;&#x6709;&#x5F88;&#x591A;&#x5176;&#x4ED6;&#x7684;&#x6280;&#x672F;&#x70B9;&#x9700;&#x8981;&#x8BA8;&#x8BBA;&#xFF0C;&#x53EF;&#x4EE5;&#x5EF6;&#x4F38;&#x5F00;&#x7684;&#x8FD8;&#x6709;&#xFF0C;&#x4E0B;&#x5355;&#x5931;&#x8D25;&#xFF0C;&#x8FC7;&#x671F;&#x672A;&#x4ED8;&#x6B3E;&#xFF0C;&#x6570;&#x636E;&#x552F;&#x4E00;&#x6027;&#x7B49;&#x95EE;&#x9898;&#x3002;</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/MongoDB/">MongoDB</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/08/4dc1c64/" title="MongoDB 3.0 用户创建 -" itemprop="url">MongoDB 3.0 用户创建 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-08T02:33:30.000Z" itemprop="datePublished"> 发表于 2015-07-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="&#x6458;&#x8981;&#xFF1A;">&#x6458;&#x8981;&#xFF1A;</h4><p>MongoDB 3.0 &#x5B89;&#x5168;&#x6743;&#x9650;&#x8BBF;&#x95EE;&#x63A7;&#x5236;&#xFF0C;&#x5728;&#x6DFB;&#x52A0;&#x7528;&#x6237;&#x4E0A;&#x9762;3.0&#x7248;&#x672C;&#x548C;&#x4E4B;&#x524D;&#x7684;&#x7248;&#x672C;&#x6709;&#x5F88;&#x5927;&#x7684;&#x533A;&#x522B;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x8BF4;&#x660E;&#x4E0B;3.0&#x7684;&#x6DFB;&#x52A0;&#x7528;&#xFFFD;&#xFFFD;&#xFFFD;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x73AF;&#x5883;&#x3001;&#x6D4B;&#x8BD5;&#xFF1A;</p>
<p>&#x5728; <a href="http://docs.mongodb.org/manual/tutorial/install-mongodb-on-ubuntu/" target="_blank" rel="external">&#x5B89;&#x88C5;MongoDB</a> &#x4E4B;&#x540E;&#xFF0C;&#x5148;&#x5173;&#x95ED;auth&#x8BA4;&#x8BC1;&#xFF0C;&#x8FDB;&#x5165;&#x67E5;&#x770B;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x53EA;&#x6709;&#x4E00;&#x4E2A;local&#x5E93;&#xFF0C;admin&#x5E93;&#x662F;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#xFF1A; </p>
<pre><code>root<span class="variable">@zhoujinyi</span><span class="symbol">:/usr/local/mongo4</span><span class="comment"># mongo --port=27020</span>
<span class="constant">MongoDB </span>shell <span class="symbol">version:</span> <span class="number">3.0</span>.<span class="number">4</span>
connecting <span class="symbol">to:</span> <span class="number">127.0</span>.<span class="number">0</span>.<span class="number">1</span><span class="symbol">:</span><span class="number">27020</span>/test
<span class="number">2015</span>-<span class="number">06</span>-<span class="number">29</span><span class="constant">T09:</span><span class="number">31</span><span class="symbol">:</span>08.<span class="number">673</span>-<span class="number">0400</span> <span class="constant">I CONTROL </span> [initandlisten] 
&amp;gt; show dbs;
local  <span class="number">0</span>.<span class="number">07</span>8GB
</code></pre><p>&#x73B0;&#x5728;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5E10;&#x53F7;&#xFF0C;&#x8BE5;&#x8D26;&#x53F7;&#x9700;&#x8981;&#x6709;grant&#x6743;&#x9650;&#xFF0C;&#x5373;&#xFF1A;&#x8D26;&#x53F7;&#x7BA1;&#x7406;&#x7684;&#x6388;&#x6743;&#x6743;&#x9650;&#x3002;&#x6CE8;&#x610F;&#x4E00;&#x70B9;&#xFF0C;&#x5E10;&#x53F7;&#x662F;&#x8DDF;&#x7740;&#x5E93;&#x8D70;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x6307;&#x5B9A;&#x5E93;&#x91CC;&#x6388;&#x6743;&#xFF0C;&#x5FC5;&#x987B;&#x4E5F;&#x5728;&#x6307;&#x5B9A;&#x5E93;&#x91CC;&#x9A8C;&#x8BC1;(auth)&#x3002; </p>
<pre><code>&amp;gt<span class="comment">; use admin</span>
switched to db admin
&amp;gt<span class="comment">;**db.createUser(</span>
...   {
...     user: &amp;quot<span class="comment">;dba&amp;quot;,</span>
...     pwd: &amp;quot<span class="comment">;dba&amp;quot;,</span>
...     roles: [ { role: &amp;quot<span class="comment">;userAdminAnyDatabase&amp;quot;, db: &amp;quot;admin&amp;quot; } ]****...   }</span>
... )**
Successfully added user: {
    &amp;quot<span class="comment">;user&amp;quot; : &amp;quot;dba&amp;quot;,</span>
    &amp;quot<span class="comment">;roles&amp;quot; : [</span>
        {
            &amp;quot<span class="comment">;role&amp;quot; : &amp;quot;userAdminAnyDatabase&amp;quot;,</span>
            &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;admin&amp;quot;</span>
        }
    ]
}
</code></pre><p>&#x4E0A;&#x9762;&#x52A0;&#x7C97;&#x7684;&#x5C31;&#x662F;&#x6267;&#x884C;&#x7684;&#x547D;&#x4EE4;&#xFF1A;</p>
<p>user&#xFF1A;&#x7528;&#x6237;&#x540D;</p>
<p>pwd&#xFF1A;&#x5BC6;&#x7801;</p>
<p>roles&#xFF1A;&#x6307;&#x5B9A;&#x7528;&#x6237;&#x7684;&#x89D2;&#x8272;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x4E00;&#x4E2A;&#x7A7A;&#x6570;&#x7EC4;&#x7ED9;&#x65B0;&#x7528;&#x6237;&#x8BBE;&#x5B9A;&#x7A7A;&#x89D2;&#x8272;&#xFF1B;&#x5728;roles&#x5B57;&#x6BB5;,&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x5185;&#x7F6E;&#x89D2;&#x8272;&#x548C;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x7684;&#x89D2;&#x8272;&#x3002; <a href="http://docs.mongodb.org/manual/reference/built-in-roles/#built-in-roles" target="_blank" rel="external">role&#x91CC;&#x7684;&#x89D2;&#x8272;</a> &#x53EF;&#x4EE5;&#x9009;&#xFF1A; </p>
<pre><code><span class="class">Built</span>-<span class="class">In</span> <span class="class">Roles</span>&amp;<span class="symbol">#xFF08</span>;&amp;<span class="symbol">#x5185</span>;&amp;<span class="symbol">#x7F6E</span>;&amp;<span class="symbol">#x89D2</span>;&amp;<span class="symbol">#x8272</span>;&amp;<span class="symbol">#xFF09</span>;&amp;<span class="symbol">#xFF1A</span>;
    <span class="number">1.</span> &amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x636E</span>;&amp;<span class="symbol">#x5E93</span>;&amp;<span class="symbol">#x7528</span>;&amp;<span class="symbol">#x6237</span>;&amp;<span class="symbol">#x89D2</span>;&amp;<span class="symbol">#x8272</span>;&amp;<span class="symbol">#xFF1A</span>;read&amp;<span class="symbol">#x3001</span>;readWrite;
    <span class="number">2.</span> &amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x636E</span>;&amp;<span class="symbol">#x5E93</span>;&amp;<span class="symbol">#x7BA1</span>;&amp;<span class="symbol">#x7406</span>;&amp;<span class="symbol">#x89D2</span>;&amp;<span class="symbol">#x8272</span>;&amp;<span class="symbol">#xFF1A</span>;dbAdmin&amp;<span class="symbol">#x3001</span>;dbOwner&amp;<span class="symbol">#x3001</span>;userAdmin&amp;<span class="symbol">#xFF1B</span>;
    <span class="number">3.</span> &amp;<span class="symbol">#x96C6</span>;&amp;<span class="symbol">#x7FA4</span>;&amp;<span class="symbol">#x7BA1</span>;&amp;<span class="symbol">#x7406</span>;&amp;<span class="symbol">#x89D2</span>;&amp;<span class="symbol">#x8272</span>;&amp;<span class="symbol">#xFF1A</span>;clusterAdmin&amp;<span class="symbol">#x3001</span>;clusterManager&amp;<span class="symbol">#x3001</span>;clusterMonitor&amp;<span class="symbol">#x3001</span>;hostManager&amp;<span class="symbol">#xFF1B</span>;
    <span class="number">4.</span> &amp;<span class="symbol">#x5907</span>;&amp;<span class="symbol">#x4EFD</span>;&amp;<span class="symbol">#x6062</span>;&amp;<span class="symbol">#x590D</span>;&amp;<span class="symbol">#x89D2</span>;&amp;<span class="symbol">#x8272</span>;&amp;<span class="symbol">#xFF1A</span>;backup&amp;<span class="symbol">#x3001</span>;restore&amp;<span class="symbol">#xFF1B</span>;
    <span class="number">5.</span> &amp;<span class="symbol">#x6240</span>;&amp;<span class="symbol">#x6709</span>;&amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x636E</span>;&amp;<span class="symbol">#x5E93</span>;&amp;<span class="symbol">#x89D2</span>;&amp;<span class="symbol">#x8272</span>;&amp;<span class="symbol">#xFF1A</span>;readAnyDatabase&amp;<span class="symbol">#x3001</span>;readWriteAnyDatabase&amp;<span class="symbol">#x3001</span>;userAdminAnyDatabase&amp;<span class="symbol">#x3001</span>;dbAdminAnyDatabase
    <span class="number">6.</span> &amp;<span class="symbol">#x8D85</span>;&amp;<span class="symbol">#x7EA7</span>;&amp;<span class="symbol">#x7528</span>;&amp;<span class="symbol">#x6237</span>;&amp;<span class="symbol">#x89D2</span>;&amp;<span class="symbol">#x8272</span>;&amp;<span class="symbol">#xFF1A</span>;root  
    // &amp;<span class="symbol">#x8FD9</span>;&amp;<span class="symbol">#x91CC</span>;&amp;<span class="symbol">#x8FD8</span>;&amp;<span class="symbol">#x6709</span>;&amp;<span class="symbol">#x51E0</span>;&amp;<span class="symbol">#x4E2A</span>;&amp;<span class="symbol">#x89D2</span>;&amp;<span class="symbol">#x8272</span>;&amp;<span class="symbol">#x95F4</span>;&amp;<span class="symbol">#x63A5</span>;&amp;<span class="symbol">#x6216</span>;&amp;<span class="symbol">#x76F4</span>;&amp;<span class="symbol">#x63A5</span>;&amp;<span class="symbol">#x63D0</span>;&amp;<span class="symbol">#x4F9B</span>;&amp;<span class="symbol">#x4E86</span>;&amp;<span class="symbol">#x7CFB</span>;&amp;<span class="symbol">#x7EDF</span>;&amp;<span class="symbol">#x8D85</span>;&amp;<span class="symbol">#x7EA7</span>;&amp;<span class="symbol">#x7528</span>;&amp;<span class="symbol">#x6237</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x8BBF</span>;&amp;<span class="symbol">#x95EE</span>;&amp;<span class="symbol">#xFF08</span>;dbOwner &amp;<span class="symbol">#x3001</span>;userAdmin&amp;<span class="symbol">#x3001</span>;userAdminAnyDatabase&amp;<span class="symbol">#xFF09</span>;
    <span class="number">7.</span> &amp;<span class="symbol">#x5185</span>;&amp;<span class="symbol">#x90E8</span>;&amp;<span class="symbol">#x89D2</span>;&amp;<span class="symbol">#x8272</span>;&amp;<span class="symbol">#xFF1A</span>;__system  
</code></pre><p>&#x521A;&#x5EFA;&#x7ACB;&#x4E86;&#xA0;userAdminAnyDatabase&#xA0;&#x89D2;&#x8272;&#xFF0C;&#x7528;&#x6765;&#x7BA1;&#x7406;&#x7528;&#x6237;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x89D2;&#x8272;&#x6765;&#x521B;&#x5EFA;&#x3001;&#x5220;&#x9664;&#x7528;&#x6237;&#x3002;&#x9A8C;&#x8BC1;&#xFF1A;&#x9700;&#x8981;&#x5F00;&#x542F;auth&#x53C2;&#x6570;&#x3002; </p>
<pre><code>root@zhoujinyi:/usr/local/mongo4<span class="array"># mongo </span>--port=<span class="number">27020</span>
MongoDB shell version: <span class="number">3.0</span>.4
connecting to: <span class="number">127.0</span>.0.1:<span class="number">27020</span>/test
&amp;gt; show dbs;    **####&amp;<span class="array">#x</span>6CA1;&amp;<span class="array">#x</span>6709;&amp;<span class="array">#x</span>9A8C;&amp;<span class="array">#x</span>8BC1;&amp;<span class="array">#xFF</span>0C;&amp;<span class="array">#x</span>5BFC;&amp;<span class="array">#x</span>81F4;&amp;<span class="array">#x</span>6CA1;&amp;<span class="array">#x</span>6743;&amp;<span class="array">#x</span>9650;&amp;<span class="array">#x</span>3002;**<span class="number">2015</span>-<span class="number">06</span>-<span class="number">29</span>T10:<span class="number">02</span>:<span class="number">16.634</span>-<span class="number">0400</span> E QUERY    Error: listDatabases failed:{
    &amp;quot;ok&amp;quot; : <span class="number">0</span>,
    &amp;quot;errmsg&amp;quot; : &amp;quot;not authorized on admin to execute command { listDatabases: <span class="number">1.0</span> }&amp;quot;,
    &amp;quot;code&amp;quot; : <span class="number">13</span>
}
    at Error (&amp;lt;anonymous&amp;gt;)
    at Mongo.getDBs (src/mongo/shell/mongo.js:<span class="number">47</span>:<span class="number">15</span>)
    at shellHelper.show (src/mongo/shell/utils.js:<span class="number">630</span>:<span class="number">33</span>)
    at shellHelper (src/mongo/shell/utils.js:<span class="number">524</span>:<span class="number">36</span>)
    at (shellhelp2):<span class="number">1</span>:<span class="number">1</span> at src/mongo/shell/mongo.js:<span class="number">47</span>
&amp;gt; use admin        **#&amp;<span class="array">#x</span>9A8C;&amp;<span class="array">#x</span>8BC1;&amp;<span class="array">#xFF</span>0C;&amp;<span class="array">#x</span>56E0;&amp;<span class="array">#x</span>4E3A;&amp;<span class="array">#x</span>5728;admin&amp;<span class="array">#x</span>4E0B;&amp;<span class="array">#x</span>9762;&amp;<span class="array">#x</span>6DFB;&amp;<span class="array">#x</span>52A0;&amp;<span class="array">#x</span>7684;&amp;<span class="array">#x</span>5E10;&amp;<span class="array">#x</span>53F7;&amp;<span class="array">#xFF</span>0C;&amp;<span class="array">#x</span>6240;&amp;<span class="array">#x</span>4EE5;&amp;<span class="array">#x</span>8981;&amp;<span class="array">#x</span>5230;admin&amp;<span class="array">#x</span>4E0B;&amp;<span class="array">#x</span>9762;&amp;<span class="array">#x</span>9A8C;&amp;<span class="array">#x</span>8BC1;&amp;<span class="array">#x</span>3002;**
switched to db admin
&amp;gt; **db.auth**(&amp;apos;dba&amp;apos;,&amp;apos;dba&amp;apos;)
<span class="number">1</span>
&amp;gt; show dbs;
admin  <span class="number">0.078</span>GB
local  <span class="number">0.078</span>GB
&amp;gt; use test        **#&amp;<span class="array">#x</span>5728;test&amp;<span class="array">#x</span>5E93;&amp;<span class="array">#x</span>91CC;&amp;<span class="array">#x</span>521B;&amp;<span class="array">#x</span>5EFA;&amp;<span class="array">#x</span>5E10;&amp;<span class="array">#x</span>53F7;**
switched to db test
&amp;gt;**db.createUser**(
...     {
...       user: &amp;quot;zjyr&amp;quot;,
...       pwd: &amp;quot;zjyr&amp;quot;,
...       roles: [
...          { role: &amp;quot;read&amp;quot;, db: &amp;quot;test&amp;quot; }    **#&amp;<span class="array">#x</span>53EA;&amp;<span class="array">#x</span>8BFB;&amp;<span class="array">#x</span>5E10;&amp;<span class="array">#x</span>53F7;**
...       ]
...     }
... )
Successfully added user: {
    &amp;quot;user&amp;quot; : &amp;quot;zjyr&amp;quot;,
    &amp;quot;roles&amp;quot; : [
        {
            &amp;quot;role&amp;quot; : &amp;quot;read&amp;quot;,
            &amp;quot;db&amp;quot; : &amp;quot;test&amp;quot;
        }
    ]
}
&amp;gt;**db.createUser**(
...     {
...       user: &amp;quot;zjy&amp;quot;,
...       pwd: &amp;quot;zjy&amp;quot;,
...       roles: [
...          { role: &amp;quot;readWrite&amp;quot;, db: &amp;quot;test&amp;quot; }   #&amp;<span class="array">#x</span>8BFB;&amp;<span class="array">#x</span>5199;&amp;<span class="array">#x</span>5E10;&amp;<span class="array">#x</span>53F7;
...       ]
...     }
... )
Successfully added user: {
    &amp;quot;user&amp;quot; : &amp;quot;zjy&amp;quot;,
    &amp;quot;roles&amp;quot; : [
        {
            &amp;quot;role&amp;quot; : &amp;quot;readWrite&amp;quot;,               **#&amp;<span class="array">#x</span>8BFB;&amp;<span class="array">#x</span>5199;&amp;<span class="array">#x</span>8D26;&amp;<span class="array">#x</span>53F7;**
            &amp;quot;db&amp;quot; : &amp;quot;test&amp;quot;
        }
    ]
}
&amp;gt; show users;                                    **#&amp;<span class="array">#x</span>67E5;&amp;<span class="array">#x</span>770B;&amp;<span class="array">#x</span>5F53;&amp;<span class="array">#x</span>524D;&amp;<span class="array">#x</span>5E93;&amp;<span class="array">#x</span>4E0B;&amp;<span class="array">#x</span>7684;&amp;<span class="array">#x</span>7528;&amp;<span class="array">#x</span>6237;**
{
    &amp;quot;_id&amp;quot; : &amp;quot;test.zjyr&amp;quot;,
    &amp;quot;user&amp;quot; : &amp;quot;zjyr&amp;quot;,
    &amp;quot;db&amp;quot; : &amp;quot;test&amp;quot;,
    &amp;quot;roles&amp;quot; : [
        {
            &amp;quot;role&amp;quot; : &amp;quot;read&amp;quot;,
            &amp;quot;db&amp;quot; : &amp;quot;test&amp;quot;
        }
    ]
}
{
    &amp;quot;_id&amp;quot; : &amp;quot;test.zjy&amp;quot;,
    &amp;quot;user&amp;quot; : &amp;quot;zjy&amp;quot;,
    &amp;quot;db&amp;quot; : &amp;quot;test&amp;quot;,
    &amp;quot;roles&amp;quot; : [
        {
            &amp;quot;role&amp;quot; : &amp;quot;readWrite&amp;quot;,
            &amp;quot;db&amp;quot; : &amp;quot;test&amp;quot;
        }
    ]
}
</code></pre><p>&#x4E0A;&#x9762;&#x521B;&#x5EFA;&#x4E86;2&#x4E2A;&#x5E10;&#x53F7;&#xFF0C;&#x73B0;&#x5728;&#x9A8C;&#x8BC1;&#x4E0B;&#xFF1A;&#x9A8C;&#x8BC1;&#x524D;&#x63D0;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x96C6;&#x5408;</p>
<pre><code>&amp;gt; db.abc.insert({&amp;quot;a&amp;quot;:<span class="number">1</span>,&amp;quot;b&amp;quot;:<span class="number">2</span>})             **#&amp;<span class="symbol">#x63D2</span>;&amp;<span class="symbol">#x5165</span>;&amp;<span class="symbol">#x5931</span>;&amp;<span class="symbol">#x8D25</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x6CA1</span>;&amp;<span class="symbol">#x6709</span>;&amp;<span class="symbol">#x6743</span>;&amp;<span class="symbol">#x9650</span>;&amp;<span class="symbol">#xFF0C</span>;userAdminAnyDatabase &amp;<span class="symbol">#x6743</span>;&amp;<span class="symbol">#x9650</span>;&amp;<span class="symbol">#x53EA</span>;&amp;<span class="symbol">#x662F</span>;&amp;<span class="symbol">#x9488</span>;&amp;<span class="symbol">#x5BF9</span>;&amp;<span class="symbol">#x7528</span>;&amp;<span class="symbol">#x6237</span>;&amp;<span class="symbol">#x7BA1</span>;&amp;<span class="symbol">#x7406</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x5BF9</span>;&amp;<span class="symbol">#x5176</span>;&amp;<span class="symbol">#x4ED6</span>;&amp;<span class="symbol">#x662F</span>;&amp;<span class="symbol">#x6CA1</span>;&amp;<span class="symbol">#x6709</span>;&amp;<span class="symbol">#x6743</span>;&amp;<span class="symbol">#x9650</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x3002</span>;**
<span class="class">WriteResult</span>({
    &amp;quot;writeError&amp;quot; : {
        &amp;quot;code&amp;quot; : <span class="number">13</span>,
        &amp;quot;errmsg&amp;quot; : &amp;quot;not authorized on test to execute command { <span class="method">insert:</span> \&amp;quot;abc\&amp;quot;, <span class="method">documents:</span> [ { _<span class="method">id:</span> <span class="class">ObjectId</span>(&amp;apos;<span class="number">55915185</span>d629831d887ce2cb&amp;apos;), <span class="method">a:</span> <span class="number">1.0</span>, <span class="method">b:</span> <span class="number">2.0</span> } ], <span class="method">ordered:</span> <span class="keyword">true</span> }&amp;quot;
    }
})
&amp;gt; 
bye
root@<span class="method">zhoujinyi:</span>/usr/local/mongo4# mongo --port=<span class="number">27020</span>
<span class="class">MongoDB</span> shell <span class="method">version:</span> <span class="number">3.0</span>.4
connecting <span class="method">to:</span> <span class="number">127.0</span>.0.1:<span class="number">27020</span>/test
&amp;gt; use test
switched to db test
&amp;gt; db.auth(&amp;apos;zjy&amp;apos;,&amp;apos;zjy&amp;apos;)      **#&amp;<span class="symbol">#x7528</span>;&amp;<span class="symbol">#x521B</span>;&amp;<span class="symbol">#x5EFA</span>;&amp;<span class="symbol">#x7684</span>;readWrite&amp;<span class="symbol">#x5E10</span>;&amp;<span class="symbol">#x53F7</span>;&amp;<span class="symbol">#x8FDB</span>;&amp;<span class="symbol">#x884C</span>;&amp;<span class="symbol">#x5199</span>;&amp;<span class="symbol">#x5165</span>;**<span class="number">1</span>
&amp;gt; db.abc.insert({&amp;quot;a&amp;quot;:<span class="number">1</span>,&amp;quot;b&amp;quot;:<span class="number">2</span>})
<span class="class">WriteResult</span>({ &amp;quot;nInserted&amp;quot; : <span class="number">1</span> })
&amp;gt; db.abc.insert({&amp;quot;a&amp;quot;:<span class="number">11</span>,&amp;quot;b&amp;quot;:<span class="number">22</span>})
<span class="class">WriteResult</span>({ &amp;quot;nInserted&amp;quot; : <span class="number">1</span> })
&amp;gt; db.abc.insert({&amp;quot;a&amp;quot;:<span class="number">111</span>,&amp;quot;b&amp;quot;:<span class="number">222</span>})
<span class="class">WriteResult</span>({ &amp;quot;nInserted&amp;quot; : <span class="number">1</span> })
&amp;gt; db.abc.find()
{ &amp;quot;_id&amp;quot; : <span class="class">ObjectId</span>(&amp;quot;<span class="number">559151</span>a1b78649ebd8316853&amp;quot;), &amp;quot;a&amp;quot; : <span class="number">1</span>, &amp;quot;b&amp;quot; : <span class="number">2</span> }
{ &amp;quot;_id&amp;quot; : <span class="class">ObjectId</span>(&amp;quot;<span class="number">559151</span>cab78649ebd8316854&amp;quot;), &amp;quot;a&amp;quot; : <span class="number">11</span>, &amp;quot;b&amp;quot; : <span class="number">22</span> }
{ &amp;quot;_id&amp;quot; : <span class="class">ObjectId</span>(&amp;quot;<span class="number">559151</span>ceb78649ebd8316855&amp;quot;), &amp;quot;a&amp;quot; : <span class="number">111</span>, &amp;quot;b&amp;quot; : <span class="number">222</span> }
&amp;gt; db.auth(&amp;apos;zjyr&amp;apos;,&amp;apos;zjyr&amp;apos;)      **#&amp;<span class="symbol">#x5207</span>;&amp;<span class="symbol">#x6362</span>;&amp;<span class="symbol">#x5230</span>;&amp;<span class="symbol">#x53EA</span>;&amp;<span class="symbol">#x6709</span>;read&amp;<span class="symbol">#x6743</span>;&amp;<span class="symbol">#x9650</span>;&amp;<span class="symbol">#x7684</span>;&amp;<span class="symbol">#x5E10</span>;&amp;<span class="symbol">#x53F7</span>;**<span class="number">1</span>
&amp;gt; db.abc.insert({&amp;quot;a&amp;quot;:<span class="number">1111</span>,&amp;quot;b&amp;quot;:<span class="number">2222</span>})  **#&amp;<span class="symbol">#x4E0D</span>;&amp;<span class="symbol">#x80FD</span>;&amp;<span class="symbol">#x5199</span>;&amp;<span class="symbol">#x5165</span>;**
<span class="class">WriteResult</span>({
    &amp;quot;writeError&amp;quot; : {
        &amp;quot;code&amp;quot; : <span class="number">13</span>,
        &amp;quot;errmsg&amp;quot; : &amp;quot;not authorized on test to execute command { <span class="method">insert:</span> \&amp;quot;abc\&amp;quot;, <span class="method">documents:</span> [ { _<span class="method">id:</span> <span class="class">ObjectId</span>(&amp;apos;<span class="number">559151</span>ebb78649ebd8316856&amp;apos;), <span class="method">a:</span> <span class="number">1111.0</span>, <span class="method">b:</span> <span class="number">2222.0</span> } ], <span class="method">ordered:</span> <span class="keyword">true</span> }&amp;quot;
    }
})
&amp;gt; db.abc.find()        **#&amp;<span class="symbol">#x53EF</span>;&amp;<span class="symbol">#x4EE5</span>;&amp;<span class="symbol">#x67E5</span>;&amp;<span class="symbol">#x770B</span>;**
{ &amp;quot;_id&amp;quot; : <span class="class">ObjectId</span>(&amp;quot;<span class="number">559151</span>a1b78649ebd8316853&amp;quot;), &amp;quot;a&amp;quot; : <span class="number">1</span>, &amp;quot;b&amp;quot; : <span class="number">2</span> }
{ &amp;quot;_id&amp;quot; : <span class="class">ObjectId</span>(&amp;quot;<span class="number">559151</span>cab78649ebd8316854&amp;quot;), &amp;quot;a&amp;quot; : <span class="number">11</span>, &amp;quot;b&amp;quot; : <span class="number">22</span> }
{ &amp;quot;_id&amp;quot; : <span class="class">ObjectId</span>(&amp;quot;<span class="number">559151</span>ceb78649ebd8316855&amp;quot;), &amp;quot;a&amp;quot; : <span class="number">111</span>, &amp;quot;b&amp;quot; : <span class="number">222</span> }
</code></pre><p>&#x6709;&#x6CA1;&#x6709;&#x4E00;&#x4E2A;&#x8D85;&#x7EA7;&#x6743;&#x9650;&#xFF1F;&#x4E0D;&#x4EC5;&#x53EF;&#x4EE5;&#x6388;&#x6743;&#xFF0C;&#x800C;&#x4E14;&#x4E5F;&#x53EF;&#x4EE5;&#x5BF9;&#x96C6;&#x5408;&#x8FDB;&#x884C;&#x4EFB;&#x610F;&#x64CD;&#x4F5C;&#xFF1F;&#x7B54;&#x6848;&#x662F;&#x80AF;&#x5B9A;&#x7684;&#xFF0C;&#x53EA;&#x662F;&#x4E0D;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;&#x3002;&#x90A3;&#x5C31;&#x662F;role&#x89D2;&#x8272;&#x8BBE;&#x7F6E;&#x6210;root&#x3002; </p>
<pre><code>&amp;gt<span class="comment">; db.auth(&amp;apos;dba&amp;apos;,&amp;apos;dba&amp;apos;)</span>
1
&amp;gt<span class="comment">;**db.createUser**(</span>
...  {
...    user: &amp;quot<span class="comment">;zhoujinyi&amp;quot;,</span>
...    pwd: &amp;quot<span class="comment">;zhoujinyi&amp;quot;,</span>
...    roles: [
...       { role: &amp;quot<span class="comment">;**root**&amp;quot;, db: &amp;quot;admin&amp;quot; }      **#&amp;#x8D85;&amp;#x7EA7;root&amp;#x5E10;&amp;#x53F7;**</span>
...    ]
...  }
... )
Successfully added user: {
    &amp;quot<span class="comment">;user&amp;quot; : &amp;quot;zhoujinyi&amp;quot;,</span>
    &amp;quot<span class="comment">;roles&amp;quot; : [</span>
        {
            &amp;quot<span class="comment">;role&amp;quot; : &amp;quot;root&amp;quot;,</span>
            &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;admin&amp;quot;</span>
        }
    ]
}
&amp;gt<span class="comment">; </span>
&amp;gt<span class="comment">;**show users;              #&amp;#x67E5;&amp;#x770B;&amp;#x5F53;&amp;#x524D;&amp;#x5E93;&amp;#x4E0B;&amp;#x7684;&amp;#x7528;&amp;#x6237;**</span>
{
    &amp;quot<span class="comment">;_id&amp;quot; : &amp;quot;admin.dba&amp;quot;,</span>
    &amp;quot<span class="comment">;user&amp;quot; : &amp;quot;dba&amp;quot;,</span>
    &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;admin&amp;quot;,</span>
    &amp;quot<span class="comment">;roles&amp;quot; : [</span>
        {
            &amp;quot<span class="comment">;role&amp;quot; : &amp;quot;userAdminAnyDatabase&amp;quot;,</span>
            &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;admin&amp;quot;</span>
        }
    ]
}
{
    &amp;quot<span class="comment">;_id&amp;quot; : &amp;quot;admin.zhoujinyi&amp;quot;,</span>
    &amp;quot<span class="comment">;user&amp;quot; : &amp;quot;zhoujinyi&amp;quot;,</span>
    &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;admin&amp;quot;,</span>
    &amp;quot<span class="comment">;roles&amp;quot; : [</span>
        {
            &amp;quot<span class="comment">;role&amp;quot; : &amp;quot;root&amp;quot;,</span>
            &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;admin&amp;quot;</span>
        }
    ]
}
&amp;gt<span class="comment">; use admin</span>
switched to db admin
&amp;gt<span class="comment">; db.auth(&amp;apos;zhoujinyi&amp;apos;,&amp;apos;zhoujinyi&amp;apos;)</span>
1
&amp;gt<span class="comment">; use test</span>
switched to db test
&amp;gt<span class="comment">; db.abc.insert({&amp;quot;a&amp;quot;:1,&amp;quot;b&amp;quot;:2})</span>
WriteResult({ &amp;quot<span class="comment">;nInserted&amp;quot; : 1 })</span>
&amp;gt<span class="comment">; db.abc.insert({&amp;quot;a&amp;quot;:1111,&amp;quot;b&amp;quot;:2222})         **#&amp;#x6743;&amp;#x9650;&amp;#x90FD;&amp;#x6709;**</span>
WriteResult({ &amp;quot<span class="comment">;nInserted&amp;quot; : 1 })</span>
&amp;gt<span class="comment">; db.abc.find()</span>
{ &amp;quot<span class="comment">;_id&amp;quot; : ObjectId(&amp;quot;5591539bb78649ebd8316857&amp;quot;), &amp;quot;a&amp;quot; : 1, &amp;quot;b&amp;quot; : 2 }</span>
{ &amp;quot<span class="comment">;_id&amp;quot; : ObjectId(&amp;quot;559153a0b78649ebd8316858&amp;quot;), &amp;quot;a&amp;quot; : 1111, &amp;quot;b&amp;quot; : 2222 }</span>
&amp;gt<span class="comment">; db.abc.remove({})</span>
WriteResult({ &amp;quot<span class="comment">;nRemoved&amp;quot; : 2 })</span>
</code></pre><p>&#x56E0;&#x4E3A;&#x5E10;&#x53F7;&#x90FD;&#x662F;&#x5728;&#x5F53;&#x524D;&#x9700;&#x8981;&#x6388;&#x6743;&#x7684;&#x6570;&#x636E;&#x5E93;&#x4E0B;&#x6388;&#x6743;&#x7684;&#xFF0C;&#x90A3;&#x8981;&#x662F;&#x4E0D;&#x5728;&#x5F53;&#x524D;&#x6570;&#x636E;&#x5E93;&#x4E0B;&#x4F1A;&#x600E;&#x4E48;&#x6837;&#xFF1F;</p>
<pre><code>&amp;gt; db
admin
&amp;gt;**db.createUser**(
...  {
...    user: &amp;quot;dxy&amp;quot;,
...    pwd: &amp;quot;dxy&amp;quot;,
...    roles: [
...       { role: &amp;quot;readWrite&amp;quot;, db: &amp;quot;test&amp;quot; },     **#&amp;<span class="array">#x</span>5728;&amp;<span class="array">#x</span>5F53;&amp;<span class="array">#x</span>524D;&amp;<span class="array">#x</span>5E93;&amp;<span class="array">#x</span>4E0B;&amp;<span class="array">#x</span>521B;&amp;<span class="array">#x</span>5EFA;&amp;<span class="array">#x</span>5176;&amp;<span class="array">#x</span>4ED6;&amp;<span class="array">#x</span>5E93;&amp;<span class="array">#x</span>7684;&amp;<span class="array">#x</span>5E10;&amp;<span class="array">#x</span>53F7;&amp;<span class="array">#xFF</span>0C;&amp;<span class="array">#x</span>5728;admin&amp;<span class="array">#x</span>5E93;&amp;<span class="array">#x</span>4E0B;&amp;<span class="array">#x</span>521B;&amp;<span class="array">#x</span>5EFA;test&amp;<span class="array">#x</span>3001;abc&amp;<span class="array">#x</span>5E93;&amp;<span class="array">#x</span>7684;&amp;<span class="array">#x</span>5E10;&amp;<span class="array">#x</span>53F7;**
...       { role: &amp;quot;readWrite&amp;quot;, db: &amp;quot;abc&amp;quot; }         
...    ]
...  }
... )
Successfully added user: {
    &amp;quot;user&amp;quot; : &amp;quot;dxy&amp;quot;,
    &amp;quot;roles&amp;quot; : [
        {
            &amp;quot;role&amp;quot; : &amp;quot;readWrite&amp;quot;,
            &amp;quot;db&amp;quot; : &amp;quot;test&amp;quot;
        },
        {
            &amp;quot;role&amp;quot; : &amp;quot;readWrite&amp;quot;,
            &amp;quot;db&amp;quot; : &amp;quot;abc&amp;quot;
        }
    ]
}
&amp;gt; 
&amp;gt; show users;
{
    &amp;quot;_id&amp;quot; : &amp;quot;admin.dba&amp;quot;,
    &amp;quot;user&amp;quot; : &amp;quot;dba&amp;quot;,
    &amp;quot;db&amp;quot; : &amp;quot;admin&amp;quot;,
    &amp;quot;roles&amp;quot; : [
        {
            &amp;quot;role&amp;quot; : &amp;quot;userAdminAnyDatabase&amp;quot;,
            &amp;quot;db&amp;quot; : &amp;quot;admin&amp;quot;
        }
    ]
}
{
    &amp;quot;_id&amp;quot; : &amp;quot;admin.zhoujinyi&amp;quot;,
    &amp;quot;user&amp;quot; : &amp;quot;zhoujinyi&amp;quot;,
    &amp;quot;db&amp;quot; : &amp;quot;admin&amp;quot;,
    &amp;quot;roles&amp;quot; : [
        {
            &amp;quot;role&amp;quot; : &amp;quot;root&amp;quot;,
            &amp;quot;db&amp;quot; : &amp;quot;admin&amp;quot;
        }
    ]
}
{
    &amp;quot;_id&amp;quot; : &amp;quot;admin.dxy&amp;quot;,
    &amp;quot;user&amp;quot; : &amp;quot;dxy&amp;quot;,
    &amp;quot;db&amp;quot; : &amp;quot;admin&amp;quot;,
    &amp;quot;roles&amp;quot; : [
        {
            &amp;quot;role&amp;quot; : &amp;quot;readWrite&amp;quot;,
            &amp;quot;db&amp;quot; : &amp;quot;test&amp;quot;
        },
        {
            &amp;quot;role&amp;quot; : &amp;quot;readWrite&amp;quot;,
            &amp;quot;db&amp;quot; : &amp;quot;abc&amp;quot;
        }
    ]
}
&amp;gt; use test
switched to db test
&amp;gt; db.auth(&amp;apos;dxy&amp;apos;,&amp;apos;dxy&amp;apos;)         **#&amp;<span class="array">#x</span>5728;admin&amp;<span class="array">#x</span>4E0B;&amp;<span class="array">#x</span>521B;&amp;<span class="array">#x</span>5EFA;&amp;<span class="array">#x</span>7684;&amp;<span class="array">#x</span>5E10;&amp;<span class="array">#x</span>53F7;&amp;<span class="array">#xFF</span>0C;&amp;<span class="array">#x</span>4E0D;&amp;<span class="array">#x</span>80FD;&amp;<span class="array">#x</span>76F4;&amp;<span class="array">#x</span>63A5;&amp;<span class="array">#x</span>5728;&amp;<span class="array">#x</span>5176;&amp;<span class="array">#x</span>4ED6;&amp;<span class="array">#x</span>5E93;&amp;<span class="array">#x</span>9A8C;&amp;<span class="array">#x</span>8BC1;&amp;<span class="array">#xFF</span>0C;**Error: <span class="number">18</span> Authentication failed.
<span class="number">0</span>
&amp;gt; use admin
switched to db admin           **#&amp;<span class="array">#x</span>53EA;&amp;<span class="array">#x</span>80FD;&amp;<span class="array">#x</span>5728;&amp;<span class="array">#x</span>5E10;&amp;<span class="array">#x</span>53F7;&amp;<span class="array">#x</span>521B;&amp;<span class="array">#x</span>5EFA;&amp;<span class="array">#x</span>5E93;&amp;<span class="array">#x</span>4E0B;&amp;<span class="array">#x</span>8BA4;&amp;<span class="array">#x</span>8BC1;&amp;<span class="array">#xFF</span>0C;&amp;<span class="array">#x</span>518D;&amp;<span class="array">#x</span>53BB;&amp;<span class="array">#x</span>5176;&amp;<span class="array">#x</span>4ED6;&amp;<span class="array">#x</span>5E93;&amp;<span class="array">#x</span>8FDB;&amp;<span class="array">#x</span>884C;&amp;<span class="array">#x</span>64CD;&amp;<span class="array">#x</span>4F5C;&amp;<span class="array">#x</span>3002;**&amp;gt; db.auth(&amp;apos;dxy&amp;apos;,&amp;apos;dxy&amp;apos;)
<span class="number">1</span>
&amp;gt; use test
switched to db test
&amp;gt; db.abc.insert({&amp;quot;a&amp;quot;:<span class="number">1111</span>,&amp;quot;b&amp;quot;:<span class="number">2222</span>})
WriteResult({ &amp;quot;nInserted&amp;quot; : <span class="number">1</span> })
&amp;gt; use abc
switched to db abc
&amp;gt; db.abc.insert({&amp;quot;a&amp;quot;:<span class="number">1111</span>,&amp;quot;b&amp;quot;:<span class="number">2222</span>})
WriteResult({ &amp;quot;nInserted&amp;quot; : <span class="number">1</span> })
</code></pre><p>&#x4E0A;&#x9762;&#x66F4;&#x52A0;&#x8FDB;&#x4E00;&#x6B65;&#x8BF4;&#x660E;&#x6570;&#x636E;&#x5E93;&#x5E10;&#x53F7;&#x662F;&#x8DDF;&#x7740;&#x6570;&#x636E;&#x5E93;&#x6765;&#x8D70;&#x7684;&#xFF0C;&#x54EA;&#x91CC;&#x521B;&#x5EFA;&#x54EA;&#x91CC;&#x8BA4;&#x8BC1;&#x3002;</p>
<p>&#x521B;&#x5EFA;&#x4E86;&#x8FD9;&#x4E48;&#x591A;&#x5E10;&#x53F7;&#xFF0C;&#x600E;&#x4E48;&#x67E5;&#x770B;&#x6240;&#x6709;&#x5E10;&#x53F7;&#xFF1F; </p>
<pre><code>&amp;gt<span class="comment">;  use admin</span>
switched to db admin
&amp;gt<span class="comment">; db.auth(&amp;apos;dba&amp;apos;,&amp;apos;dba&amp;apos;)</span>
1
&amp;gt<span class="comment">;**db.system.users.find().pretty()**</span>
{
    &amp;quot<span class="comment">;_id&amp;quot; : &amp;quot;admin.dba&amp;quot;,</span>
    &amp;quot<span class="comment">;user&amp;quot; : &amp;quot;dba&amp;quot;,</span>
    &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;admin&amp;quot;,</span>
    &amp;quot<span class="comment">;credentials&amp;quot; : {</span>
        &amp;quot<span class="comment">;SCRAM-SHA-1&amp;quot; : {</span>
            &amp;quot<span class="comment">;iterationCount&amp;quot; : 10000,</span>
            &amp;quot<span class="comment">;salt&amp;quot; : &amp;quot;KfDUzCOIUo7WVjFr64ZOcQ==&amp;quot;,</span>
            &amp;quot<span class="comment">;storedKey&amp;quot; : &amp;quot;t4sPsKG2dXnZztVYj5EgdUzT9sc=&amp;quot;,</span>
            &amp;quot<span class="comment">;serverKey&amp;quot; : &amp;quot;2vCGiq9NIc1zKqeEL6VvO4rP26A=&amp;quot;</span>
        }
    },
    &amp;quot<span class="comment">;roles&amp;quot; : [</span>
        {
            &amp;quot<span class="comment">;role&amp;quot; : &amp;quot;userAdminAnyDatabase&amp;quot;,</span>
            &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;admin&amp;quot;</span>
        }
    ]
}
{
    &amp;quot<span class="comment">;_id&amp;quot; : &amp;quot;test.zjyr&amp;quot;,</span>
    &amp;quot<span class="comment">;user&amp;quot; : &amp;quot;zjyr&amp;quot;,</span>
    &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;test&amp;quot;,</span>
    &amp;quot<span class="comment">;credentials&amp;quot; : {</span>
        &amp;quot<span class="comment">;SCRAM-SHA-1&amp;quot; : {</span>
            &amp;quot<span class="comment">;iterationCount&amp;quot; : 10000,</span>
            &amp;quot<span class="comment">;salt&amp;quot; : &amp;quot;h1gOW3J7wzJuTqgmmQgJKQ==&amp;quot;,</span>
            &amp;quot<span class="comment">;storedKey&amp;quot; : &amp;quot;7lkoANdxM2py0qiDBzFaZYPp1cM=&amp;quot;,</span>
            &amp;quot<span class="comment">;serverKey&amp;quot; : &amp;quot;Qyu6IRNyaKLUvqJ2CAa/tQYY36c=&amp;quot;</span>
        }
    },
    &amp;quot<span class="comment">;roles&amp;quot; : [</span>
        {
            &amp;quot<span class="comment">;role&amp;quot; : &amp;quot;read&amp;quot;,</span>
            &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;test&amp;quot;</span>
        }
    ]
}
{
    &amp;quot<span class="comment">;_id&amp;quot; : &amp;quot;test.zjy&amp;quot;,</span>
    &amp;quot<span class="comment">;user&amp;quot; : &amp;quot;zjy&amp;quot;,</span>
    &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;test&amp;quot;,</span>
    &amp;quot<span class="comment">;credentials&amp;quot; : {</span>
        &amp;quot<span class="comment">;SCRAM-SHA-1&amp;quot; : {</span>
            &amp;quot<span class="comment">;iterationCount&amp;quot; : 10000,</span>
            &amp;quot<span class="comment">;salt&amp;quot; : &amp;quot;afwaKuTYPWwbDBduQ4Hm7g==&amp;quot;,</span>
            &amp;quot<span class="comment">;storedKey&amp;quot; : &amp;quot;ebb2LYLn4hiOVlZqgrAKBdStfn8=&amp;quot;,</span>
            &amp;quot<span class="comment">;serverKey&amp;quot; : &amp;quot;LG2qWwuuV+FNMmr9lWs+Rb3DIhQ=&amp;quot;</span>
        }
    },
    &amp;quot<span class="comment">;roles&amp;quot; : [</span>
        {
            &amp;quot<span class="comment">;role&amp;quot; : &amp;quot;readWrite&amp;quot;,</span>
            &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;test&amp;quot;</span>
        }
    ]
}
{
    &amp;quot<span class="comment">;_id&amp;quot; : &amp;quot;admin.zhoujinyi&amp;quot;,</span>
    &amp;quot<span class="comment">;user&amp;quot; : &amp;quot;zhoujinyi&amp;quot;,</span>
    &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;admin&amp;quot;,</span>
    &amp;quot<span class="comment">;credentials&amp;quot; : {</span>
        &amp;quot<span class="comment">;SCRAM-SHA-1&amp;quot; : {</span>
            &amp;quot<span class="comment">;iterationCount&amp;quot; : 10000,</span>
            &amp;quot<span class="comment">;salt&amp;quot; : &amp;quot;pE2cSOYtBOYevk8tqrwbSQ==&amp;quot;,</span>
            &amp;quot<span class="comment">;storedKey&amp;quot; : &amp;quot;TwMxdnlB5Eiaqg4tNh9ByNuUp9A=&amp;quot;,</span>
            &amp;quot<span class="comment">;serverKey&amp;quot; : &amp;quot;Mofr9ohVlFfR6/md4LMRkOhXouc=&amp;quot;</span>
        }
    },
    &amp;quot<span class="comment">;roles&amp;quot; : [</span>
        {
            &amp;quot<span class="comment">;role&amp;quot; : &amp;quot;root&amp;quot;,</span>
            &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;admin&amp;quot;</span>
        }
    ]
}
{
    &amp;quot<span class="comment">;_id&amp;quot; : &amp;quot;admin.dxy&amp;quot;,</span>
    &amp;quot<span class="comment">;user&amp;quot; : &amp;quot;dxy&amp;quot;,</span>
    &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;admin&amp;quot;,</span>
    &amp;quot<span class="comment">;credentials&amp;quot; : {</span>
        &amp;quot<span class="comment">;SCRAM-SHA-1&amp;quot; : {</span>
            &amp;quot<span class="comment">;iterationCount&amp;quot; : 10000,</span>
            &amp;quot<span class="comment">;salt&amp;quot; : &amp;quot;XD6smcWX4tdg/ZJPoLxxRg==&amp;quot;,</span>
            &amp;quot<span class="comment">;storedKey&amp;quot; : &amp;quot;F4uiayykHDp/r9krAKZjdr+gqjM=&amp;quot;,</span>
            &amp;quot<span class="comment">;serverKey&amp;quot; : &amp;quot;Kf51IU9J3RIrB8CFn5Z5hEKMSkw=&amp;quot;</span>
        }
    },
    &amp;quot<span class="comment">;roles&amp;quot; : [</span>
        {
            &amp;quot<span class="comment">;role&amp;quot; : &amp;quot;readWrite&amp;quot;,</span>
            &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;test&amp;quot;</span>
        },
        {
            &amp;quot<span class="comment">;role&amp;quot; : &amp;quot;readWrite&amp;quot;,</span>
            &amp;quot<span class="comment">;db&amp;quot; : &amp;quot;abc&amp;quot;</span>
        }
    ]
}
&amp;gt<span class="comment">; db.system.users.find().count()</span>
5
</code></pre><p>&#x5907;&#x4EFD;&#x8FD8;&#x539F;&#x4F7F;&#x7528;&#x90A3;&#x4E2A;&#x89D2;&#x8272;&#x7684;&#x5E10;&#x53F7;&#xFF1F;&#x4E4B;&#x524D;&#x521B;&#x5EFA;&#x7684;&#x5E10;&#x53F7;zjy:test&#x5E93;&#x8BFB;&#x5199;&#x6743;&#x9650;&#xFF1B;zjyr:test&#x5E93;&#x8BFB;&#x6743;&#x9650;</p>
<pre><code>root@zhoujinyi:~# **mongodump** --port=27020 -uzjyr -pzjyr --<span class="keyword">db</span>=<span class="keyword">test</span> -o backup  **#&amp;#x53EA;&amp;#x8981;&amp;#x8BFB;&amp;#x6743;&amp;#x9650;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x5907;&amp;#x4EFD;**
2015-06-29T11:20:04.864-0400    writing <span class="keyword">test</span>.abc to backup/<span class="keyword">test</span>/abc.bson
2015-06-29T11:20:04.865-0400    writing <span class="keyword">test</span>.abc metadata to backup/<span class="keyword">test</span>/abc.metadata.json
2015-06-29T11:20:04.866-0400    done dumping <span class="keyword">test</span>.abc
2015-06-29T11:20:04.867-0400    writing <span class="keyword">test</span>.system.indexes to backup/<span class="keyword">test</span>/system.indexes.bson


root@zhoujinyi:~# **mongorestore** --port=27020 -uzjy -pzjy --<span class="keyword">db</span>=<span class="keyword">test</span> backup/<span class="keyword">test</span>/  #&amp;#x8BFB;&amp;#x5199;&amp;#x6743;&amp;#x9650;&amp;#x53EF;&amp;#x4EE5;&amp;#x8FDB;&amp;#x884C;&amp;#x8FD8;&amp;#x539F;
2015-06-29T11:20:26.607-0400    building a <span class="keyword">list</span> of collections to <span class="keyword">restore</span> from backup/<span class="keyword">test</span>/ <span class="keyword">dir</span>
2015-06-29T11:20:26.609-0400    reading metadata <span class="keyword">file</span> from backup/<span class="keyword">test</span>/abc.metadata.json
2015-06-29T11:20:26.609-0400    restoring <span class="keyword">test</span>.abc from <span class="keyword">file</span> backup/<span class="keyword">test</span>/abc.bson
2015-06-29T11:20:26.611-0400    <span class="keyword">error</span>: E11000 duplicate key <span class="keyword">error</span> index: <span class="keyword">test</span>.abc.<span class="label">$_id_</span> dup key: { : ObjectId(&amp;apos;559154efb78649ebd831685a&amp;apos;) }
2015-06-29T11:20:26.611-0400    restoring indexes <span class="keyword">for</span> collection <span class="keyword">test</span>.abc from metadata
2015-06-29T11:20:26.612-0400    finished restoring <span class="keyword">test</span>.abc
2015-06-29T11:20:26.612-0400    done
</code></pre>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/MongoDB/">MongoDB</a><a href="/tags/数据库/">数据库</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/08/4da31ab/" title="mongodb运维之副本集实践 -" itemprop="url">mongodb运维之副本集实践 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-08T02:33:30.000Z" itemprop="datePublished"> 发表于 2015-07-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <pre><code><span class="keyword">&amp;</span><span class="id">#x6B63</span>;<span class="keyword">&amp;</span><span class="id">#x5F0F</span>;<span class="keyword">&amp;</span><span class="id">#x73AF</span>;<span class="keyword">&amp;</span><span class="id">#x5883</span>;<span class="keyword">&amp;</span><span class="id">#xFF0C</span>;  
</code></pre><p>4&#x53F0;&#x673A;&#x5668;+&#x4E00;&#x53F0;&#x5B9A;&#x65F6;&#x4EFB;&#x52A1;&#x7684;&#x673A;&#x5668;&#x3002;<br>&#x670D;&#x52A1;&#x5668;&#x662F;&#x963F;&#x91CC;&#x4E91;&#x7684;ECS&#xFF0C;<br>&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#x7528;&#x7684;&#x662F;&#x963F;&#x91CC;&#x4E91;&#x7684;SLB&#xFF0C;<br>mysql&#x7528;&#x963F;&#x91CC;&#x4E91;&#x7684;RDS&#xFF0C;<br>&#x7F13;&#x5B58;&#x7528;&#x963F;&#x91CC;&#x4E91;&#x7684;OCS&#xFF0C;<br>&#x8FD0;&#x7EF4;&#x57FA;&#x672C;&#x4E0A;&#x662F;&#x90FD;&#x4E0D;&#x9700;&#x8981;&#x62C5;&#x5FC3;&#x4E86;&#xFF0C;<br>&#x73B0;&#x5728;&#x7684;&#x4E91;&#x670D;&#x52A1;&#x5DF2;&#x7ECF;&#x975E;&#x5E38;&#x5B8C;&#x5584;&#x4E86;&#xFF0C;<br>&#x5176;&#x5B9E;&#x6211;&#x4EEC;&#x7528;&#x963F;&#x91CC;&#x4E91;&#x7684;&#x670D;&#x52A1;&#x975E;&#x5E38;&#x591A;&#xFF0C;<br>&#x5927;&#x6982;&#x6709;20&#x591A;&#x4E2A;&#x7C7B;&#x578B;&#x7684;&#x670D;&#x52A1;&#xFF0C;<br>&#x611F;&#x8C22;&#x963F;&#x91CC;&#x4E91;&#x3002; </p>
<p>&#x800C;&#x6211;&#x7684;&#x6280;&#x672F;&#x6808;&#x662F;nodejs + mongodb&#xFF0C;&#x800C;&#x963F;&#x91CC;&#x4E91;&#x6709;k-v&#x517C;&#x5BB9;redis&#x534F;&#x8BAE;&#x7684;nosql&#xFF0C;&#x65E0;mongodb&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x8981;&#x60B2;&#x5267;&#x7684;&#x81EA;&#x5DF1;&#x8FD0;&#x7EF4;mongodb&#x4E86;&#x3002;</p>
<p>&#x963F;&#x91CC;&#x7684;ots&#x662F;&#x975E;&#x7ED3;&#x6784;&#x5316;&#x5B58;&#x50A8;&#xFF0C;&#x6CA1;&#x6709;nodejs&#x7684;sdk&#xFF0C;&#x5C31;&#x7B97;&#x6709;&#xFF0C;&#x4E0D;&#x517C;&#x5BB9;mongodb&#xFF0C;&#x4E5F;&#x6CA1;&#x5565;&#x53EF;&#x73A9;&#x7684;&#x3002;</p>
<h2 id="&#x4E91;&#x670D;&#x52A1;">&#x4E91;&#x670D;&#x52A1;</h2><p>MongoDB&#x5B58;&#x50A8;&#x670D;&#x52A1;&#x7684;&#x4E91;&#x5E73;&#x53F0;&#xFF08;MongoHQ, MongoLabs &#x548C; Mongo Machine&#xFF09;</p>
<p>&#x56FD;&#x5185;&#x7684;&#x8C8C;&#x4F3C;&#x53EA;&#x6709; <a href="http://developer.baidu.com/wiki/index.php?title=docs/cplat/bae/mongodb" target="_blank" rel="external">http://developer.baidu.com/wiki/index.php?title=docs/cplat/bae/mongodb</a></p>
<p>&#x828B;&#x5934;&#x63A8;&#x8350;&#x7528;pg&#xFF0C;&#x652F;&#x6301;json&#x683C;&#x5F0F;&#x5B58;&#x50A8;</p>
<p>&#x8FD8;&#x6709;&#x5C31;&#x662F;parse&#x548C;leancloud&#x8FD9;&#x7C7B;&#x9762;&#x5411;api&#x7684;&#x3002;</p>
<p>&#x4EAC;&#x4E1C;&#x548C;&#x817E;&#x8BAF;&#x90FD;&#x6709;&#x8FC7;&#xFF0C;&#x540E;&#x6765;&#x5173;&#x95ED;&#x4E86;&#xFF0C;&#x4E0D;&#x77E5;&#x4F55;&#x6545;</p>
<h2 id="mongodb&#x90E8;&#x7F72;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;">mongodb&#x90E8;&#x7F72;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;</h2><p>&#x5E38;&#x8BC6;&#xFF1A; replset + shard</p>
<p>replset&#x662F;&#x526F;&#x672C;&#x96C6;&#xFF0C;shard&#x662F;&#x5206;&#x7247;</p>
<p>mongoDB&#x7684;&#x4E3B;&#x4ECE;&#x6A21;&#x5F0F;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x5355;&#x526F;&#x672C;&#x7684;&#x5E94;&#x7528;&#xFF0C;&#x6CA1;&#x6709;&#x5F88;&#x597D;&#x7684;&#x6269;&#x5C55;&#x6027;&#x548C;&#x5BB9;&#x9519;&#x6027;&#x3002;&#x800C;&#x526F;&#x672C;&#x96C6;&#x5177;&#x6709;&#x591A;&#x4E2A;&#x526F;&#x672C;&#x4FDD;&#x8BC1;&#x4E86;&#x5BB9;&#x9519;&#x6027;&#xFF0C;&#x5C31;&#x7B97;&#x4E00;&#x4E2A;&#x526F;&#x672C;&#x6302;&#x6389;&#x4E86;&#x8FD8;&#x6709;&#x5F88;&#x591A;&#x526F;&#x672C;&#x5B58;&#x5728;&#xFF0C;&#x5E76;&#x4E14;&#x89E3;&#x51B3;&#x4E86;&#x4E0A;&#x9762;&#x7B2C;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x201C;&#x4E3B;&#x8282;&#x70B9;&#x6302;&#x6389;&#x4E86;&#xFF0C;&#x6574;&#x4E2A;&#x96C6;&#x7FA4;&#x5185;&#x4F1A;&#x81EA;&#x52A8;&#x5207;&#x6362;&#x201D;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#x6E38;&#x620F;&#xFF0C;&#x5F00;&#x4E86;&#x67D0;&#x4E00;&#x4E2A;&#x670D;&#xFF0C;&#x90A3;&#x4E48;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;&#x90FD;&#x5728;&#x4E00;&#x53F0;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#xFF0C;&#x6B64;&#x65F6;&#x5B83;&#x8981;&#x4FDD;&#x8BC1;&#x7684;&#x662F;&#x670D;&#x52A1;&#x4E0D;&#x6302;&#x5C31;&#x53EF;&#x4EE5;&#xFF0C;&#x4E0D;&#x7528;&#x8003;&#x8651;&#x66F4;&#x591A;&#x7684;&#x5E76;&#x53D1;&#x4E0A;&#x7684;&#x538B;&#x529B;&#xFF0C;&#x90A3;&#x4E48;&#x5B83;&#x9996;&#x5148;&#x662F;&#x526F;&#x672C;&#x96C6;&#x3002;</p>
<p><img src="http://taojinke.github.io/img/20150708/4d99a4d.png" alt=""></p>
<p>&#x5982;&#x679C;&#x6709;&#x8282;&#x70B9;&#x6302;&#x4E86;&#xFF0C;&#x5B83;&#x4F1A;&#x91CD;&#x65B0;&#x9009;&#x4E3E;&#x65B0;&#x7684;&#x4E3B;&#x8282;&#x70B9;</p>
<p><img src="http://taojinke.github.io/img/20150708/4d99cbe.png" alt=""></p>
<p>&#x800C;&#x66F4;&#x591A;&#x7684;&#x60C5;&#x51B5;&#x662F;&#xFF0C;&#x4F60;&#x8981;&#x8003;&#x8651;&#x5E76;&#x53D1;&#xFF0C;&#x800C;&#x4E14;&#x53EF;&#x80FD;&#x662F;&#x5343;&#x4E07;&#xFF0C;&#x4EBF;&#x4E07;&#x5E76;&#x53D1;&#xFF0C;&#x526F;&#x672C;&#x96C6;&#x662F;&#x641E;&#x4E0D;&#x5B9A;&#x7684;&#x3002;</p>
<p>&#x4E8E;&#x662F;shard&#x5C31;&#x767B;&#x573A;&#x4E86;&#x3002;</p>
<p>&#x5206;&#x7247;&#x5E76;&#x4E0D;&#x662F;mongo&#x72EC;&#x6709;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x5F88;&#x591A;&#x6570;&#x636E;&#x5E93;&#x90FD;&#x6709;&#xFF0C;mongodb&#x91CC;&#x7684;&#x5206;&#x7247;&#x662F;&#x6307;&#x901A;&#x8FC7;mongos&#x6765;&#x5F53;&#x7F51;&#x5173;&#x8DEF;&#x7531;&#xFF0C;&#x5206;&#x53D1;&#x8BF7;&#x6C42;&#x5230;&#x6BCF;&#x4E2A;shard&#xFF0C;&#x7136;&#x540E;&#x6BCF;&#x4E2A;shard&#x4F1A;&#x5BF9;&#x5E94;&#x5404;&#x81EA;&#x7684;&#x526F;&#x672C;&#x96C6;&#x3002;</p>
<p>&#x65E2;&#x7136;&#x662F;&#x5206;&#x53D1;&#x8BF7;&#x6C42;&#xFF0C;&#x5C31;&#x4F1A;&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x6027;&#x80FD;&#x635F;&#x8017;&#xFF0C;&#x4F46;&#x597D;&#x5904;&#x662F;&#x4F60;&#x80FD;&#x5904;&#x7406;&#x66F4;&#x591A;&#x8BF7;&#x6C42;&#x3002;&#x6240;&#x4EE5;&#x6309;&#x7167;&#x573A;&#x666F;&#x9009;&#x62E9;</p>
<ul>
<li>&#x6027;&#x80FD;&#x6700;&#x4F73;&#xFF0C;&#x5F53;&#x7136;&#x662F;&#x4E00;&#x4E2A;&#x526F;&#x672C;&#x96C6;&#xFF0C;&#x5982;&#x679C;&#x80FD;&#x6EE1;&#x8DB3;&#x9700;&#x6C42;&#xFF0C;&#x4F18;&#x5148;</li>
<li>&#x5982;&#x679C;&#x526F;&#x672C;&#x96C6;&#x4E0D;&#x8DB3;&#x53CA;&#x652F;&#x6491;&#x5E76;&#x53D1;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x9009;shard</li>
</ul>
<h2 id="&#x51C6;&#x5907;3&#x53F0;&#x963F;&#x91CC;&#x4E91;&#x4E3B;&#x673A;">&#x51C6;&#x5907;3&#x53F0;&#x963F;&#x91CC;&#x4E91;&#x4E3B;&#x673A;</h2><ul>
<li>10.51.83.118</li>
<li>10.51.77.129</li>
<li>10.44.204.241</li>
</ul>
<p>&#x5148;&#x5404;&#x81EA;ping&#x4E00;&#x4E0B;&#xFF0C;&#x4FDD;&#x8BC1;&#x7F51;&#x7EDC;&#x901A;&#x7545;&#x3002;</p>
<p>&#x786E;&#x5B9A;&#x6211;&#x7684;&#x76EE;&#x6807;&#x662F;1&#x4E3B;&#xFF0C;2&#x4ECE;&#xFF0C;&#x5947;&#x6570;&#x4E2A;</p>
<p>&#x8FD9;&#x7BC7;&#x6587;&#x5B57;&#x8BB2;&#x4E86;Bully&#x7B97;&#x6CD5;&#x4EE5;&#x53CA;&#x4E3A;&#x5565;&#x662F;&#x5947;&#x6570;&#x4E2A;</p>
<p><a href="http://www.lanceyan.com/tech/mongodb_repset2.html" target="_blank" rel="external">http://www.lanceyan.com/tech/mongodb_repset2.html</a></p>
<h2 id="&#x6CE8;&#x610F;&#x70B9;">&#x6CE8;&#x610F;&#x70B9;</h2><ul>
<li>&#x670D;&#x52A1;&#x5668;&#x8282;&#x70B9;&#x4E4B;&#x524D;&#x65F6;&#x95F4;&#x8981;&#x540C;&#x6B65;</li>
<li>&#x5F00;&#x542F;&#x9632;&#x706B;&#x5899;&#x7684;&#x4E00;&#x5B9A;&#x8981;&#x5141;&#x8BB8;&#x901A;&#x8FC7;</li>
<li>&#x5F00;&#x542F;selinux&#x7684;&#x4E5F;&#x8981;&#x8FDB;&#x884C;&#x8BBE;&#x7F6E;</li>
<li>&#x5EFA;&#x7ACB;&#x53CC;&#x51FB;&#x4E92;&#x4FE1;&#x6A21;&#x5F0F;&#x6700;&#x597D;&#x4E0D;&#x8FC7;</li>
</ul>
<h2 id="&#x683C;&#x5F0F;&#x5316;&#x963F;&#x91CC;&#x4E91;&#x7684;&#x65B0;&#x589E;&#x786C;&#x76D8;">&#x683C;&#x5F0F;&#x5316;&#x963F;&#x91CC;&#x4E91;&#x7684;&#x65B0;&#x589E;&#x786C;&#x76D8;</h2><p><a href="http://www.cnblogs.com/dudu/archive/2012/12/07/aliyun-linux-fdisk.html" target="_blank" rel="external">http://www.cnblogs.com/dudu/archive/2012/12/07/aliyun-linux-fdisk.html</a></p>
<p>&#x7136;&#x540E;&#x6302;&#x8F7D;&#x5230;/data&#x76EE;&#x5F55;&#x4E0B;</p>
<h2 id="&#x914D;&#x7F6E;&#x6587;&#x4EF6;">&#x914D;&#x7F6E;&#x6587;&#x4EF6;</h2><p>~/config/r0.config</p>
<pre><code><span class="variable">port=</span><span class="number">27000</span> <span class="variable">fork=</span><span class="constant">true</span> <span class="variable">logpath=</span>/data/replset/log/r0.log <span class="variable">dbpath=</span>/data/replset/r0 <span class="variable">logappend=</span><span class="constant">true</span> <span class="variable">replSet=</span>rs <span class="comment">#keyFile=/data/replset/key/r0 </span>
</code></pre><p>~/config/r1.config</p>
<pre><code><span class="variable">port=</span><span class="number">27001</span> <span class="variable">fork=</span><span class="constant">true</span> <span class="variable">logpath=</span>/data/replset/log/r1.log <span class="variable">dbpath=</span>/data/replset/r1 <span class="variable">logappend=</span><span class="constant">true</span> <span class="variable">replSet=</span>rs <span class="comment">#keyFile=/data/replset/key/r1 </span>
</code></pre><p>~/config/r2.config</p>
<pre><code><span class="variable">port=</span><span class="number">27002</span> <span class="variable">fork=</span><span class="constant">true</span> <span class="variable">logpath=</span>/data/replset/log/r2.log <span class="variable">dbpath=</span>/data/replset/r2 <span class="variable">logappend=</span><span class="constant">true</span> <span class="variable">replSet=</span>rs <span class="comment">#keyFile=/data/replset/key/r2 </span>
</code></pre><h2 id="&#x542F;&#x52A8;">&#x542F;&#x52A8;</h2><p>&#x786E;&#x4FDD;&#x76EE;&#x5F55;&#x4E3A;&#x7A7A;&#xFF0C;&#x6740;&#x6B7B;&#x6240;&#x6709;mongod&#x8FDB;&#x7A0B;</p>
<pre><code>rm -rf /data/replset/  ps -ef|<span class="keyword">grep</span> mongod | awk &amp;apos;{<span class="keyword">print</span> <span class="variable">$2</span>}&amp;apos; | xargs <span class="keyword">kill</span> -<span class="number">9</span> ps -ef|<span class="keyword">grep</span> mongod 
</code></pre><p>&#x521B;&#x5EFA;&#x76EE;&#x5F55;</p>
<pre><code>mkdir -<span class="tag">p</span> /data/replset/r0 mkdir -<span class="tag">p</span> /data/replset/r1 mkdir -<span class="tag">p</span> /data/replset/r2 mkdir -<span class="tag">p</span> /data/replset/key mkdir -<span class="tag">p</span> /data/replset/log 
</code></pre><p>&#x51C6;&#x5907;key&#x6587;&#x4EF6;</p>
<pre><code>echo &amp;quot;replset1 key&amp;quot; &amp;gt; <span class="regexp">/data/</span>replset<span class="regexp">/key/</span>r0 echo &amp;quot;replset1 key&amp;quot; &amp;gt; <span class="regexp">/data/</span>replset<span class="regexp">/key/</span>r1 echo &amp;quot;replset1 key&amp;quot; &amp;gt; <span class="regexp">/data/</span>replset<span class="regexp">/key/</span>r2 chmod <span class="number">600</span> <span class="regexp">/data/</span>replset<span class="regexp">/key/</span>r*   
</code></pre><p>&#x6CE8;&#x610F;&#x7B2C;&#x4E00;&#x6B21;&#x4E0D;&#x80FD;&#x7528;keyFile</p>
<pre><code>mongod <span class="operator">-f</span> ~/config/r0.config &amp;amp; mongod <span class="operator">-f</span> ~/config/r1.config &amp;amp; mongod <span class="operator">-f</span> ~/config/r2.config &amp;amp; 
</code></pre><p>&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x91CC;&#x662F;fork=true&#xFF0C;&#x6240;&#x4EE5;&#x542F;&#x52A8;&#x9700;&#x8981;&#x70B9;&#x65F6;&#x95F4;</p>
<h2 id="&#x521D;&#x59CB;&#x5316;">&#x521D;&#x59CB;&#x5316;</h2><pre><code>&amp;gt; rs<span class="class">.initiate</span>()   {   &amp;quot;info2&amp;quot; <span class="value">: &amp;quot;</span>no configuration explicitly specified -- making one&amp;quot;,   &amp;quot;me&amp;quot; <span class="value">: &amp;quot;</span>iZ25xk7uei1Z<span class="value">:<span class="number">27001</span>&amp;quot;</span>,   &amp;quot;ok&amp;quot; <span class="value">: <span class="number">1</span> } </span>
</code></pre><p>&#x64E6;&#xFF0C;&#x8D85;&#x7EA7;&#x6162;&#x3002;&#x3002;&#x3002;&#x3002;</p>
<p>&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x8BED;&#x53E5;&#x521D;&#x59CB;&#x5316;</p>
<pre><code>mongo --port <span class="number">27000</span> rs.initiate({ <span class="string">_id:</span>&amp;apos;rs&amp;apos;,<span class="string">members:</span>[{ <span class="string">_id:</span><span class="number">0</span>, <span class="string">host:</span>&amp;apos;<span class="number">10.51</span>.77.129:<span class="number">27000</span>&amp;apos; }]}) 
</code></pre><p>&#x8FD9;&#x4E2A;&#x5176;&#x5B9E;&#x4E5F;&#x5F88;&#x6162;&#x3002;&#x3002;&#x3002;&#x3002;</p>
<p>&#x5F85;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x7EE7;&#x7EED;&#x589E;&#x52A0;&#x5176;&#x4ED6;2&#x4E2A;&#x8282;&#x70B9;&#xFF08;&#x4E00;&#x5B9A;&#x8981;&#x6CE8;&#x610F;&#xFF0C;&#x5728;rs:PRIMARY&#x5373;&#x4E3B;&#x8282;&#x70B9;&#x4E0A;&#x624D;&#x80FD;&#x589E;&#x52A0;rs:SECONDARY&#x548C;ARBITER&#x3002;&#x5982;&#x679C;&#x4E4B;&#x524D;&#x8FDE;&#x7684;&#x662F;&#x5176;&#x4ED6;&#x7AEF;&#x53E3;&#xFF0C;&#x9700;&#x8981;&#x5207;&#x6362;&#x7684;&#x3002;&#xFF09;</p>
<pre><code><span class="tag">rs</span><span class="class">.add</span>(&amp;<span class="tag">quot</span>;10<span class="class">.51</span><span class="class">.77</span><span class="class">.129</span><span class="pseudo">:27001</span>&amp;<span class="tag">quot</span>;) <span class="tag">rs</span><span class="class">.addArb</span>(&amp;<span class="tag">quot</span>;10<span class="class">.51</span><span class="class">.77</span><span class="class">.129</span><span class="pseudo">:27002</span>&amp;<span class="tag">quot</span>;) 
</code></pre><p>&#x67E5;&#x770B;&#x72B6;&#x6001;</p>
<pre><code><span class="tag">rs</span><span class="class">.status</span>(); 
</code></pre><p>&#x5982;&#x679C;&#x60F3;&#x79FB;&#x9664;&#x67D0;&#x4E00;&#x4E2A;&#x8282;&#x70B9;</p>
<pre><code><span class="tag">rs</span><span class="class">.remove</span>(&amp;<span class="tag">quot</span>;10<span class="class">.51</span><span class="class">.77</span><span class="class">.129</span><span class="pseudo">:27001</span>&amp;<span class="tag">quot</span>;) <span class="tag">rs</span><span class="class">.remove</span>(&amp;<span class="tag">quot</span>;10<span class="class">.51</span><span class="class">.77</span><span class="class">.129</span><span class="pseudo">:27000</span>&amp;<span class="tag">quot</span>;) <span class="tag">rs</span><span class="class">.remove</span>(&amp;<span class="tag">quot</span>;10<span class="class">.51</span><span class="class">.77</span><span class="class">.129</span><span class="pseudo">:27002</span>&amp;<span class="tag">quot</span>;) 
</code></pre><h2 id="reconfig">reconfig</h2><p>&#x5982;&#x679C;&#x60F3;&#x5220;&#x9664;&#xFF0C;&#x91CD;&#x7F6E;&#x7528;rs.reconfig(),&#x8FD9;&#x6837;&#x505A;&#x4E0D;&#x4E00;&#x5B9A;&#x4F1A;&#x6210;&#x529F;&#xFF0C;&#x6709;&#x7684;&#x65F6;&#x5019;&#x65E0;&#x6CD5;&#x5207;&#x6362;&#x5230;&#x4E3B;&#x8282;&#x70B9;&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#xFF0C;&#x5220;&#x9664;/data/replset&#x76EE;&#x5F55;&#xFF0C;&#x7136;&#x540E;&#x91CD;&#x542F;&#x6240;&#x6709;mongo&#x7684;&#x8FDB;&#x7A0B;&#x3002;</p>
<pre><code>rs.<span class="function"><span class="title">reconfig</span><span class="params">({ _id:&amp;apos;rs&amp;apos;,members:[{ _id:<span class="number">1</span>, host:&amp;apos;<span class="number">10.51</span>.<span class="number">77.129</span>:<span class="number">27000</span>&amp;apos; }]})</span></span> rs.<span class="function"><span class="title">add</span><span class="params">(&amp;quot;<span class="number">10.51</span>.<span class="number">77.129</span>:<span class="number">27000</span>&amp;quot;)</span></span> rs.<span class="function"><span class="title">addArb</span><span class="params">(&amp;quot;<span class="number">10.51</span>.<span class="number">77.129</span>:<span class="number">27002</span>&amp;quot;)</span></span> 
</code></pre><h2 id="db-oplog-rs">db.oplog.rs</h2><pre><code>rs<span class="value">:PRIMARY&amp;gt;</span> use local switched to db local rs<span class="value">:PRIMARY&amp;gt;</span> show collections me oplog<span class="class">.rs</span> startup_log system<span class="class">.indexes</span> system<span class="class">.replset</span> rs<span class="value">:PRIMARY&amp;gt;</span>  rs<span class="value">:PRIMARY&amp;gt;</span>  rs<span class="value">:PRIMARY&amp;gt;</span> db<span class="class">.oplog</span><span class="class">.rs</span><span class="class">.find</span>() { &amp;quot;ts&amp;quot; <span class="value">: <span class="function">Timestamp</span>(<span class="number">1435495192</span>, <span class="number">1</span>), &amp;quot;</span>h&amp;quot; <span class="value">: <span class="function">NumberLong</span>(<span class="number">0</span>), &amp;quot;</span>v&amp;quot; <span class="value">: <span class="number">2</span>, &amp;quot;</span>op&amp;quot; <span class="value">: &amp;quot;</span>n&amp;quot;, &amp;quot;ns&amp;quot; <span class="value">: &amp;quot;</span>&amp;quot;, &amp;quot;o&amp;quot; <span class="value">: { &amp;quot;</span>msg&amp;quot; <span class="value">: &amp;quot;</span>initiating set&amp;quot; } } { &amp;quot;ts&amp;quot; <span class="value">: <span class="function">Timestamp</span>(<span class="number">1435495306</span>, <span class="number">1</span>), &amp;quot;</span>h&amp;quot; <span class="value">: <span class="function">NumberLong</span>(<span class="number">0</span>), &amp;quot;</span>v&amp;quot; <span class="value">: <span class="number">2</span>, &amp;quot;</span>op&amp;quot; <span class="value">: &amp;quot;</span>n&amp;quot;, &amp;quot;ns&amp;quot; <span class="value">: &amp;quot;</span>&amp;quot;, &amp;quot;o&amp;quot; <span class="value">: { &amp;quot;</span>msg&amp;quot; <span class="value">: &amp;quot;</span>Reconfig set&amp;quot;, &amp;quot;version&amp;quot; <span class="value">: <span class="number">2</span> } } { &amp;quot;</span>ts&amp;quot; <span class="value">: <span class="function">Timestamp</span>(<span class="number">1435495323</span>, <span class="number">1</span>), &amp;quot;</span>h&amp;quot; <span class="value">: <span class="function">NumberLong</span>(<span class="number">0</span>), &amp;quot;</span>v&amp;quot; <span class="value">: <span class="number">2</span>, &amp;quot;</span>op&amp;quot; <span class="value">: &amp;quot;</span>n&amp;quot;, &amp;quot;ns&amp;quot; <span class="value">: &amp;quot;</span>&amp;quot;, &amp;quot;o&amp;quot; <span class="value">: { &amp;quot;</span>msg&amp;quot; <span class="value">: &amp;quot;</span>Reconfig set&amp;quot;, &amp;quot;version&amp;quot; <span class="value">: <span class="number">3</span> } } </span>
</code></pre><h2 id="&#x5728;SECONDARY&#x8282;&#x70B9;&#x65E0;&#x6CD5;show_dbs">&#x5728;SECONDARY&#x8282;&#x70B9;&#x65E0;&#x6CD5;show dbs</h2><p>&#x4E3B;&#x4ECE;&#x542F;&#x52A8;&#x4E4B;&#x540E;&#xFF0C;&#x8FDE;&#x63A5;slave&#x53EF;&#x4EE5;&#x6210;&#x529F;&#x8FDE;&#x4E0A;&#xFF0C;&#x4F46;&#x662F;&#x5728;slave&#x4E2D;&#x6267;&#x884C; show dbs &#x7684;&#x65F6;&#x5019;&#x5C31;&#x62A5;&#x9519;&#x4E86;:</p>
<pre><code>QUERY    Error<span class="value">: listDatabases failed:{ &amp;quot;</span>note&amp;quot; <span class="value">: &amp;quot;</span>from execCommand&amp;quot;, &amp;quot;ok&amp;quot; <span class="value">: <span class="number">0</span>, &amp;quot;</span>errmsg&amp;quot; <span class="value">: &amp;quot;</span>not master&amp;quot; } 
</code></pre><p>&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#xFF1A;</p>
<p>&#x5728;&#x62A5;&#x9519;&#x7684;slave&#x673A;&#x5668;&#x4E0A;&#x6267;&#x884C; rs.slaveOk()&#x65B9;&#x6CD5;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x89E3;&#x91CA;&#x4E00;&#x4E0B;&#x5177;&#x4F53;slaveOk&#x65B9;&#x6CD5;&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#xFF1F;</p>
<pre><code>Provides a shorthand <span class="keyword">for</span> the following operation:  db.getMongo().setSlaveOk() This allows the current connection <span class="keyword">to</span> allow <span class="keyword">read</span> operations <span class="keyword">to</span> run <span class="keyword">on</span> secondary members. See the readPref() <span class="function"><span class="keyword">method</span> <span class="title">for</span> <span class="title">more</span> <span class="title">fine</span>-<span class="title">grained</span> <span class="title">control</span> <span class="title">over</span> <span class="title">read</span> <span class="title">preference</span> <span class="title">in</span> <span class="title">the</span> <span class="title">mongo</span> <span class="title">shell</span>. </span>
</code></pre><p>see</p>
<ul>
<li><a href="http://segmentfault.com/a/1190000002924522" target="_blank" rel="external">http://segmentfault.com/a/1190000002924522</a></li>
<li><a href="http://www.it165.net/database/html/201402/5280.html" target="_blank" rel="external">http://www.it165.net/database/html/201402/5280.html</a></li>
</ul>
<h2 id="&#x5185;&#x5B58;&#x95EE;&#x9898;">&#x5185;&#x5B58;&#x95EE;&#x9898;</h2><p>&#x67E5;&#x770B;&#x5185;&#x5B58;&#x60C5;&#x51B5;&#x6700;&#x5E38;&#x7528;&#x7684;&#x662F;free&#x547D;&#x4EE4;&#xFF1A;</p>
<pre><code>[deploy<span class="annotation">@iZ</span>25xk7uei1Z config]$ free -m              total       used       free     shared    buffers     cached <span class="string">Mem:</span>          <span class="number">7567</span>       <span class="number">6821</span>        <span class="number">745</span>          <span class="number">8</span>        <span class="number">129</span>       <span class="number">6122</span> -<span class="regexp">/+ buffers/</span><span class="string">cache:</span>        <span class="number">569</span>       <span class="number">6997</span> <span class="string">Swap:</span>            <span class="number">0</span>          <span class="number">0</span>          <span class="number">0</span> 
</code></pre><p>&#x9650;&#x5236;&#x5185;&#x5B58;</p>
<p>&#x6240;&#x6709;&#x8FDE;&#x63A5;&#x6D88;&#x8017;&#x7684;&#x5185;&#x5B58;&#x52A0;&#x8D77;&#x6765;&#x4F1A;&#x76F8;&#x5F53;&#x60CA;&#x4EBA;&#xFF0C;&#x63A8;&#x8350;&#x628A;Stack&#x8BBE;&#x7F6E;&#x5C0F;&#x4E00;&#x70B9;&#xFF0C;&#x6BD4;&#x5982;&#x8BF4;1024&#xFF1A;</p>
<pre><code><span class="built_in">ulimit</span> <span class="operator">-s</span> <span class="number">1024</span> 
</code></pre><p>&#x901A;&#x8FC7;&#x8C03;&#x6574;&#x5185;&#x6838;&#x53C2;&#x6570;drop_caches&#x4E5F;&#x53EF;&#x4EE5;&#x91CA;&#x653E;&#x7F13;&#x5B58;&#xFF1A;</p>
<pre><code><span class="attribute">sysctl vm.drop_caches</span>=<span class="string">1 </span>
</code></pre><p>&#x6709;&#x65F6;&#x5019;&#xFF0C;&#x51FA;&#x4E8E;&#x67D0;&#x4E9B;&#x539F;&#x56E0;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x60F3;&#x91CA;&#x653E;&#x6389;MongoDB&#x5360;&#x7528;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x4E0D;&#x8FC7;&#x524D;&#x9762;&#x8BF4;&#x4E86;&#xFF0C;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x5DE5;&#x4F5C;&#x662F;&#x7531;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x5668;&#x63A7;&#x5236;&#x7684;&#xFF0C;&#x5E78;&#x597D;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;MongoDB&#x5185;&#x7F6E;&#x7684;closeAllDatabases&#x547D;&#x4EE4;&#x8FBE;&#x5230;&#x76EE;&#x7684;&#xFF1A;</p>
<pre><code>mongo&amp;<span class="keyword">gt</span>; <span class="keyword">use</span> admin mongo&amp;<span class="keyword">gt</span>; db.runCommand({closeAllDatabases:<span class="number">1</span>}) 
</code></pre><p>&#x5E73;&#x65F6;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;mongo&#x547D;&#x4EE4;&#x884C;&#x6765;&#x76D1;&#x63A7;MongoDB&#x7684;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x60C5;&#x51B5;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<pre><code><span class="tag">mongo</span>&amp;<span class="tag">gt</span>; <span class="tag">db</span><span class="class">.serverStatus</span>()<span class="rule"><span class="attribute">.mem</span>:<span class="value"> {  &amp;quot</span></span>;<span class="tag">resident</span>&amp;<span class="tag">quot</span>; : 22346,  &amp;<span class="tag">quot</span>;<span class="tag">virtual</span>&amp;<span class="tag">quot</span>; : 1938524,  &amp;<span class="tag">quot</span>;<span class="tag">mapped</span>&amp;<span class="tag">quot</span>; : 962283 } 
</code></pre><p>&#x8FD8;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;mongostat&#x547D;&#x4EE4;&#x6765;&#x76D1;&#x63A7;MongoDB&#x7684;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x60C5;&#x51B5;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<pre><code><span class="keyword">shell</span>&amp;gt; mongostat mapped vsize <span class="keyword">res</span> faults  <span class="number">940</span><span class="keyword">g</span> <span class="number">1893</span><span class="keyword">g</span> <span class="number">21.9</span><span class="keyword">g</span> <span class="number">0</span> 
</code></pre><p>&#x5176;&#x4E2D;&#x5185;&#x5B58;&#x76F8;&#x5173;&#x5B57;&#x6BB5;&#x7684;&#x542B;&#x4E49;&#x662F;&#xFF1A;</p>
<ul>
<li>mapped&#xFF1A;&#x6620;&#x5C04;&#x5230;&#x5185;&#x5B58;&#x7684;&#x6570;&#x636E;&#x5927;&#x5C0F;</li>
<li>visze&#xFF1A;&#x5360;&#x7528;&#x7684;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x5927;&#x5C0F;</li>
<li>res&#xFF1A;&#x5360;&#x7528;&#x7684;&#x7269;&#x7406;&#x5185;&#x5B58;&#x5927;&#x5C0F;</li>
</ul>
<p>&#x6CE8;&#xFF1A;&#x5982;&#x679C;&#x64CD;&#x4F5C;&#x4E0D;&#x80FD;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x5B8C;&#x6210;&#xFF0C;&#x7ED3;&#x679C;faults&#x5217;&#x7684;&#x6570;&#x503C;&#x4E0D;&#x4F1A;&#x662F;0&#xFF0C;&#x89C6;&#x5927;&#x5C0F;&#x53EF;&#x80FD;&#x6709;&#x6027;&#x80FD;&#x95EE;&#x9898;&#x3002; &#x5728;&#x4E0A;&#x9762;&#x7684;&#x7ED3;&#x679C;&#x4E2D;&#xFF0C;vsize&#x662F;mapped&#x7684;&#x4E24;&#x500D;&#xFF0C;&#x800C;mapped&#x7B49;&#x4E8E;&#x6570;&#x636E;&#x6587;&#x4EF6;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x6240;&#x4EE5;&#x8BF4;vsize&#x662F;&#x6570;&#x636E;&#x6587;&#x4EF6;&#x7684;&#x4E24;&#x500D;&#xFF0C;&#x4E4B;&#x6240;&#x4EE5;&#x4F1A;&#x8FD9;&#x6837;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x672C;&#x4F8B;&#x4E2D;&#xFF0C;MongoDB&#x5F00;&#x542F;&#x4E86;journal&#xFF0C;&#x9700;&#x8981;&#x5728;&#x5185;&#x5B58;&#x91CC;&#x591A;&#x6620;&#x5C04;&#x4E00;&#x6B21;&#x6570;&#x636E;&#x6587;&#x4EF6;&#xFF0C;&#x5982;&#x679C;&#x5173;&#x95ED;journal&#xFF0C;&#x5219;vsize&#x548C;mapped&#x5927;&#x81F4;&#x76F8;&#x5F53;&#x3002;</p>
<p>see</p>
<ul>
<li><a href="http://www.oschina.net/question/16840_44521" target="_blank" rel="external">http://www.oschina.net/question/16840_44521</a></li>
</ul>
<p>&#x66F4;&#x597D;&#x7684;&#x505A;&#x6CD5;&#x662F;&#x4F7F;&#x7528;docker&#xFF0C;&#x4E00;&#x52B3;&#x6C38;&#x9038;</p>
<ul>
<li>&#x624B;&#x628A;&#x624B;&#x6559;&#x4F60;&#x7528;Docker&#x90E8;&#x7F72;&#x4E00;&#x4E2A;MongoDB&#x96C6;&#x7FA4;&#xA0; <a href="http://dockone.io/article/181" target="_blank" rel="external">http://dockone.io/article/181</a></li>
</ul>
<p>&#x5168;&#x6587;&#x5B8C;</p>
<p>&#x6B22;&#x8FCE;&#x5173;&#x6CE8;&#x6211;&#x7684;&#x516C;&#x4F17;&#x53F7;&#x3010;node&#x5168;&#x6808;&#x3011;</p>
<p><img src="http://taojinke.github.io/img/20150708/4d99f2f.png" alt=""></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/MongoDB/">MongoDB</a><a href="/tags/运维技术/">运维技术</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/08/4da9835/" title="MongoDb gridfs-ngnix文件存储方案 -" itemprop="url">MongoDb gridfs-ngnix文件存储方案 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-08T02:33:30.000Z" itemprop="datePublished"> 发表于 2015-07-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>&#x5728;&#x5404;&#x7C7B;&#x7CFB;&#x7EDF;&#x5E94;&#x7528;&#x670D;&#x52A1;&#x7AEF;&#x5F00;&#x53D1;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x7ECF;&#x5E38;&#x4F1A;&#x9047;&#x5230;&#x6587;&#x4EF6;&#x5B58;&#x50A8;&#x7684;&#x95EE;&#x9898;&#x3002; &#x5E38;&#x89C1;&#x7684;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;DBMS&#x4F20;&#x7EDF;&#x6587;&#x4EF6;&#x6D41;&#x5B58;&#x50A8;&#x3002;&#x4ECA;&#x5929;&#x6211;&#x4EEC;&#x770B;&#x4E00;&#x4E0B;&#x57FA;&#x4E8E;NoSQL&#x6570;&#x636E;&#x5E93;MongoDb&#x7684;&#x5B58;&#x50A8;&#x65B9;&#x6848;&#x3002;&#x7B14;&#x8005;&#x73AF;&#x5883; &#x4EE5;CentOS 6.5&#xFF0C;MongoDb 2.6.3,&#xA0; Nginx-1.4.7 &#x4E3A;&#x4F8B;&#xFF0C;&#x60A8;&#x9700;&#x8981;&#x4E86;&#x89E3;Linux&#x5E38;&#x7528;&#x547D;&#x4EE4;&#x3002;&#x5148;&#x6765;&#x56DE;&#x987E;&#x4E00;&#x4E0B;MongoDb&#x7684;&#x5185;&#x90E8;&#x6587;&#x4EF6;&#x7ED3;&#x6784; </p>
<p><img src="http://taojinke.github.io/img/20150708/4da4533.png" alt="O6EzR"></p>
<ol>
<li>MongoDB&#x5728;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x4E0A;&#x6309;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x6765;&#x5212;&#x5206;&#xFF0C;&#x4E00;&#x4E2A;collection&#x662F;&#x4E00;&#x4E2A;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#xFF0C;&#x4E00;&#x4E2A;&#x7D22;&#x5F15;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x547D;&#x540D;&#x7A7A;&#x95F4;</li>
<li>&#x540C;&#x4E00;&#x4E2A;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x7684;&#x6570;&#x636E;&#x88AB;&#x5206;&#x6210;&#x5F88;&#x591A;&#x4E2A;Extent&#xFF0C;Extent&#x4E4B;&#x95F4;&#x4F7F;&#x7528;&#x53CC;&#x5411;&#x94FE;&#x8868;&#x8FDE;&#x63A5;</li>
<li>&#x5728;&#x6BCF;&#x4E00;&#x4E2A;Extent&#x4E2D;&#xFF0C;&#x4FDD;&#x5B58;&#x4E86;&#x5177;&#x4F53;&#x6BCF;&#x4E00;&#x884C;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#x4E5F;&#x662F;&#x901A;&#x8FC7;&#x53CC;&#x5411;&#x94FE;&#x63A5;&#x8FDE;&#x63A5;&#x7684;</li>
<li>&#x6BCF;&#x4E00;&#x884C;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x7A7A;&#x95F4;&#x4E0D;&#x4EC5;&#x5305;&#x62EC;&#x6570;&#x636E;&#x5360;&#x7528;&#x7A7A;&#x95F4;&#xFF0C;&#x8FD8;&#x53EF;&#x80FD;&#x5305;&#x542B;&#x4E00;&#x90E8;&#x5206;&#x9644;&#x52A0;&#x7A7A;&#x95F4;&#xFF0C;&#x8FD9;&#x4F7F;&#x5F97;&#x5728;&#x6570;&#x636E;update&#x53D8;&#x5927;&#x540E;&#x53EF;&#x4EE5;&#x4E0D;&#x79FB;&#x52A8;&#x4F4D;&#x7F6E;</li>
<li>&#x7D22;&#x5F15;&#x4EE5;BTree&#x7ED3;&#x6784;&#x5B9E;&#x73B0;</li>
</ol>
<p>&#x7136;&#x540E;&#x662F;GridFs&#x7684;&#x7ED3;&#x6784;</p>
<p><img src="http://taojinke.github.io/img/20150708/4da47a4.png" alt="gridfs1"></p>
<p>GridFS&#x5728;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#xFF0C;&#x9ED8;&#x8BA4;&#x4F7F;&#x7528;fs.chunks&#x548C;fs.files&#x6765;&#x5B58;&#x50A8;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x5176;&#x4E2D;fs.files&#x96C6;&#x5408;&#x5B58;&#x653E;&#x6587;&#x4EF6;&#x7684;&#x4FE1;&#x606F;&#xFF0C;fs.chunks&#x5B58;&#x653E;&#x6587;&#x4EF6;&#x6570;&#x636E;&#x3002;</p>
<p>&#x4E00;&#x4E2A;fs.files&#x96C6;&#x5408;&#x4E2D;&#x7684;&#x4E00;&#x6761;&#x8BB0;&#x5F55;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF0C;&#x5373;&#x4E00;&#x4E2A;file&#x7684;&#x4FE1;&#x606F;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code><span class="xml"></span><span class="expression">{ 
&amp;<span class="variable">quot</span>;_<span class="variable">id</span>&amp;<span class="variable">quot</span>; : <span class="variable">ObjectId</span>(&amp;<span class="variable">quot</span>;4<span class="variable">f</span>4608844<span class="variable">f</span>9<span class="variable">b</span>855<span class="variable">c</span>6<span class="variable">c</span>35<span class="variable">e</span>298&amp;<span class="variable">quot</span>;),       //&amp;<span class="begin-block">#x</span>552<span class="variable">F</span>;&amp;<span class="begin-block">#x</span>4<span class="variable">E</span>00;<span class="variable">id</span>&amp;<span class="begin-block">#xFF</span>0<span class="variable">C</span>;&amp;<span class="begin-block">#x</span>53<span class="variable">EF</span>;&amp;<span class="begin-block">#x</span>4<span class="variable">EE</span>5;&amp;<span class="begin-block">#x</span>662<span class="variable">F</span>;&amp;<span class="begin-block">#x</span>7528;&amp;<span class="begin-block">#x</span>6237;&amp;<span class="begin-block">#x</span>81<span class="variable">EA</span>;&amp;<span class="begin-block">#x</span>5<span class="variable">B</span>9<span class="variable">A</span>;&amp;<span class="begin-block">#x</span>4<span class="variable">E</span>49;&amp;<span class="begin-block">#x</span>7684;&amp;<span class="begin-block">#x</span>7<span class="variable">C</span>7<span class="variable">B</span>;&amp;<span class="begin-block">#x</span>578<span class="variable">B</span>;
&amp;<span class="variable">quot</span>;<span class="variable">filename</span>&amp;<span class="variable">quot</span>; : &amp;<span class="variable">quot</span>;<span class="variable">CPU.txt</span>&amp;<span class="variable">quot</span>;,      //&amp;<span class="begin-block">#x</span>6587;&amp;<span class="begin-block">#x</span>4<span class="variable">EF</span>6;&amp;<span class="begin-block">#x</span>540<span class="variable">D</span>;
&amp;<span class="variable">quot</span>;<span class="variable">length</span>&amp;<span class="variable">quot</span>; : 778,      //&amp;<span class="begin-block">#x</span>6587;&amp;<span class="begin-block">#x</span>4<span class="variable">EF</span>6;&amp;<span class="begin-block">#x</span>957<span class="variable">F</span>;&amp;<span class="begin-block">#x</span>5<span class="variable">EA</span>6;
&amp;<span class="variable">quot</span>;<span class="variable">chunkSize</span>&amp;<span class="variable">quot</span>; : 262144,    /<span class="end-block">/chunk</span>&amp;<span class="begin-block">#x</span>7684;&amp;<span class="begin-block">#x</span>5927;&amp;<span class="begin-block">#x</span>5<span class="variable">C</span>0<span class="variable">F</span>;
&amp;<span class="variable">quot</span>;<span class="variable">uploadDate</span>&amp;<span class="variable">quot</span>; : <span class="variable">ISODate</span>(&amp;<span class="variable">quot</span>;2012<span class="variable">-</span>02<span class="variable">-</span>23<span class="variable">T</span>09:36:04<span class="variable">.</span>593<span class="variable">Z</span>&amp;<span class="variable">quot</span>;), //&amp;<span class="begin-block">#x</span>4<span class="variable">E</span>0<span class="variable">A</span>;&amp;<span class="begin-block">#x</span>4<span class="variable">F</span>20;&amp;<span class="begin-block">#x</span>65<span class="variable">F</span>6;&amp;<span class="begin-block">#x</span>95<span class="variable">F</span>4;
&amp;<span class="variable">quot</span>;<span class="variable">md</span>5&amp;<span class="variable">quot</span>; : &amp;<span class="variable">quot</span>;<span class="variable">e</span>2<span class="variable">c</span>789<span class="variable">b</span>036<span class="variable">cfb</span>3<span class="variable">b</span>848<span class="variable">ae</span>39<span class="variable">a</span>24<span class="variable">e</span>795<span class="variable">ca</span>6&amp;<span class="variable">quot</span>;,      //&amp;<span class="begin-block">#x</span>6587;&amp;<span class="begin-block">#x</span>4<span class="variable">EF</span>6;&amp;<span class="begin-block">#x</span>7684;<span class="variable">md</span>5&amp;<span class="begin-block">#x</span>503<span class="variable">C</span>;
&amp;<span class="variable">quot</span>;<span class="variable">contentType</span>&amp;<span class="variable">quot</span>; : &amp;<span class="variable">quot</span>;<span class="variable">text</span><span class="end-block">/plain</span>&amp;<span class="variable">quot</span>;     //&amp;<span class="begin-block">#x</span>6587;&amp;<span class="begin-block">#x</span>4<span class="variable">EF</span>6;&amp;<span class="begin-block">#x</span>7684;<span class="variable">MIME</span>&amp;<span class="begin-block">#x</span>7<span class="variable">C</span>7<span class="variable">B</span>;&amp;<span class="begin-block">#x</span>578<span class="variable">B</span>;
&amp;<span class="variable">quot</span>;<span class="variable">meta</span>&amp;<span class="variable">quot</span>; : <span class="variable">null</span>    //&amp;<span class="begin-block">#x</span>6587;&amp;<span class="begin-block">#x</span>4<span class="variable">EF</span>6;&amp;<span class="begin-block">#x</span>7684;&amp;<span class="begin-block">#x</span>5176;&amp;<span class="begin-block">#x</span>5<span class="variable">B</span>83;&amp;<span class="begin-block">#x</span>4<span class="variable">FE</span>1;&amp;<span class="begin-block">#x</span>606<span class="variable">F</span>;&amp;<span class="begin-block">#xFF</span>0<span class="variable">C</span>;&amp;<span class="begin-block">#x</span>9<span class="variable">ED</span>8;&amp;<span class="begin-block">#x</span>8<span class="variable">BA</span>4;&amp;<span class="begin-block">#x</span>662<span class="variable">F</span>;&amp;<span class="begin-block">#x</span>6<span class="variable">CA</span>1;&amp;<span class="begin-block">#x</span>6709;&amp;<span class="begin-block">#x</span>201<span class="variable">D</span>;<span class="variable">meta</span>&amp;<span class="begin-block">#x</span>201<span class="variable">D</span>;&amp;<span class="begin-block">#x</span>8<span class="variable">FD</span>9;&amp;<span class="begin-block">#x</span>4<span class="variable">E</span>2<span class="variable">A</span>;<span class="variable">key</span>&amp;<span class="begin-block">#xFF</span>0<span class="variable">C</span>;&amp;<span class="begin-block">#x</span>7528;&amp;<span class="begin-block">#x</span>6237;&amp;<span class="begin-block">#x</span>53<span class="variable">EF</span>;&amp;<span class="begin-block">#x</span>4<span class="variable">EE</span>5;&amp;<span class="begin-block">#x</span>81<span class="variable">EA</span>;&amp;<span class="begin-block">#x</span>5<span class="variable">DF</span>1;&amp;<span class="begin-block">#x</span>5<span class="variable">B</span>9<span class="variable">A</span>;&amp;<span class="begin-block">#x</span>4<span class="variable">E</span>49;&amp;<span class="begin-block">#x</span>4<span class="variable">E</span>3<span class="variable">A</span>;&amp;<span class="begin-block">#x</span>4<span class="variable">EFB</span>;&amp;<span class="begin-block">#x</span>610<span class="variable">F</span>;<span class="variable">BSON</span>&amp;<span class="begin-block">#x</span>5<span class="variable">BF</span>9;&amp;<span class="begin-block">#x</span>8<span class="variable">C</span>61;
}</span><span class="xml"></span>
</code></pre><p>&#x5BF9;&#x5E94;&#x7684;fs.chunks&#x4E2D;&#x7684;chunk&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code><span class="xml"></span><span class="expression">{ 
&amp;<span class="variable">quot</span>;_<span class="variable">id</span>&amp;<span class="variable">quot</span>; : <span class="variable">ObjectId</span>(&amp;<span class="variable">quot</span>;4<span class="variable">f</span>4608844<span class="variable">f</span>9<span class="variable">b</span>855<span class="variable">c</span>6<span class="variable">c</span>35<span class="variable">e</span>299&amp;<span class="variable">quot</span>;),    /<span class="end-block">/chunk</span>&amp;<span class="begin-block">#x</span>7684;<span class="variable">id</span>
&amp;<span class="variable">quot</span>;<span class="variable">files</span>_<span class="variable">id</span>&amp;<span class="variable">quot</span>; : <span class="variable">ObjectId</span>(&amp;<span class="variable">quot</span>;4<span class="variable">f</span>4608844<span class="variable">f</span>9<span class="variable">b</span>855<span class="variable">c</span>6<span class="variable">c</span>35<span class="variable">e</span>298&amp;<span class="variable">quot</span>;),  //&amp;<span class="begin-block">#x</span>6587;&amp;<span class="begin-block">#x</span>4<span class="variable">EF</span>6;&amp;<span class="begin-block">#x</span>7684;<span class="variable">id</span>&amp;<span class="begin-block">#xFF</span>0<span class="variable">C</span>;&amp;<span class="begin-block">#x</span>5<span class="variable">BF</span>9;&amp;<span class="begin-block">#x</span>5<span class="variable">E</span>94;<span class="variable">fs.files</span>&amp;<span class="begin-block">#x</span>4<span class="variable">E</span>2<span class="variable">D</span>;&amp;<span class="begin-block">#x</span>7684;&amp;<span class="begin-block">#x</span>5<span class="variable">BF</span>9;&amp;<span class="begin-block">#x</span>8<span class="variable">C</span>61;&amp;<span class="begin-block">#xFF</span>0<span class="variable">C</span>;&amp;<span class="begin-block">#x</span>76<span class="variable">F</span>8;&amp;<span class="begin-block">#x</span>5<span class="variable">F</span>53;&amp;<span class="begin-block">#x</span>4<span class="variable">E</span>8<span class="variable">E</span>;<span class="variable">fs.files</span>&amp;<span class="begin-block">#x</span>96<span class="variable">C</span>6;&amp;<span class="begin-block">#x</span>5408;&amp;<span class="begin-block">#x</span>7684;&amp;<span class="begin-block">#x</span>5916;&amp;<span class="begin-block">#x</span>952<span class="variable">E</span>;
&amp;<span class="variable">quot</span>;<span class="variable">n</span>&amp;<span class="variable">quot</span>; : 0,     //&amp;<span class="begin-block">#x</span>6587;&amp;<span class="begin-block">#x</span>4<span class="variable">EF</span>6;&amp;<span class="begin-block">#x</span>7684;&amp;<span class="begin-block">#x</span>7<span class="variable">B</span>2<span class="variable">C</span>;&amp;<span class="begin-block">#x</span>51<span class="variable">E</span>0;&amp;<span class="begin-block">#x</span>4<span class="variable">E</span>2<span class="variable">A</span>;<span class="variable">chunk</span>&amp;<span class="begin-block">#x</span>5757;&amp;<span class="begin-block">#xFF</span>0<span class="variable">C</span>;&amp;<span class="begin-block">#x</span>5982;&amp;<span class="begin-block">#x</span>679<span class="variable">C</span>;&amp;<span class="begin-block">#x</span>6587;&amp;<span class="begin-block">#x</span>4<span class="variable">EF</span>6;&amp;<span class="begin-block">#x</span>5927;&amp;<span class="begin-block">#x</span>4<span class="variable">E</span>8<span class="variable">E</span>;<span class="variable">chunksize</span>&amp;<span class="begin-block">#x</span>7684;&amp;<span class="begin-block">#x</span>8<span class="variable">BDD</span>;&amp;<span class="begin-block">#xFF</span>0<span class="variable">C</span>;&amp;<span class="begin-block">#x</span>4<span class="variable">F</span>1<span class="variable">A</span>;&amp;<span class="begin-block">#x</span>88<span class="variable">AB</span>;&amp;<span class="begin-block">#x</span>5206;&amp;<span class="begin-block">#x</span>5272;&amp;<span class="begin-block">#x</span>6210;&amp;<span class="begin-block">#x</span>591<span class="variable">A</span>;&amp;<span class="begin-block">#x</span>4<span class="variable">E</span>2<span class="variable">A</span>;<span class="variable">chunk</span>&amp;<span class="begin-block">#x</span>5757;
&amp;<span class="variable">quot</span>;<span class="variable">data</span>&amp;<span class="variable">quot</span>; : <span class="variable">BinData</span>(0,&amp;<span class="variable">quot</span>;<span class="variable">QGV...</span>&amp;<span class="variable">quot</span>;)     //&amp;<span class="begin-block">#x</span>6587;&amp;<span class="begin-block">#x</span>4<span class="variable">EF</span>6;&amp;<span class="begin-block">#x</span>7684;&amp;<span class="begin-block">#x</span>4<span class="variable">E</span>8<span class="variable">C</span>;&amp;<span class="begin-block">#x</span>8<span class="variable">FDB</span>;&amp;<span class="begin-block">#x</span>5236;&amp;<span class="begin-block">#x</span>6570;&amp;<span class="begin-block">#x</span>636<span class="variable">E</span>;&amp;<span class="begin-block">#xFF</span>0<span class="variable">C</span>;&amp;<span class="begin-block">#x</span>8<span class="variable">FD</span>9;&amp;<span class="begin-block">#x</span>91<span class="variable">CC</span>;&amp;<span class="begin-block">#x</span>7701;&amp;<span class="begin-block">#x</span>7565;&amp;<span class="begin-block">#x</span>4<span class="variable">E</span>86;&amp;<span class="begin-block">#x</span>5177;&amp;<span class="begin-block">#x</span>4<span class="variable">F</span>53;&amp;<span class="begin-block">#x</span>5185;&amp;<span class="begin-block">#x</span>5<span class="variable">BB</span>9;
}</span><span class="xml"></span>
</code></pre><p>&#x6587;&#x4EF6;&#x5B58;&#x5165;&#x5230;GridFS&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x6587;&#x4EF6;&#x5927;&#x4E8E;chunksize&#xFF0C;&#x5219;&#x628A;&#x6587;&#x4EF6;&#x5206;&#x5272;&#x6210;&#x591A;&#x4E2A;chunk&#xFF0C;&#x518D;&#x628A;&#x8FD9;&#x4E9B;chunk&#x4FDD;&#x5B58;&#x5230;fs.chunks&#x4E2D;&#xFF0C;&#x6700;&#x540E;&#x518D;&#x628A;&#x6587;&#x4EF6;&#x4FE1;&#x606F;&#x5B58;&#x5165;&#x5230;fs.files&#x4E2D;&#x3002;</p>
<p>&#x5728;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5148;&#x636E;&#x67E5;&#x8BE2;&#x7684;&#x6761;&#x4EF6;&#xFF0C;&#x5728;fs.files&#x4E2D;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x5408;&#x9002;&#x7684;&#x8BB0;&#x5F55;&#xFF0C;&#x5F97;&#x5230;&#x201C;_id&#x201D;&#x7684;&#x503C;&#xFF0C;&#x518D;&#x636E;&#x8FD9;&#x4E2A;&#x503C;&#x5230;fs.chunks&#x4E2D;&#x67E5;&#x627E;&#x6240;&#x6709;&#x201C;files_id&#x201D;&#x4E3A;&#x201C;_id&#x201D;&#x7684;chunk&#xFF0C;&#x5E76;&#x6309;&#x201C;n&#x201D;&#x6392;&#x5E8F;&#xFF0C;&#x6700;&#x540E;&#x4F9D;&#x6B21;&#x8BFB;&#x53D6;chunk&#x4E2D;&#x201C;data&#x201D;&#x5BF9;&#x8C61;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x8FD8;&#x539F;&#x6210;&#x539F;&#x6765;&#x7684;&#x6587;&#x4EF6;&#x3002; </p>
<h3 id="&#x5B89;&#x88C5;Install&#x4E0E;&#x914D;&#x7F6E;">&#x5B89;&#x88C5;Install&#x4E0E;&#x914D;&#x7F6E;</h3><p>1.&#x5B89;&#x88C5;mongoDb</p>
<p>&#x589E;&#x52A0;MongoDB Repository&#xFF0C;&#x4E0D;&#x6E05;&#x695A;vim&#xFF0C;&#x8BF7;&#x53C2;&#x8003; <a href="http://linux.chinaunix.net/techdoc/beginner/2009/12/20/1150108.shtml" target="_blank" rel="external">VIM</a></p>
<p>vim /etc/yum.repos.d/mongodb.repo</p>
<p>&#x5982;&#x679C;&#x662F;64bit&#x7684;</p>
<p>[mongodb]</p>
<p>name=MongoDB Repository</p>
<p>baseurl=<a href="http://downloads-distro.mongodb.org/repo/redhat/os/x86_64/" target="_blank" rel="external">http://downloads-distro.mongodb.org/repo/redhat/os/x86_64/</a></p>
<p>gpgcheck=0</p>
<p>enabled=1</p>
<p>32bit&#x7684;&#x7CFB;&#x7EDF;&#xFF1A;</p>
<p>[mongodb]</p>
<p>name=MongoDB Repository</p>
<p>baseurl=<a href="http://downloads-distro.mongodb.org/repo/redhat/os/i686/" target="_blank" rel="external">http://downloads-distro.mongodb.org/repo/redhat/os/i686/</a></p>
<p>gpgcheck=0</p>
<p>enabled=1</p>
<p>&#x7136;&#x540E;&#x5B89;&#x88C5;&#xFF0C;&#x4F1A;&#x63D0;&#x793A;Y/N&#xFF1A;</p>
<p>yum install mongo-10gen mongo-10gen-server</p>
<p>&#x542F;&#x52A8;&#xFF1A;</p>
<p>service mongod start</p>
<p>&#x67E5;&#x770B;&#x72B6;&#x6001;</p>
<p>service mongod status</p>
<p>&#x505C;&#x6B62;</p>
<p>service mongod stop</p>
<p>&#x66F4;&#x591A;&#xFF0C;&#x5173;&#x4E8E;3.0&#x4EE5;&#x4E0A;&#x7248;&#x672C;&#xFF0C;&#x8BF7;&#x53C2;&#x8003;&#x5B98;&#x7F51;&#x3002;</p>
<p>2.&#x5B89;&#x88C5;nginx&#x53CA;nginx-gridfs</p>
<p>&#x4F9D;&#x8D56;&#x5E93;&#x3001;&#x5DE5;&#x5177;</p>
<h1 id="yum_-y_install_pcre-devel_openssl-devel_zlib-devel">yum -y install pcre-devel openssl-devel zlib-devel</h1><h1 id="yum_-y_install_gcc_gcc-c++">yum -y install gcc gcc-c++</h1><p>&#x4E0B;&#x8F7D;nginx-gridfs&#x6E90;&#x7801;</p>
<h1 id="git_clone_https://github-com/mdirolf/nginx-gridfs-git">git clone <a href="https://github.com/mdirolf/nginx-gridfs.git" target="_blank" rel="external">https://github.com/mdirolf/nginx-gridfs.git</a></h1><h1 id="cd_nginx-gridfs">cd nginx-gridfs</h1><h1 id="git_checkout_v0-8">git checkout v0.8</h1><h1 id="git_submodule_init">git submodule init</h1><h1 id="git_submodule_update">git submodule update</h1><p>&#x4E0B;&#x8F7D;nginx&#x6E90;&#x7801;&#xFF0C;&#x7F16;&#x8BD1;&#x5B89;&#x88C5;&#x3002;(&#x9AD8;&#x7248;&#x672C;&#x652F;&#x6301;&#x4E0D;&#x597D;)</p>
<h1 id="wget_http://nginx-org/download/nginx-1-4-7-tar-gz">wget <a href="http://nginx.org/download/nginx-1.4.7.tar.gz" target="_blank" rel="external">http://nginx.org/download/nginx-1.4.7.tar.gz</a></h1><h1 id="tar_zxvf_nginx-1-4-7-tar-gz">tar zxvf nginx-1.4.7.tar.gz</h1><h1 id="cd_nginx-1-4-7">cd nginx-1.4.7</h1><h1 id="-/configure_—with-openssl=/usr/include/openssl_—add-module=-/nginx-gridfs/">./configure —with-openssl=/usr/include/openssl —add-module=../nginx-gridfs/</h1><h1 id="make_-j8_&amp;&amp;_make_install_&#x2013;j8">make -j8 &amp;&amp; make install &#x2013;j8</h1><p>&#x6CE8;&#x610F;&#x84DD;&#x8272;&#x5B57;&#x7B26;&#x914D;&#x7F6E;&#x6210;&#x5BF9;&#x5E94;nginx-gridfs&#x7684;&#x8DEF;&#x5F84;</p>
<ol>
<li>&#x914D;&#x7F6E;nginx-gridfs</li>
</ol>
<p>vim /usr/local/nginx/conf/nginx.conf</p>
<p>&#x5728; server &#x8282;&#x70B9;&#x4E2D;&#x6DFB;&#x52A0; location &#x8282;&#x70B9;</p>
<p>location /img/ {</p>
<p>gridfs testdb</p>
<p>field=filename</p>
<p>type=string;</p>
<p>mongo 192.168.0.159:27017;</p>
<p>}</p>
<p>location /files/ {</p>
<p>gridfs testdb</p>
<p>field=_id</p>
<p>type=objectid;</p>
<p>mongo 192.168.0.159:27017;</p>
<p>}</p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x7684;mongo&#x670D;&#x52A1;&#x5728;IP 192.168.0.159&#x3002;&#x5982;&#x679C;&#x4E0D;&#x6307;&#x5B9A; field&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A; MongoDB &#x7684;&#x81EA;&#x589E;ID&#xFF0C;&#x4E14;type&#x4E3A;int </p>
<p>&#x914D;&#x7F6E;&#x53C2;&#x6570;&#x4ECB;&#x7ECD;&#xFF1A;</p>
<p>gridfs&#xFF1A;nginx&#x8BC6;&#x522B;&#x63D2;&#x4EF6;&#x7684;&#x5173;&#x952E;&#x5B57;</p>
<p>testdb&#xFF1A;db&#x540D;</p>
<p>[root_collection]: &#x9009;&#x62E9;collection&#xFF0C;&#x5982;root_collection=blog&#xFF0C; mongod&#x5C31;&#x4F1A;&#x53BB;&#x627E;blog.files&#x4E0E;blog.chunks&#x4E24;&#x4E2A;&#x5757;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;fs</p>
<p>[field]: &#x67E5;&#x8BE2;&#x5B57;&#x6BB5;&#xFF0C;&#x4FDD;&#x8BC1;mongdb&#x91CC;&#x6709;&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x540D;&#xFF0C;&#x652F;&#x6301;_id, filename, &#x53EF;&#x7701;&#x7565;, &#x9ED8;&#x8BA4;&#x662F;_id</p>
<p>[type]: &#x89E3;&#x91CA;field&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF0C;&#x652F;&#x6301;objectid, int, string, &#x53EF;&#x7701;&#x7565;, &#x9ED8;&#x8BA4;&#x662F;int</p>
<p>[user]: &#x7528;&#x6237;&#x540D;, &#x53EF;&#x7701;&#x7565;</p>
<p>[pass]: &#x5BC6;&#x7801;, &#x53EF;&#x7701;&#x7565;</p>
<p>mongo: mongodb url</p>
<h3 id="&#x542F;&#x52A8;nginx&#x670D;&#x52A1;">&#x542F;&#x52A8;nginx&#x670D;&#x52A1;</h3><h1 id="/usr/local/nginx/sbin/nginx">/usr/local/nginx/sbin/nginx</h1><p>&#x53EF;&#x80FD;&#x51FA;&#x73B0;&#xFF1A;Nginx [emerg]: bind() to 0.0.0.0:80 failed (98: Address already in use) </p>
<p>&#x8FD9;&#x65F6;&#x53EF;&#x7528;&#x4F7F;&#x7528;&#x547D;&#x4EE4;&#x5173;&#x95ED;&#x5360;&#x7528;80&#x7AEF;&#x53E3;&#x7684;&#x7A0B;&#x5E8F;</p>
<p>sudo fuser -k 80/tcp</p>
<h3 id="&#x7B80;&#x5355;&#x6D4B;&#x8BD5;">&#x7B80;&#x5355;&#x6D4B;&#x8BD5;</h3><p>&#x7528;&#x539F;&#x751F;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x4E0A;&#x4F20;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;</p>
<p>mongofiles put 937910.jpg —local ~/937910_100.jpg —host 192.168.0.159 —port 27017 —db testdb —type jpg</p>
<p>937910.jpg&#x662F;&#x6211;&#x4EEC;&#x63D0;&#x524D;&#x4E0B;&#x8F7D;&#x597D;&#x4E00;&#x4E2A;&#x56FE;&#x7247;&#x6587;&#x4EF6;&#xFF0C;&#x6CE8;&#x610F;&#x6211;&#x4EEC;&#x6CA1;&#x6709;&#x6307;&#x5B9A;collection&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;fs</p>
<p>&#x4ECE; <a href="http://www.robomongo.org/" target="_blank" rel="external">http://www.robomongo.org/</a> &#x5B89;&#x88C5;robomongo&#x7BA1;&#x7406;&#x5DE5;&#x5177;, &#x67E5;&#x770B;&#x521A;&#x521A;&#x4E0A;&#x4F20;&#x7684;&#x6587;&#x4EF6; </p>
<p><img src="http://taojinke.github.io/img/20150708/4da4a15.png" alt="image"></p>
<p>&#x6700;&#x540E;&#x6211;&#x4EEC;&#x5728;&#x6D4F;&#x89C8;&#x5668;&#x8BBF;&#x95EE;&#xFF0C;&#x5982;&#x679C;&#x770B;&#x5230;&#x56FE;&#x7247;&#x5C31;OK&#x4E86;</p>
<p><a href="http://192.168.0.159/img/937910.jpg" target="_blank" rel="external">http://192.168.0.159/img/937910.jpg</a></p>
<p>&#x5BF9;&#x4E8E;.net&#x73AF;&#x5883;&#x4E0B;mongodb CSharpDriver&#xA0; 1.10.0 &#x4ECE;Nuget:</p>
<p>Install-Package mongocsharpdriver -Version 1.10.0</p>
<p>&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x5982;&#x4E0B;&#x7247;&#x6BB5;&#x4EE3;&#x7801;:</p>
<pre><code>int nFileLen = fileUploadModel.<span class="class">FileBytes</span>.<span class="class">Length</span>;
<span class="class">MongoGridFSSettings</span> fsSetting = new <span class="class">MongoGridFSSettings</span>() { <span class="class">Root</span> = <span class="class">CollectionName</span> };
<span class="class">MongoGridFS</span> fs = new <span class="class">MongoGridFS</span>(mongoServer, <span class="class">MongoDatabaseName</span>, fsSetting);
//&amp;<span class="symbol">#x8C03</span>;&amp;<span class="symbol">#x7528</span>;<span class="class">Write</span>&amp;<span class="symbol">#x3001</span>;<span class="class">WriteByte</span>&amp;<span class="symbol">#x3001</span>;<span class="class">WriteLine</span>&amp;<span class="symbol">#x51FD</span>;&amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x65F6</span>;&amp;<span class="symbol">#x9700</span>;&amp;<span class="symbol">#x8981</span>;&amp;<span class="symbol">#x624B</span>;&amp;<span class="symbol">#x52A8</span>;&amp;<span class="symbol">#x8BBE</span>;&amp;<span class="symbol">#x7F6E</span>;&amp;<span class="symbol">#x4E0A</span>;&amp;<span class="symbol">#x4F20</span>;&amp;<span class="symbol">#x65F6</span>;&amp;<span class="symbol">#x95F4</span>;
//&amp;<span class="symbol">#x901A</span>;&amp;<span class="symbol">#x8FC7</span>;<span class="class">Metadata</span> &amp;<span class="symbol">#x6DFB</span>;&amp;<span class="symbol">#x52A0</span>;&amp;<span class="symbol">#x9644</span>;&amp;<span class="symbol">#x52A0</span>;&amp;<span class="symbol">#x4FE1</span>;&amp;<span class="symbol">#x606F</span>;
<span class="class">MongoGridFSCreateOptions</span> option = new <span class="class">MongoGridFSCreateOptions</span>();
option.<span class="class">Id</span> = <span class="class">ObjectId</span>.<span class="class">GenerateNewId</span>();
var currentDate = <span class="class">DateTime</span>.<span class="class">Now</span>;
option.<span class="class">UploadDate</span> = currentDate;
option.<span class="class">Aliases</span> = alias;
<span class="class">BsonDocument</span> doc = new <span class="class">BsonDocument</span>();
//&amp;<span class="symbol">#x6587</span>;&amp;<span class="symbol">#x6863</span>;&amp;<span class="symbol">#x9644</span>;&amp;<span class="symbol">#x52A0</span>;&amp;<span class="symbol">#x4FE1</span>;&amp;<span class="symbol">#x606F</span>;&amp;<span class="symbol">#x5B58</span>;&amp;<span class="symbol">#x50A8</span>;
if(fileUploadModel.<span class="class">DocExtraInfo</span>!=null&amp;amp;&amp;amp;fileUploadModel.<span class="class">DocExtraInfo</span>.<span class="class">Count</span>&amp;gt;<span class="number">0</span>)
{
    foreach(var obj in fileUploadModel.<span class="class">DocExtraInfo</span>)
    {
        if (!doc.<span class="class">Elements</span>.<span class="class">Any</span>(p =&amp;gt; p.<span class="class">Name</span> == obj.<span class="class">Key</span>))
        {
            doc.<span class="class">Add</span>(obj.<span class="class">Key</span>, obj.<span class="class">Value</span>);
        }
    }
}
option.<span class="class">Metadata</span> = doc;
//&amp;<span class="symbol">#x521B</span>;&amp;<span class="symbol">#x5EFA</span>;&amp;<span class="symbol">#x6587</span>;&amp;<span class="symbol">#x4EF6</span>;&amp;<span class="symbol">#xFF0C</span>;&amp;<span class="symbol">#x6587</span>;&amp;<span class="symbol">#x4EF6</span>;&amp;<span class="symbol">#x5E76</span>;&amp;<span class="symbol">#x5B58</span>;&amp;<span class="symbol">#x50A8</span>;&amp;<span class="symbol">#x6570</span>;&amp;<span class="symbol">#x636E</span>;
using (<span class="class">MongoGridFSStream</span> gfs = fs.<span class="class">Create</span>(fileUploadModel.<span class="class">FileName</span>, option))
{
    gfs.<span class="class">Write</span>(fileUploadModel.<span class="class">FileBytes</span>, <span class="number">0</span>, nFileLen);
    gfs.<span class="class">Close</span>();
}
log.<span class="class">ErrorFormat</span>(&amp;quot;&amp;<span class="symbol">#x9644</span>;&amp;<span class="symbol">#x4EF6</span>;&amp;<span class="symbol">#x6807</span>;&amp;<span class="symbol">#x8BC6</span>;&amp;<span class="symbol">#xFF1A</span>;{<span class="number">0</span>} &amp;<span class="symbol">#x6587</span>;&amp;<span class="symbol">#x4EF6</span>;&amp;<span class="symbol">#x540D</span>;&amp;<span class="symbol">#xFF1A</span>;{<span class="number">1</span>} &amp;<span class="symbol">#x4E0A</span>;&amp;<span class="symbol">#x4F20</span>;&amp;<span class="symbol">#x6210</span>;&amp;<span class="symbol">#x529F</span>;&amp;quot;, alias, fileUploadModel.<span class="class">FileName</span>);
return option.<span class="class">Id</span>.<span class="class">ToString</span>();
</code></pre><p>&#x6CE8;&#x610F;&#xFF0C;&#x76EE;&#x524D;gridfs-ngnix&#x4E0D;&#x652F;&#x6301;_id&#x7C7B;&#x578B;&#x662F;GUID&#x7684;&#xFF0C;&#x5173;&#x4E8E;ObjectId&#x53C2;&#x8003; <a href="http://docs.mongodb.org/manual/reference/object-id/" target="_blank" rel="external">&#x5B98;&#x7F51;</a> &#xFF0C;&#x5982;&#x4E0B;&#x56FE;: </p>
<p><img src="http://taojinke.github.io/img/20150708/4da4a15.png" alt="mongodb-objectid"></p>
<p>mongodb&#x4EA7;&#x751F;objectid&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x66F4;&#x5927;&#x7684;&#x4F18;&#x52BF;&#xFF0C;&#x5C31;&#x662F;mongodb&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x81EA;&#x8EAB;&#x7684;&#x670D;&#x52A1;&#x6765;&#x4EA7;&#x751F;objectid&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#x6765;&#x4EA7;&#x751F;&#x3002;</p>
<h3 id="&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x4F7F;&#x7528;Gridfs">&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x4F7F;&#x7528;Gridfs</h3><p>&#x6765;&#x81EA;&#x5B98;&#x65B9;2.6.10&#x7248;&#x672C; &#x624B;&#x518C;&#x5185;&#x5BB9;</p>
<p>For documents in a MongoDB collection, you should always use GridFS for storing files <strong>larger than</strong> 16 MB.&#xA0; In some situations, storing large files may be more efficient in a MongoDB database than on a system-level filesystem. </p>
<p>&#x2022; If your filesystem limits the number of files in a directory, you can use GridFS to store as many files as needed.</p>
<p>&#x2022; When you want to keep your files and metadata automatically synced and deployed across a number of systems and facilities. When using geographically distributed replica sets MongoDB can distribute files and their metadata automatically to a number of mongod instances and&#xA0; facilities.</p>
<p>&#x2022; When you want to access information from portions of large files without having to load whole files into memory, you can use GridFS to recall sections of files without reading the entire file into memory.</p>
<p>Do not use GridFS if you need to update the content of the entire file atomically. As an alternative you can store multiple versions of each file and specify the current version of the file in the metadata. You can update the metadata field that indicates &#x201C;latest&#x201D; status in an atomic update after uploading the new version of the file, and later remove previous versions if needed.</p>
<p>Furthermore, if your files are all smaller the 16 MB BSON Document Size limit, consider storing the file manually within a single document. You may use the BinData data type to store the binary data. See your drivers documentation for details on using BinData.</p>
<h3 id="&#x6570;&#x636E;&#x5E93;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;">&#x6570;&#x636E;&#x5E93;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;</h3><p>&#x539F;&#x7406;&#x56FE;</p>
<p><img src="http://taojinke.github.io/img/20150708/4da4c86.png" alt="mongodbre"></p>
<p>&#x4E0A;&#x56FE;&#x662F;MongoDB&#x91C7;&#x7528;Replica Sets&#x6A21;&#x5F0F;&#x7684;&#x540C;&#x6B65;&#x6D41;&#x7A0B;</p>
<ul>
<li>&#x7EA2;&#x8272;&#x7BAD;&#x5934;&#x8868;&#x793A;&#x5199;&#x64CD;&#x4F5C;&#x5199;&#x5230;Primary&#x4E0A;&#xFF0C;&#x7136;&#x540E;&#x5F02;&#x6B65;&#x540C;&#x6B65;&#x5230;&#x591A;&#x4E2A;Secondary&#x4E0A;</li>
<li>&#x84DD;&#x8272;&#x7BAD;&#x5934;&#x8868;&#x793A;&#x8BFB;&#x64CD;&#x4F5C;&#x53EF;&#x4EE5;&#x4ECE;Primary&#x6216;Secondary&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x4E0A;&#x8BFB;</li>
<li>&#x5404;&#x4E2A;Primary&#x4E0E;Secondary&#x4E4B;&#x95F4;&#x4E00;&#x76F4;&#x4FDD;&#x6301;&#x5FC3;&#x8DF3;&#x540C;&#x6B65;&#x68C0;&#x6D4B;&#xFF0C;&#x7528;&#x4E8E;&#x5224;&#x65AD;Replica Sets&#x7684;&#x72B6;&#x6001;</li>
</ul>
<h3 id="&#x6570;&#x636E;&#x5206;&#x7247;&#x673A;&#x5236;">&#x6570;&#x636E;&#x5206;&#x7247;&#x673A;&#x5236;</h3><p><img src="http://taojinke.github.io/img/20150708/4da4c86.png" alt="wlqvf"></p>
<ul>
<li>MongoDB&#x7684;&#x5206;&#x7247;&#x662F;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x5206;&#x7247;key&#x6765;&#x8FDB;&#x884C;&#xFF0C;&#x6570;&#x636E;&#x6309;&#x8303;&#x56F4;&#x5206;&#x6210;&#x4E0D;&#x540C;&#x7684;chunk&#xFF0C;&#x6BCF;&#x4E2A;chunk&#x7684;&#x5927;&#x5C0F;&#x6709;&#x9650;&#x5236;</li>
<li>&#x6709;&#x591A;&#x4E2A;&#x5206;&#x7247;&#x8282;&#x70B9;&#x4FDD;&#x5B58;&#x8FD9;&#x4E9B;chunk&#xFF0C;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x4FDD;&#x5B58;&#x4E00;&#x90E8;&#x5206;&#x7684;chunk</li>
<li>&#x6BCF;&#x4E00;&#x4E2A;&#x5206;&#x7247;&#x8282;&#x70B9;&#x90FD;&#x662F;&#x4E00;&#x4E2A;Replica Sets&#xFF0C;&#x8FD9;&#x6837;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x7684;&#x5B89;&#x5168;&#x6027;</li>
<li>&#x5F53;&#x4E00;&#x4E2A;chunk&#x8D85;&#x8FC7;&#x5176;&#x9650;&#x5236;&#x7684;&#x6700;&#x5927;&#x4F53;&#x79EF;&#x65F6;&#xFF0C;&#x4F1A;&#x5206;&#x88C2;&#x6210;&#x4E24;&#x4E2A;&#x5C0F;&#x7684;chunk</li>
<li>&#x5F53;chunk&#x5728;&#x5206;&#x7247;&#x8282;&#x70B9;&#x4E2D;&#x5206;&#x5E03;&#x4E0D;&#x5747;&#x8861;&#x65F6;&#xFF0C;&#x4F1A;&#x5F15;&#x53D1;chunk&#x8FC1;&#x79FB;&#x64CD;&#x4F5C;</li>
</ul>
<h3 id="&#x5206;&#x7247;&#x65F6;&#x670D;&#x52A1;&#x5668;&#x89D2;&#x8272;">&#x5206;&#x7247;&#x65F6;&#x670D;&#x52A1;&#x5668;&#x89D2;&#x8272;</h3><p><img src="http://taojinke.github.io/img/20150708/4da4ef7.png" alt="RArrX"></p>
<p>&#x4E0A;&#x9762;&#x8BB2;&#x4E86;&#x5206;&#x7247;&#x7684;&#x6807;&#x51C6;&#xFF0C;&#x4E0B;&#x9762;&#x662F;&#x5177;&#x4F53;&#x5728;&#x5206;&#x7247;&#x65F6;&#x7684;&#x51E0;&#x79CD;&#x8282;&#x70B9;&#x89D2;&#x8272;</p>
<ul>
<li>&#x5BA2;&#x6237;&#x7AEF;&#x8BBF;&#x95EE;&#x8DEF;&#x7531;&#x8282;&#x70B9;mongos&#x6765;&#x8FDB;&#x884C;&#x6570;&#x636E;&#x8BFB;&#x5199;</li>
<li>config&#x670D;&#x52A1;&#x5668;&#x4FDD;&#x5B58;&#x4E86;&#x4E24;&#x4E2A;&#x6620;&#x5C04;&#x5173;&#x7CFB;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;key&#x503C;&#x7684;&#x533A;&#x95F4;&#x5BF9;&#x5E94;&#x54EA;&#x4E00;&#x4E2A;chunk&#x7684;&#x6620;&#x5C04;&#x5173;&#x7CFB;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x662F;chunk&#x5B58;&#x5728;&#x54EA;&#x4E00;&#x4E2A;&#x5206;&#x7247;&#x8282;&#x70B9;&#x7684;&#x6620;&#x5C04;&#x5173;&#x7CFB;</li>
<li>&#x8DEF;&#x7531;&#x8282;&#x70B9;&#x901A;&#x8FC7;config&#x670D;&#x52A1;&#x5668;&#x83B7;&#x53D6;&#x6570;&#x636E;&#x4FE1;&#x606F;&#xFF0C;&#x901A;&#x8FC7;&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#xFF0C;&#x627E;&#x5230;&#x771F;&#x6B63;&#x5B58;&#x653E;&#x6570;&#x636E;&#x7684;&#x5206;&#x7247;&#x8282;&#x70B9;&#x8FDB;&#x884C;&#x5BF9;&#x5E94;&#x64CD;&#x4F5C;</li>
<li>&#x8DEF;&#x7531;&#x8282;&#x70B9;&#x8FD8;&#x4F1A;&#x5728;&#x5199;&#x64CD;&#x4F5C;&#x65F6;&#x5224;&#x65AD;&#x5F53;&#x524D;chunk&#x662F;&#x5426;&#x8D85;&#x51FA;&#x9650;&#x5B9A;&#x5927;&#x5C0F;&#xFF0C;&#x5982;&#x679C;&#x8D85;&#x51FA;&#xFF0C;&#x5C31;&#x5206;&#x5217;&#x6210;&#x4E24;&#x4E2A;chunk</li>
<li>&#x5BF9;&#x4E8E;&#x6309;&#x5206;&#x7247;key&#x8FDB;&#x884C;&#x7684;&#x67E5;&#x8BE2;&#x548C;update&#x64CD;&#x4F5C;&#x6765;&#x8BF4;&#xFF0C;&#x8DEF;&#x7531;&#x8282;&#x70B9;&#x4F1A;&#x67E5;&#x5230;&#x5177;&#x4F53;&#x7684;chunk&#x7136;&#x540E;&#x518D;&#x8FDB;&#x884C;&#x76F8;&#x5173;&#x7684;&#x5DE5;&#x4F5C;</li>
<li>&#x5BF9;&#x4E8E;&#x4E0D;&#x6309;&#x5206;&#x7247;key&#x8FDB;&#x884C;&#x7684;&#x67E5;&#x8BE2;&#x548C;update&#x64CD;&#x4F5C;&#x6765;&#x8BF4;&#xFF0C;mongos&#x4F1A;&#x5BF9;&#x6240;&#x6709;&#x4E0B;&#x5C5E;&#x8282;&#x70B9;&#x53D1;&#x9001;&#x8BF7;&#x6C42;&#x7136;&#x540E;&#x518D;&#x5BF9;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x8FDB;&#x884C;&#x5408;&#x5E76;</li>
</ul>
<h3 id="&#x5176;&#x5B83;&#x5173;&#x4E8E;mongodb_&#x7684;&#x4E00;&#x4E9B;&#x5C0F;&#x63D0;&#x793A;:">&#x5176;&#x5B83;&#x5173;&#x4E8E;mongodb &#x7684;&#x4E00;&#x4E9B;&#x5C0F;&#x63D0;&#x793A;:</h3><ul>
<li>&#x4E0D;&#x8981;&#x4F7F;&#x7528;32&#x4F4D;&#x7248;&#x672C;</li>
</ul>
<p>MongoDB&#x7684;32&#x4F4D;&#x7248;&#x672C;&#x4E5F;&#x662F;&#x4E0D;&#x5EFA;&#x8BAE;&#x88AB;&#x4F7F;&#x7528;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x4F60;&#x53EA;&#x80FD;&#x5904;&#x7406;2GB&#x5927;&#x5C0F;&#x7684;&#x6570;&#x636E;&#x3002;&#x8FD8;&#x8BB0;&#x5F97;&#x7B2C;&#x4E00;&#x4E2A;&#x9650;&#x5236;&#x4E48;&#xFF1F;&#x8FD9;&#x662F;MongoDB&#x5173;&#x4E8E;&#x8BE5;&#x9650;&#x5236;&#x7684; <a href="http://blog.mongodb.org/post/137788967/32-bit-limitations" target="_blank" rel="external">&#x8BF4;&#x660E;</a> &#x3002; </p>
<ul>
<li>&#x4E86;&#x89E3;&#x5B98;&#x65B9;&#x7684;&#x9650;&#x5236;</li>
</ul>
<p>&#x8BA9;&#x6211;&#x611F;&#x5230;&#x60CA;&#x8BB6;&#x7684;&#x662F;&#xFF0C;&#x5F88;&#x5C11;&#x6709;&#x4EBA;&#x4F1A;&#x67E5;&#x8BE2;&#x5173;&#x4E8E;&#x4ED6;&#x4EEC;&#x5C06;&#x8981;&#x4F7F;&#x7528;&#x7684;&#x5DE5;&#x5177;&#x7684;&#x9650;&#x5236;&#x3002;&#x5E78;&#x597D;&#xFF0C;MongoDB&#x7684;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x53D1;&#x5E03;&#x4E86;&#x4E00;&#x7BC7;MongoDB&#x6240;&#x6709;&#x9650;&#x5236;&#x7684; <a href="http://docs.mongodb.org/manual/reference/limits/" target="_blank" rel="external">&#x535A;&#x5BA2;</a> &#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x63D0;&#x524D;&#x4E86;&#x89E3;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#xFF0C;&#x907F;&#x514D;&#x5728;&#x4F7F;&#x7528;&#x8FC7;&#x7A0B;&#x4E2D;&#x96BE;&#x582A;&#x3002; </p>
<ul>
<li>&#x4E3B;&#x4ECE;&#x590D;&#x5236;&#x4E0D;&#x4F1A;&#x786E;&#x4FDD;&#x9AD8;&#x53EF;&#x7528;&#x6027;</li>
</ul>
<p>&#x5C3D;&#x7BA1;&#x5DF2;&#x7ECF;&#x4E0D;&#x5EFA;&#x8BAE;&#x88AB;&#x4F7F;&#x7528;&#x4E86;&#xFF0C;&#x4E0D;&#x8FC7;MongoDB&#x8FD8;&#x662F;&#x63D0;&#x4F9B;&#x4E86;&#x53E6;&#x5916;&#x4E00;&#x79CD;&#x590D;&#x5236;&#x7B56;&#x7565;&#xFF0C;&#x5373;&#x4E3B;&#x4ECE;&#x590D;&#x5236;&#x3002;&#x5B83;&#x89E3;&#x51B3;&#x4E86;12&#x4E2A;&#x8282;&#x70B9;&#x9650;&#x5236;&#x95EE;&#x9898;&#xFF0C;&#x4E0D;&#x8FC7;&#x5374;&#x4EA7;&#x751F;&#x4E86;&#x65B0;&#x7684;&#x95EE;&#x9898;&#xFF1A;&#x5982;&#x679C;&#x9700;&#x8981;&#x6539;&#x53D8;&#x96C6;&#x7FA4;&#x7684;&#x4E3B;&#x8282;&#x70B9;&#xFF0C;&#x90A3;&#x4E48;&#x4F60;&#x5FC5;&#x987B;&#x5F97;&#x624B;&#x5DE5;&#x5B8C;&#x6210;&#xFF0C;&#x611F;&#x5230;&#x60CA;&#x8BB6;&#xFF1F;&#x770B;&#x770B;&#x8FD9;&#x4E2A; <a href="http://docs.mongodb.org/manual/core/master-slave/" target="_blank" rel="external">&#x94FE;&#x63A5;</a> &#x5427;&#x3002; </p>
<ul>
<li>&#x901A;&#x8FC7;&#x590D;&#x5236;&#x96C6;&#x5B9E;&#x73B0;&#x7684;&#x6570;&#x636E;&#x590D;&#x5236;&#x6548;&#x679C;&#x975E;&#x5E38;&#x68D2;&#xFF0C;&#x4E0D;&#x8FC7;&#x4E5F;&#x6709;&#x9650;&#x5236;</li>
</ul>
<p>MongoDB&#x4E2D;&#x6570;&#x636E;&#x590D;&#x5236;&#x7684;&#x590D;&#x5236;&#x96C6;&#x7B56;&#x7565;&#x975E;&#x5E38;&#x68D2;&#xFF0C;&#x5F88;&#x5BB9;&#x6613;&#x914D;&#x7F6E;&#x5E76;&#x4E14;&#x4F7F;&#x7528;&#x8D77;&#x6765;&#x786E;&#x5B9E;&#x4E0D;&#x9519;&#x3002;&#x4F46;&#x5982;&#x679C;&#x96C6;&#x7FA4;&#x7684;&#x8282;&#x70B9;&#x6709;12&#x4E2A;&#x4EE5;&#x4E0A;&#xFF0C;&#x90A3;&#x4E48;&#x4F60;&#x5C31;&#x4F1A;&#x9047;&#x5230;&#x95EE;&#x9898;&#x3002;MongoDB&#x4E2D;&#x7684;&#x590D;&#x5236;&#x96C6;&#x6709;12&#x4E2A;&#x8282;&#x70B9;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x95EE;&#x9898;&#x7684;&#x63CF;&#x8FF0;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x8FFD;&#x8E2A;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x770B;&#x770B;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x88AB;&#x89E3;&#x51B3;&#x4E86;&#x3002;</p>
<h3 id="&#x7ED3;&#x8BBA;">&#x7ED3;&#x8BBA;</h3><p>Gridfs&#x6700;&#x9002;&#x5408;&#x5927;&#x6587;&#x4EF6;&#x5B58;&#x50A8; &#xFF0C;&#x7279;&#x522B;&#x662F;&#x89C6;&#x9891;&#xFF0C;&#x97F3;&#x9891;&#xFF0C;&#x5927;&#x578B;&#x56FE;&#x7247;&#x8D85;&#x8FC7;16MB&#x5927;&#x5C0F;&#x7684;&#x6587;&#x4EF6;&#x3002;&#x5C0F;&#x578B;&#x6587;&#x4EF6;&#x4E5F;&#x53EF;&#x4EE5;&#x5B58;&#x50A8;&#xFF0C;&#x4E0D;&#x8FC7;&#x9700;&#x8981;&#x4ED8;&#x51FA;2&#x6B21;&#x67E5;&#x8BE2;&#x4EE3;&#x4EF7;(metadata&#x4E0E;file content) [Tip#18 <a href="http://www.amazon.com/MongoDB-Developers-Kristina-Chodorow-published/dp/B00EKYSTNC/ref=sr_1_2?ie=UTF8&amp;qid=1436080688&amp;sr=8-2&amp;keywords=50+Tips+and+Tricks+for+MongoDB+Developers&amp;pebp=1436080699671&amp;perid=1AHGRNQ81QNF615GVVBC" target="_blank" rel="external">50 Tips and Tricks for MongoDB Developers</a> ]&#x3002;&#x4E0D;&#x8981;&#x4FEE;&#x6539;&#x5B58;&#x50A8;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x800C;&#x662F;&#x66F4;&#x65B0;&#x6587;&#x4EF6;&#x5143;&#x6570;&#x636E;&#x5982;&#x7248;&#x672C;&#xFF0C;&#x6216;&#x4E0A;&#x4F20;&#x65B0;&#x7248;&#x672C;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x5220;&#x9664;&#x8001;&#x7248;&#x672C;&#x7684;&#x6587;&#x4EF6;&#x3002;&#x5BF9;&#x4E8E;&#x5927;&#x91CF;&#x6587;&#x4EF6;&#x5B58;&#x50A8;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x591A;&#x4E2A;&#x6570;&#x636E;&#x8282;&#x70B9;&#xFF0C;&#x590D;&#x5236;&#xFF0C;&#x6570;&#x636E;&#x5206;&#x7247;&#x7B49;&#x3002;&#x522B;&#x57FA;&#x4E8E;nginx&#x8BBF;&#x95EE;&#x56FE;&#x7247;&#x6587;&#x4EF6;&#xFF0C;&#x6D4F;&#x89C8;&#x5668;&#x6CA1;&#x6709;&#x7F13;&#x5B58;&#x3002; &#x4ECE;&#x4E92;&#x8054;&#x7F51;&#x5B58;&#x50A8;&#x56FE;&#x7247;&#x6848;&#x4F8B;&#x6765;&#x770B;&#xFF0C;&#x56FE;&#x7247;&#x5927;&#x90FD;&#x662F;jpg, png&#x4E0E;&#x7F29;&#x7565;&#x56FE;&#x6587;&#x4EF6;&#xFF0C;&#x5206;&#x5B58;&#x5F0F;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;(DFS)&#x4F1A;&#x662F;&#x66F4;&#x597D;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x3002; </p>
<h3 id="&#x8D44;&#x6E90;&#xFF1A;">&#x8D44;&#x6E90;&#xFF1A;</h3><p><a href="https://docs.mongodb.org/v2.6/core/gridfs/" target="_blank" rel="external">GridFS&#x5B98;&#x65B9;</a><a href="https://www.mongodb.com/blog/post/building-mongodb-applications-binary-files-using-gridfs-part-1?jmp=docs" target="_blank" rel="external">Building MongoDB Applications with Binary Files Using GridFS</a></p>
<p>&#x5E0C;&#x671B;&#x5BF9;&#x60A8;&#x8F6F;&#x4EF6;&#x5F00;&#x53D1;&#x6709;&#x5E2E;&#x52A9;&#x3002; &#x5176;&#x5B83;&#x60A8;&#x53EF;&#x80FD;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x6587;&#x7AE0;&#xFF1A;</p>
<p><a href="http://www.cnblogs.com/wintersun/p/4573969.html" target="_blank" rel="external">&#x80FD;&#x529B;&#x7D20;&#x8D28;&#x6A21;&#x578B;&#x54A8;&#x8BE2;&#x5DE5;&#x5177;(Part1)</a><a href="http://www.cnblogs.com/wintersun/p/4192493.html" target="_blank" rel="external">&#x4F01;&#x4E1A;&#x5E94;&#x7528;&#x4E4B;&#x6027;&#x80FD;&#x5B9E;&#x65F6;&#x5EA6;&#x91CF;&#x7CFB;&#x7EDF;&#x6F14;&#x53D8;</a> &#x4E91;&#x8BA1;&#x7B97;&#x53C2;&#x8003;&#x67B6;&#x6784;&#x51E0;&#x4F8B; <a href="http://www.cnblogs.com/wintersun/p/3871433.html" target="_blank" rel="external">&#x667A;&#x80FD;&#x79FB;&#x52A8;&#x5BFC;&#x6E38;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x7B80;&#x4ECB;</a><a href="http://www.cnblogs.com/wintersun/p/4279863.html" target="_blank" rel="external">&#x4EBA;&#x529B;&#x8D44;&#x6E90;&#x7BA1;&#x7406;&#x7CFB;&#x7EDF;&#x7684;&#x6F14;&#x5316;</a>&#x5982;&#x6709;&#x60F3;&#x4E86;&#x89E3;&#x66F4;&#x591A;&#x8F6F;&#x4EF6;,&#x7CFB;&#x7EDF; IT,&#x4F01;&#x4E1A;&#x4FE1;&#x606F;&#x5316; &#x8D44;&#x8BAF;&#xFF0C;&#x8BF7;&#x5173;&#x6CE8;&#x6211;&#x7684;&#x5FAE;&#x4FE1;&#x8BA2;&#x9605;&#x53F7;&#xFF1A;</p>
<p><img src="http://taojinke.github.io/img/20150708/4da5168.jpg" alt="MegadotnetMicroMsg_thumb1_thumb1_thu[1]"></p>
<p>&#x4F5C;&#x8005;&#xFF1A;Petter Liu </p>
<p>&#x51FA;&#x5904;&#xFF1A; <a href="http://www.cnblogs.com/wintersun/" target="_blank" rel="external">http://www.cnblogs.com/wintersun/</a></p>
<p>&#x672C;&#x6587;&#x7248;&#x6743;&#x5F52;&#x4F5C;&#x8005;&#x548C;&#x535A;&#x5BA2;&#x56ED;&#x5171;&#x6709;&#xFF0C;&#x6B22;&#x8FCE;&#x8F6C;&#x8F7D;&#xFF0C;&#x4F46;&#x672A;&#x7ECF;&#x4F5C;&#x8005;&#x540C;&#x610F;&#x5FC5;&#x987B;&#x4FDD;&#x7559;&#x6B64;&#x6BB5;&#x58F0;&#x660E;&#xFF0C;&#x4E14;&#x5728;&#x6587;&#x7AE0;&#x9875;&#x9762;&#x660E;&#x663E;&#x4F4D;&#x7F6E;&#x7ED9;&#x51FA;&#x539F;&#x6587;&#x8FDE;&#x63A5;&#xFF0C;&#x5426;&#x5219;&#x4FDD;&#x7559;&#x8FFD;&#x7A76;&#x6CD5;&#x5F8B;&#x8D23;&#x4EFB;&#x7684;&#x6743;&#x5229;&#x3002;</p>
<p>&#x8BE5;&#x6587;&#x7AE0;&#x4E5F;&#x540C;&#x65F6;&#x53D1;&#x5E03;&#x5728;&#x6211;&#x7684;&#x72EC;&#x7ACB;&#x535A;&#x5BA2;&#x4E2D;-Petter Liu Blog&#x3002; </p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/MongoDB/">MongoDB</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/08/4d5e709/" title="MySQL Cluster 与 MongoDB 复制及分片设计及原理 -" itemprop="url">MySQL Cluster 与 MongoDB 复制及分片设计及原理 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-08T02:33:29.000Z" itemprop="datePublished"> 发表于 2015-07-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>&#x5206;&#x5E03;&#x5F0F;&#x6570;&#x636E;&#x5E93;&#x8BA1;&#x7B97;&#x6D89;&#x53CA;&#x5230;&#x5206;&#x5E03;&#x5F0F;&#x4E8B;&#x52A1;&#x3001;&#x6570;&#x636E;&#x5206;&#x5E03;&#x3001;&#x6570;&#x636E;&#x6536;&#x655B;&#x8BA1;&#x7B97;&#x7B49;&#x7B49;&#x8981;&#x6C42;</p>
<p>&#x5206;&#x5E03;&#x5F0F;&#x6570;&#x636E;&#x5E93;&#x80FD;&#x5B9E;&#x73B0;&#x9AD8;&#x5B89;&#x5168;&#x3001;&#x9AD8;&#x6027;&#x80FD;&#x3001;&#x9AD8;&#x53EF;&#x7528;&#x7B49;&#x7279;&#x5F81;&#xFF0C;&#x5F53;&#x7136;&#x4E5F;&#x5E26;&#x6765;&#x4E86;&#x9AD8;&#x6210;&#x672C;(&#x56FA;&#x5B9A;&#x6210;&#x672C;&#x53CA;&#x8FD0;&#x8425;&#x6210;&#x672C;)&#xFF0C;&#x6211;&#x4EEC;&#x901A;&#x8FC7;MongoDB&#x53CA;MySQL Cluster&#x4ECE;&#x5B9E;&#x73B0;&#x4E0A;&#x6765;&#x5206;&#x6790;&#x5176;&#x4E2D;&#x7684;&#x8BBE;&#x8BA1;&#x601D;&#x8DEF;&#xFF0C;&#x7528;&#x4EE5;&#x62BD;&#x8C61;&#x6211;&#x4EEC;&#x5728;&#x8BBE;&#x8BA1;&#x6570;&#x636E;&#x5E93;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x5F15;&#x7528;&#x7684;&#x90E8;&#x5206;&#x8BBE;&#x8BA1;&#x65B9;&#x6CD5;&#xFF0C;&#x5E94;&#x7528;&#x4E8E;&#x6211;&#x4EEC;&#x7684;&#x751F;&#x4EA7;&#x7CFB;&#x7EDF;</p>
<p>&#x9996;&#x5148;&#x8BF4;&#x8BF4;&#x5173;&#x7CFB;&#x53CA;&#x975E;&#x5173;&#x7CFB;&#x6570;&#x636E;&#x5E93;&#x7684;&#x7279;&#x5F81;</p>
<p>MySQL&#x7684;Innodb&#x53CA;Cluster&#x62E5;&#x6709;&#x5B8C;&#x6574;&#x7684;ACID&#x5C5E;&#x6027;</p>
<p>A&#xA0;&#x539F;&#x5B50;&#x6027; &#xA0;&#x6574;&#x4E2A;&#x4E8B;&#x52A1;&#x5C06;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x6574;&#x4F53;&#xFF0C;&#x8981;&#x4E48;&#x5B8C;&#x6210;&#xFF0C;&#x8981;&#x4E48;&#x56DE;&#x6EDA;</p>
<p>C&#xA0;&#x4E00;&#x81F4;&#x6027;&#xA0;&#x4E8B;&#x52A1;&#x5F00;&#x59CB;&#x4E4B;&#x524D;&#x548C;&#x4E8B;&#x52A1;&#x7ED3;&#x675F;&#x4EE5;&#x540E;&#xFF0C;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5B8C;&#x6574;&#x6027;&#x9650;&#x5236;&#x6CA1;&#x6709;&#x88AB;&#x7834;&#x574F;</p>
<p>I &#x9694;&#x79BB;&#x6027;&#xA0;&#x4E24;&#x4E2A;&#x4E8B;&#x52A1;&#x7684;&#x6267;&#x884C;&#x662F;&#x4E92;&#x4E0D;&#x5E72;&#x6270;&#x7684;&#xFF0C;&#x4E24;&#x4E2A;&#x4E8B;&#x52A1;&#x65F6;&#x95F4;&#x4E0D;&#x4F1A;&#x4E92;&#x76F8;&#x5F71;&#x54CD;</p>
<p>D&#xA0;&#x6301;&#x4E45;&#x6027; &#x5728;&#x4E8B;&#x52A1;&#x5B8C;&#x6210;&#x4EE5;&#x540E;&#xFF0C;&#x8BE5;&#x4E8B;&#x52A1;&#x5BF9;&#x6570;&#x636E;&#x5E93;&#x6240;&#x4F5C;&#x7684;&#x66F4;&#x6539;&#x4FBF;&#x6301;&#x4E45;&#x5730;&#x4FDD;&#x5B58;&#x5728;&#x6570;&#x636E;&#x5E93;&#x4E4B;&#x4E2D;&#xFF0C;&#x5E76;&#x4E14;&#x662F;&#x5B8C;&#x5168;&#x7684;</p>
<p>&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;ACID&#xFF0C;&#x5F15;&#x5165;&#x4E86;&#x8BF8;&#x5982;Undo&#x3001;Redo&#x3001;MVCC&#x3001;TAS&#x3001;&#x4FE1;&#x53F7;&#x3001;&#x4E24;&#x9636;&#x6BB5;&#x5C01;&#x9501;&#x3001;&#x4E24;&#x9636;&#x6BB5;&#x63D0;&#x4EA4;&#x3001;&#x5C01;&#x9501;&#x7B49;&#x5B9E;&#x73B0;&#xFF0C;&#x5F15;&#x5165;&#x4E86;&#x6570;&#x636E;&#x5B58;&#x53D6;&#x8DEF;&#x5F84;&#xFF0C;&#x6574;&#x4E2A;&#x4E8B;&#x60C5;&#x53D8;&#x5F97;&#x5C06;&#x6781;&#x5176;&#x590D;&#x6742;</p>
<p>MySQL&#x9075;&#x5FAA;SQL&#x6807;&#x51C6;&#x3001;&#x4F7F;&#x7528;SQL&#x6807;&#x51C6;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x505A;&#x5230;RDBMS&#x4E4B;&#x95F4;&#x7684;&#x65E0;&#x7F1D;&#x8FC1;&#x79FB;</p>
<p>&#x5176;&#x4E30;&#x5BCC;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x3001;&#x5B8C;&#x6574;&#x7684;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x63A7;&#x5236;&#x53CA;&#x8868;&#x8FBE;&#x80FD;&#x529B;&#x4E00;&#x76F4;&#x4F5C;&#x4E3A;&#x5546;&#x4E1A;&#x5E94;&#x7528;&#x7684;&#x9996;&#x9009;</p>
<p>MongoDB&#x4F7F;&#x7528;&#x96C6;&#x5408;&#x8868;&#x793A;&#x6570;&#x636E;&#xFF0C;&#x4E0D;&#x62E5;&#x6709;ACID&#x5C5E;&#x6027;&#xFF0C;&#x4F46;&#x5176;&#x65E0;&#x7C7B;&#x578B;&#x3001;&#x5FEB;&#x901F;&#x90E8;&#x7F72;&#x53CA;&#x5FEB;&#x901F;&#x5F00;&#x53D1;&#x5F97;&#x5230;&#x4E86;&#x666E;&#x904D;&#x7684;&#x8BA4;&#x53EF;</p>
<p>&#x4E0D;&#x7BA1;&#x662F;RDBMS&#x8FD8;&#x662F;MongoDB&#xFF0C;&#x65E0;&#x4E00;&#x90FD;&#x4F7F;&#x7528;&#x4E86;&#x7D22;&#x5F15;&#x7ED3;&#x6784;&#xFF0C;MongoDB&#x652F;&#x6301;B&#x6811;&#x7D22;&#x5F15;&#xFF0C;&#x7D22;&#x5F15;&#x6839;&#x636E;&#x7528;&#x6237;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x5EFA;&#x7ACB;&#xFF0C;&#x53EF;&#x4EE5;&#x5D4C;&#x5957;&#x5728;&#x5404;&#x4E2A;&#x5C42;&#x6B21;&#x7684;&#x5404;&#x4E2A;&#x5BB9;&#x5668;&#x4E4B;&#x95F4;&#x6784;&#x5EFA;</p>
<p>&#x5728;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#xFF0C;&#x6570;&#x636E;&#x6709;&#x4E24;&#x79CD;&#x5B58;&#x653E;&#x65B9;&#x6CD5;&#xFF1A;</p>
<p>1&#x3001;&#x5806;&#x8868;&#xFF1A;&#x6570;&#x636E;&#x6309;&#x7167;&#x5411;&#x540E;&#x63D2;&#x5165;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4E00;&#x76F4;&#x5806;&#x79EF;&#x5728;&#x6587;&#x4EF6;&#x672B;&#x5C3E;&#xFF0C;&#x4F7F;&#x7528;&#x7D22;&#x5F15;&#x7ED3;&#x6784;&#x8BBF;&#x95EE;&#x6570;&#x636E;&#x65F6;&#xFF0C;&#x5C06;&#x5728;&#x7D22;&#x5F15;&#x4E2D;&#x5F97;&#x5230;&#x6570;&#x636E;&#x6307;&#x9488;&#xFF0C;&#x7136;&#x540E;&#x83B7;&#x53D6;&#x6570;&#x636E;&#xFF0C;&#x5F53;&#x6709;&#x6570;&#x636E;&#x5220;&#x9664;&#x65F6;&#xFF0C;&#x5C06;&#x5176;&#x4ECE;&#x5BF9;&#x5E94;&#x4F4D;&#x7F6E;&#x5220;&#x9664;&#xFF0C;&#x5BF9;&#x4E8E;&#x9891;&#x7E41;&#x66F4;&#x65B0;&#x7684;&#x5806;&#x8868;&#xFF0C;&#x9700;&#x8981;&#x5B9A;&#x671F;&#x8FDB;&#x884C;&#x4F18;&#x5316;&#xFF0C;&#x4F7F;&#x7528;&#x5806;&#x8868;&#xFF0C;&#x4F1A;&#x5BFC;&#x81F4;&#x6570;&#x636E;&#x987A;&#x5E8F;&#x8BBF;&#x95EE;&#x539F;&#x5219;&#x88AB;&#x6253;&#x7834;(&#x5728;DBMS&#x4E2D;&#x505A;&#x4E86;&#x8BBF;&#x95EE;&#x4F18;&#x5316;&#xFF0C;&#x5F97;&#x5230;&#x90E8;&#x5206;&#x4F53;&#x80FD;&#x63D0;&#x5347;)&#xFF0C;&#x7531;&#x4E8E;&#x6CA1;&#x6709;&#x586B;&#x5145;&#x56E0;&#x5B50;&#xFF0C;&#x5728;&#x76F8;&#x540C;&#x538B;&#x7F29;&#x7B97;&#x6CD5;&#x4E0B;&#xFF0C;&#x7A7A;&#x95F4;&#x80FD;&#x5F97;&#x5230;&#x5F88;&#x5927;&#x7684;&#x8282;&#x7701;&#xFF0C;&#x5806;&#x8868;&#x5F88;&#x9002;&#x5408;&#x4E8E;&#x987A;&#x5E8F;&#x8303;&#x56F4;&#x8BBF;&#x95EE;&#xFF0C;&#x5982;&#x6570;&#x636E;&#x4ED3;&#x5E93;&#x7B49;&#x4E1A;&#x52A1;&#x573A;&#x666F;</p>
<p>2&#x3001;&#x7D22;&#x5F15;&#x7EC4;&#x7EC7;&#x8868;&#xFF1A;&#x4E00;&#x822C;&#x7D22;&#x5F15;&#x7EC4;&#x7EC7;&#x8868;&#x4F7F;&#x7528;B+&#x4F5C;&#x4E3A;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#xFF0C;&#x6574;&#x4E2A;&#x7ED3;&#x6784;&#x5982;&#x540C;&#x4E00;&#x4E2A;&#x5012;&#x6302;&#x7684;&#x6811;(&#x4ECE;&#x6570;&#x636E;&#x8BBF;&#x95EE;&#x6D41;&#x6765;&#x770B;)&#xFF0C;&#x8DEF;&#x7531;&#x4FE1;&#x606F;&#x5B58;&#x653E;&#x5728;&#x6811;&#x679D;&#x4E0A;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;&#x5B58;&#x653E;&#x5728;&#x53F6;&#x5B50;&#x8282;&#x70B9;&#xFF0C;&#x901A;&#x8FC7;&#x53CC;&#x5411;&#x6307;&#x9488;&#x5C06;&#x6240;&#x6709;&#x53F6;&#x5B50;&#x6839;&#x636E;&#x987A;&#x5E8F;&#x65B9;&#x5F0F;&#x4E32;&#x8054;&#x8D77;&#x6765;&#xFF0C;&#x7531;&#x4E8E;&#x65F6;&#x7A7A;&#x8BBF;&#x95EE;&#x5C40;&#x9650;&#x7279;&#x6027;&#xFF0C;&#x8FD9;&#x80FD;&#x5F88;&#x5927;&#x63D0;&#x5347;&#x6570;&#x636E;&#x6027;&#x80FD;&#xFF0C;DBMS&#x6839;&#x636E;&#x8BBF;&#x95EE;&#x5B58;&#x53D6;&#x8DEF;&#x5F84;&#x8BBF;&#x95EE;&#x53CA;&#x6784;&#x9020;&#x6570;&#x636E;&#xFF0C;&#x8BBF;&#x95EE;&#x8DEF;&#x5F84;&#x6DF1;&#x5EA6;&#x76F4;&#x63A5;&#x5F71;&#x54CD;&#x4E86;&#x6027;&#x80FD;&#xFF0C;&#x4E00;&#x822C;&#x5EFA;&#x8BAE;&#x8BBF;&#x95EE;&#x8DEF;&#x5F84;&#x63A7;&#x5236;&#x5728;4&#x4EE5;&#x5185;(&#x5C0F;&#x4E8E;&#x6216;&#x7B49;&#x4E8E;3)&#xFF0C;&#x539F;&#x56E0;&#x7531;&#x4E8E;&#x8BBF;&#x95EE;&#x591A;&#x5C42;&#x8DEF;&#x5F84;&#x9700;&#x8981;&#x6D88;&#x8017;&#x66F4;&#x9AD8;&#x7684;&#x4EE3;&#x4EF7;&#x53CA;&#x7EF4;&#x62A4;&#x7D22;&#x5F15;&#x6811;&#x4EE3;&#x4EF7;&#x8D8A;&#x6765;&#x8D8A;&#x6602;&#x8D35;</p>
<p>&#x6211;&#x4EEC;&#x5E38;&#x89C1;&#x7684;Innodb&#x3001;MySQL Cluster&#x7B49;&#x90FD;&#x662F;&#x7D22;&#x5F15;&#x7EC4;&#x7EC7;&#x8868;&#x3001;MyISAM&#x4E3A;&#x5806;&#x8868;&#xFF0C;MongoDB&#x7684;&#x7EC4;&#x7EC7;&#x7ED3;&#x6784;&#x4E3A;&#x5806;&#x8868;</p>
<p>&#x62E5;&#x6709;AICD&#x5C5E;&#x6027;&#x7684;&#x6570;&#x636E;&#x5E93;&#x62E5;&#x6709;&#x7D22;&#x5F15;&#x7EF4;&#x62A4;&#x529F;&#x80FD;&#xFF0C;MyISAM&#x53CA;MongoDB&#x7531;&#x4E8E;&#x662F;&#x5806;&#x8868;&#xFF0C;&#x4E14;&#x6CA1;&#x6709;ACID&#x7684;&#x63A7;&#x5236;&#xFF0C;&#x4F1A;&#x5BFC;&#x81F4;&#x5143;&#x6570;&#x636E;&#x4E0E;&#x7D22;&#x5F15;&#x4E0D;&#x4E00;&#x81F4;&#x95EE;&#x9898;&#xFF0C;&#x76F4;&#x63A5;&#x5BFC;&#x81F4;&#x6570;&#x636E;&#x8BBF;&#x95EE;&#x6DF7;&#x4E71;&#xFF0C;&#x6570;&#x636E;&#x4E0D;&#x4E00;&#x81F4;&#xFF0C;&#x4F46;&#x7531;&#x4E8E;&#x6CA1;&#x6709;ACID&#x7684;&#x8981;&#x6C42;&#xFF0C;&#x66F4;&#x65B0;(&#x672C;&#x6587;&#x6240;&#x9610;&#x8FF0;&#x7684;&#x66F4;&#x65B0;&#x5305;&#x62EC;&#x5305;&#x62EC;&#x6240;&#x6709;&#x7684;&#x5199;&#x5165;&#x64CD;&#x4F5C;)&#x901F;&#x5EA6;&#x5C06;&#x5F97;&#x5230;&#x5F88;&#x5927;&#x7684;&#x63D0;&#x5347;&#xFF0C;MyISAM&#x9700;&#x8981;&#x5B9A;&#x671F;&#x8FDB;&#x884C;&#x4E00;&#x81F4;&#x6027;check</p>
<p>MySQL Cluster &#x67B6;&#x6784;</p>
<p>Cluster&#x5206;&#x4E3A;SQL&#x8282;&#x70B9;&#x3001;&#x6570;&#x636E;&#x8282;&#x70B9;&#x3001;&#x7BA1;&#x7406;&#x8282;&#x70B9;(MySQL Cluster&#x63D0;&#x4F9B;&#x4E86;API&#x4F9B;&#x5185;&#x90E8;&#x8C03;&#x7528;&#xFF0C;&#x5916;&#x90E8;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;API&#x501F;&#x53E3;&#x8BBF;&#x95EE;&#x4EFB;&#x610F;&#x5C42;&#x65B9;&#x6CD5;)</p>
<p>SQL&#x8282;&#x70B9;&#x63D0;&#x4F9B;&#x7528;&#x6237;SQL&#x6307;&#x4EE4;&#x8BF7;&#x6C42;&#xFF0C;&#x89E3;&#x6790;&#x3001;&#x7EF4;&#x62A4;&#x7BA1;&#x7406;&#x8282;&#x70B9;&#x5217;&#x8868;&#x3001;&#x5411;&#x7BA1;&#x7406;&#x8282;&#x70B9;&#x53D1;&#x8D77;&#x5B58;&#x53D6;&#x8DEF;&#x5F84;&#x8BF7;&#x6C42;&#x3001;&#x67E5;&#x8BE2;&#x4F18;&#x5316;&#x3001;&#x6570;&#x636E;merge&#x3001;sort&#xFF0C;&#x88C1;&#x526A;&#x7B49;&#x529F;&#x80FD;</p>
<p>&#x6570;&#x636E;&#x8282;&#x70B9;&#x63D0;&#x4F9B;&#x6570;&#x636E;&#x5B58;&#x53D6;&#xFF0C;&#x6301;&#x4E45;&#x5316;&#x3001;API&#x6570;&#x636E;&#x5B58;&#x53D6;&#x8BBF;&#x95EE;&#x7B49;&#x529F;&#x80FD;</p>
<p>&#x7BA1;&#x7406;&#x8282;&#x70B9;&#x7EF4;&#x62A4;&#x7740;&#x8FD9;&#x4E2A;Cluster&#x4E2D;&#x6240;&#x6709;&#x6570;&#x636E;&#x8282;&#x70B9;&#x7684;&#x5B58;&#x53D6;&#x8DEF;&#x5F84;&#x89C4;&#x5219;&#x3001;&#x5907;&#x4EFD;&#x8C03;&#x5EA6;&#x7B49;&#x529F;&#x80FD;</p>
<p>&#x6570;&#x636E;&#x8282;&#x70B9;&#x4F7F;&#x7528;&#x5206;&#x7247;&#x53CA;&#x591A;&#x4EFD;&#x6570;&#x636E;&#x5B58;&#x50A8;&#xFF0C;&#x81F3;&#x5C11;&#x5B58;&#x653E;2&#x4EFD;&#xFF0C;&#x6570;&#x636E;&#x5B58;&#x653E;&#x4E8E;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x6839;&#x636E;&#x7BA1;&#x7406;&#x8282;&#x70B9;&#x7684;&#x89C4;&#x5219;&#x8FDB;&#x884C;&#x6301;&#x4E45;&#x5316;&#xFF0C;&#x4F5C;&#x4E3A;&#x6570;&#x636E;&#x5B58;&#x53D6;&#x5730;&#xFF0C;&#x9700;&#x8981;&#x5927;&#x91CF;&#x5185;&#x5B58;&#x652F;&#x6301;</p>
<p>SQL&#x8282;&#x70B9;&#x4F5C;&#x4E3A;&#x67E5;&#x8BE2;&#x5165;&#x53E3;&#xFF0C;&#x9700;&#x8981;&#x6D88;&#x8017;&#x5927;&#x91CF;cpu&#x53CA;&#x5185;&#x5B58;&#x8D44;&#x6E90;&#xFF0C;&#x53EF;&#x4F7F;&#x7528;&#x5206;&#x5E03;&#x5F0F;&#x7BA1;&#x7406;&#x8282;&#x70B9;&#xFF0C;&#x5E76;&#x5728;SQL&#x8282;&#x70B9;&#x5916;&#x5C01;&#x88C5;&#x4E00;&#x5C42;&#x8BF7;&#x6C42;&#x5206;&#x53D1;&#x53CA;HA&#x63A7;&#x5236;&#x673A;&#x5236;&#x53EF;&#x89E3;&#x51B3;&#x5355;&#x70B9;&#x53CA;&#x6027;&#x80FD;&#x95EE;&#x9898;&#xFF0C;&#x5176;&#x63D0;&#x4F9B;&#x4E86;&#x7EBF;&#x6027;&#x6269;&#x5C55;&#x529F;&#x80FD;</p>
<p>&#x7BA1;&#x7406;&#x8282;&#x70B9;&#x7EF4;&#x62A4;&#x7740;&#x5168;&#x5C40;&#x8DEF;&#x7531;&#x53CA;&#x89C4;&#x5219;&#x4FE1;&#x606F;&#xFF0C;&#x9700;&#x8981;&#x5927;&#x91CF;&#x7684;&#x5185;&#x5B58;&#x6765;&#x652F;&#x6491;&#xFF0C;&#x53EF;&#x4F7F;&#x7528;&#x5206;&#x5E03;&#x5F0F;&#x7BA1;&#x7406;&#x8282;&#x70B9;&#x6765;&#x89E3;&#x51B3;</p>
<p>&#x518D;&#x6574;&#x4E2A;Cluster&#x4F53;&#x7CFB;&#x4E2D;&#xFF0C;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x7EC4;&#x5EFA;&#x90FD;&#x652F;&#x6301;&#x52A8;&#x6001;&#x6269;&#x5C55;&#xFF0C;&#x7EBF;&#x6027;&#x6269;&#x5C55;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;&#x9AD8;&#x53EF;&#x7528;&#xFF0C;&#x9AD8;&#x6027;&#x80FD;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;</p>
<p>&#x95EE;&#x9898;&#xFF1A;</p>
<p>&#x5F53;&#x65B0;&#x589E;&#x6570;&#x636E;&#x8282;&#x70B9;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x91CD;&#x6784;&#x5B58;&#x53D6;&#x8DEF;&#x5F84;&#x4FE1;&#x606F;&#xFF0C;&#x5BF9;&#x7BA1;&#x7406;&#x8282;&#x70B9;&#x5C06;&#x9020;&#x6210;&#x6570;&#x636E;&#x91CD;&#x6784;&#x538B;&#x529B;&#xFF0C;&#x8BE5;&#x64CD;&#x4F5C;&#x53EA;&#x80FD;&#x5728;&#x975E;&#x4E1A;&#x52A1;&#x9AD8;&#x5CF0;&#x65F6;&#x8FDB;&#x884C;</p>
<p>Cluster&#x4F7F;&#x7528;&#x81EA;&#x52A8;&#x952E;&#x503C;&#x8BC6;&#x522B;&#x6570;&#x636E;&#x5206;&#x5E03;&#x65B9;&#x6848;&#xFF0C;&#x5982;&#x679C;&#x6570;&#x636E;&#x6709;&#x4E3B;&#x952E;&#xFF0C;&#x5219;&#x6839;&#x636E;(1&#x3001;&#x4E3B;&#x952E;&#x3001;2&#x552F;&#x4E00;&#x7D22;&#x5F15;&#x3001;3&#x81EA;&#x52A8;&#x884C;&#x6807;&#x8BC6;rowid)&#x96C6;&#x7FA4;&#x4E2A;&#x6570;&#x8FDB;&#x884C;&#x53D6;&#x6A21;&#x5206;&#x5E03;&#xFF0C;&#x5F53;&#x4F7F;&#x7528;&#x975E;&#x4E3B;&#x952E;&#x8BBF;&#x95EE;&#x65F6;&#xFF0C;&#x5C06;&#x5BFC;&#x81F4;&#x6240;&#x6709;&#x7C07;&#x8282;&#x70B9;&#x626B;&#x63CF;&#xFF0C;&#x5F71;&#x54CD;&#x6027;&#x80FD;(&#x8FD9;&#x662F;Cluster&#x9762;&#x5BF9;&#x7684;&#x6838;&#x5FC3;&#x6311;&#x6218;)</p>
<p>MongoDB &#x590D;&#x5236;&#x96C6;&#xFF0C;&#x57FA;&#x4E8E;MongoDB&#x590D;&#x5236;&#xFF0C;&#x6784;&#x9020;&#x51FA;&#x7684;&#x5206;&#x5E03;&#x5F0F;&#x6570;&#x636E;&#x5E93;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF1A;</p>
<p>MongoDB&#x63D0;&#x4F9B;&#x4E86;&#x548C;MySQL Cluster&#x7C7B;&#x4F3C;&#x7684;&#x67B6;&#x6784;&#xFF0C;&#x5728;mongod&#x3001;mongos&#x3001;mongo&#x4E2D;&#xFF0C;&#x5305;&#x542B;&#xFF1A;</p>
<p>Mongod&#xFF1A; &#x6570;&#x636E;&#x8BBF;&#x95EE;&#x501F;&#x53E3;&#xFF0C;&#x5C06;&#x8BF7;&#x6C42;&#x5206;&#x53D1;&#x7ED9;Mongos&#x8282;&#x70B9;</p>
<p>Mongs&#xFF1A; &#x6570;&#x636E;&#x8BBF;&#x95EE;&#x8DEF;&#x7531;&#x3001;&#x67E5;&#x8BE2;&#x4F18;&#x5316;&#x3001;&#x6570;&#x636E;merge&#x3001;sort&#xFF0C;&#x88C1;&#x526A;&#x7B49;&#x529F;&#x80FD;</p>
<p>mongo&#xFF1A;&#x6570;&#x636E;&#x5B58;&#x53D6;(&#x4F7F;&#x7528;mongo&#x534F;&#x8BAE;&#x8FD8;&#x63D0;&#x4F9B;&#x76F4;&#x63A5;&#x6570;&#x636E;&#x8BBF;&#x95EE;)</p>
<p>MongoDB&#x5728;&#x6784;&#x5EFA;&#x96C6;&#x5408;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x63D0;&#x4F9B;&#x6570;&#x636E;&#x5206;&#x7247;&#x89C4;&#x5219;&#xFF0C;&#x8BE5;&#x89C4;&#x5219;&#x5C06;&#x88AB;&#x8BB0;&#x5F55;&#x518D;mongos&#x4E2D;&#xFF0C;&#x67E5;&#x8BE2;&#x8BF7;&#x6C42;mongod&#x5C06;&#x5411;mongos&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#xFF0C;mongos&#x6839;&#x636E;&#x5B58;&#x53D6;&#x8DEF;&#x5F84;&#x5728;mongo&#x4E2D;&#x8BBF;&#x95EE;&#x6570;&#x636E;</p>
<p>&#x7531;&#x4E8E;MongoDB&#x4E3A;&#x7528;&#x6237;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x9009;&#x62E9;&#x6027;&#xFF0C;&#x5C06;&#x6570;&#x636E;&#x5982;&#x4F55;&#x8FDB;&#x884C;&#x5207;&#x7247;&#xFF0C;&#x5728;&#x5BF9;&#x7528;&#x6237;&#x8BBF;&#x95EE;&#x900F;&#x660E;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5FEB;&#x901F;&#x5B58;&#x53D6;&#x6570;&#x636E;</p>
<p>MongoDB&#x9762;&#x4E34;&#x7684;&#x95EE;&#x9898;&#xFF1A;</p>
<p>&#x4EE5;&#x975E;&#x5206;&#x7247;&#x89C4;&#x5219;&#x8BBF;&#x95EE;&#x6570;&#x636E;&#x65F6;(&#x7D22;&#x5F15;&#x53EF;&#x4EE5;&#x5EFA;&#x7ACB;&#x5728;&#x5404;&#x4E2A;&#x5206;&#x7247;)&#xFF0C;&#x5C06;&#x5BFC;&#x81F4;&#x6240;&#x6709;Mongo&#x7C07;&#x8282;&#x70B9;&#x5168;&#x626B;&#x63CF;(&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x591A;&#x4EFD;&#x5197;&#x4F59;&#x62F7;&#x8D1D;&#x5E76;&#x8FDB;&#x884C;&#x4E0D;&#x540C;&#x7684;&#x5206;&#x7247;&#x89C4;&#x5219;&#x5B9E;&#x73B0;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;&#x5F53;&#x524D;&#x6570;&#x636E;&#x5206;&#x7247;&#x5E94;&#x7528;&#x5E38;&#x7528;&#x7684;&#x624B;&#x6BB5;)</p>
<p>&#x5F53;&#x65B0;&#x589E;&#x6570;&#x636E;&#x7C07;&#x65F6;&#xFF0C;&#x5C06;&#x5BFC;&#x81F4;&#x6240;&#x6709;&#x6570;&#x636E;&#x8282;&#x70B9;&#x91CD;&#x6784;&#xFF0C;&#x76F4;&#x63A5;&#x5F71;&#x54CD;&#x6027;&#x80FD;</p>
<p>&#x603B;&#x7ED3;&#xFF1A;</p>
<p>MongoDB&#x4F7F;&#x7528;&#x5806;&#x8868;&#x65B9;&#x6CD5;&#x7EC4;&#x7EC7;&#x6570;&#x636E;&#x3001;&#x4E0D;&#x5305;&#x542B;ACID&#x7279;&#x6027;&#x5BF9;&#x4E8E;&#x6570;&#x636E;&#x5927;&#x91CF;&#x6570;&#x636E;&#x66F4;&#x65B0;&#x53CA;&#x67E5;&#x8BE2;(&#x5BF9;&#x4E8E;&#x62E5;&#x6709;MVCC&#x7684;&#x67B6;&#x6784;&#xFF0C;&#x5C06;&#x964D;&#x4F4E;&#x5728;&#x9AD8;&#x5E76;&#x53D1;&#x3001;&#x5927;&#x6570;&#x636E;&#x96C6;&#x7684;&#x54CD;&#x5E94;&#x901F;&#x5EA6;)&#x6709;&#x5F88;&#x5927;&#x7684;&#x63D0;&#x5347;&#xFF0C;&#x4F46;&#x6CA1;&#x6709;ACID&#x4FDD;&#x8BC1;&#x5173;&#x952E;&#x6570;&#x636E;&#x7684;&#x7A33;&#x5B9A;&#x3001;&#x5B89;&#x5168;</p>
<p>MongoDB&#x89E3;&#x51B3;&#x4E86;MySQL Cluster&#x7684;&#x81EA;&#x52A8;&#x5206;&#x7247;&#x89C4;&#x5219;&#xFF0C;&#x5C06;MySQL Cluster&#x7684;SQL&#x8282;&#x70B9;&#x6570;&#x636E;&#x5904;&#x7406;&#x5DE5;&#x4F5C;&#x79FB;&#x4EA4;&#x7ED9;mongos&#xFF0C;&#x80FD;&#x964D;&#x4F4E;MySQL Cluster SQL&#x8282;&#x70B9;&#x4E0E;Cluster&#x76F8;&#x4E92;&#x901A;&#x4FE1;&#x7684;&#x74F6;&#x9888;&#xFF0C;&#x63D0;&#x5347;&#x4F53;&#x7EDF;&#x6027;&#x80FD;&#xFF0C;&#x4F46;&#x65E0;&#x6CD5;&#x89E3;&#x51B3;&#x8DE8;&#x5206;&#x7247;&#x67E5;&#x8BE2;&#x95EE;&#x9898;&#x53CA;&#x6570;&#x636E;&#x8282;&#x70B9;&#x6DFB;&#x52A0;&#x7684;&#x7A33;&#x5B9A;&#x53CA;&#x6027;&#x80FD;&#x95EE;&#x9898;</p>
<p>MySQL Cluster&#x62E5;&#x6709;&#x5B8C;&#x6574;&#x7684;&#x5546;&#x4E1A;&#x652F;&#x6301;&#x53CA;&#x901A;&#x7528;&#x6807;&#x51C6;&#x652F;&#x6301;&#xFF0C;&#x76F8;&#x5BF9;&#x4E30;&#x5BCC;&#x7684;&#x7BA1;&#x7406;&#x5DE5;&#x5177;&#xFF0C;MongoDB&#x62E5;&#x6709;&#x76F8;&#x5BF9;&#x7684;&#x6027;&#x80FD;&#x4F18;&#x52BF;&#xFF0C;&#x4F46;&#x7F3A;&#x5C11;&#x5F3A;&#x5927;&#x7684;&#x7A33;&#x5B9A;&#x53CA;&#x5B89;&#x5168;&#x652F;&#x6491;&#xFF0C;&#x4E30;&#x5BCC;&#x7684;&#x7BA1;&#x7406;&#x5DE5;&#x5177;&#xFF0C;&#x4E24;&#x8005;&#x6709;&#x5404;&#x81EA;&#x7684;&#x4F18;&#x52BF;&#xFF0C;&#x4F46;&#x6709;&#x5DEE;&#x4E0D;&#x591A;&#x76F8;&#x540C;&#x7684;&#x81F4;&#x547D;&#x5F31;&#x70B9;&#x3002;</p>
<p>&#x4ECE;&#x5546;&#x4E1A;&#x4E0A;&#x6765;&#x8BF4;&#xFF0C;MySQL Cluster&#x62E5;&#x6709;&#x8DB3;&#x591F;&#x7684;&#x5546;&#x4E1A;&#x4F7F;&#x7528;&#x4EF7;&#x503C;&#xFF0C;&#x4F46;&#x7F3A;&#x9677;&#x4E5F;&#x5F88;&#x660E;&#x663E;&#xFF0C;MongoDB&#x5BF9;MySQL Cluster&#x7684;&#x6539;&#x8FDB;&#x5F88;&#x503C;&#x5F97;&#x601D;&#x8003;&#x53CA;&#x5728;&#x65E5;&#x5E38;&#x6570;&#x636E;&#x67B6;&#x6784;&#x8BBE;&#x8BA1;&#xFF0C;&#x6A21;&#x5F0F;&#x8BBE;&#x8BA1;&#x4E2D;&#x5F15;&#x5165;&#xFF0C;&#x4F46;&#x4F5C;&#x4E3A;&#x5927;&#x9762;&#x79EF;&#x5546;&#x4E1A;&#x5E94;&#x7528;&#xFF0C;MySQL Cluster&#x548C;MongoDB&#x90FD;&#x8FD8;&#x6709;&#x5F88;&#x957F;&#x4E00;&#x6BB5;&#x8DEF;&#x8981;&#x8D70;&#xFF0C;&#x4E0D;&#x7BA1;&#x662F;&#x56FA;&#x6709;&#x7684;&#x7F3A;&#x9677;&#x8FD8;&#x662F;&#x7BA1;&#x7406;&#x6A21;&#x5F0F;&#x4E0A;&#x3002;</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/MongoDB/">MongoDB</a><a href="/tags/MySQL-Cluster/">MySQL Cluster</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/08/4d5cc2e/" title="Mongodb和Hbase的对比 -" itemprop="url">Mongodb和Hbase的对比 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-08T02:33:29.000Z" itemprop="datePublished"> 发表于 2015-07-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p> &#x539F;&#x6587;&#xFF1A; <a href="http://www.cnblogs.com/visionwang/archive/2012/11/17/2775469.html" target="_blank" rel="external">http://www.cnblogs.com/visionwang/archive/2012/11/17/2775469.html</a></p>
<p>1.Mongodb bson&#x6587;&#x6863;&#x578B;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x6574;&#x4E2A;&#x6570;&#x636E;&#x90FD;&#x5B58;&#x5728;&#x78C1;&#x76D8;&#x4E2D;&#xFF0C;hbase&#x662F;&#x5217;&#x5F0F;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x96C6;&#x7FA4;&#x90E8;&#x7F72;&#x65F6;&#x6BCF;&#x4E2A;familycolumn&#x4FDD;&#x5B58;&#x5728;&#x5355;&#x72EC;&#x7684;hdfs&#x6587;&#x4EF6;&#x4E2D;&#x3002;</p>
<p>2.Mongodb &#x4E3B;&#x952E;&#x662F;&#x201C;_id&#x201D;,&#x4E3B;&#x952E;&#x4E0A;&#x9762;&#x53EF;&#x4EE5;&#x4E0D;&#x5EFA;&#x7D22;&#x5F15;,&#x8BB0;&#x5F55;&#x63D2;&#x5165;&#x7684;&#x987A;&#x5E8F;&#x548C;&#x5B58;&#x653E;&#x7684;&#x987A;&#x5E8F;&#x4E00;&#x6837;&#xFF0C;hbase&#x7684;&#x4E3B;&#x952E;&#x5C31;&#x662F;row key&#xFF0C;&#x53EF;&#x4EE5;&#x662F;&#x4EFB;&#x610F;&#x5B57;&#x7B26;&#x4E32;(&#x6700;&#x5927;&#x957F;&#x5EA6;&#x662F; 64KB&#xFF0C;&#x5B9E;&#x9645;&#x5E94;&#x7528;&#x4E2D;&#x957F;&#x5EA6;&#x4E00;&#x822C;&#x4E3A; 10-100bytes)&#xFF0C;&#x5728;hbase&#x5185;&#x90E8;&#xFF0C;row key&#x4FDD;&#x5B58;&#x4E3A;&#x5B57;&#x8282;&#x6570;&#x7EC4;&#x3002;&#x5B58;&#x50A8;&#x65F6;&#xFF0C;&#x6570;&#x636E;&#x6309;&#x7167;Row key&#x7684;&#x5B57;&#x5178;&#x5E8F;(byte order)&#x6392;&#x5E8F;&#x5B58;&#x50A8;&#x3002;&#x8BBE;&#x8BA1;key&#x65F6;&#xFF0C;&#x8981;&#x5145;&#x5206;&#x6392;&#x5E8F;&#x5B58;&#x50A8;&#x8FD9;&#x4E2A;&#x7279;&#x6027;&#xFF0C;&#x5C06;&#x7ECF;&#x5E38;&#x4E00;&#x8D77;&#x8BFB;&#x53D6;&#x7684;&#x884C;&#x5B58;&#x50A8;&#x653E;&#x5230;&#x4E00;&#x8D77;&#x3002;</p>
<p>&#x5B57;&#x5178;&#x5E8F;&#x5BF9;int&#x6392;&#x5E8F;&#x7684;&#x7ED3;&#x679C;&#x662F;1,10,100,11,12,13,14,15,16,17,18,19,2,20,21,&#x2026;,9,91,92,93,94,95,96,97,98,99&#x3002;&#x8981;&#x4FDD;&#x6301;&#x6574;&#x5F62;&#x7684;&#x81EA;&#x7136;&#x5E8F;&#xFF0C;&#x884C;&#x952E;&#x5FC5;&#x987B;&#x7528;0&#x4F5C;&#x5DE6;&#x586B;&#x5145;&#x3002;3.Mongodb&#x652F;&#x6301;&#x4E8C;&#x7EA7;&#x7D22;&#x5F15;&#xFF0C;&#x800C;hbase&#x672C;&#x8EAB;&#x4E0D;&#x652F;&#x6301;&#x4E8C;&#x7EA7;&#x7D22;&#x5F15;4.Mongodb&#x652F;&#x6301;&#x96C6;&#x5408;&#x67E5;&#x627E;&#xFF0C;&#x6B63;&#x5219;&#x67E5;&#x627E;&#xFF0C;&#x8303;&#x56F4;&#x67E5;&#x627E;&#xFF0C;&#x652F;&#x6301;skip&#x548C;limit&#x7B49;&#x7B49;&#xFF0C;&#x662F;&#x6700;&#x50CF;mysql&#x7684;nosql&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x800C;hbase&#x53EA;&#x652F;&#x6301;&#x4E09;&#x79CD;&#x67E5;&#x627E;&#xFF1A;&#x901A;&#x8FC7;&#x5355;&#x4E2A;row key&#x8BBF;&#x95EE;&#xFF0C;&#x901A;&#x8FC7;row key&#x7684;range&#xFF0C;&#x5168;&#x8868;&#x626B;&#x63CF;5.mongodb&#x7684;update&#x662F;update-in-place&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x539F;&#x5730;&#x66F4;&#x65B0;&#xFF0C;&#x9664;&#x975E;&#x539F;&#x5730;&#x5BB9;&#x7EB3;&#x4E0D;&#x4E0B;&#x66F4;&#x65B0;&#x540E;&#x7684;&#x6570;&#x636E;&#x8BB0;&#x5F55;&#x3002;&#x800C;hbase&#x7684;&#x4FEE;&#x6539;&#x548C;&#x6DFB;&#x52A0;&#x90FD;&#x662F;&#x540C;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#xFF1A;put&#xFF0C;&#x5982;&#x679C;put&#x4F20;&#x5165;&#x7684;row key&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#x5C31;&#x66F4;&#x65B0;&#x539F;&#x8BB0;&#x5F55;,&#x5B9E;&#x9645;&#x4E0A;hbase&#x5185;&#x90E8;&#x4E5F;&#x4E0D;&#x662F;&#x66F4;&#x65B0;&#xFF0C;&#x5B83;&#x53EA;&#x662F;&#x5C06;&#x8FD9;&#x4E00;&#x4EFD;&#x6570;&#x636E;&#x5DF2;&#x4E0D;&#x540C;&#x7684;&#x7248;&#x672C;&#x4FDD;&#x5B58;&#x4E0B;&#x6765;&#x800C;&#x5DF2;&#xFF0C;hbase&#x9ED8;&#x8BA4;&#x7684;&#x4FDD;&#x5B58;&#x7248;&#x672C;&#x7684;&#x5386;&#x53F2;&#x6570;&#x91CF;&#x662F;3&#x3002;6.mongodb&#x7684;delete&#x4F1A;&#x5C06;&#x8BE5;&#x884C;&#x7684;&#x6570;&#x636E;&#x6807;&#x793A;&#x4E3A;&#x5DF2;&#x5220;&#x9664;&#xFF0C;&#x56E0;&#x4E3A;mongodb&#x5728;&#x5220;&#x9664;&#x8BB0;&#x5F55;&#x65F6;&#x5E76;&#x4E0D;&#x662F;&#x771F;&#x628A;&#x8BB0;&#x5F55;&#x4ECE;&#x5185;&#x5B58;&#x6216;&#x6587;&#x4EF6;&#x4E2D;remove&#xFF0C;&#x800C;&#x662F;&#x5C06;&#x8BE5;&#x5220;&#x9664;&#x8BB0;&#x5F55;&#x6570;&#x636E;&#x7F6E;&#x7A7A;&#xFF08;&#x5199;0&#x6216;&#x7279;&#x6B8A;&#x6570;&#x5B57;&#x52A0;&#x4EE5;&#x6807;&#x8BC6;&#xFF09;&#x540C;&#x65F6;&#x5C06;&#x8BE5;&#x8BB0;&#x5F55;&#x6240;&#x5728;&#x5730;&#x5740;&#x653E;&#x5230;&#x4E00;&#x4E2A;list&#x5217;&#x8868;&#x201C;&#x91CA;&#x653E;&#x5217;&#x8868;&#x201D;&#x4E2D;&#xFF0C;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x597D;&#x5C31;&#x662F;&#x5C31;&#x662F;&#x5982;&#x679C;&#x6709;&#x7528;&#x6237;&#x8981;&#x6267;&#x884C;&#x63D2;&#x5165;&#x8BB0;&#x5F55;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;mongodb&#x4F1A;&#x9996;&#x5148;&#x4ECE;&#x8BE5;&#x201C;&#x91CA;&#x653E;&#x5217;&#x8868;&#x201D;&#x4E2D;&#x83B7;&#x53D6;size&#x5408;&#x9002;&#x7684;&#x201C;&#x5DF2;&#x5220;&#x9664;&#x8BB0;&#x5F55;&#x201D;&#x5730;&#x5740;&#x8FD4;&#x56DE;&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x4F1A;&#x63D0;&#x5347;&#x6027;&#x80FD;&#xFF08;&#x907F;&#x514D;&#x4E86;malloc&#x5185;&#x5B58;&#x64CD;&#x4F5C;&#xFF09;&#xFF0C;&#x540C;&#x65F6;mongodb&#x4E5F;&#x4F7F;&#x7528;&#x4E86;bucket size&#x6570;&#x7EC4;&#x6765;&#x5B9A;&#x4E49;&#x591A;&#x4E2A;&#x5927;&#x5C0F;size&#x4E0D;&#x540C;&#x7684;&#x5217;&#x8868;&#xFF0C;&#x7528;&#x4E8E;&#x5C06;&#x8981;&#x5220;&#x9664;&#x7684;&#x8BB0;&#x5F55;&#x6839;&#x636E;&#x5176;size&#x5927;&#x5C0F;&#x653E;&#x5230;&#x5408;&#x9002;&#x7684;&#x201C;&#x91CA;&#x653E;&#x5217;&#x8868;&#x201D;&#x4E2D;&#x3002;Hbase&#x7684;delete&#x662F;&#x5148;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A; <em>tombstone</em> markers&#xFF0C;&#x7136;&#x540E;&#x8BFB;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x548C; <em>tombstone</em> markers&#x505A;merge&#xFF0C;&#x5728; &#x53D1;&#x751F;major compaction&#x65F6;delete&#x7684;&#x6570;&#x636E;&#x8BB0;&#x5F55;&#x624D;&#x4F1A;&#x771F;&#x771F;&#x5220;&#x9664;&#x3002;7.mongodb&#x548C;hbase&#x90FD;&#x652F;&#x6301;mapreduce&#xFF0C;&#x4E0D;&#x8FC7;mongodb&#x7684;mapreduce&#x652F;&#x6301;&#x4E0D;&#x591F;&#x5F3A;&#x5927;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x4F7F;&#x7528;mongodb&#x5206;&#x7247;&#xFF0C;mapreduce&#x5B9E;&#x9645;&#x4E0A;&#x4E0D;&#x662F;&#x5E76;&#x884C;&#x6267;&#x884C;&#x7684;8.mongodb&#x652F;&#x6301;shard&#x5206;&#x7247;&#xFF0C;hbase&#x6839;&#x636E;row key&#x81EA;&#x52A8;&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#xFF0C;&#x8FD9;&#x91CC;shard key&#x548C;row key&#x7684;&#x9009;&#x53D6;&#x5C3D;&#x91CF;&#x7528;&#x975E;&#x9012;&#x589E;&#x7684;&#x5B57;&#x6BB5;&#xFF0C;&#x5C3D;&#x91CF;&#x7528;&#x5206;&#x5E03;&#x5747;&#x8861;&#x7684;&#x5B57;&#x6BB5;&#xFF0C;&#x56E0;&#x4E3A;&#x5206;&#x7247;&#x90FD;&#x662F;&#x6839;&#x636E;&#x8303;&#x56F4;&#x6765;&#x9009;&#x62E9;&#x5BF9;&#x5E94;&#x7684;&#x5B58;&#x53D6;server&#x7684;&#xFF0C;&#x5982;&#x679C;&#x7528;&#x9012;&#x589E;&#x5B57;&#x6BB5;&#x5F88;&#x5BB9;&#x6613;&#x70ED;&#x70B9;server&#x7684;&#x4EA7;&#x751F;&#xFF0C;&#x7531;&#x4E8E;&#x662F;&#x6839;&#x636E;key&#x7684;&#x8303;&#x56F4;&#x6765;&#x81EA;&#x52A8;&#x5206;&#x7247;&#x7684;&#xFF0C;&#x5982;&#x679C;key&#x5206;&#x5E03;&#x4E0D;&#x5747;&#x8861;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x6709;&#x4E9B;key&#x6839;&#x672C;&#x5C31;&#x6CA1;&#x6CD5;&#x5207;&#x5206;&#xFF0C;&#x4ECE;&#x800C;&#x4EA7;&#x751F;&#x8D1F;&#x8F7D;&#x4E0D;&#x5747;&#x8861;&#x3002;9.mongodb&#x7684;&#x8BFB;&#x6548;&#x7387;&#x6BD4;&#x5199;&#x9AD8;&#xFF0C;hbase&#x9ED8;&#x8BA4;&#x9002;&#x5408;&#x5199;&#x591A;&#x8BFB;&#x5C11;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;hfile.block.cache.size&#x914D;&#x7F6E;&#xFF0C;&#x8BE5;&#x914D;&#x7F6E;storefile&#x7684;&#x8BFB;&#x7F13;&#x5B58;&#x5360;&#x7528;Heap&#x7684;&#x5927;&#x5C0F;&#x767E;&#x5206;&#x6BD4;&#xFF0C;0.2&#x8868;&#x793A;20%&#x3002;&#x8BE5;&#x503C;&#x76F4;&#x63A5;&#x5F71;&#x54CD;&#x6570;&#x636E;&#x8BFB;&#x7684;&#x6027;&#x80FD;&#x3002;&#x5982;&#x679C;&#x5199;&#x6BD4;&#x8BFB;&#x5C11;&#x5F88;&#x591A;&#xFF0C;&#x5F00;&#x5230;0.4-0.5&#x4E5F;&#x6CA1;&#x95EE;&#x9898;&#x3002;&#x5982;&#x679C;&#x8BFB;&#x5199;&#x8F83;&#x5747;&#x8861;&#xFF0C;0.3&#x5DE6;&#x53F3;&#x3002;&#x5982;&#x679C;&#x5199;&#x6BD4;&#x8BFB;&#x591A;&#xFF0C;&#x679C;&#x65AD;&#x9ED8;&#x8BA4;0.2&#x5427;&#x3002;&#x8BBE;&#x7F6E;&#x8FD9;&#x4E2A;&#x503C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F60;&#x540C;&#x65F6;&#x8981;&#x53C2;&#x8003;hbase.regionserver.global.memstore.upperLimit&#xFF0C;&#x8BE5;&#x503C;&#x662F;memstore&#x5360;heap&#x7684;&#x6700;&#x5927;&#x767E;&#x5206;&#x6BD4;&#xFF0C;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x4E00;&#x4E2A;&#x5F71;&#x54CD;&#x8BFB;&#xFF0C;&#x4E00;&#x4E2A;&#x5F71;&#x54CD;&#x5199;&#x3002;&#x5982;&#x679C;&#x4E24;&#x503C;&#x52A0;&#x8D77;&#x6765;&#x8D85;&#x8FC7;80-90%&#xFF0C;&#x4F1A;&#x6709;OOM&#x7684;&#x98CE;&#x9669;&#xFF0C;&#x8C28;&#x614E;&#x8BBE;&#x7F6E;&#x3002; </p>
<p>10.hbase&#x91C7;&#x7528;&#x7684;LSM&#x601D;&#x60F3;(Log-Structured Merge-Tree)&#xFF0C;&#x5C31;&#x662F;&#x5C06;&#x5BF9;&#x6570;&#x636E;&#x7684;&#x66F4;&#x6539;hold&#x5728;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x8FBE;&#x5230;&#x6307;&#x5B9A;&#x7684;threadhold&#x540E;&#x5C06;&#x8BE5;&#x6279;&#x66F4;&#x6539;merge&#x540E;&#x6279;&#x91CF;&#x5199;&#x5165;&#x5230;&#x78C1;&#x76D8;&#xFF0C;&#x8FD9;&#x6837;&#x5C06;&#x5355;&#x4E2A;&#x5199;&#x53D8;&#x6210;&#x4E86;&#x6279;&#x91CF;&#x5199;&#xFF0C;&#x5927;&#x5927;&#x63D0;&#x9AD8;&#x4E86;&#x5199;&#x5165;&#x901F;&#x5EA6;&#xFF0C;&#x4E0D;&#x8FC7;&#x8FD9;&#x6837;&#x7684;&#x8BDD;&#x8BFB;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x8D39;&#x52B2;&#x4E86;&#xFF0C;&#x9700;&#x8981;merge disk&#x4E0A;&#x7684;&#x6570;&#x636E;&#x548C;memory&#x4E2D;&#x7684;&#x4FEE;&#x6539;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x663E;&#x7136;&#x964D;&#x4F4E;&#x4E86;&#x8BFB;&#x7684;&#x6027;&#x80FD;&#x3002;mongodb&#x91C7;&#x7528;&#x7684;&#x662F;mapfile+Journal&#x601D;&#x60F3;&#xFF0C;&#x5982;&#x679C;&#x8BB0;&#x5F55;&#x4E0D;&#x5728;&#x5185;&#x5B58;&#xFF0C;&#x5148;&#x52A0;&#x8F7D;&#x5230;&#x5185;&#x5B58;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x66F4;&#x6539;&#x540E;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#xFF0C;&#x7136;&#x540E;&#x9694;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x6279;&#x91CF;&#x7684;&#x5199;&#x5165;data&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x6837;&#x5BF9;&#x5185;&#x5B58;&#x7684;&#x8981;&#x6C42;&#x8F83;&#x9AD8;&#xFF0C;&#x81F3;&#x5C11;&#x9700;&#x8981;&#x5BB9;&#x7EB3;&#x4E0B;&#x70ED;&#x70B9;&#x6570;&#x636E;&#x548C;&#x7D22;&#x5F15;&#x3002;</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/HBase/">HBase</a><a href="/tags/MongoDB/">MongoDB</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/08/4d56333/" title="dbDao 汪伟华的MySQL初学者入门视频教程 -" itemprop="url">dbDao 汪伟华的MySQL初学者入门视频教程 -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-08T02:33:29.000Z" itemprop="datePublished"> 发表于 2015-07-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>dbDao &#xA0;&#x6C6A;&#x4F1F;&#x534E;&#x7684;MySQL&#x521D;&#x5B66;&#x8005;&#x5165;&#x95E8;&#x89C6;&#x9891;&#x6559;&#x7A0B;&#xFF0C; &#x89C2;&#x770B;&#x5730;&#x5740;&#xFF1A;</p>
<p><a href="http://www.tudou.com/listplay/3EfXnLqpfu0.html" target="_blank" rel="external">http://www.tudou.com/listplay/3EfXnLqpfu0.html</a></p>
<p><img src="http://taojinke.github.io/img/20150708/4d54d3a.png" alt=""></p>
<p><img src="http://taojinke.github.io/img/20150708/4d54fab.png" alt=""></p>
<p><img src="http://taojinke.github.io/img/20150708/4d54fab.png" alt=""></p>
<p>&#x76F8;&#x5173;&#x6587;&#x7AE0; | Related posts:</p>
<ol>
<li><a href="http://www.askmaclean.com/archives/win7-install-oracle-11gr2-plsqldeveloper-sqldeveloper.html" target="_blank" rel="external">&#x3010;&#x89C6;&#x9891;&#x6559;&#x5B66;&#x3011;&#x5728;WIN7&#x4E0A;&#x90E8;&#x7F72;Oracle 11gR2+PL/SQL Developer+SQL Developer</a>&#x3010;&#x89C6;&#x9891;&#x6559;&#x5B66;&#x3011;&#x5728;WIN7&#x4E0A;&#x90E8;&#x7F72;Oracle 11gR2+PL/SQL Developer+SQL Develop [&#x2026;]…</li>
<li><a href="http://www.askmaclean.com/archives/%e6%b1%aa%e4%bc%9f%e5%8d%8e-mysql-replication-%e5%a4%8d%e5%88%b6%e9%ab%98%e5%8f%af%e7%94%a8%e9%85%8d%e7%bd%ae%e6%96%b9%e6%a1%88.html" target="_blank" rel="external">&#x6C6A;&#x4F1F;&#x534E;-MySQL Replication &#x590D;&#x5236;&#x9AD8;&#x53EF;&#x7528;&#x914D;&#x7F6E;&#x65B9;&#x6848;</a>&#x6C6A;&#x4F1F;&#x534E;-MySQL Replication &#x590D;&#x5236;&#x9AD8;&#x53EF;&#x7528;&#x914D;&#x7F6E;&#x65B9;&#x6848; dbDao &#x767E;&#x5EA6;&#x8D34;&#x5427;&#xFF1A;<a href="http://tieba" target="_blank" rel="external">http://tieba</a> [&#x2026;]…</li>
<li><a href="http://www.askmaclean.com/archives/mysql-replication-ha.html" target="_blank" rel="external">&#x8BD7;&#x6A80;&#x8F6F;&#x4EF6;&#x6C6A;&#x4F1F;&#x534E; MySQL Replication &#x590D;&#x5236;&#x9AD8;&#x53EF;&#x7528;&#x914D;&#x7F6E;&#x65B9;&#x6848;</a>&#x3010;&#x8BD7;&#x6A80;&#x8F6F;&#x4EF6;&#x6C6A;&#x4F1F;&#x534E;&#x3011; MySQL Replication &#x590D;&#x5236;&#x9AD8;&#x53EF;&#x7528;&#x914D;&#x7F6E;&#x65B9;&#x6848; dbDao &#x767E;&#x5EA6;&#x8D34;&#x5427;&#xFF1A;http:/ [&#x2026;]…</li>
<li><a href="http://www.askmaclean.com/archives/mongodb-db-collection-remove%e6%96%b9%e6%b3%95.html" target="_blank" rel="external">MongoDB db.collection.remove()&#x65B9;&#x6CD5;</a>mongodb&#x4E2D;&#x5220;&#x9664;document&#x91C7;&#x7528;remove&#x65B9;&#x6CD5;&#xFF0C; <a href="http://docs.mongodb.org/m" target="_blank" rel="external">http://docs.mongodb.org/m</a> [&#x2026;]…</li>
<li><a href="http://www.askmaclean.com/archives/mongodb-change-password.html" target="_blank" rel="external">MongoDB&#x4E2D;&#x4FEE;&#x6539;&#x5BC6;&#x7801;&#x548C;&#x5FD8;&#x8BB0;&#x5BC6;&#x7801;&#x7684;&#x60C5;&#x51B5;</a>&#xA0; MongoDB&#x4E2D;&#x4FEE;&#x6539;&#x5BC6;&#x7801;&#x548C;&#x5FD8;&#x8BB0;&#x5BC6;&#x7801;&#x7684;&#x60C5;&#x51B5; dbDao &#x767E;&#x5EA6;&#x8D34;&#x5427;&#xFF1A;<a href="http://tieba.bai" target="_blank" rel="external">http://tieba.bai</a> [&#x2026;]…</li>
<li><a href="http://www.askmaclean.com/archives/mongodb-not-null.html" target="_blank" rel="external">MongoDB &#x4E2D;&#x627E;&#x51FA;&#x975E;&#x7A7A;&#x7684;VALUE, NOT NULL</a>&#x672C;&#x6587;&#x5730;&#x5740;&#xFF1A;<a href="http://www.askmaclean.com/archives/mongodb-not-nul" target="_blank" rel="external">http://www.askmaclean.com/archives/mongodb-not-nul</a> [&#x2026;]…</li>
<li><a href="http://www.askmaclean.com/archives/parnassusdata-mongodb-service.html" target="_blank" rel="external">&#x8BD7;&#x6A80;&#x8F6F;&#x4EF6;&#x63D0;&#x4F9B;MongoDB&#x6570;&#x636E;&#x5E93;&#x670D;&#x52A1;</a>&#x8BD7;&#x6A80;&#x8F6F;&#x4EF6;&#x63D0;&#x4F9B;MongoDB&#x6570;&#x636E;&#x5E93;&#x670D;&#x52A1; dbDao &#x767E;&#x5EA6;&#x8D34;&#x5427;&#xFF1A;<a href="http://tieba.baidu.com/db" target="_blank" rel="external">http://tieba.baidu.com/db</a> [&#x2026;]…</li>
<li><a href="http://www.askmaclean.com/archives/%e9%80%9a%e8%bf%87mongolab%e7%94%b3%e8%af%b7%e5%85%8d%e8%b4%b9%e7%9a%84mongodb%e6%b5%8b%e8%af%95%e5%ae%9e%e4%be%8b.html" target="_blank" rel="external">&#x901A;&#x8FC7;Mongolab&#x7533;&#x8BF7;&#x514D;&#x8D39;&#x7684;MongoDB&#x6D4B;&#x8BD5;&#x5B9E;&#x4F8B;</a>Mongolab&#x76EE;&#x524D;&#x63D0;&#x4F9B;&#x7684;&#x514D;&#x8D39;&#x7684;MongoDB&#x5B9E;&#x4F8B;&#x4F9B;&#x5E7F;&#x5927;&#x7528;&#x6237;&#x6D4B;&#x8BD5;&#x4F7F;&#x7528;&#xFF0C;&#x514D;&#x8D39;&#x5B9E;&#x4F8B;&#x7684;&#x9650;&#x5236;&#x662F;&#x6700;&#x5927;500MB&#x3002; &amp;nb [&#x2026;]…</li>
<li><a href="http://www.askmaclean.com/archives/mongodb-aggregation%e8%81%9a%e9%9b%86%e6%b5%8b%e8%af%95.html" target="_blank" rel="external">MongoDB Aggregation&#x805A;&#x96C6;&#x6D4B;&#x8BD5;</a>dbDao &#x767E;&#x5EA6;&#x8D34;&#x5427;&#xFF1A;<a href="http://tieba.baidu.com/dbdao" target="_blank" rel="external">http://tieba.baidu.com/dbdao</a> MongoDB&#x6280;&#x672F;&#x5B66;&#x4E60;QQ&#x7FA4;&#xFF1A; [&#x2026;]…</li>
<li><a href="http://www.askmaclean.com/archives/mongodb-getcmdlineopts.html" target="_blank" rel="external">MongoDB&#x83B7;&#x53D6;&#x547D;&#x4EE4;&#x884C;&#x542F;&#x52A8;&#x53C2;&#x6570;getCmdLineOpts</a>MongoDB&#x83B7;&#x53D6;&#x547D;&#x4EE4;&#x884C;&#x542F;&#x52A8;&#x53C2;&#x6570;&#x7684;&#x65B9;&#x6CD5;; &#x6709;&#x65F6;&#x5019;&#x5E0C;&#x671B;&#x77E5;&#x9053;&#x542F;&#x52A8;mongd&#x7684;&#x542F;&#x52A8;&#x53C2;&#x6570;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5982;&#x4E0B;&#x547D;&#x4EE4;&#x83B7;&#x5F97;&#xFF1A; db [&#x2026;]…</li>
</ol>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/MongoDB/">MongoDB</a><a href="/tags/MySQL/">MySQL</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/08/4d49b01/" title="MongoDB 在线讲座系列2 的视频及PPT -" itemprop="url">MongoDB 在线讲座系列2 的视频及PPT -</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="edwin" target="_blank" itemprop="author">edwin</a>
		
  <p class="article-time">
    <time datetime="2015-07-08T02:33:29.000Z" itemprop="datePublished"> 发表于 2015-07-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>&#x7B2C;&#x4E8C;&#x6B21;&#x8BB2;&#x5EA7;&#x7684;&#x89C6;&#x9891;&#x548C;PPT&#x5DF2;&#x7ECF;&#x4E0A;&#x4F20;&#x6574;&#x7406;&#x5B8C;&#x6BD5;&#x3002;</p>
<p>&#x8BB2;&#x5EA7;&#x9898;&#x76EE;&#xFF1A;&#x4F7F;&#x7528;MMS&#x5728;&#x963F;&#x91CC;&#x4E91;&#x90E8;&#x7F72;MongoDB&#x53CA;&#x8BBE;&#x7F6E;&#x76D1;&#x63A7;&#x5907;&#x4EFD; </p>
<p>&#x6F14;&#x8BB2;&#x5185;&#x5BB9;&#xFF1A;MMS&#x662F;&#x4E00;&#x9879;&#x53EF;&#x4F9B;&#x4F60;&#x9009;&#x62E9;&#x7684;&#x3001;&#x5728;&#x57FA;&#x7840;&#x8BBE;&#x65BD;&#x4E0A;&#x5BF9;MongoDB&#x8FDB;&#x884C;&#x914D;&#x7F6E;&#x3001;&#x76D1;&#x7763;&#x3001;&#x5907;&#x4EFD;&#x4EE5;&#x53CA;&#x62D3;&#x5C55;&#x7684;&#x4E91;&#x670D;&#x52A1;&#x3002;MMS&#x7531;&#x5F00;&#x53D1;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5DE5;&#x7A0B;&#x5E08;&#x521B;&#x5EFA;&#x3002;&#x5982;&#x4ECA;&#xFF0C;MMS&#x652F;&#x6491;&#x7740;&#x6570;&#x4EE5;&#x5343;&#x8BA1;&#x7684;&#x90E8;&#x7F72;&#xFF0C;&#x5305;&#x62EC;&#x8FD0;&#x884C;&#x4ECE;&#x4E00;&#x53F0;&#x5230;&#x6570;&#x767E;&#x53F0;&#x670D;&#x52A1;&#x5668;&#x7684;&#x7CFB;&#x7EDF;&#x3002; </p>
<p>&#x672C;&#x6B21;&#x8BB2;&#x5EA7;&#x5C06;&#x4ECB;&#x7ECD;MMS&#x7684;&#x57FA;&#x672C;&#x529F;&#x80FD;&#x548C;&#x754C;&#x9762;&#xFF0C;&#x6F14;&#x793A;&#x5982;&#x4F55;&#x4F7F;&#x7528;MMS Automation&#x5728;&#x963F;&#x91CC;&#x4E91;&#x4E0A;&#x90E8;&#x7F72;MongoDB Cluster&#xFF0C;&#x5E76;&#x4E14;&#x8BBE;&#x7F6E;&#x597D;&#x76D1;&#x63A7;&#x548C;&#x5907;&#x4EFD;&#x3002;</p>
<p>&#x6F14;&#x8BB2;&#x8005;&#xFF1A;&#x5170;&#x658C;&#xFF0C;MongoDB&#x7684;MMS&#x8F6F;&#x4EF6;&#x5F00;&#x53D1;&#x5DE5;&#x7A0B;&#x5E08; </p>
<p>PPT&#x5730;&#x5740;&#xFF1A; <a href="http://pan.baidu.com/s/1dipaQ" target="_blank" rel="external">http://pan.baidu.com/s/1dipaQ</a></p>
<h4 id="&#x4E0B;&#x4E00;&#x6B21;&#x8BB2;&#x5EA7;&#x9884;&#x544A;">&#x4E0B;&#x4E00;&#x6B21;&#x8BB2;&#x5EA7;&#x9884;&#x544A;</h4><h4 id="&#x9898;&#x76EE;&#xFF1A;&#x548C;&#x8001;&#x864E;&#x89C1;&#x9762;&#xFF1A;_WiredTiger&#x5B58;&#x50A8;&#x5F15;&#x64CE;&#x6280;&#x672F;&#x5185;&#x5E55;">&#x9898;&#x76EE;&#xFF1A;&#x548C;&#x8001;&#x864E;&#x89C1;&#x9762;&#xFF1A; WiredTiger&#x5B58;&#x50A8;&#x5F15;&#x64CE;&#x6280;&#x672F;&#x5185;&#x5E55;</h4><p>&#x65F6;&#x95F4;&#xFF1A;2015.07.29 &#xA0;20:00-21:00</p>
<p>&#x62A5;&#x540D;&#x5730;&#x5740;&#xFF1A; <a href="http://www.mongoing.com/event/2015/mms-monitoring" target="_blank" rel="external">http://www.mongoing.com/event/2015/wired-tiger-storage-engine</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/transcribe/">transcribe</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/MongoDB/">MongoDB</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/61/">61</a><a class="extend next" rel="next" href="/page/2/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/transcribe/" title="transcribe">transcribe<sup>606</sup></a></li>
		  
		
		  
			<li><a href="/categories/日志/" title="日志">日志<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/ZooKeeper/" title="ZooKeeper">ZooKeeper<sup>80</sup></a></li>
			
		
			
				<li><a href="/tags/Node-js/" title="Node.js">Node.js<sup>75</sup></a></li>
			
		
			
				<li><a href="/tags/Memcached/" title="Memcached">Memcached<sup>71</sup></a></li>
			
		
			
				<li><a href="/tags/JVM/" title="JVM">JVM<sup>65</sup></a></li>
			
		
			
				<li><a href="/tags/MongoDB/" title="MongoDB">MongoDB<sup>42</sup></a></li>
			
		
			
				<li><a href="/tags/io-js/" title="io.js">io.js<sup>35</sup></a></li>
			
		
			
				<li><a href="/tags/数据库/" title="数据库">数据库<sup>35</sup></a></li>
			
		
			
				<li><a href="/tags/Spring-MVC/" title="Spring MVC">Spring MVC<sup>33</sup></a></li>
			
		
			
				<li><a href="/tags/Gulp/" title="Gulp">Gulp<sup>29</sup></a></li>
			
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>28</sup></a></li>
			
		
			
				<li><a href="/tags/Nosql/" title="Nosql">Nosql<sup>27</sup></a></li>
			
		
			
				<li><a href="/tags/C/" title="C++">C++<sup>24</sup></a></li>
			
		
			
				<li><a href="/tags/开源/" title="开源">开源<sup>17</sup></a></li>
			
		
			
				<li><a href="/tags/Java/" title="Java">Java<sup>16</sup></a></li>
			
		
			
				<li><a href="/tags/Redis/" title="Redis">Redis<sup>15</sup></a></li>
			
		
			
				<li><a href="/tags/程序员/" title="程序员">程序员<sup>13</sup></a></li>
			
		
			
				<li><a href="/tags/Dubbo/" title="Dubbo">Dubbo<sup>13</sup></a></li>
			
		
			
				<li><a href="/tags/Net/" title=".Net">.Net<sup>11</sup></a></li>
			
		
			
				<li><a href="/tags/源码分析/" title="源码分析">源码分析<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/MySQL/" title="MySQL">MySQL<sup>10</sup></a></li>
			
		
		</ul>
</div>


<div class="weiboshow">
	<p class="asidetitle">新浪微博</p>
	<iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=1289635200&verifier=e6bef170&dpc=1"></iframe>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Larry Page in Google. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/512316815" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/sblig" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/sblig" target="_blank" title="fblog">fblog</a> © 2015
		
		<a href="/about" target="_blank" title="edwin">edwin</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
